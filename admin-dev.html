<!doctype html>
<html lang="nl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hoofdadmin ‚Äì Dev tools</title>
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="stylesheet" href="/style.css">
  </head>
  <body>
    <!-- Topbar -->
    <header class="topbar">
      <div class="brand">Shadow App</div>
      <nav class="nav" aria-label="Hoofdnavigatie">
        <a href="/" class="tab" id="btnMember">Lid</a>
        <a href="/admin-scan.html" class="tab" id="btnAdmin">Inschrijftafel</a>
      </nav>
    </header>

    <main class="wrap">

      <div class="admin-nav-dropdown">
        <select id="adminNavSelect" class="admin-nav-select">
          <option value="admin-scan.html">Inschrijftafel</option>
          <option value="admin-planning.html">Begin van het jaar</option>
          <option value="admin-passwords.html">Wachtwoorden</option>
          <option value="admin-stats.html">Ritten data</option>
          <option value="admin-lunch.html">Lunch inplannen</option>
                      <option value="admin-excel.html">Excel import / export</option>

          <option value="admin-dev.html" selected>Dev</option>
        </select>
      </div>

      <section class="card">
        <div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
          <span style="font-size: 22px;">üß™</span>
          <h2 style="margin:0;">Reset acties</h2>
        </div>
        <p class="muted" style="margin: 6px 0 12px 0;">Gevaarlijk: deze acties passen alle leden aan. Alleen gebruiken voor tests of bij jaarswitch.</p>
        <div class="row" style="gap:12px; align-items:center; flex-wrap:wrap;">
          <button id="resetJaarhangerBtn" class="btn" style="border-color:#ef4444;">‚ö†Ô∏è Reset Jaarhanger voor alle leden</button>
          <span id="resetJaarhangerStatus" class="status"></span>
        </div>
        <div class="row" style="gap:12px; align-items:center; flex-wrap:wrap; margin-top:10px;">
          <button id="resetLunchBtn" class="btn" style="border-color:#ef4444;">‚ö†Ô∏è Reset alle lunchgegevens</button>
          <span id="resetLunchStatus" class="status"></span>
        </div>
        <details class="muted" style="margin-top:12px;">
          <summary>Wat wordt gereset?</summary>
          <ul>
            <li>Jaarhanger: veld <code>Jaarhanger</code> wordt leeg gemaakt ("") voor alle members</li>
            <li>Lunch: velden <code>lunchDeelname</code>, <code>lunchKeuze</code>, <code>lunchTimestamp</code>, <code>lunchRideDateYMD</code> worden op <code>null</code> gezet</li>
          </ul>
        </details>
      </section>
    </main>

    <script type="module">
      import { checkAdminAuth, applyAdminLevel } from '/src/auth.js';
      import { initAdminView } from '/src/admin.js';

      // Dropdown navigation handler
      const navSelect = document.getElementById('adminNavSelect');
      if (navSelect) {
        navSelect.addEventListener('change', (e) => {
          window.location.href = e.target.value;
        });
      }

      // Alleen root admins voor deze pagina
      if (checkAdminAuth()) {
        const adminLevel = sessionStorage.getItem("admin_level");
        if (adminLevel !== "root") {
          window.location.href = "admin-scan.html";
        } else {
          applyAdminLevel();
          initAdminView();
        }
      }
    </script>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
