(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var oc={},hw=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},jg={},Qr={};let y0;const dw=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Qr.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};Qr.getSymbolTotalCodewords=function(e){return dw[e]};Qr.getBCHDigit=function(r){let e=0;for(;r!==0;)e++,r>>>=1;return e};Qr.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');y0=e};Qr.isKanjiModeEnabled=function(){return typeof y0<"u"};Qr.toSJIS=function(e){return y0(e)};var su={};(function(r){r.L={bit:1},r.M={bit:0},r.Q={bit:3},r.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return r.L;case"m":case"medium":return r.M;case"q":case"quartile":return r.Q;case"h":case"high":return r.H;default:throw new Error("Unknown EC Level: "+t)}}r.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},r.from=function(n,i){if(r.isValid(n))return n;try{return e(n)}catch{return i}}})(su);function Kg(){this.buffer=[],this.length=0}Kg.prototype={get:function(r){const e=Math.floor(r/8);return(this.buffer[e]>>>7-r%8&1)===1},put:function(r,e){for(let t=0;t<e;t++)this.putBit((r>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),r&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var mw=Kg;function cc(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}cc.prototype.set=function(r,e,t,n){const i=r*this.size+e;this.data[i]=t,n&&(this.reservedBit[i]=!0)};cc.prototype.get=function(r,e){return this.data[r*this.size+e]};cc.prototype.xor=function(r,e,t){this.data[r*this.size+e]^=t};cc.prototype.isReserved=function(r,e){return this.reservedBit[r*this.size+e]};var pw=cc,qg={};(function(r){const e=Qr.getSymbolSize;r.getRowColCoords=function(n){if(n===1)return[];const i=Math.floor(n/7)+2,s=e(n),a=s===145?26:Math.ceil((s-13)/(2*i-2))*2,o=[s-7];for(let c=1;c<i-1;c++)o[c]=o[c-1]-a;return o.push(6),o.reverse()},r.getPositions=function(n){const i=[],s=r.getRowColCoords(n),a=s.length;for(let o=0;o<a;o++)for(let c=0;c<a;c++)o===0&&c===0||o===0&&c===a-1||o===a-1&&c===0||i.push([s[o],s[c]]);return i}})(qg);var Xg={};const gw=Qr.getSymbolSize,em=7;Xg.getPositions=function(e){const t=gw(e);return[[0,0],[t-em,0],[0,t-em]]};var Qg={};(function(r){r.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};r.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},r.from=function(i){return r.isValid(i)?parseInt(i,10):void 0},r.getPenaltyN1=function(i){const s=i.size;let a=0,o=0,c=0,l=null,u=null;for(let h=0;h<s;h++){o=c=0,l=u=null;for(let d=0;d<s;d++){let m=i.get(h,d);m===l?o++:(o>=5&&(a+=e.N1+(o-5)),l=m,o=1),m=i.get(d,h),m===u?c++:(c>=5&&(a+=e.N1+(c-5)),u=m,c=1)}o>=5&&(a+=e.N1+(o-5)),c>=5&&(a+=e.N1+(c-5))}return a},r.getPenaltyN2=function(i){const s=i.size;let a=0;for(let o=0;o<s-1;o++)for(let c=0;c<s-1;c++){const l=i.get(o,c)+i.get(o,c+1)+i.get(o+1,c)+i.get(o+1,c+1);(l===4||l===0)&&a++}return a*e.N2},r.getPenaltyN3=function(i){const s=i.size;let a=0,o=0,c=0;for(let l=0;l<s;l++){o=c=0;for(let u=0;u<s;u++)o=o<<1&2047|i.get(l,u),u>=10&&(o===1488||o===93)&&a++,c=c<<1&2047|i.get(u,l),u>=10&&(c===1488||c===93)&&a++}return a*e.N3},r.getPenaltyN4=function(i){let s=0;const a=i.data.length;for(let c=0;c<a;c++)s+=i.data[c];return Math.abs(Math.ceil(s*100/a/5)-10)*e.N4};function t(n,i,s){switch(n){case r.Patterns.PATTERN000:return(i+s)%2===0;case r.Patterns.PATTERN001:return i%2===0;case r.Patterns.PATTERN010:return s%3===0;case r.Patterns.PATTERN011:return(i+s)%3===0;case r.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(s/3))%2===0;case r.Patterns.PATTERN101:return i*s%2+i*s%3===0;case r.Patterns.PATTERN110:return(i*s%2+i*s%3)%2===0;case r.Patterns.PATTERN111:return(i*s%3+(i+s)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}r.applyMask=function(i,s){const a=s.size;for(let o=0;o<a;o++)for(let c=0;c<a;c++)s.isReserved(c,o)||s.xor(c,o,t(i,c,o))},r.getBestMask=function(i,s){const a=Object.keys(r.Patterns).length;let o=0,c=1/0;for(let l=0;l<a;l++){s(l),r.applyMask(l,i);const u=r.getPenaltyN1(i)+r.getPenaltyN2(i)+r.getPenaltyN3(i)+r.getPenaltyN4(i);r.applyMask(l,i),u<c&&(c=u,o=l)}return o}})(Qg);var au={};const di=su,$c=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],jc=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];au.getBlocksCount=function(e,t){switch(t){case di.L:return $c[(e-1)*4+0];case di.M:return $c[(e-1)*4+1];case di.Q:return $c[(e-1)*4+2];case di.H:return $c[(e-1)*4+3];default:return}};au.getTotalCodewordsCount=function(e,t){switch(t){case di.L:return jc[(e-1)*4+0];case di.M:return jc[(e-1)*4+1];case di.Q:return jc[(e-1)*4+2];case di.H:return jc[(e-1)*4+3];default:return}};var Yg={},ou={};const po=new Uint8Array(512),El=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)po[t]=e,El[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)po[t]=po[t-255]})();ou.log=function(e){if(e<1)throw new Error("log("+e+")");return El[e]};ou.exp=function(e){return po[e]};ou.mul=function(e,t){return e===0||t===0?0:po[El[e]+El[t]]};(function(r){const e=ou;r.mul=function(n,i){const s=new Uint8Array(n.length+i.length-1);for(let a=0;a<n.length;a++)for(let o=0;o<i.length;o++)s[a+o]^=e.mul(n[a],i[o]);return s},r.mod=function(n,i){let s=new Uint8Array(n);for(;s.length-i.length>=0;){const a=s[0];for(let c=0;c<i.length;c++)s[c]^=e.mul(i[c],a);let o=0;for(;o<s.length&&s[o]===0;)o++;s=s.slice(o)}return s},r.generateECPolynomial=function(n){let i=new Uint8Array([1]);for(let s=0;s<n;s++)i=r.mul(i,new Uint8Array([1,e.exp(s)]));return i}})(Yg);const Jg=Yg;function w0(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}w0.prototype.initialize=function(e){this.degree=e,this.genPoly=Jg.generateECPolynomial(this.degree)};w0.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const n=Jg.mod(t,this.genPoly),i=this.degree-n.length;if(i>0){const s=new Uint8Array(this.degree);return s.set(n,i),s}return n};var _w=w0,Zg={},Pi={},E0={};E0.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var Nn={};const e1="[0-9]+",xw="[A-Z $%*+\\-./:]+";let bo="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";bo=bo.replace(/u/g,"\\u");const vw="(?:(?![A-Z0-9 $%*+\\-./:]|"+bo+`)(?:.|[\r
]))+`;Nn.KANJI=new RegExp(bo,"g");Nn.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Nn.BYTE=new RegExp(vw,"g");Nn.NUMERIC=new RegExp(e1,"g");Nn.ALPHANUMERIC=new RegExp(xw,"g");const yw=new RegExp("^"+bo+"$"),ww=new RegExp("^"+e1+"$"),Ew=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Nn.testKanji=function(e){return yw.test(e)};Nn.testNumeric=function(e){return ww.test(e)};Nn.testAlphanumeric=function(e){return Ew.test(e)};(function(r){const e=E0,t=Nn;r.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},r.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},r.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},r.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},r.MIXED={bit:-1},r.getCharCountIndicator=function(s,a){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?s.ccBits[0]:a<27?s.ccBits[1]:s.ccBits[2]},r.getBestModeForData=function(s){return t.testNumeric(s)?r.NUMERIC:t.testAlphanumeric(s)?r.ALPHANUMERIC:t.testKanji(s)?r.KANJI:r.BYTE},r.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},r.isValid=function(s){return s&&s.bit&&s.ccBits};function n(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return r.NUMERIC;case"alphanumeric":return r.ALPHANUMERIC;case"kanji":return r.KANJI;case"byte":return r.BYTE;default:throw new Error("Unknown mode: "+i)}}r.from=function(s,a){if(r.isValid(s))return s;try{return n(s)}catch{return a}}})(Pi);(function(r){const e=Qr,t=au,n=su,i=Pi,s=E0,a=7973,o=e.getBCHDigit(a);function c(d,m,g){for(let p=1;p<=40;p++)if(m<=r.getCapacity(p,g,d))return p}function l(d,m){return i.getCharCountIndicator(d,m)+4}function u(d,m){let g=0;return d.forEach(function(p){const x=l(p.mode,m);g+=x+p.getBitsLength()}),g}function h(d,m){for(let g=1;g<=40;g++)if(u(d,g)<=r.getCapacity(g,m,i.MIXED))return g}r.from=function(m,g){return s.isValid(m)?parseInt(m,10):g},r.getCapacity=function(m,g,p){if(!s.isValid(m))throw new Error("Invalid QR Code version");typeof p>"u"&&(p=i.BYTE);const x=e.getSymbolTotalCodewords(m),T=t.getTotalCodewordsCount(m,g),C=(x-T)*8;if(p===i.MIXED)return C;const w=C-l(p,m);switch(p){case i.NUMERIC:return Math.floor(w/10*3);case i.ALPHANUMERIC:return Math.floor(w/11*2);case i.KANJI:return Math.floor(w/13);case i.BYTE:default:return Math.floor(w/8)}},r.getBestVersionForData=function(m,g){let p;const x=n.from(g,n.M);if(Array.isArray(m)){if(m.length>1)return h(m,x);if(m.length===0)return 1;p=m[0]}else p=m;return c(p.mode,p.getLength(),x)},r.getEncodedBits=function(m){if(!s.isValid(m)||m<7)throw new Error("Invalid QR Code version");let g=m<<12;for(;e.getBCHDigit(g)-o>=0;)g^=a<<e.getBCHDigit(g)-o;return m<<12|g}})(Zg);var t1={};const Ff=Qr,r1=1335,Tw=21522,tm=Ff.getBCHDigit(r1);t1.getEncodedBits=function(e,t){const n=e.bit<<3|t;let i=n<<10;for(;Ff.getBCHDigit(i)-tm>=0;)i^=r1<<Ff.getBCHDigit(i)-tm;return(n<<10|i)^Tw};var n1={};const Aw=Pi;function ha(r){this.mode=Aw.NUMERIC,this.data=r.toString()}ha.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};ha.prototype.getLength=function(){return this.data.length};ha.prototype.getBitsLength=function(){return ha.getBitsLength(this.data.length)};ha.prototype.write=function(e){let t,n,i;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),i=parseInt(n,10),e.put(i,10);const s=this.data.length-t;s>0&&(n=this.data.substr(t),i=parseInt(n,10),e.put(i,s*3+1))};var Sw=ha;const Iw=Pi,Yu=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function da(r){this.mode=Iw.ALPHANUMERIC,this.data=r}da.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};da.prototype.getLength=function(){return this.data.length};da.prototype.getBitsLength=function(){return da.getBitsLength(this.data.length)};da.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=Yu.indexOf(this.data[t])*45;n+=Yu.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(Yu.indexOf(this.data[t]),6)};var kw=da;const Cw=Pi;function ma(r){this.mode=Cw.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}ma.getBitsLength=function(e){return e*8};ma.prototype.getLength=function(){return this.data.length};ma.prototype.getBitsLength=function(){return ma.getBitsLength(this.data.length)};ma.prototype.write=function(r){for(let e=0,t=this.data.length;e<t;e++)r.put(this.data[e],8)};var bw=ma;const Rw=Pi,Fw=Qr;function pa(r){this.mode=Rw.KANJI,this.data=r}pa.getBitsLength=function(e){return e*13};pa.prototype.getLength=function(){return this.data.length};pa.prototype.getBitsLength=function(){return pa.getBitsLength(this.data.length)};pa.prototype.write=function(r){let e;for(e=0;e<this.data.length;e++){let t=Fw.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),r.put(t,13)}};var Dw=pa,i1={exports:{}};(function(r){var e={single_source_shortest_paths:function(t,n,i){var s={},a={};a[n]=0;var o=e.PriorityQueue.make();o.push(n,0);for(var c,l,u,h,d,m,g,p,x;!o.empty();){c=o.pop(),l=c.value,h=c.cost,d=t[l]||{};for(u in d)d.hasOwnProperty(u)&&(m=d[u],g=h+m,p=a[u],x=typeof a[u]>"u",(x||p>g)&&(a[u]=g,o.push(u,g),s[u]=l))}if(typeof i<"u"&&typeof a[i]>"u"){var T=["Could not find a path from ",n," to ",i,"."].join("");throw new Error(T)}return s},extract_shortest_path_from_predecessor_list:function(t,n){for(var i=[],s=n;s;)i.push(s),t[s],s=t[s];return i.reverse(),i},find_path:function(t,n,i){var s=e.single_source_shortest_paths(t,n,i);return e.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(t){var n=e.PriorityQueue,i={},s;t=t||{};for(s in n)n.hasOwnProperty(s)&&(i[s]=n[s]);return i.queue=[],i.sorter=t.sorter||n.default_sorter,i},default_sorter:function(t,n){return t.cost-n.cost},push:function(t,n){var i={value:t,cost:n};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};r.exports=e})(i1);var Pw=i1.exports;(function(r){const e=Pi,t=Sw,n=kw,i=bw,s=Dw,a=Nn,o=Qr,c=Pw;function l(T){return unescape(encodeURIComponent(T)).length}function u(T,C,w){const F=[];let L;for(;(L=T.exec(w))!==null;)F.push({data:L[0],index:L.index,mode:C,length:L[0].length});return F}function h(T){const C=u(a.NUMERIC,e.NUMERIC,T),w=u(a.ALPHANUMERIC,e.ALPHANUMERIC,T);let F,L;return o.isKanjiModeEnabled()?(F=u(a.BYTE,e.BYTE,T),L=u(a.KANJI,e.KANJI,T)):(F=u(a.BYTE_KANJI,e.BYTE,T),L=[]),C.concat(w,F,L).sort(function(v,A){return v.index-A.index}).map(function(v){return{data:v.data,mode:v.mode,length:v.length}})}function d(T,C){switch(C){case e.NUMERIC:return t.getBitsLength(T);case e.ALPHANUMERIC:return n.getBitsLength(T);case e.KANJI:return s.getBitsLength(T);case e.BYTE:return i.getBitsLength(T)}}function m(T){return T.reduce(function(C,w){const F=C.length-1>=0?C[C.length-1]:null;return F&&F.mode===w.mode?(C[C.length-1].data+=w.data,C):(C.push(w),C)},[])}function g(T){const C=[];for(let w=0;w<T.length;w++){const F=T[w];switch(F.mode){case e.NUMERIC:C.push([F,{data:F.data,mode:e.ALPHANUMERIC,length:F.length},{data:F.data,mode:e.BYTE,length:F.length}]);break;case e.ALPHANUMERIC:C.push([F,{data:F.data,mode:e.BYTE,length:F.length}]);break;case e.KANJI:C.push([F,{data:F.data,mode:e.BYTE,length:l(F.data)}]);break;case e.BYTE:C.push([{data:F.data,mode:e.BYTE,length:l(F.data)}])}}return C}function p(T,C){const w={},F={start:{}};let L=["start"];for(let O=0;O<T.length;O++){const v=T[O],A=[];for(let y=0;y<v.length;y++){const I=v[y],k=""+O+y;A.push(k),w[k]={node:I,lastCount:0},F[k]={};for(let b=0;b<L.length;b++){const R=L[b];w[R]&&w[R].node.mode===I.mode?(F[R][k]=d(w[R].lastCount+I.length,I.mode)-d(w[R].lastCount,I.mode),w[R].lastCount+=I.length):(w[R]&&(w[R].lastCount=I.length),F[R][k]=d(I.length,I.mode)+4+e.getCharCountIndicator(I.mode,C))}}L=A}for(let O=0;O<L.length;O++)F[L[O]].end=0;return{map:F,table:w}}function x(T,C){let w;const F=e.getBestModeForData(T);if(w=e.from(C,F),w!==e.BYTE&&w.bit<F.bit)throw new Error('"'+T+'" cannot be encoded with mode '+e.toString(w)+`.
 Suggested mode is: `+e.toString(F));switch(w===e.KANJI&&!o.isKanjiModeEnabled()&&(w=e.BYTE),w){case e.NUMERIC:return new t(T);case e.ALPHANUMERIC:return new n(T);case e.KANJI:return new s(T);case e.BYTE:return new i(T)}}r.fromArray=function(C){return C.reduce(function(w,F){return typeof F=="string"?w.push(x(F,null)):F.data&&w.push(x(F.data,F.mode)),w},[])},r.fromString=function(C,w){const F=h(C,o.isKanjiModeEnabled()),L=g(F),O=p(L,w),v=c.find_path(O.map,"start","end"),A=[];for(let y=1;y<v.length-1;y++)A.push(O.table[v[y]].node);return r.fromArray(m(A))},r.rawSplit=function(C){return r.fromArray(h(C,o.isKanjiModeEnabled()))}})(n1);const cu=Qr,Ju=su,Nw=mw,Ow=pw,Lw=qg,Mw=Xg,Df=Qg,Pf=au,Vw=_w,Tl=Zg,Bw=t1,Uw=Pi,Zu=n1;function Gw(r,e){const t=r.size,n=Mw.getPositions(e);for(let i=0;i<n.length;i++){const s=n[i][0],a=n[i][1];for(let o=-1;o<=7;o++)if(!(s+o<=-1||t<=s+o))for(let c=-1;c<=7;c++)a+c<=-1||t<=a+c||(o>=0&&o<=6&&(c===0||c===6)||c>=0&&c<=6&&(o===0||o===6)||o>=2&&o<=4&&c>=2&&c<=4?r.set(s+o,a+c,!0,!0):r.set(s+o,a+c,!1,!0))}}function Ww(r){const e=r.size;for(let t=8;t<e-8;t++){const n=t%2===0;r.set(t,6,n,!0),r.set(6,t,n,!0)}}function Hw(r,e){const t=Lw.getPositions(e);for(let n=0;n<t.length;n++){const i=t[n][0],s=t[n][1];for(let a=-2;a<=2;a++)for(let o=-2;o<=2;o++)a===-2||a===2||o===-2||o===2||a===0&&o===0?r.set(i+a,s+o,!0,!0):r.set(i+a,s+o,!1,!0)}}function zw(r,e){const t=r.size,n=Tl.getEncodedBits(e);let i,s,a;for(let o=0;o<18;o++)i=Math.floor(o/3),s=o%3+t-8-3,a=(n>>o&1)===1,r.set(i,s,a,!0),r.set(s,i,a,!0)}function ef(r,e,t){const n=r.size,i=Bw.getEncodedBits(e,t);let s,a;for(s=0;s<15;s++)a=(i>>s&1)===1,s<6?r.set(s,8,a,!0):s<8?r.set(s+1,8,a,!0):r.set(n-15+s,8,a,!0),s<8?r.set(8,n-s-1,a,!0):s<9?r.set(8,15-s-1+1,a,!0):r.set(8,15-s-1,a,!0);r.set(n-8,8,1,!0)}function $w(r,e){const t=r.size;let n=-1,i=t-1,s=7,a=0;for(let o=t-1;o>0;o-=2)for(o===6&&o--;;){for(let c=0;c<2;c++)if(!r.isReserved(i,o-c)){let l=!1;a<e.length&&(l=(e[a]>>>s&1)===1),r.set(i,o-c,l),s--,s===-1&&(a++,s=7)}if(i+=n,i<0||t<=i){i-=n,n=-n;break}}}function jw(r,e,t){const n=new Nw;t.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),Uw.getCharCountIndicator(c.mode,r)),c.write(n)});const i=cu.getSymbolTotalCodewords(r),s=Pf.getTotalCodewordsCount(r,e),a=(i-s)*8;for(n.getLengthInBits()+4<=a&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const o=(a-n.getLengthInBits())/8;for(let c=0;c<o;c++)n.put(c%2?17:236,8);return Kw(n,r,e)}function Kw(r,e,t){const n=cu.getSymbolTotalCodewords(e),i=Pf.getTotalCodewordsCount(e,t),s=n-i,a=Pf.getBlocksCount(e,t),o=n%a,c=a-o,l=Math.floor(n/a),u=Math.floor(s/a),h=u+1,d=l-u,m=new Vw(d);let g=0;const p=new Array(a),x=new Array(a);let T=0;const C=new Uint8Array(r.buffer);for(let v=0;v<a;v++){const A=v<c?u:h;p[v]=C.slice(g,g+A),x[v]=m.encode(p[v]),g+=A,T=Math.max(T,A)}const w=new Uint8Array(n);let F=0,L,O;for(L=0;L<T;L++)for(O=0;O<a;O++)L<p[O].length&&(w[F++]=p[O][L]);for(L=0;L<d;L++)for(O=0;O<a;O++)w[F++]=x[O][L];return w}function qw(r,e,t,n){let i;if(Array.isArray(r))i=Zu.fromArray(r);else if(typeof r=="string"){let l=e;if(!l){const u=Zu.rawSplit(r);l=Tl.getBestVersionForData(u,t)}i=Zu.fromString(r,l||40)}else throw new Error("Invalid data");const s=Tl.getBestVersionForData(i,t);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=s;else if(e<s)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+s+`.
`);const a=jw(e,t,i),o=cu.getSymbolSize(e),c=new Ow(o);return Gw(c,e),Ww(c),Hw(c,e),ef(c,t,0),e>=7&&zw(c,e),$w(c,a),isNaN(n)&&(n=Df.getBestMask(c,ef.bind(null,c,t))),Df.applyMask(n,c),ef(c,t,n),{modules:c,version:e,errorCorrectionLevel:t,maskPattern:n,segments:i}}jg.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let n=Ju.M,i,s;return typeof t<"u"&&(n=Ju.from(t.errorCorrectionLevel,Ju.M),i=Tl.from(t.version),s=Df.from(t.maskPattern),t.toSJISFunc&&cu.setToSJISFunction(t.toSJISFunc)),qw(e,i,n,s)};var s1={},T0={};(function(r){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let n=t.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+t);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(s){return[s,s]}))),n.length===6&&n.push("F","F");const i=parseInt(n.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+n.slice(0,6).join("")}}r.getOptions=function(n){n||(n={}),n.color||(n.color={});const i=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,s=n.width&&n.width>=21?n.width:void 0,a=n.scale||4;return{width:s,scale:s?4:a,margin:i,color:{dark:e(n.color.dark||"#000000ff"),light:e(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},r.getScale=function(n,i){return i.width&&i.width>=n+i.margin*2?i.width/(n+i.margin*2):i.scale},r.getImageWidth=function(n,i){const s=r.getScale(n,i);return Math.floor((n+i.margin*2)*s)},r.qrToImageData=function(n,i,s){const a=i.modules.size,o=i.modules.data,c=r.getScale(a,s),l=Math.floor((a+s.margin*2)*c),u=s.margin*c,h=[s.color.light,s.color.dark];for(let d=0;d<l;d++)for(let m=0;m<l;m++){let g=(d*l+m)*4,p=s.color.light;if(d>=u&&m>=u&&d<l-u&&m<l-u){const x=Math.floor((d-u)/c),T=Math.floor((m-u)/c);p=h[o[x*a+T]?1:0]}n[g++]=p.r,n[g++]=p.g,n[g++]=p.b,n[g]=p.a}}})(T0);(function(r){const e=T0;function t(i,s,a){i.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=a,s.width=a,s.style.height=a+"px",s.style.width=a+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}r.render=function(s,a,o){let c=o,l=a;typeof c>"u"&&(!a||!a.getContext)&&(c=a,a=void 0),a||(l=n()),c=e.getOptions(c);const u=e.getImageWidth(s.modules.size,c),h=l.getContext("2d"),d=h.createImageData(u,u);return e.qrToImageData(d.data,s,c),t(h,l,u),h.putImageData(d,0,0),l},r.renderToDataURL=function(s,a,o){let c=o;typeof c>"u"&&(!a||!a.getContext)&&(c=a,a=void 0),c||(c={});const l=r.render(s,a,c),u=c.type||"image/png",h=c.rendererOpts||{};return l.toDataURL(u,h.quality)}})(s1);var a1={};const Xw=T0;function rm(r,e){const t=r.a/255,n=e+'="'+r.hex+'"';return t<1?n+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':n}function tf(r,e,t){let n=r+e;return typeof t<"u"&&(n+=" "+t),n}function Qw(r,e,t){let n="",i=0,s=!1,a=0;for(let o=0;o<r.length;o++){const c=Math.floor(o%e),l=Math.floor(o/e);!c&&!s&&(s=!0),r[o]?(a++,o>0&&c>0&&r[o-1]||(n+=s?tf("M",c+t,.5+l+t):tf("m",i,0),i=0,s=!1),c+1<e&&r[o+1]||(n+=tf("h",a),a=0)):i++}return n}a1.render=function(e,t,n){const i=Xw.getOptions(t),s=e.modules.size,a=e.modules.data,o=s+i.margin*2,c=i.color.light.a?"<path "+rm(i.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",l="<path "+rm(i.color.dark,"stroke")+' d="'+Qw(a,s,i.margin)+'"/>',u='viewBox="0 0 '+o+" "+o+'"',d='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+u+' shape-rendering="crispEdges">'+c+l+`</svg>
`;return typeof n=="function"&&n(null,d),d};const Yw=hw,Nf=jg,o1=s1,Jw=a1;function A0(r,e,t,n,i){const s=[].slice.call(arguments,1),a=s.length,o=typeof s[a-1]=="function";if(!o&&!Yw())throw new Error("Callback required as last argument");if(o){if(a<2)throw new Error("Too few arguments provided");a===2?(i=t,t=e,e=n=void 0):a===3&&(e.getContext&&typeof i>"u"?(i=n,n=void 0):(i=n,n=t,t=e,e=void 0))}else{if(a<1)throw new Error("Too few arguments provided");return a===1?(t=e,e=n=void 0):a===2&&!e.getContext&&(n=t,t=e,e=void 0),new Promise(function(c,l){try{const u=Nf.create(t,n);c(r(u,e,n))}catch(u){l(u)}})}try{const c=Nf.create(t,n);i(null,r(c,e,n))}catch(c){i(c)}}oc.create=Nf.create;oc.toCanvas=A0.bind(null,o1.render);oc.toDataURL=A0.bind(null,o1.renderToDataURL);oc.toString=A0.bind(null,function(r,e,t){return Jw.render(r,t)});var nm={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Zw=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],a=r[t++],o=r[t++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=r[t++],a=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},l1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],a=i+1<r.length,o=a?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0,u=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|l>>6,m=l&63;c||(m=64,a||(d=64)),n.push(t[u],t[h],t[d],t[m])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(c1(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):Zw(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],o=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const h=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||o==null||l==null||h==null)throw new eE;const d=s<<2|o>>4;if(n.push(d),l!==64){const m=o<<4&240|l>>2;if(n.push(m),h!==64){const g=l<<6&192|h;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class eE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tE=function(r){const e=c1(r);return l1.encodeByteArray(e,!0)},Al=function(r){return tE(r).replace(/\./g,"")},rE=function(r){try{return l1.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=()=>nE().__FIREBASE_DEFAULTS__,sE=()=>{if(typeof process>"u"||typeof nm>"u")return;const r=nm.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},aE=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&rE(r[1]);return e&&JSON.parse(e)},S0=()=>{try{return iE()||sE()||aE()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},oE=r=>{var e,t;return(t=(e=S0())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},cE=r=>{const e=oE(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},u1=()=>{var r;return(r=S0())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Al(JSON.stringify(t)),Al(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sl(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fE(){var r;const e=(r=S0())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function f1(){return!fE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function h1(){try{return typeof indexedDB=="object"}catch{return!1}}function hE(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE="FirebaseError";class Is extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=dE,Object.setPrototypeOf(this,Is.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,d1.prototype.create)}}class d1{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?mE(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Is(i,o,n)}}function mE(r,e){return r.replace(pE,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const pE=/\{\$([^}]+)}/g;function Ro(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],a=e[i];if(im(s)&&im(a)){if(!Ro(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function im(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(r){return r&&r._delegate?r._delegate:r}class ga{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new lE;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xE(e))try{this.getOrInitializeService({instanceIdentifier:Yi})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Yi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yi){return this.instances.has(e)}getOptions(e=Yi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:_E(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Yi){return this.component?this.component.multipleInstances?e:Yi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _E(r){return r===Yi?void 0:r}function xE(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new gE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Qe||(Qe={}));const yE={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},wE=Qe.INFO,EE={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},TE=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=EE[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class m1{constructor(e){this.name=e,this._logLevel=wE,this._logHandler=TE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const AE=(r,e)=>e.some(t=>r instanceof t);let sm,am;function SE(){return sm||(sm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IE(){return am||(am=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const p1=new WeakMap,Of=new WeakMap,g1=new WeakMap,rf=new WeakMap,I0=new WeakMap;function kE(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",a)},s=()=>{t(vi(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&p1.set(t,r)}).catch(()=>{}),I0.set(e,r),e}function CE(r){if(Of.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",a),r.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",a),r.addEventListener("abort",a)});Of.set(r,e)}let Lf={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Of.get(r);if(e==="objectStoreNames")return r.objectStoreNames||g1.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return vi(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function bE(r){Lf=r(Lf)}function RE(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(nf(this),e,...t);return g1.set(n,e.sort?e.sort():[e]),vi(n)}:IE().includes(r)?function(...e){return r.apply(nf(this),e),vi(p1.get(this))}:function(...e){return vi(r.apply(nf(this),e))}}function FE(r){return typeof r=="function"?RE(r):(r instanceof IDBTransaction&&CE(r),AE(r,SE())?new Proxy(r,Lf):r)}function vi(r){if(r instanceof IDBRequest)return kE(r);if(rf.has(r))return rf.get(r);const e=FE(r);return e!==r&&(rf.set(r,e),I0.set(e,r)),e}const nf=r=>I0.get(r);function DE(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(r,e),o=vi(a);return n&&a.addEventListener("upgradeneeded",c=>{n(vi(a.result),c.oldVersion,c.newVersion,vi(a.transaction),c)}),t&&a.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const PE=["get","getKey","getAll","getAllKeys","count"],NE=["put","add","delete","clear"],sf=new Map;function om(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(sf.get(e))return sf.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=NE.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||PE.includes(t)))return;const s=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[t](...o),i&&c.done]))[0]};return sf.set(e,s),s}bE(r=>({...r,get:(e,t,n)=>om(e,t)||r.get(e,t,n),has:(e,t)=>!!om(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(LE(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function LE(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mf="@firebase/app",cm="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn=new m1("@firebase/app"),ME="@firebase/app-compat",VE="@firebase/analytics-compat",BE="@firebase/analytics",UE="@firebase/app-check-compat",GE="@firebase/app-check",WE="@firebase/auth",HE="@firebase/auth-compat",zE="@firebase/database",$E="@firebase/data-connect",jE="@firebase/database-compat",KE="@firebase/functions",qE="@firebase/functions-compat",XE="@firebase/installations",QE="@firebase/installations-compat",YE="@firebase/messaging",JE="@firebase/messaging-compat",ZE="@firebase/performance",e2="@firebase/performance-compat",t2="@firebase/remote-config",r2="@firebase/remote-config-compat",n2="@firebase/storage",i2="@firebase/storage-compat",s2="@firebase/firestore",a2="@firebase/vertexai-preview",o2="@firebase/firestore-compat",c2="firebase",l2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vf="[DEFAULT]",u2={[Mf]:"fire-core",[ME]:"fire-core-compat",[BE]:"fire-analytics",[VE]:"fire-analytics-compat",[GE]:"fire-app-check",[UE]:"fire-app-check-compat",[WE]:"fire-auth",[HE]:"fire-auth-compat",[zE]:"fire-rtdb",[$E]:"fire-data-connect",[jE]:"fire-rtdb-compat",[KE]:"fire-fn",[qE]:"fire-fn-compat",[XE]:"fire-iid",[QE]:"fire-iid-compat",[YE]:"fire-fcm",[JE]:"fire-fcm-compat",[ZE]:"fire-perf",[e2]:"fire-perf-compat",[t2]:"fire-rc",[r2]:"fire-rc-compat",[n2]:"fire-gcs",[i2]:"fire-gcs-compat",[s2]:"fire-fst",[o2]:"fire-fst-compat",[a2]:"fire-vertex","fire-js":"fire-js",[c2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=new Map,f2=new Map,Bf=new Map;function lm(r,e){try{r.container.addComponent(e)}catch(t){Yn.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Fo(r){const e=r.name;if(Bf.has(e))return Yn.debug(`There were multiple attempts to register component ${e}.`),!1;Bf.set(e,r);for(const t of Il.values())lm(t,r);for(const t of f2.values())lm(t,r);return!0}function _1(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yi=new d1("app","Firebase",h2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ga("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1=l2;function v1(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Vf,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw yi.create("bad-app-name",{appName:String(i)});if(t||(t=u1()),!t)throw yi.create("no-options");const s=Il.get(i);if(s){if(Ro(t,s.options)&&Ro(n,s.config))return s;throw yi.create("duplicate-app",{appName:i})}const a=new vE(i);for(const c of Bf.values())a.addComponent(c);const o=new d2(t,n,a);return Il.set(i,o),o}function m2(r=Vf){const e=Il.get(r);if(!e&&r===Vf&&u1())return v1();if(!e)throw yi.create("no-app",{appName:r});return e}function wi(r,e,t){var n;let i=(n=u2[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yn.warn(o.join(" "));return}Fo(new ga(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2="firebase-heartbeat-database",g2=1,Do="firebase-heartbeat-store";let af=null;function y1(){return af||(af=DE(p2,g2,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Do)}catch(t){console.warn(t)}}}}).catch(r=>{throw yi.create("idb-open",{originalErrorMessage:r.message})})),af}async function _2(r){try{const t=(await y1()).transaction(Do),n=await t.objectStore(Do).get(w1(r));return await t.done,n}catch(e){if(e instanceof Is)Yn.warn(e.message);else{const t=yi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Yn.warn(t.message)}}}async function um(r,e){try{const n=(await y1()).transaction(Do,"readwrite");await n.objectStore(Do).put(e,w1(r)),await n.done}catch(t){if(t instanceof Is)Yn.warn(t.message);else{const n=yi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Yn.warn(n.message)}}}function w1(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=1024,v2=30*24*60*60*1e3;class y2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new E2(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=fm();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=v2}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Yn.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=fm(),{heartbeatsToSend:n,unsentEntries:i}=w2(this._heartbeatsCache.heartbeats),s=Al(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Yn.warn(t),""}}}function fm(){return new Date().toISOString().substring(0,10)}function w2(r,e=x2){const t=[];let n=r.slice();for(const i of r){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),hm(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),hm(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class E2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return h1()?hE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _2(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return um(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return um(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function hm(r){return Al(JSON.stringify({version:2,heartbeats:r})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T2(r){Fo(new ga("platform-logger",e=>new OE(e),"PRIVATE")),Fo(new ga("heartbeat",e=>new y2(e),"PRIVATE")),wi(Mf,cm,r),wi(Mf,cm,"esm2017"),wi("fire-js","")}T2("");var A2="firebase",S2="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wi(A2,S2,"app");var dm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var is,E1;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,A){function y(){}y.prototype=A.prototype,v.D=A.prototype,v.prototype=new y,v.prototype.constructor=v,v.C=function(I,k,b){for(var R=Array(arguments.length-2),K=2;K<arguments.length;K++)R[K-2]=arguments[K];return A.prototype[k].apply(I,R)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,A,y){y||(y=0);var I=Array(16);if(typeof A=="string")for(var k=0;16>k;++k)I[k]=A.charCodeAt(y++)|A.charCodeAt(y++)<<8|A.charCodeAt(y++)<<16|A.charCodeAt(y++)<<24;else for(k=0;16>k;++k)I[k]=A[y++]|A[y++]<<8|A[y++]<<16|A[y++]<<24;A=v.g[0],y=v.g[1],k=v.g[2];var b=v.g[3],R=A+(b^y&(k^b))+I[0]+3614090360&4294967295;A=y+(R<<7&4294967295|R>>>25),R=b+(k^A&(y^k))+I[1]+3905402710&4294967295,b=A+(R<<12&4294967295|R>>>20),R=k+(y^b&(A^y))+I[2]+606105819&4294967295,k=b+(R<<17&4294967295|R>>>15),R=y+(A^k&(b^A))+I[3]+3250441966&4294967295,y=k+(R<<22&4294967295|R>>>10),R=A+(b^y&(k^b))+I[4]+4118548399&4294967295,A=y+(R<<7&4294967295|R>>>25),R=b+(k^A&(y^k))+I[5]+1200080426&4294967295,b=A+(R<<12&4294967295|R>>>20),R=k+(y^b&(A^y))+I[6]+2821735955&4294967295,k=b+(R<<17&4294967295|R>>>15),R=y+(A^k&(b^A))+I[7]+4249261313&4294967295,y=k+(R<<22&4294967295|R>>>10),R=A+(b^y&(k^b))+I[8]+1770035416&4294967295,A=y+(R<<7&4294967295|R>>>25),R=b+(k^A&(y^k))+I[9]+2336552879&4294967295,b=A+(R<<12&4294967295|R>>>20),R=k+(y^b&(A^y))+I[10]+4294925233&4294967295,k=b+(R<<17&4294967295|R>>>15),R=y+(A^k&(b^A))+I[11]+2304563134&4294967295,y=k+(R<<22&4294967295|R>>>10),R=A+(b^y&(k^b))+I[12]+1804603682&4294967295,A=y+(R<<7&4294967295|R>>>25),R=b+(k^A&(y^k))+I[13]+4254626195&4294967295,b=A+(R<<12&4294967295|R>>>20),R=k+(y^b&(A^y))+I[14]+2792965006&4294967295,k=b+(R<<17&4294967295|R>>>15),R=y+(A^k&(b^A))+I[15]+1236535329&4294967295,y=k+(R<<22&4294967295|R>>>10),R=A+(k^b&(y^k))+I[1]+4129170786&4294967295,A=y+(R<<5&4294967295|R>>>27),R=b+(y^k&(A^y))+I[6]+3225465664&4294967295,b=A+(R<<9&4294967295|R>>>23),R=k+(A^y&(b^A))+I[11]+643717713&4294967295,k=b+(R<<14&4294967295|R>>>18),R=y+(b^A&(k^b))+I[0]+3921069994&4294967295,y=k+(R<<20&4294967295|R>>>12),R=A+(k^b&(y^k))+I[5]+3593408605&4294967295,A=y+(R<<5&4294967295|R>>>27),R=b+(y^k&(A^y))+I[10]+38016083&4294967295,b=A+(R<<9&4294967295|R>>>23),R=k+(A^y&(b^A))+I[15]+3634488961&4294967295,k=b+(R<<14&4294967295|R>>>18),R=y+(b^A&(k^b))+I[4]+3889429448&4294967295,y=k+(R<<20&4294967295|R>>>12),R=A+(k^b&(y^k))+I[9]+568446438&4294967295,A=y+(R<<5&4294967295|R>>>27),R=b+(y^k&(A^y))+I[14]+3275163606&4294967295,b=A+(R<<9&4294967295|R>>>23),R=k+(A^y&(b^A))+I[3]+4107603335&4294967295,k=b+(R<<14&4294967295|R>>>18),R=y+(b^A&(k^b))+I[8]+1163531501&4294967295,y=k+(R<<20&4294967295|R>>>12),R=A+(k^b&(y^k))+I[13]+2850285829&4294967295,A=y+(R<<5&4294967295|R>>>27),R=b+(y^k&(A^y))+I[2]+4243563512&4294967295,b=A+(R<<9&4294967295|R>>>23),R=k+(A^y&(b^A))+I[7]+1735328473&4294967295,k=b+(R<<14&4294967295|R>>>18),R=y+(b^A&(k^b))+I[12]+2368359562&4294967295,y=k+(R<<20&4294967295|R>>>12),R=A+(y^k^b)+I[5]+4294588738&4294967295,A=y+(R<<4&4294967295|R>>>28),R=b+(A^y^k)+I[8]+2272392833&4294967295,b=A+(R<<11&4294967295|R>>>21),R=k+(b^A^y)+I[11]+1839030562&4294967295,k=b+(R<<16&4294967295|R>>>16),R=y+(k^b^A)+I[14]+4259657740&4294967295,y=k+(R<<23&4294967295|R>>>9),R=A+(y^k^b)+I[1]+2763975236&4294967295,A=y+(R<<4&4294967295|R>>>28),R=b+(A^y^k)+I[4]+1272893353&4294967295,b=A+(R<<11&4294967295|R>>>21),R=k+(b^A^y)+I[7]+4139469664&4294967295,k=b+(R<<16&4294967295|R>>>16),R=y+(k^b^A)+I[10]+3200236656&4294967295,y=k+(R<<23&4294967295|R>>>9),R=A+(y^k^b)+I[13]+681279174&4294967295,A=y+(R<<4&4294967295|R>>>28),R=b+(A^y^k)+I[0]+3936430074&4294967295,b=A+(R<<11&4294967295|R>>>21),R=k+(b^A^y)+I[3]+3572445317&4294967295,k=b+(R<<16&4294967295|R>>>16),R=y+(k^b^A)+I[6]+76029189&4294967295,y=k+(R<<23&4294967295|R>>>9),R=A+(y^k^b)+I[9]+3654602809&4294967295,A=y+(R<<4&4294967295|R>>>28),R=b+(A^y^k)+I[12]+3873151461&4294967295,b=A+(R<<11&4294967295|R>>>21),R=k+(b^A^y)+I[15]+530742520&4294967295,k=b+(R<<16&4294967295|R>>>16),R=y+(k^b^A)+I[2]+3299628645&4294967295,y=k+(R<<23&4294967295|R>>>9),R=A+(k^(y|~b))+I[0]+4096336452&4294967295,A=y+(R<<6&4294967295|R>>>26),R=b+(y^(A|~k))+I[7]+1126891415&4294967295,b=A+(R<<10&4294967295|R>>>22),R=k+(A^(b|~y))+I[14]+2878612391&4294967295,k=b+(R<<15&4294967295|R>>>17),R=y+(b^(k|~A))+I[5]+4237533241&4294967295,y=k+(R<<21&4294967295|R>>>11),R=A+(k^(y|~b))+I[12]+1700485571&4294967295,A=y+(R<<6&4294967295|R>>>26),R=b+(y^(A|~k))+I[3]+2399980690&4294967295,b=A+(R<<10&4294967295|R>>>22),R=k+(A^(b|~y))+I[10]+4293915773&4294967295,k=b+(R<<15&4294967295|R>>>17),R=y+(b^(k|~A))+I[1]+2240044497&4294967295,y=k+(R<<21&4294967295|R>>>11),R=A+(k^(y|~b))+I[8]+1873313359&4294967295,A=y+(R<<6&4294967295|R>>>26),R=b+(y^(A|~k))+I[15]+4264355552&4294967295,b=A+(R<<10&4294967295|R>>>22),R=k+(A^(b|~y))+I[6]+2734768916&4294967295,k=b+(R<<15&4294967295|R>>>17),R=y+(b^(k|~A))+I[13]+1309151649&4294967295,y=k+(R<<21&4294967295|R>>>11),R=A+(k^(y|~b))+I[4]+4149444226&4294967295,A=y+(R<<6&4294967295|R>>>26),R=b+(y^(A|~k))+I[11]+3174756917&4294967295,b=A+(R<<10&4294967295|R>>>22),R=k+(A^(b|~y))+I[2]+718787259&4294967295,k=b+(R<<15&4294967295|R>>>17),R=y+(b^(k|~A))+I[9]+3951481745&4294967295,v.g[0]=v.g[0]+A&4294967295,v.g[1]=v.g[1]+(k+(R<<21&4294967295|R>>>11))&4294967295,v.g[2]=v.g[2]+k&4294967295,v.g[3]=v.g[3]+b&4294967295}n.prototype.u=function(v,A){A===void 0&&(A=v.length);for(var y=A-this.blockSize,I=this.B,k=this.h,b=0;b<A;){if(k==0)for(;b<=y;)i(this,v,b),b+=this.blockSize;if(typeof v=="string"){for(;b<A;)if(I[k++]=v.charCodeAt(b++),k==this.blockSize){i(this,I),k=0;break}}else for(;b<A;)if(I[k++]=v[b++],k==this.blockSize){i(this,I),k=0;break}}this.h=k,this.o+=A},n.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var A=1;A<v.length-8;++A)v[A]=0;var y=8*this.o;for(A=v.length-8;A<v.length;++A)v[A]=y&255,y/=256;for(this.u(v),v=Array(16),A=y=0;4>A;++A)for(var I=0;32>I;I+=8)v[y++]=this.g[A]>>>I&255;return v};function s(v,A){var y=o;return Object.prototype.hasOwnProperty.call(y,v)?y[v]:y[v]=A(v)}function a(v,A){this.h=A;for(var y=[],I=!0,k=v.length-1;0<=k;k--){var b=v[k]|0;I&&b==A||(y[k]=b,I=!1)}this.g=y}var o={};function c(v){return-128<=v&&128>v?s(v,function(A){return new a([A|0],0>A?-1:0)}):new a([v|0],0>v?-1:0)}function l(v){if(isNaN(v)||!isFinite(v))return h;if(0>v)return x(l(-v));for(var A=[],y=1,I=0;v>=y;I++)A[I]=v/y|0,y*=4294967296;return new a(A,0)}function u(v,A){if(v.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(v.charAt(0)=="-")return x(u(v.substring(1),A));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=l(Math.pow(A,8)),I=h,k=0;k<v.length;k+=8){var b=Math.min(8,v.length-k),R=parseInt(v.substring(k,k+b),A);8>b?(b=l(Math.pow(A,b)),I=I.j(b).add(l(R))):(I=I.j(y),I=I.add(l(R)))}return I}var h=c(0),d=c(1),m=c(16777216);r=a.prototype,r.m=function(){if(p(this))return-x(this).m();for(var v=0,A=1,y=0;y<this.g.length;y++){var I=this.i(y);v+=(0<=I?I:4294967296+I)*A,A*=4294967296}return v},r.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(g(this))return"0";if(p(this))return"-"+x(this).toString(v);for(var A=l(Math.pow(v,6)),y=this,I="";;){var k=F(y,A).g;y=T(y,k.j(A));var b=((0<y.g.length?y.g[0]:y.h)>>>0).toString(v);if(y=k,g(y))return b+I;for(;6>b.length;)b="0"+b;I=b+I}},r.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function g(v){if(v.h!=0)return!1;for(var A=0;A<v.g.length;A++)if(v.g[A]!=0)return!1;return!0}function p(v){return v.h==-1}r.l=function(v){return v=T(this,v),p(v)?-1:g(v)?0:1};function x(v){for(var A=v.g.length,y=[],I=0;I<A;I++)y[I]=~v.g[I];return new a(y,~v.h).add(d)}r.abs=function(){return p(this)?x(this):this},r.add=function(v){for(var A=Math.max(this.g.length,v.g.length),y=[],I=0,k=0;k<=A;k++){var b=I+(this.i(k)&65535)+(v.i(k)&65535),R=(b>>>16)+(this.i(k)>>>16)+(v.i(k)>>>16);I=R>>>16,b&=65535,R&=65535,y[k]=R<<16|b}return new a(y,y[y.length-1]&-2147483648?-1:0)};function T(v,A){return v.add(x(A))}r.j=function(v){if(g(this)||g(v))return h;if(p(this))return p(v)?x(this).j(x(v)):x(x(this).j(v));if(p(v))return x(this.j(x(v)));if(0>this.l(m)&&0>v.l(m))return l(this.m()*v.m());for(var A=this.g.length+v.g.length,y=[],I=0;I<2*A;I++)y[I]=0;for(I=0;I<this.g.length;I++)for(var k=0;k<v.g.length;k++){var b=this.i(I)>>>16,R=this.i(I)&65535,K=v.i(k)>>>16,Z=v.i(k)&65535;y[2*I+2*k]+=R*Z,C(y,2*I+2*k),y[2*I+2*k+1]+=b*Z,C(y,2*I+2*k+1),y[2*I+2*k+1]+=R*K,C(y,2*I+2*k+1),y[2*I+2*k+2]+=b*K,C(y,2*I+2*k+2)}for(I=0;I<A;I++)y[I]=y[2*I+1]<<16|y[2*I];for(I=A;I<2*A;I++)y[I]=0;return new a(y,0)};function C(v,A){for(;(v[A]&65535)!=v[A];)v[A+1]+=v[A]>>>16,v[A]&=65535,A++}function w(v,A){this.g=v,this.h=A}function F(v,A){if(g(A))throw Error("division by zero");if(g(v))return new w(h,h);if(p(v))return A=F(x(v),A),new w(x(A.g),x(A.h));if(p(A))return A=F(v,x(A)),new w(x(A.g),A.h);if(30<v.g.length){if(p(v)||p(A))throw Error("slowDivide_ only works with positive integers.");for(var y=d,I=A;0>=I.l(v);)y=L(y),I=L(I);var k=O(y,1),b=O(I,1);for(I=O(I,2),y=O(y,2);!g(I);){var R=b.add(I);0>=R.l(v)&&(k=k.add(y),b=R),I=O(I,1),y=O(y,1)}return A=T(v,k.j(A)),new w(k,A)}for(k=h;0<=v.l(A);){for(y=Math.max(1,Math.floor(v.m()/A.m())),I=Math.ceil(Math.log(y)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),b=l(y),R=b.j(A);p(R)||0<R.l(v);)y-=I,b=l(y),R=b.j(A);g(b)&&(b=d),k=k.add(b),v=T(v,R)}return new w(k,v)}r.A=function(v){return F(this,v).h},r.and=function(v){for(var A=Math.max(this.g.length,v.g.length),y=[],I=0;I<A;I++)y[I]=this.i(I)&v.i(I);return new a(y,this.h&v.h)},r.or=function(v){for(var A=Math.max(this.g.length,v.g.length),y=[],I=0;I<A;I++)y[I]=this.i(I)|v.i(I);return new a(y,this.h|v.h)},r.xor=function(v){for(var A=Math.max(this.g.length,v.g.length),y=[],I=0;I<A;I++)y[I]=this.i(I)^v.i(I);return new a(y,this.h^v.h)};function L(v){for(var A=v.g.length+1,y=[],I=0;I<A;I++)y[I]=v.i(I)<<1|v.i(I-1)>>>31;return new a(y,v.h)}function O(v,A){var y=A>>5;A%=32;for(var I=v.g.length-y,k=[],b=0;b<I;b++)k[b]=0<A?v.i(b+y)>>>A|v.i(b+y+1)<<32-A:v.i(b+y);return new a(k,v.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,E1=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=u,is=a}).apply(typeof dm<"u"?dm:typeof self<"u"?self:typeof window<"u"?window:{});var Kc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var T1,oo,A1,dl,Uf,S1,I1,k1;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,_,E){return f==Array.prototype||f==Object.prototype||(f[_]=E.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kc=="object"&&Kc];for(var _=0;_<f.length;++_){var E=f[_];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var n=t(this);function i(f,_){if(_)e:{var E=n;f=f.split(".");for(var D=0;D<f.length-1;D++){var j=f[D];if(!(j in E))break e;E=E[j]}f=f[f.length-1],D=E[f],_=_(D),_!=D&&_!=null&&e(E,f,{configurable:!0,writable:!0,value:_})}}function s(f,_){f instanceof String&&(f+="");var E=0,D=!1,j={next:function(){if(!D&&E<f.length){var re=E++;return{value:_(re,f[re]),done:!1}}return D=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}i("Array.prototype.values",function(f){return f||function(){return s(this,function(_,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(f){var _=typeof f;return _=_!="object"?_:f?Array.isArray(f)?"array":_:"null",_=="array"||_=="object"&&typeof f.length=="number"}function l(f){var _=typeof f;return _=="object"&&f!=null||_=="function"}function u(f,_,E){return f.call.apply(f.bind,arguments)}function h(f,_,E){if(!f)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,D),f.apply(_,j)}}return function(){return f.apply(_,arguments)}}function d(f,_,E){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,d.apply(null,arguments)}function m(f,_){var E=Array.prototype.slice.call(arguments,1);return function(){var D=E.slice();return D.push.apply(D,arguments),f.apply(this,D)}}function g(f,_){function E(){}E.prototype=_.prototype,f.aa=_.prototype,f.prototype=new E,f.prototype.constructor=f,f.Qb=function(D,j,re){for(var ye=Array(arguments.length-2),dt=2;dt<arguments.length;dt++)ye[dt-2]=arguments[dt];return _.prototype[j].apply(D,ye)}}function p(f){const _=f.length;if(0<_){const E=Array(_);for(let D=0;D<_;D++)E[D]=f[D];return E}return[]}function x(f,_){for(let E=1;E<arguments.length;E++){const D=arguments[E];if(c(D)){const j=f.length||0,re=D.length||0;f.length=j+re;for(let ye=0;ye<re;ye++)f[j+ye]=D[ye]}else f.push(D)}}class T{constructor(_,E){this.i=_,this.j=E,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function C(f){return/^[\s\xa0]*$/.test(f)}function w(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function F(f){return F[" "](f),f}F[" "]=function(){};var L=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function O(f,_,E){for(const D in f)_.call(E,f[D],D,f)}function v(f,_){for(const E in f)_.call(void 0,f[E],E,f)}function A(f){const _={};for(const E in f)_[E]=f[E];return _}const y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(f,_){let E,D;for(let j=1;j<arguments.length;j++){D=arguments[j];for(E in D)f[E]=D[E];for(let re=0;re<y.length;re++)E=y[re],Object.prototype.hasOwnProperty.call(D,E)&&(f[E]=D[E])}}function k(f){var _=1;f=f.split(":");const E=[];for(;0<_&&f.length;)E.push(f.shift()),_--;return f.length&&E.push(f.join(":")),E}function b(f){o.setTimeout(()=>{throw f},0)}function R(){var f=Y;let _=null;return f.g&&(_=f.g,f.g=f.g.next,f.g||(f.h=null),_.next=null),_}class K{constructor(){this.h=this.g=null}add(_,E){const D=Z.get();D.set(_,E),this.h?this.h.next=D:this.g=D,this.h=D}}var Z=new T(()=>new ge,f=>f.reset());class ge{constructor(){this.next=this.g=this.h=null}set(_,E){this.h=_,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let de,ze=!1,Y=new K,Ce=()=>{const f=o.Promise.resolve(void 0);de=()=>{f.then(Fe)}};var Fe=()=>{for(var f;f=R();){try{f.h.call(f.g)}catch(E){b(E)}var _=Z;_.j(f),100>_.h&&(_.h++,f.next=_.g,_.g=f)}ze=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(f,_){this.type=f,this.g=this.target=_,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var W=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,_=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const E=()=>{};o.addEventListener("test",E,_),o.removeEventListener("test",E,_)}catch{}return f}();function H(f,_){if(z.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var E=this.type=f.type,D=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=_,_=f.relatedTarget){if(L){e:{try{F(_.nodeName);var j=!0;break e}catch{}j=!1}j||(_=null)}}else E=="mouseover"?_=f.fromElement:E=="mouseout"&&(_=f.toElement);this.relatedTarget=_,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:se[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&H.aa.h.call(this)}}g(H,z);var se={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),me=0;function le(f,_,E,D,j){this.listener=f,this.proxy=null,this.src=_,this.type=E,this.capture=!!D,this.ha=j,this.key=++me,this.da=this.fa=!1}function oe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Oe(f){this.src=f,this.g={},this.h=0}Oe.prototype.add=function(f,_,E,D,j){var re=f.toString();f=this.g[re],f||(f=this.g[re]=[],this.h++);var ye=it(f,_,D,j);return-1<ye?(_=f[ye],E||(_.fa=!1)):(_=new le(_,this.src,re,!!D,j),_.fa=E,f.push(_)),_};function G(f,_){var E=_.type;if(E in f.g){var D=f.g[E],j=Array.prototype.indexOf.call(D,_,void 0),re;(re=0<=j)&&Array.prototype.splice.call(D,j,1),re&&(oe(_),f.g[E].length==0&&(delete f.g[E],f.h--))}}function it(f,_,E,D){for(var j=0;j<f.length;++j){var re=f[j];if(!re.da&&re.listener==_&&re.capture==!!E&&re.ha==D)return j}return-1}var $e="closure_lm_"+(1e6*Math.random()|0),nt={};function Ge(f,_,E,D,j){if(Array.isArray(_)){for(var re=0;re<_.length;re++)Ge(f,_[re],E,D,j);return null}return E=Zr(E),f&&f[he]?f.K(_,E,l(D)?!!D.capture:!1,j):Ee(f,_,E,!1,D,j)}function Ee(f,_,E,D,j,re){if(!_)throw Error("Invalid event type");var ye=l(j)?!!j.capture:!!j,dt=Jr(f);if(dt||(f[$e]=dt=new Oe(f)),E=dt.add(_,E,D,ye,re),E.proxy)return E;if(D=At(),E.proxy=D,D.src=f,D.listener=E,f.addEventListener)W||(j=ye),j===void 0&&(j=!1),f.addEventListener(_.toString(),D,j);else if(f.attachEvent)f.attachEvent(Yr(_.toString()),D);else if(f.addListener&&f.removeListener)f.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return E}function At(){function f(E){return _.call(f.src,f.listener,E)}const _=Wi;return f}function Ar(f,_,E,D,j){if(Array.isArray(_))for(var re=0;re<_.length;re++)Ar(f,_[re],E,D,j);else D=l(D)?!!D.capture:!!D,E=Zr(E),f&&f[he]?(f=f.i,_=String(_).toString(),_ in f.g&&(re=f.g[_],E=it(re,E,D,j),-1<E&&(oe(re[E]),Array.prototype.splice.call(re,E,1),re.length==0&&(delete f.g[_],f.h--)))):f&&(f=Jr(f))&&(_=f.g[_.toString()],f=-1,_&&(f=it(_,E,D,j)),(E=-1<f?_[f]:null)&&Rr(E))}function Rr(f){if(typeof f!="number"&&f&&!f.da){var _=f.src;if(_&&_[he])G(_.i,f);else{var E=f.type,D=f.proxy;_.removeEventListener?_.removeEventListener(E,D,f.capture):_.detachEvent?_.detachEvent(Yr(E),D):_.addListener&&_.removeListener&&_.removeListener(D),(E=Jr(_))?(G(E,f),E.h==0&&(E.src=null,_[$e]=null)):oe(f)}}}function Yr(f){return f in nt?nt[f]:nt[f]="on"+f}function Wi(f,_){if(f.da)f=!0;else{_=new H(_,this);var E=f.listener,D=f.ha||f.src;f.fa&&Rr(f),f=E.call(D,_)}return f}function Jr(f){return f=f[$e],f instanceof Oe?f:null}var rr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zr(f){return typeof f=="function"?f:(f[rr]||(f[rr]=function(_){return f.handleEvent(_)}),f[rr])}function gt(){B.call(this),this.i=new Oe(this),this.M=this,this.F=null}g(gt,B),gt.prototype[he]=!0,gt.prototype.removeEventListener=function(f,_,E,D){Ar(this,f,_,E,D)};function Ot(f,_){var E,D=f.F;if(D)for(E=[];D;D=D.F)E.push(D);if(f=f.M,D=_.type||_,typeof _=="string")_=new z(_,f);else if(_ instanceof z)_.target=_.target||f;else{var j=_;_=new z(D,f),I(_,j)}if(j=!0,E)for(var re=E.length-1;0<=re;re--){var ye=_.g=E[re];j=Gt(ye,D,!0,_)&&j}if(ye=_.g=f,j=Gt(ye,D,!0,_)&&j,j=Gt(ye,D,!1,_)&&j,E)for(re=0;re<E.length;re++)ye=_.g=E[re],j=Gt(ye,D,!1,_)&&j}gt.prototype.N=function(){if(gt.aa.N.call(this),this.i){var f=this.i,_;for(_ in f.g){for(var E=f.g[_],D=0;D<E.length;D++)oe(E[D]);delete f.g[_],f.h--}}this.F=null},gt.prototype.K=function(f,_,E,D){return this.i.add(String(f),_,!1,E,D)},gt.prototype.L=function(f,_,E,D){return this.i.add(String(f),_,!0,E,D)};function Gt(f,_,E,D){if(_=f.i.g[String(_)],!_)return!0;_=_.concat();for(var j=!0,re=0;re<_.length;++re){var ye=_[re];if(ye&&!ye.da&&ye.capture==E){var dt=ye.listener,ir=ye.ha||ye.src;ye.fa&&G(f.i,ye),j=dt.call(ir,D)!==!1&&j}}return j&&!D.defaultPrevented}function Vr(f,_,E){if(typeof f=="function")E&&(f=d(f,E));else if(f&&typeof f.handleEvent=="function")f=d(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(f,_||0)}function Be(f){f.g=Vr(()=>{f.g=null,f.i&&(f.i=!1,Be(f))},f.l);const _=f.h;f.h=null,f.m.apply(null,_)}class St extends B{constructor(_,E){super(),this.m=_,this.l=E,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Be(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xt(f){B.call(this),this.h=f,this.g={}}g(Xt,B);var bt=[];function En(f){O(f.g,function(_,E){this.g.hasOwnProperty(E)&&Rr(_)},f),f.g={}}Xt.prototype.N=function(){Xt.aa.N.call(this),En(this)},Xt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ls=o.JSON.stringify,Gu=o.JSON.parse,Wu=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Ms(){}Ms.prototype.h=null;function $a(f){return f.h||(f.h=f.i())}function ja(){}var Hi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ka(){z.call(this,"d")}g(Ka,z);function ii(){z.call(this,"c")}g(ii,z);var Vn={},Rc=null;function Vs(){return Rc=Rc||new gt}Vn.La="serverreachability";function Fc(f){z.call(this,Vn.La,f)}g(Fc,z);function zi(f){const _=Vs();Ot(_,new Fc(_))}Vn.STAT_EVENT="statevent";function Dc(f,_){z.call(this,Vn.STAT_EVENT,f),this.stat=_}g(Dc,z);function nr(f){const _=Vs();Ot(_,new Dc(_,f))}Vn.Ma="timingevent";function Pc(f,_){z.call(this,Vn.Ma,f),this.size=_}g(Pc,z);function Bn(f,_){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},_)}function $i(){this.g=!0}$i.prototype.xa=function(){this.g=!1};function Hu(f,_,E,D,j,re){f.info(function(){if(f.g)if(re)for(var ye="",dt=re.split("&"),ir=0;ir<dt.length;ir++){var tt=dt[ir].split("=");if(1<tt.length){var ur=tt[0];tt=tt[1];var fr=ur.split("_");ye=2<=fr.length&&fr[1]=="type"?ye+(ur+"="+tt+"&"):ye+(ur+"=redacted&")}}else ye=null;else ye=re;return"XMLHTTP REQ ("+D+") [attempt "+j+"]: "+_+`
`+E+`
`+ye})}function zu(f,_,E,D,j,re,ye){f.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+j+"]: "+_+`
`+E+`
`+re+" "+ye})}function S(f,_,E,D){f.info(function(){return"XMLHTTP TEXT ("+_+"): "+P(f,E)+(D?" "+D:"")})}function M(f,_){f.info(function(){return"TIMEOUT: "+_})}$i.prototype.info=function(){};function P(f,_){if(!f.g)return _;if(!_)return null;try{var E=JSON.parse(_);if(E){for(f=0;f<E.length;f++)if(Array.isArray(E[f])){var D=E[f];if(!(2>D.length)){var j=D[1];if(Array.isArray(j)&&!(1>j.length)){var re=j[0];if(re!="noop"&&re!="stop"&&re!="close")for(var ye=1;ye<j.length;ye++)j[ye]=""}}}}return Ls(E)}catch{return _}}var N={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},U;function X(){}g(X,Ms),X.prototype.g=function(){return new XMLHttpRequest},X.prototype.i=function(){return{}},U=new X;function ne(f,_,E,D){this.j=f,this.i=_,this.l=E,this.R=D||1,this.U=new Xt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Q}function Q(){this.i=null,this.g="",this.h=!1}var J={},ee={};function ue(f,_,E){f.L=1,f.v=Lc(Gn(_)),f.m=E,f.P=!0,ve(f,null)}function ve(f,_){f.F=Date.now(),Te(f),f.A=Gn(f.v);var E=f.A,D=f.R;Array.isArray(D)||(D=[String(D)]),Dd(E.i,"t",D),f.C=0,E=f.j.J,f.h=new Q,f.g=Qd(f.j,E?_:null,!f.m),0<f.O&&(f.M=new St(d(f.Y,f,f.g),f.O)),_=f.U,E=f.g,D=f.ca;var j="readystatechange";Array.isArray(j)||(j&&(bt[0]=j.toString()),j=bt);for(var re=0;re<j.length;re++){var ye=Ge(E,j[re],D||_.handleEvent,!1,_.h||_);if(!ye)break;_.g[ye.key]=ye}_=f.H?A(f.H):{},f.m?(f.u||(f.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,_)):(f.u="GET",f.g.ea(f.A,f.u,null,_)),zi(),Hu(f.i,f.u,f.A,f.l,f.R,f.m)}ne.prototype.ca=function(f){f=f.target;const _=this.M;_&&Wn(f)==3?_.j():this.Y(f)},ne.prototype.Y=function(f){try{if(f==this.g)e:{const fr=Wn(this.g);var _=this.g.Ba();const Ws=this.g.Z();if(!(3>fr)&&(fr!=3||this.g&&(this.h.h||this.g.oa()||Bd(this.g)))){this.J||fr!=4||_==7||(_==8||0>=Ws?zi(3):zi(2)),ht(this);var E=this.g.Z();this.X=E;t:if(Ae(this)){var D=Bd(this.g);f="";var j=D.length,re=Wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wt(this),st(this);var ye="";break t}this.h.i=new o.TextDecoder}for(_=0;_<j;_++)this.h.h=!0,f+=this.h.i.decode(D[_],{stream:!(re&&_==j-1)});D.length=0,this.h.g+=f,this.C=0,ye=this.h.g}else ye=this.g.oa();if(this.o=E==200,zu(this.i,this.u,this.A,this.l,this.R,fr,E),this.o){if(this.T&&!this.K){t:{if(this.g){var dt,ir=this.g;if((dt=ir.g?ir.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(dt)){var tt=dt;break t}}tt=null}if(E=tt)S(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Un(this,E);else{this.o=!1,this.s=3,nr(12),wt(this),st(this);break e}}if(this.P){E=!0;let dn;for(;!this.J&&this.C<ye.length;)if(dn=pe(this,ye),dn==ee){fr==4&&(this.s=4,nr(14),E=!1),S(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==J){this.s=4,nr(15),S(this.i,this.l,ye,"[Invalid Chunk]"),E=!1;break}else S(this.i,this.l,dn,null),Un(this,dn);if(Ae(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),fr!=4||ye.length!=0||this.h.h||(this.s=1,nr(16),E=!1),this.o=this.o&&E,!E)S(this.i,this.l,ye,"[Invalid Chunked Response]"),wt(this),st(this);else if(0<ye.length&&!this.W){this.W=!0;var ur=this.j;ur.g==this&&ur.ba&&!ur.M&&(ur.j.info("Great, no buffering proxy detected. Bytes received: "+ye.length),Xu(ur),ur.M=!0,nr(11))}}else S(this.i,this.l,ye,null),Un(this,ye);fr==4&&wt(this),this.o&&!this.J&&(fr==4?jd(this.j,this):(this.o=!1,Te(this)))}else uw(this.g),E==400&&0<ye.indexOf("Unknown SID")?(this.s=3,nr(12)):(this.s=0,nr(13)),wt(this),st(this)}}}catch{}finally{}};function Ae(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function pe(f,_){var E=f.C,D=_.indexOf(`
`,E);return D==-1?ee:(E=Number(_.substring(E,D)),isNaN(E)?J:(D+=1,D+E>_.length?ee:(_=_.slice(D,D+E),f.C=D+E,_)))}ne.prototype.cancel=function(){this.J=!0,wt(this)};function Te(f){f.S=Date.now()+f.I,Le(f,f.I)}function Le(f,_){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Bn(d(f.ba,f),_)}function ht(f){f.B&&(o.clearTimeout(f.B),f.B=null)}ne.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(M(this.i,this.A),this.L!=2&&(zi(),nr(17)),wt(this),this.s=2,st(this)):Le(this,this.S-f)};function st(f){f.j.G==0||f.J||jd(f.j,f)}function wt(f){ht(f);var _=f.M;_&&typeof _.ma=="function"&&_.ma(),f.M=null,En(f.U),f.g&&(_=f.g,f.g=null,_.abort(),_.ma())}function Un(f,_){try{var E=f.j;if(E.G!=0&&(E.g==f||Br(E.h,f))){if(!f.K&&Br(E.h,f)&&E.G==3){try{var D=E.Da.g.parse(_)}catch{D=null}if(Array.isArray(D)&&D.length==3){var j=D;if(j[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<f.F)Wc(E),Uc(E);else break e;qu(E),nr(18)}}else E.za=j[1],0<E.za-E.T&&37500>j[2]&&E.F&&E.v==0&&!E.C&&(E.C=Bn(d(E.Za,E),6e3));if(1>=Bs(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else qi(E,11)}else if((f.K||E.g==f)&&Wc(E),!C(_))for(j=E.Da.g.parse(_),_=0;_<j.length;_++){let tt=j[_];if(E.T=tt[0],tt=tt[1],E.G==2)if(tt[0]=="c"){E.K=tt[1],E.ia=tt[2];const ur=tt[3];ur!=null&&(E.la=ur,E.j.info("VER="+E.la));const fr=tt[4];fr!=null&&(E.Aa=fr,E.j.info("SVER="+E.Aa));const Ws=tt[5];Ws!=null&&typeof Ws=="number"&&0<Ws&&(D=1.5*Ws,E.L=D,E.j.info("backChannelRequestTimeoutMs_="+D)),D=E;const dn=f.g;if(dn){const zc=dn.g?dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zc){var re=D.h;re.g||zc.indexOf("spdy")==-1&&zc.indexOf("quic")==-1&&zc.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&($u(re,re.h),re.h=null))}if(D.D){const Qu=dn.g?dn.g.getResponseHeader("X-HTTP-Session-Id"):null;Qu&&(D.ya=Qu,_t(D.I,D.D,Qu))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-f.F,E.j.info("Handshake RTT: "+E.R+"ms")),D=E;var ye=f;if(D.qa=Xd(D,D.J?D.ia:null,D.W),ye.K){Ad(D.h,ye);var dt=ye,ir=D.L;ir&&(dt.I=ir),dt.B&&(ht(dt),Te(dt)),D.g=ye}else zd(D);0<E.i.length&&Gc(E)}else tt[0]!="stop"&&tt[0]!="close"||qi(E,7);else E.G==3&&(tt[0]=="stop"||tt[0]=="close"?tt[0]=="stop"?qi(E,7):Ku(E):tt[0]!="noop"&&E.l&&E.l.ta(tt),E.v=0)}}zi(4)}catch{}}var ji=class{constructor(f,_){this.g=f,this.map=_}};function si(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tn(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Bs(f){return f.h?1:f.g?f.g.size:0}function Br(f,_){return f.h?f.h==_:f.g?f.g.has(_):!1}function $u(f,_){f.g?f.g.add(_):f.h=_}function Ad(f,_){f.h&&f.h==_?f.h=null:f.g&&f.g.has(_)&&f.g.delete(_)}si.prototype.cancel=function(){if(this.i=Sd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Sd(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let _=f.i;for(const E of f.g.values())_=_.concat(E.D);return _}return p(f.i)}function Xy(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var _=[],E=f.length,D=0;D<E;D++)_.push(f[D]);return _}_=[],E=0;for(D in f)_[E++]=f[D];return _}function Qy(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var _=[];f=f.length;for(var E=0;E<f;E++)_.push(E);return _}_=[],E=0;for(const D in f)_[E++]=D;return _}}}function Id(f,_){if(f.forEach&&typeof f.forEach=="function")f.forEach(_,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,_,void 0);else for(var E=Qy(f),D=Xy(f),j=D.length,re=0;re<j;re++)_.call(void 0,D[re],E&&E[re],f)}var kd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yy(f,_){if(f){f=f.split("&");for(var E=0;E<f.length;E++){var D=f[E].indexOf("="),j=null;if(0<=D){var re=f[E].substring(0,D);j=f[E].substring(D+1)}else re=f[E];_(re,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Ki(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Ki){this.h=f.h,Nc(this,f.j),this.o=f.o,this.g=f.g,Oc(this,f.s),this.l=f.l;var _=f.i,E=new Qa;E.i=_.i,_.g&&(E.g=new Map(_.g),E.h=_.h),Cd(this,E),this.m=f.m}else f&&(_=String(f).match(kd))?(this.h=!1,Nc(this,_[1]||"",!0),this.o=qa(_[2]||""),this.g=qa(_[3]||"",!0),Oc(this,_[4]),this.l=qa(_[5]||"",!0),Cd(this,_[6]||"",!0),this.m=qa(_[7]||"")):(this.h=!1,this.i=new Qa(null,this.h))}Ki.prototype.toString=function(){var f=[],_=this.j;_&&f.push(Xa(_,bd,!0),":");var E=this.g;return(E||_=="file")&&(f.push("//"),(_=this.o)&&f.push(Xa(_,bd,!0),"@"),f.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&f.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&f.push("/"),f.push(Xa(E,E.charAt(0)=="/"?ew:Zy,!0))),(E=this.i.toString())&&f.push("?",E),(E=this.m)&&f.push("#",Xa(E,rw)),f.join("")};function Gn(f){return new Ki(f)}function Nc(f,_,E){f.j=E?qa(_,!0):_,f.j&&(f.j=f.j.replace(/:$/,""))}function Oc(f,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);f.s=_}else f.s=null}function Cd(f,_,E){_ instanceof Qa?(f.i=_,nw(f.i,f.h)):(E||(_=Xa(_,tw)),f.i=new Qa(_,f.h))}function _t(f,_,E){f.i.set(_,E)}function Lc(f){return _t(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function qa(f,_){return f?_?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Xa(f,_,E){return typeof f=="string"?(f=encodeURI(f).replace(_,Jy),E&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Jy(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var bd=/[#\/\?@]/g,Zy=/[#\?:]/g,ew=/[#\?]/g,tw=/[#\?@]/g,rw=/#/g;function Qa(f,_){this.h=this.g=null,this.i=f||null,this.j=!!_}function ai(f){f.g||(f.g=new Map,f.h=0,f.i&&Yy(f.i,function(_,E){f.add(decodeURIComponent(_.replace(/\+/g," ")),E)}))}r=Qa.prototype,r.add=function(f,_){ai(this),this.i=null,f=Us(this,f);var E=this.g.get(f);return E||this.g.set(f,E=[]),E.push(_),this.h+=1,this};function Rd(f,_){ai(f),_=Us(f,_),f.g.has(_)&&(f.i=null,f.h-=f.g.get(_).length,f.g.delete(_))}function Fd(f,_){return ai(f),_=Us(f,_),f.g.has(_)}r.forEach=function(f,_){ai(this),this.g.forEach(function(E,D){E.forEach(function(j){f.call(_,j,D,this)},this)},this)},r.na=function(){ai(this);const f=Array.from(this.g.values()),_=Array.from(this.g.keys()),E=[];for(let D=0;D<_.length;D++){const j=f[D];for(let re=0;re<j.length;re++)E.push(_[D])}return E},r.V=function(f){ai(this);let _=[];if(typeof f=="string")Fd(this,f)&&(_=_.concat(this.g.get(Us(this,f))));else{f=Array.from(this.g.values());for(let E=0;E<f.length;E++)_=_.concat(f[E])}return _},r.set=function(f,_){return ai(this),this.i=null,f=Us(this,f),Fd(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[_]),this.h+=1,this},r.get=function(f,_){return f?(f=this.V(f),0<f.length?String(f[0]):_):_};function Dd(f,_,E){Rd(f,_),0<E.length&&(f.i=null,f.g.set(Us(f,_),p(E)),f.h+=E.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],_=Array.from(this.g.keys());for(var E=0;E<_.length;E++){var D=_[E];const re=encodeURIComponent(String(D)),ye=this.V(D);for(D=0;D<ye.length;D++){var j=re;ye[D]!==""&&(j+="="+encodeURIComponent(String(ye[D]))),f.push(j)}}return this.i=f.join("&")};function Us(f,_){return _=String(_),f.j&&(_=_.toLowerCase()),_}function nw(f,_){_&&!f.j&&(ai(f),f.i=null,f.g.forEach(function(E,D){var j=D.toLowerCase();D!=j&&(Rd(this,D),Dd(this,j,E))},f)),f.j=_}function iw(f,_){const E=new $i;if(o.Image){const D=new Image;D.onload=m(oi,E,"TestLoadImage: loaded",!0,_,D),D.onerror=m(oi,E,"TestLoadImage: error",!1,_,D),D.onabort=m(oi,E,"TestLoadImage: abort",!1,_,D),D.ontimeout=m(oi,E,"TestLoadImage: timeout",!1,_,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=f}else _(!1)}function sw(f,_){const E=new $i,D=new AbortController,j=setTimeout(()=>{D.abort(),oi(E,"TestPingServer: timeout",!1,_)},1e4);fetch(f,{signal:D.signal}).then(re=>{clearTimeout(j),re.ok?oi(E,"TestPingServer: ok",!0,_):oi(E,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(j),oi(E,"TestPingServer: error",!1,_)})}function oi(f,_,E,D,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),D(E)}catch{}}function aw(){this.g=new Wu}function ow(f,_,E){const D=E||"";try{Id(f,function(j,re){let ye=j;l(j)&&(ye=Ls(j)),_.push(D+re+"="+encodeURIComponent(ye))})}catch(j){throw _.push(D+"type="+encodeURIComponent("_badmap")),j}}function Mc(f){this.l=f.Ub||null,this.j=f.eb||!1}g(Mc,Ms),Mc.prototype.g=function(){return new Vc(this.l,this.j)},Mc.prototype.i=function(f){return function(){return f}}({});function Vc(f,_){gt.call(this),this.D=f,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Vc,gt),r=Vc.prototype,r.open=function(f,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=_,this.readyState=1,Ja(this)},r.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(_.body=f),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ya(this)),this.readyState=0},r.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Ja(this)),this.g&&(this.readyState=3,Ja(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Pd(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Pd(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}r.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var _=f.value?f.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!f.done}))&&(this.response=this.responseText+=_)}f.done?Ya(this):Ja(this),this.readyState==3&&Pd(this)}},r.Ra=function(f){this.g&&(this.response=this.responseText=f,Ya(this))},r.Qa=function(f){this.g&&(this.response=f,Ya(this))},r.ga=function(){this.g&&Ya(this)};function Ya(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Ja(f)}r.setRequestHeader=function(f,_){this.u.append(f,_)},r.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],_=this.h.entries();for(var E=_.next();!E.done;)E=E.value,f.push(E[0]+": "+E[1]),E=_.next();return f.join(`\r
`)};function Ja(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Vc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Nd(f){let _="";return O(f,function(E,D){_+=D,_+=":",_+=E,_+=`\r
`}),_}function ju(f,_,E){e:{for(D in E){var D=!1;break e}D=!0}D||(E=Nd(E),typeof f=="string"?E!=null&&encodeURIComponent(String(E)):_t(f,_,E))}function Rt(f){gt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Rt,gt);var cw=/^https?$/i,lw=["POST","PUT"];r=Rt.prototype,r.Ha=function(f){this.J=f},r.ea=function(f,_,E,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);_=_?_.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():U.g(),this.v=this.o?$a(this.o):$a(U),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(_,String(f),!0),this.B=!1}catch(re){Od(this,re);return}if(f=E||"",E=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var j in D)E.set(j,D[j]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const re of D.keys())E.set(re,D.get(re));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(E.keys()).find(re=>re.toLowerCase()=="content-type"),j=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(lw,_,void 0))||D||j||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,ye]of E)this.g.setRequestHeader(re,ye);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Vd(this),this.u=!0,this.g.send(f),this.u=!1}catch(re){Od(this,re)}};function Od(f,_){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=_,f.m=5,Ld(f),Bc(f)}function Ld(f){f.A||(f.A=!0,Ot(f,"complete"),Ot(f,"error"))}r.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ot(this,"complete"),Ot(this,"abort"),Bc(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bc(this,!0)),Rt.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Md(this):this.bb())},r.bb=function(){Md(this)};function Md(f){if(f.h&&typeof a<"u"&&(!f.v[1]||Wn(f)!=4||f.Z()!=2)){if(f.u&&Wn(f)==4)Vr(f.Ea,0,f);else if(Ot(f,"readystatechange"),Wn(f)==4){f.h=!1;try{const ye=f.Z();e:switch(ye){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var E;if(!(E=_)){var D;if(D=ye===0){var j=String(f.D).match(kd)[1]||null;!j&&o.self&&o.self.location&&(j=o.self.location.protocol.slice(0,-1)),D=!cw.test(j?j.toLowerCase():"")}E=D}if(E)Ot(f,"complete"),Ot(f,"success");else{f.m=6;try{var re=2<Wn(f)?f.g.statusText:""}catch{re=""}f.l=re+" ["+f.Z()+"]",Ld(f)}}finally{Bc(f)}}}}function Bc(f,_){if(f.g){Vd(f);const E=f.g,D=f.v[0]?()=>{}:null;f.g=null,f.v=null,_||Ot(f,"ready");try{E.onreadystatechange=D}catch{}}}function Vd(f){f.I&&(o.clearTimeout(f.I),f.I=null)}r.isActive=function(){return!!this.g};function Wn(f){return f.g?f.g.readyState:0}r.Z=function(){try{return 2<Wn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(f){if(this.g){var _=this.g.responseText;return f&&_.indexOf(f)==0&&(_=_.substring(f.length)),Gu(_)}};function Bd(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function uw(f){const _={};f=(f.g&&2<=Wn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<f.length;D++){if(C(f[D]))continue;var E=k(f[D]);const j=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const re=_[j]||[];_[j]=re,re.push(E)}v(_,function(D){return D.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Za(f,_,E){return E&&E.internalChannelParams&&E.internalChannelParams[f]||_}function Ud(f){this.Aa=0,this.i=[],this.j=new $i,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Za("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Za("baseRetryDelayMs",5e3,f),this.cb=Za("retryDelaySeedMs",1e4,f),this.Wa=Za("forwardChannelMaxRetries",2,f),this.wa=Za("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new si(f&&f.concurrentRequestLimit),this.Da=new aw,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Ud.prototype,r.la=8,r.G=1,r.connect=function(f,_,E,D){nr(0),this.W=f,this.H=_||{},E&&D!==void 0&&(this.H.OSID=E,this.H.OAID=D),this.F=this.X,this.I=Xd(this,null,this.W),Gc(this)};function Ku(f){if(Gd(f),f.G==3){var _=f.U++,E=Gn(f.I);if(_t(E,"SID",f.K),_t(E,"RID",_),_t(E,"TYPE","terminate"),eo(f,E),_=new ne(f,f.j,_),_.L=2,_.v=Lc(Gn(E)),E=!1,o.navigator&&o.navigator.sendBeacon)try{E=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!E&&o.Image&&(new Image().src=_.v,E=!0),E||(_.g=Qd(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Te(_)}qd(f)}function Uc(f){f.g&&(Xu(f),f.g.cancel(),f.g=null)}function Gd(f){Uc(f),f.u&&(o.clearTimeout(f.u),f.u=null),Wc(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function Gc(f){if(!Tn(f.h)&&!f.s){f.s=!0;var _=f.Ga;de||Ce(),ze||(de(),ze=!0),Y.add(_,f),f.B=0}}function fw(f,_){return Bs(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=_.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Bn(d(f.Ga,f,_),Kd(f,f.B)),f.B++,!0)}r.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const j=new ne(this,this.j,f);let re=this.o;if(this.S&&(re?(re=A(re),I(re,this.S)):re=this.S),this.m!==null||this.O||(j.H=re,re=null),this.P)e:{for(var _=0,E=0;E<this.i.length;E++){t:{var D=this.i[E];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(_+=D,4096<_){_=E;break e}if(_===4096||E===this.i.length-1){_=E+1;break e}}_=1e3}else _=1e3;_=Hd(this,j,_),E=Gn(this.I),_t(E,"RID",f),_t(E,"CVER",22),this.D&&_t(E,"X-HTTP-Session-Id",this.D),eo(this,E),re&&(this.O?_="headers="+encodeURIComponent(String(Nd(re)))+"&"+_:this.m&&ju(E,this.m,re)),$u(this.h,j),this.Ua&&_t(E,"TYPE","init"),this.P?(_t(E,"$req",_),_t(E,"SID","null"),j.T=!0,ue(j,E,null)):ue(j,E,_),this.G=2}}else this.G==3&&(f?Wd(this,f):this.i.length==0||Tn(this.h)||Wd(this))};function Wd(f,_){var E;_?E=_.l:E=f.U++;const D=Gn(f.I);_t(D,"SID",f.K),_t(D,"RID",E),_t(D,"AID",f.T),eo(f,D),f.m&&f.o&&ju(D,f.m,f.o),E=new ne(f,f.j,E,f.B+1),f.m===null&&(E.H=f.o),_&&(f.i=_.D.concat(f.i)),_=Hd(f,E,1e3),E.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),$u(f.h,E),ue(E,D,_)}function eo(f,_){f.H&&O(f.H,function(E,D){_t(_,D,E)}),f.l&&Id({},function(E,D){_t(_,D,E)})}function Hd(f,_,E){E=Math.min(f.i.length,E);var D=f.l?d(f.l.Na,f.l,f):null;e:{var j=f.i;let re=-1;for(;;){const ye=["count="+E];re==-1?0<E?(re=j[0].g,ye.push("ofs="+re)):re=0:ye.push("ofs="+re);let dt=!0;for(let ir=0;ir<E;ir++){let tt=j[ir].g;const ur=j[ir].map;if(tt-=re,0>tt)re=Math.max(0,j[ir].g-100),dt=!1;else try{ow(ur,ye,"req"+tt+"_")}catch{D&&D(ur)}}if(dt){D=ye.join("&");break e}}}return f=f.i.splice(0,E),_.D=f,D}function zd(f){if(!f.g&&!f.u){f.Y=1;var _=f.Fa;de||Ce(),ze||(de(),ze=!0),Y.add(_,f),f.v=0}}function qu(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Bn(d(f.Fa,f),Kd(f,f.v)),f.v++,!0)}r.Fa=function(){if(this.u=null,$d(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Bn(d(this.ab,this),f)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nr(10),Uc(this),$d(this))};function Xu(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function $d(f){f.g=new ne(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var _=Gn(f.qa);_t(_,"RID","rpc"),_t(_,"SID",f.K),_t(_,"AID",f.T),_t(_,"CI",f.F?"0":"1"),!f.F&&f.ja&&_t(_,"TO",f.ja),_t(_,"TYPE","xmlhttp"),eo(f,_),f.m&&f.o&&ju(_,f.m,f.o),f.L&&(f.g.I=f.L);var E=f.g;f=f.ia,E.L=1,E.v=Lc(Gn(_)),E.m=null,E.P=!0,ve(E,f)}r.Za=function(){this.C!=null&&(this.C=null,Uc(this),qu(this),nr(19))};function Wc(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function jd(f,_){var E=null;if(f.g==_){Wc(f),Xu(f),f.g=null;var D=2}else if(Br(f.h,_))E=_.D,Ad(f.h,_),D=1;else return;if(f.G!=0){if(_.o)if(D==1){E=_.m?_.m.length:0,_=Date.now()-_.F;var j=f.B;D=Vs(),Ot(D,new Pc(D,E)),Gc(f)}else zd(f);else if(j=_.s,j==3||j==0&&0<_.X||!(D==1&&fw(f,_)||D==2&&qu(f)))switch(E&&0<E.length&&(_=f.h,_.i=_.i.concat(E)),j){case 1:qi(f,5);break;case 4:qi(f,10);break;case 3:qi(f,6);break;default:qi(f,2)}}}function Kd(f,_){let E=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(E*=2),E*_}function qi(f,_){if(f.j.info("Error code "+_),_==2){var E=d(f.fb,f),D=f.Xa;const j=!D;D=new Ki(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Nc(D,"https"),Lc(D),j?iw(D.toString(),E):sw(D.toString(),E)}else nr(2);f.G=0,f.l&&f.l.sa(_),qd(f),Gd(f)}r.fb=function(f){f?(this.j.info("Successfully pinged google.com"),nr(2)):(this.j.info("Failed to ping google.com"),nr(1))};function qd(f){if(f.G=0,f.ka=[],f.l){const _=Sd(f.h);(_.length!=0||f.i.length!=0)&&(x(f.ka,_),x(f.ka,f.i),f.h.i.length=0,p(f.i),f.i.length=0),f.l.ra()}}function Xd(f,_,E){var D=E instanceof Ki?Gn(E):new Ki(E);if(D.g!="")_&&(D.g=_+"."+D.g),Oc(D,D.s);else{var j=o.location;D=j.protocol,_=_?_+"."+j.hostname:j.hostname,j=+j.port;var re=new Ki(null);D&&Nc(re,D),_&&(re.g=_),j&&Oc(re,j),E&&(re.l=E),D=re}return E=f.D,_=f.ya,E&&_&&_t(D,E,_),_t(D,"VER",f.la),eo(f,D),D}function Qd(f,_,E){if(_&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=f.Ca&&!f.pa?new Rt(new Mc({eb:E})):new Rt(f.pa),_.Ha(f.J),_}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yd(){}r=Yd.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Hc(){}Hc.prototype.g=function(f,_){return new Ur(f,_)};function Ur(f,_){gt.call(this),this.g=new Ud(_),this.l=f,this.h=_&&_.messageUrlParams||null,f=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(f?f["X-WebChannel-Content-Type"]=_.messageContentType:f={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(f?f["X-WebChannel-Client-Profile"]=_.va:f={"X-WebChannel-Client-Profile":_.va}),this.g.S=f,(f=_&&_.Sb)&&!C(f)&&(this.g.m=f),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!C(_)&&(this.g.D=_,f=this.h,f!==null&&_ in f&&(f=this.h,_ in f&&delete f[_])),this.j=new Gs(this)}g(Ur,gt),Ur.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ur.prototype.close=function(){Ku(this.g)},Ur.prototype.o=function(f){var _=this.g;if(typeof f=="string"){var E={};E.__data__=f,f=E}else this.u&&(E={},E.__data__=Ls(f),f=E);_.i.push(new ji(_.Ya++,f)),_.G==3&&Gc(_)},Ur.prototype.N=function(){this.g.l=null,delete this.j,Ku(this.g),delete this.g,Ur.aa.N.call(this)};function Jd(f){Ka.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var _=f.__sm__;if(_){e:{for(const E in _){f=E;break e}f=void 0}(this.i=f)&&(f=this.i,_=_!==null&&f in _?_[f]:void 0),this.data=_}else this.data=f}g(Jd,Ka);function Zd(){ii.call(this),this.status=1}g(Zd,ii);function Gs(f){this.g=f}g(Gs,Yd),Gs.prototype.ua=function(){Ot(this.g,"a")},Gs.prototype.ta=function(f){Ot(this.g,new Jd(f))},Gs.prototype.sa=function(f){Ot(this.g,new Zd)},Gs.prototype.ra=function(){Ot(this.g,"b")},Hc.prototype.createWebChannel=Hc.prototype.g,Ur.prototype.send=Ur.prototype.o,Ur.prototype.open=Ur.prototype.m,Ur.prototype.close=Ur.prototype.close,k1=function(){return new Hc},I1=function(){return Vs()},S1=Vn,Uf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},N.NO_ERROR=0,N.TIMEOUT=8,N.HTTP_ERROR=6,dl=N,V.COMPLETE="complete",A1=V,ja.EventType=Hi,Hi.OPEN="a",Hi.CLOSE="b",Hi.ERROR="c",Hi.MESSAGE="d",gt.prototype.listen=gt.prototype.K,oo=ja,Rt.prototype.listenOnce=Rt.prototype.L,Rt.prototype.getLastError=Rt.prototype.Ka,Rt.prototype.getLastErrorCode=Rt.prototype.Ba,Rt.prototype.getStatus=Rt.prototype.Z,Rt.prototype.getResponseJson=Rt.prototype.Oa,Rt.prototype.getResponseText=Rt.prototype.oa,Rt.prototype.send=Rt.prototype.ea,Rt.prototype.setWithCredentials=Rt.prototype.Ha,T1=Rt}).apply(typeof Kc<"u"?Kc:typeof self<"u"?self:typeof window<"u"?window:{});const mm="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}mr.UNAUTHENTICATED=new mr(null),mr.GOOGLE_CREDENTIALS=new mr("google-credentials-uid"),mr.FIRST_PARTY=new mr("first-party-uid"),mr.MOCK_USER=new mr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pa="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls=new m1("@firebase/firestore");function Qs(){return ls.logLevel}function ce(r,...e){if(ls.logLevel<=Qe.DEBUG){const t=e.map(k0);ls.debug(`Firestore (${Pa}): ${r}`,...t)}}function Mt(r,...e){if(ls.logLevel<=Qe.ERROR){const t=e.map(k0);ls.error(`Firestore (${Pa}): ${r}`,...t)}}function Po(r,...e){if(ls.logLevel<=Qe.WARN){const t=e.map(k0);ls.warn(`Firestore (${Pa}): ${r}`,...t)}}function k0(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(r="Unexpected state"){const e=`FIRESTORE (${Pa}) INTERNAL ASSERTION FAILED: `+r;throw Mt(e),new Error(e)}function ke(r,e){r||Se()}function Ie(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fe extends Is{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(mr.UNAUTHENTICATED))}shutdown(){}}class C2{constructor(e){this.t=e,this.currentUser=mr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ke(this.o===void 0);let n=this.i;const i=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve();let s=new _n;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new _n,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new _n)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ke(typeof n.accessToken=="string"),new I2(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string"),new mr(e)}}class b2{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=mr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class R2{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new b2(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(mr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class F2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ke(this.o===void 0);const n=s=>{s.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,ce("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ke(typeof t.token=="string"),this.R=t.token,new F2(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=P2(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%e.length))}return n}}function Me(r,e){return r<e?-1:r>e?1:0}function _a(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function b1(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new fe(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ct.fromMillis(Date.now())}static fromDate(e){return Ct.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Ct(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.timestamp=e}static fromTimestamp(e){return new be(e)}static min(){return new be(new Ct(0,0))}static max(){return new be(new Ct(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e,t,n){t===void 0?t=0:t>e.length&&Se(),n===void 0?n=e.length-t:n>e.length-t&&Se(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return No.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof No?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Je extends No{construct(e,t,n){return new Je(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new fe(te.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Je(t)}static emptyPath(){return new Je([])}}const N2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class It extends No{construct(e,t,n){return new It(e,t,n)}static isValidIdentifier(e){return N2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),It.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new It(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new fe(te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new fe(te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new fe(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new fe(te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new It(t)}static emptyPath(){return new It([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(Je.fromString(e))}static fromName(e){return new we(Je.fromString(e).popFirst(5))}static empty(){return new we(Je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Je.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new Je(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function Gf(r){return r.fields.find(e=>e.kind===2)}function Ji(r){return r.fields.filter(e=>e.kind!==2)}kl.UNKNOWN_ID=-1;class ml{constructor(e,t){this.fieldPath=e,this.kind=t}}class Oo{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Oo(0,Kr.min())}}function R1(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=be.fromTimestamp(n===1e9?new Ct(t+1,0):new Ct(t,n));return new Kr(i,we.empty(),e)}function F1(r){return new Kr(r.readTime,r.key,-1)}class Kr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Kr(be.min(),we.empty(),-1)}static max(){return new Kr(be.max(),we.empty(),-1)}}function C0(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=we.comparator(r.documentKey,e.documentKey),t!==0?t:Me(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class P1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ni(r){if(r.code!==te.FAILED_PRECONDITION||r.message!==D1)throw r;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Se(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):q.reject(t)}static resolve(e){return new q((t,n)=>{t(e)})}static reject(e){return new q((t,n)=>{n(e)})}static waitFor(e){return new q((t,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&t()},c=>n(c))}),a=!0,s===i&&t()})}static or(e){let t=q.resolve(!1);for(const n of e)t=t.next(i=>i?q.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new q((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let c=0;c<s;c++){const l=c;t(e[l]).next(u=>{a[l]=u,++o,o===s&&n(a)},u=>i(u))}})}static doWhile(e,t){return new q((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new _n,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new go(e,t.error)):this.V.resolve()},this.transaction.onerror=n=>{const i=b0(n.target.error);this.V.reject(new go(e,i))}}static open(e,t,n,i){try{return new lu(t,e.transaction(i,n))}catch(s){throw new go(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ce("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new L2(t)}}class Ei{constructor(e,t,n){this.name=e,this.version=t,this.p=n,Ei.S(Sl())===12.2&&Mt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ce("SimpleDb","Removing database:",e),Zi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!h1())return!1;if(Ei.v())return!0;const e=Sl(),t=Ei.S(e),n=0<t&&t<10,i=N1(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(ce("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{n(new go(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?n(new fe(te.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?n(new fe(te.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):n(new go(e,a))},i.onupgradeneeded=s=>{ce("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.O(a,i.transaction,s.oldVersion,this.version).next(()=>{ce("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.M(e);const o=lu.open(this.db,e,s?"readonly":"readwrite",n),c=i(o).next(l=>(o.g(),l)).catch(l=>(o.abort(l),q.reject(l))).toPromise();return c.catch(()=>{}),await o.m,c}catch(o){const c=o,l=c.name!=="FirebaseError"&&a<3;if(ce("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function N1(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class O2{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Zi(this.B.delete())}}class go extends fe{constructor(e,t){super(te.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Oi(r){return r.name==="IndexedDbTransactionError"}class L2{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(ce("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(ce("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Zi(n)}add(e){return ce("SimpleDb","ADD",this.store.name,e,e),Zi(this.store.add(e))}get(e){return Zi(this.store.get(e)).next(t=>(t===void 0&&(t=null),ce("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return ce("SimpleDb","DELETE",this.store.name,e),Zi(this.store.delete(e))}count(){return ce("SimpleDb","COUNT",this.store.name),Zi(this.store.count())}U(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(n.range);return new q((a,o)=>{s.onerror=c=>{o(c.target.error)},s.onsuccess=c=>{a(c.target.result)}})}{const s=this.cursor(n),a=[];return this.W(s,(o,c)=>{a.push(c)}).next(()=>a)}}G(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new q((i,s)=>{n.onerror=a=>{s(a.target.error)},n.onsuccess=a=>{i(a.target.result)}})}j(e,t){ce("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const i=this.cursor(n);return this.W(i,(s,a,o)=>o.delete())}J(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.W(i,t)}Y(e){const t=this.cursor({});return new q((n,i)=>{t.onerror=s=>{const a=b0(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(o=>{o?a.continue():n()}):n()}})}W(e,t){const n=[];return new q((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const c=new O2(o),l=t(o.primaryKey,o.value,c);if(l instanceof q){const u=l.catch(h=>(c.done(),q.reject(h)));n.push(u)}c.isDone?i():c.K===null?o.continue():o.continue(c.K)}}).next(()=>q.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Zi(r){return new q((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=b0(n.target.error);t(i)}})}let pm=!1;function b0(r){const e=Ei.S(Sl());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new fe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return pm||(pm=!0,setTimeout(()=>{throw n},0)),n}}return r}class M2{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){ce("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{ce("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Oi(t)?ce("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Ni(t)}await this.X(6e4)})}}class V2{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const n=new Set;let i=t,s=!0;return q.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!n.has(a))return ce("IndexBackfiller",`Processing collection: ${a}`),this.ne(e,a,i).next(o=>{i-=o,n.add(a)});s=!1})).next(()=>t-i)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.re(i,s)).next(o=>(ce("IndexBackfiller",`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o))).next(()=>a.size)}))}re(e,t){let n=e;return t.changes.forEach((i,s)=>{const a=F1(s);C0(a,n)>0&&(n=a)}),new Kr(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ie(n),this.se=n=>t.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Pr.oe=-1;function lc(r){return r==null}function Lo(r){return r===0&&1/r==-1/0}function O1(r){return typeof r=="number"&&Number.isInteger(r)&&!Lo(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=gm(e)),e=B2(r.get(t),e);return gm(e)}function B2(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function gm(r){return r+""}function kn(r){const e=r.length;if(ke(e>=2),e===2)return ke(r.charAt(0)===""&&r.charAt(1)===""),Je.emptyPath();const t=e-2,n=[];let i="";for(let s=0;s<e;){const a=r.indexOf("",s);switch((a<0||a>t)&&Se(),r.charAt(a+1)){case"":const o=r.substring(s,a);let c;i.length===0?c=o:(i+=o,c=i,i=""),n.push(c);break;case"":i+=r.substring(s,a),i+="\0";break;case"":i+=r.substring(s,a+1);break;default:Se()}s=a+2}return new Je(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pl(r,e){return[r,kr(e)]}function L1(r,e,t){return[r,kr(e),t]}const U2={},G2=["prefixPath","collectionGroup","readTime","documentId"],W2=["prefixPath","collectionGroup","documentId"],H2=["collectionGroup","readTime","prefixPath","documentId"],z2=["canonicalId","targetId"],$2=["targetId","path"],j2=["path","targetId"],K2=["collectionId","parent"],q2=["indexId","uid"],X2=["uid","sequenceNumber"],Q2=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Y2=["indexId","uid","orderedDocumentKey"],J2=["userId","collectionPath","documentId"],Z2=["userId","collectionPath","largestBatchId"],eT=["userId","collectionGroup","largestBatchId"],M1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],tT=[...M1,"documentOverlays"],V1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],B1=V1,R0=[...B1,"indexConfiguration","indexState","indexEntries"],rT=R0,nT=[...R0,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf extends P1{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function qt(r,e){const t=Ie(r);return Ei.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ks(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function U1(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,t){this.comparator=e,this.root=t||ar.EMPTY}insert(e,t){return new pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ar.BLACK,null,null))}remove(e){return new pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ar.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qc(this.root,e,this.comparator,!1)}getReverseIterator(){return new qc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qc(this.root,e,this.comparator,!0)}}class qc{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ar{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??ar.RED,this.left=i??ar.EMPTY,this.right=s??ar.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new ar(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ar.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ar.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ar.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ar.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Se();const e=this.left.check();if(e!==this.right.check())throw Se();return e+(this.isRed()?0:1)}}ar.EMPTY=null,ar.RED=!0,ar.BLACK=!1;ar.EMPTY=new class{constructor(){this.size=0}get key(){throw Se()}get value(){throw Se()}get color(){throw Se()}get left(){throw Se()}get right(){throw Se()}copy(e,t,n,i,s){return this}insert(e,t,n){return new ar(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vm(this.data.getIterator())}getIteratorFrom(e){return new vm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof ft)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ft(this.comparator);return t.data=e,t}}class vm{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Hs(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this.fields=e,e.sort(It.comparator)}static empty(){return new Nr([])}unionWith(e){let t=new ft(It.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Nr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _a(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new G1("Invalid base64 string: "+s):s}}(e);return new Bt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Bt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bt.EMPTY_BYTE_STRING=new Bt("");const iT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Jn(r){if(ke(!!r),typeof r=="string"){let e=0;const t=iT.exec(r);if(ke(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Et(r.seconds),nanos:Et(r.nanos)}}function Et(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Ai(r){return typeof r=="string"?Bt.fromBase64String(r):Bt.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function F0(r){const e=r.mapValue.fields.__previous_value__;return uu(e)?F0(e):e}function Mo(r){const e=Jn(r.mapValue.fields.__local_write_time__.timestampValue);return new Ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e,t,n,i,s,a,o,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l}}class us{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new us("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof us&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},gl={nullValue:"NULL_VALUE"};function fs(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?uu(r)?4:W1(r)?9007199254740991:fu(r)?10:11:Se()}function Fn(r,e){if(r===e)return!0;const t=fs(r);if(t!==fs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Mo(r).isEqual(Mo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Jn(i.timestampValue),o=Jn(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return Ai(i.bytesValue).isEqual(Ai(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Et(i.geoPointValue.latitude)===Et(s.geoPointValue.latitude)&&Et(i.geoPointValue.longitude)===Et(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Et(i.integerValue)===Et(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Et(i.doubleValue),o=Et(s.doubleValue);return a===o?Lo(a)===Lo(o):isNaN(a)&&isNaN(o)}return!1}(r,e);case 9:return _a(r.arrayValue.values||[],e.arrayValue.values||[],Fn);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(xm(a)!==xm(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!Fn(a[c],o[c])))return!1;return!0}(r,e);default:return Se()}}function Vo(r,e){return(r.values||[]).find(t=>Fn(t,e))!==void 0}function Si(r,e){if(r===e)return 0;const t=fs(r),n=fs(e);if(t!==n)return Me(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Me(r.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Et(s.integerValue||s.doubleValue),c=Et(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(r,e);case 3:return ym(r.timestampValue,e.timestampValue);case 4:return ym(Mo(r),Mo(e));case 5:return Me(r.stringValue,e.stringValue);case 6:return function(s,a){const o=Ai(s),c=Ai(a);return o.compareTo(c)}(r.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){const u=Me(o[l],c[l]);if(u!==0)return u}return Me(o.length,c.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Me(Et(s.latitude),Et(a.latitude));return o!==0?o:Me(Et(s.longitude),Et(a.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return wm(r.arrayValue,e.arrayValue);case 10:return function(s,a){var o,c,l,u;const h=s.fields||{},d=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,g=(c=d.value)===null||c===void 0?void 0:c.arrayValue,p=Me(((l=m==null?void 0:m.values)===null||l===void 0?void 0:l.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return p!==0?p:wm(m,g)}(r.mapValue,e.mapValue);case 11:return function(s,a){if(s===mi.mapValue&&a===mi.mapValue)return 0;if(s===mi.mapValue)return 1;if(a===mi.mapValue)return-1;const o=s.fields||{},c=Object.keys(o),l=a.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const d=Me(c[h],u[h]);if(d!==0)return d;const m=Si(o[c[h]],l[u[h]]);if(m!==0)return m}return Me(c.length,u.length)}(r.mapValue,e.mapValue);default:throw Se()}}function ym(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Me(r,e);const t=Jn(r),n=Jn(e),i=Me(t.seconds,n.seconds);return i!==0?i:Me(t.nanos,n.nanos)}function wm(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=Si(t[i],n[i]);if(s)return s}return Me(t.length,n.length)}function xa(r){return Hf(r)}function Hf(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Jn(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Ai(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return we.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=Hf(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${Hf(t.fields[a])}`;return i+"}"}(r.mapValue):Se()}function hs(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function zf(r){return!!r&&"integerValue"in r}function Bo(r){return!!r&&"arrayValue"in r}function Em(r){return!!r&&"nullValue"in r}function Tm(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function _l(r){return!!r&&"mapValue"in r}function fu(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function _o(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return ks(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=_o(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_o(r.arrayValue.values[t]);return e}return Object.assign({},r)}function W1(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const H1={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function aT(r){return"nullValue"in r?gl:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?hs(us.empty(),we.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?fu(r)?H1:{mapValue:{}}:Se()}function oT(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?hs(us.empty(),we.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?H1:"mapValue"in r?fu(r)?{mapValue:{}}:mi:Se()}function Am(r,e){const t=Si(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function Sm(r,e){const t=Si(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.value=e}static empty(){return new cr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!_l(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_o(t)}setAll(e){let t=It.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=o.popLast()}a?n[o.lastSegment()]=_o(a):i.push(o.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());_l(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];_l(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){ks(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new cr(_o(this.value))}}function z1(r){const e=[];return ks(r.fields,(t,n)=>{const i=new It([t]);if(_l(n)){const s=z1(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Nr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,t,n,i,s,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Tt(e,0,be.min(),be.min(),be.min(),cr.empty(),0)}static newFoundDocument(e,t,n,i){return new Tt(e,1,t,be.min(),n,i,0)}static newNoDocument(e,t){return new Tt(e,2,t,be.min(),be.min(),cr.empty(),0)}static newUnknownDocument(e,t){return new Tt(e,3,t,be.min(),be.min(),cr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,t){this.position=e,this.inclusive=t}}function Im(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],a=r.position[i];if(s.field.isKeyField()?n=we.comparator(we.fromName(a.referenceValue),t.key):n=Si(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function km(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Fn(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,t="asc"){this.field=e,this.dir=t}}function cT(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{}class Ke extends $1{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new lT(e,t,n):t==="array-contains"?new hT(e,n):t==="in"?new Y1(e,n):t==="not-in"?new dT(e,n):t==="array-contains-any"?new mT(e,n):new Ke(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new uT(e,n):new fT(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Si(t,this.value)):t!==null&&fs(this.value)===fs(t)&&this.matchesComparison(Si(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ct extends $1{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new ct(e,t)}matches(e){return va(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function va(r){return r.op==="and"}function $f(r){return r.op==="or"}function D0(r){return j1(r)&&va(r)}function j1(r){for(const e of r.filters)if(e instanceof ct)return!1;return!0}function jf(r){if(r instanceof Ke)return r.field.canonicalString()+r.op.toString()+xa(r.value);if(D0(r))return r.filters.map(e=>jf(e)).join(",");{const e=r.filters.map(t=>jf(t)).join(",");return`${r.op}(${e})`}}function K1(r,e){return r instanceof Ke?function(n,i){return i instanceof Ke&&n.op===i.op&&n.field.isEqual(i.field)&&Fn(n.value,i.value)}(r,e):r instanceof ct?function(n,i){return i instanceof ct&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&K1(a,i.filters[o]),!0):!1}(r,e):void Se()}function q1(r,e){const t=r.filters.concat(e);return ct.create(t,r.op)}function X1(r){return r instanceof Ke?function(t){return`${t.field.canonicalString()} ${t.op} ${xa(t.value)}`}(r):r instanceof ct?function(t){return t.op.toString()+" {"+t.getFilters().map(X1).join(" ,")+"}"}(r):"Filter"}class lT extends Ke{constructor(e,t,n){super(e,t,n),this.key=we.fromName(n.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class uT extends Ke{constructor(e,t){super(e,"in",t),this.keys=Q1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class fT extends Ke{constructor(e,t){super(e,"not-in",t),this.keys=Q1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Q1(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>we.fromName(n.referenceValue))}class hT extends Ke{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Bo(t)&&Vo(t.arrayValue,this.value)}}class Y1 extends Ke{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Vo(this.value.arrayValue,t)}}class dT extends Ke{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Vo(this.value.arrayValue,t)}}class mT extends Ke{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Bo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Vo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(e,t=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function Kf(r,e=null,t=[],n=[],i=null,s=null,a=null){return new pT(r,e,t,n,i,s,a)}function ds(r){const e=Ie(r);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>jf(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),lc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>xa(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>xa(n)).join(",")),e.ue=t}return e.ue}function uc(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!cT(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!K1(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!km(r.startAt,e.startAt)&&km(r.endAt,e.endAt)}function Cl(r){return we.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function bl(r,e){return r.filters.filter(t=>t instanceof Ke&&t.field.isEqual(e))}function Cm(r,e,t){let n=gl,i=!0;for(const s of bl(r,e)){let a=gl,o=!0;switch(s.op){case"<":case"<=":a=aT(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=gl}Am({value:n,inclusive:i},{value:a,inclusive:o})<0&&(n=a,i=o)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const a=t.position[s];Am({value:n,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(n=a,i=t.inclusive);break}}return{value:n,inclusive:i}}function bm(r,e,t){let n=mi,i=!0;for(const s of bl(r,e)){let a=mi,o=!0;switch(s.op){case">=":case">":a=oT(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=mi}Sm({value:n,inclusive:i},{value:a,inclusive:o})>0&&(n=a,i=o)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const a=t.position[s];Sm({value:n,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(n=a,i=t.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,t=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function J1(r,e,t,n,i,s,a,o){return new Li(r,e,t,n,i,s,a,o)}function fc(r){return new Li(r)}function Rm(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function P0(r){return r.collectionGroup!==null}function aa(r){const e=Ie(r);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new ft(It.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Uo(s,n))}),t.has(It.keyField().canonicalString())||e.ce.push(new Uo(It.keyField(),n))}return e.ce}function $r(r){const e=Ie(r);return e.le||(e.le=gT(e,aa(r))),e.le}function gT(r,e){if(r.limitType==="F")return Kf(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Uo(i.field,s)});const t=r.endAt?new Ii(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Ii(r.startAt.position,r.startAt.inclusive):null;return Kf(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function qf(r,e){const t=r.filters.concat([e]);return new Li(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Rl(r,e,t){return new Li(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function hu(r,e){return uc($r(r),$r(e))&&r.limitType===e.limitType}function Z1(r){return`${ds($r(r))}|lt:${r.limitType}`}function Ys(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>X1(i)).join(", ")}]`),lc(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>xa(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>xa(i)).join(",")),`Target(${n})`}($r(r))}; limitType=${r.limitType})`}function hc(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):we.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of aa(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){const l=Im(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,aa(n),i)||n.endAt&&!function(a,o,c){const l=Im(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,aa(n),i))}(r,e)}function e_(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function t_(r){return(e,t)=>{let n=!1;for(const i of aa(r)){const s=_T(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function _T(r,e,t){const n=r.field.isKeyField()?we.comparator(e.key,t.key):function(s,a,o){const c=a.data.field(s),l=o.data.field(s);return c!==null&&l!==null?Si(c,l):Se()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Se()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ks(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return U1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT=new pt(we.comparator);function zr(){return xT}const r_=new pt(we.comparator);function co(...r){let e=r_;for(const t of r)e=e.insert(t.key,t);return e}function n_(r){let e=r_;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Cn(){return xo()}function i_(){return xo()}function xo(){return new Mi(r=>r.toString(),(r,e)=>r.isEqual(e))}const vT=new pt(we.comparator),yT=new ft(we.comparator);function He(...r){let e=yT;for(const t of r)e=e.add(t);return e}const wT=new ft(Me);function N0(){return wT}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lo(e)?"-0":e}}function s_(r){return{integerValue:""+r}}function a_(r,e){return O1(e)?s_(e):O0(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(){this._=void 0}}function ET(r,e,t){return r instanceof ya?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&uu(s)&&(s=F0(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):r instanceof ms?c_(r,e):r instanceof wa?l_(r,e):function(i,s){const a=o_(i,s),o=Fm(a)+Fm(i.Pe);return zf(a)&&zf(i.Pe)?s_(o):O0(i.serializer,o)}(r,e)}function TT(r,e,t){return r instanceof ms?c_(r,e):r instanceof wa?l_(r,e):t}function o_(r,e){return r instanceof Ea?function(n){return zf(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class ya extends du{}class ms extends du{constructor(e){super(),this.elements=e}}function c_(r,e){const t=u_(e);for(const n of r.elements)t.some(i=>Fn(i,n))||t.push(n);return{arrayValue:{values:t}}}class wa extends du{constructor(e){super(),this.elements=e}}function l_(r,e){let t=u_(e);for(const n of r.elements)t=t.filter(i=>!Fn(i,n));return{arrayValue:{values:t}}}class Ea extends du{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Fm(r){return Et(r.integerValue||r.doubleValue)}function u_(r){return Bo(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,t){this.field=e,this.transform=t}}function AT(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof ms&&i instanceof ms||n instanceof wa&&i instanceof wa?_a(n.elements,i.elements,Fn):n instanceof Ea&&i instanceof Ea?Fn(n.Pe,i.Pe):n instanceof ya&&i instanceof ya}(r.transform,e.transform)}class ST{constructor(e,t){this.version=e,this.transformResults=t}}class Vt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Vt}static exists(e){return new Vt(void 0,e)}static updateTime(e){return new Vt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xl(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class pu{}function f_(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new dc(r.key,Vt.none()):new Na(r.key,r.data,Vt.none());{const t=r.data,n=cr.empty();let i=new ft(It.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ei(r.key,n,new Nr(i.toArray()),Vt.none())}}function IT(r,e,t){r instanceof Na?function(i,s,a){const o=i.value.clone(),c=Pm(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(r,e,t):r instanceof ei?function(i,s,a){if(!xl(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=Pm(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(h_(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(r,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function vo(r,e,t,n){return r instanceof Na?function(s,a,o,c){if(!xl(s.precondition,a))return o;const l=s.value.clone(),u=Nm(s.fieldTransforms,c,a);return l.setAll(u),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(r,e,t,n):r instanceof ei?function(s,a,o,c){if(!xl(s.precondition,a))return o;const l=Nm(s.fieldTransforms,c,a),u=a.data;return u.setAll(h_(s)),u.setAll(l),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(r,e,t,n):function(s,a,o){return xl(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(r,e,t)}function kT(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=o_(n.transform,i||null);s!=null&&(t===null&&(t=cr.empty()),t.set(n.field,s))}return t||null}function Dm(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&_a(n,i,(s,a)=>AT(s,a))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Na extends pu{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ei extends pu{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function h_(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function Pm(r,e,t){const n=new Map;ke(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,TT(a,o,t[i]))}return n}function Nm(r,e,t){const n=new Map;for(const i of r){const s=i.transform,a=t.data.field(i.field);n.set(i.field,ET(s,a,e))}return n}class dc extends pu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class L0 extends pu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&IT(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=vo(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=vo(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=i_();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const c=f_(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(be.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),He())}isEqual(e){return this.batchId===e.batchId&&_a(this.mutations,e.mutations,(t,n)=>Dm(t,n))&&_a(this.baseMutations,e.baseMutations,(t,n)=>Dm(t,n))}}class V0{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ke(e.mutations.length===n.length);let i=function(){return vT}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new V0(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ht,Xe;function d_(r){switch(r){default:return Se();case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0}}function m_(r){if(r===void 0)return Mt("GRPC error has no .code"),te.UNKNOWN;switch(r){case Ht.OK:return te.OK;case Ht.CANCELLED:return te.CANCELLED;case Ht.UNKNOWN:return te.UNKNOWN;case Ht.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case Ht.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case Ht.INTERNAL:return te.INTERNAL;case Ht.UNAVAILABLE:return te.UNAVAILABLE;case Ht.UNAUTHENTICATED:return te.UNAUTHENTICATED;case Ht.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case Ht.NOT_FOUND:return te.NOT_FOUND;case Ht.ALREADY_EXISTS:return te.ALREADY_EXISTS;case Ht.PERMISSION_DENIED:return te.PERMISSION_DENIED;case Ht.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case Ht.ABORTED:return te.ABORTED;case Ht.OUT_OF_RANGE:return te.OUT_OF_RANGE;case Ht.UNIMPLEMENTED:return te.UNIMPLEMENTED;case Ht.DATA_LOSS:return te.DATA_LOSS;default:return Se()}}(Xe=Ht||(Ht={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=new is([4294967295,4294967295],0);function Om(r){const e=bT().encode(r),t=new E1;return t.update(e),new Uint8Array(t.digest())}function Lm(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new is([t,n],0),new is([i,s],0)]}class U0{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new lo(`Invalid padding: ${t}`);if(n<0)throw new lo(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new lo(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new lo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=is.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(is.fromNumber(n)));return i.compare(RT)===1&&(i=new is([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Om(e),[n,i]=Lm(t);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new U0(s,i,t);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const t=Om(e),[n,i]=Lm(t);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class lo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,pc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new mc(be.min(),i,new pt(Me),zr(),He())}}class pc{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new pc(n,t,He(),He(),He())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}}class p_{constructor(e,t){this.targetId=e,this.me=t}}class g_{constructor(e,t,n=Bt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Mm{constructor(){this.fe=0,this.ge=Bm(),this.pe=Bt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=He(),t=He(),n=He();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Se()}}),new pc(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Bm()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ke(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class FT{constructor(e){this.Le=e,this.Be=new Map,this.ke=zr(),this.qe=Vm(),this.Qe=new pt(Me)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Se()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,n=e.me.count,i=this.Je(t);if(i){const s=i.target;if(Cl(s))if(n===0){const a=new we(s.path);this.Ue(t,a,Tt.newNoDocument(a,be.min()))}else ke(n===1);else{const a=this.Ye(t);if(a!==n){const o=this.Ze(e),c=o?this.Xe(o,e,a):1;if(c!==0){this.je(t);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=Ai(n).toUint8Array()}catch(c){if(c instanceof G1)return Po("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new U0(a,i,s)}catch(c){return Po(c instanceof lo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.Ie===0?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&Cl(o.target)){const c=new we(o.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,Tt.newNoDocument(c,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let n=He();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(c=>{const l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new mc(e,t,this.Qe,this.ke,n);return this.ke=zr(),this.qe=Vm(),this.Qe=new pt(Me),i}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Mm,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ft(Me),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||ce("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Mm),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Vm(){return new pt(we.comparator)}function Bm(){return new pt(we.comparator)}const DT={asc:"ASCENDING",desc:"DESCENDING"},PT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NT={and:"AND",or:"OR"};class OT{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Xf(r,e){return r.useProto3Json||lc(e)?e:{value:e}}function Ta(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function LT(r,e){return Ta(r,e.toTimestamp())}function tr(r){return ke(!!r),be.fromTimestamp(function(t){const n=Jn(t);return new Ct(n.seconds,n.nanos)}(r))}function G0(r,e){return Qf(r,e).canonicalString()}function Qf(r,e){const t=function(i){return new Je(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function x_(r){const e=Je.fromString(r);return ke(k_(e)),e}function Go(r,e){return G0(r.databaseId,e.path)}function qn(r,e){const t=x_(e);if(t.get(1)!==r.databaseId.projectId)throw new fe(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new fe(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new we(w_(t))}function v_(r,e){return G0(r.databaseId,e)}function y_(r){const e=x_(r);return e.length===4?Je.emptyPath():w_(e)}function Yf(r){return new Je(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function w_(r){return ke(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Um(r,e,t){return{name:Go(r,e),fields:t.value.mapValue.fields}}function MT(r,e,t){const n=qn(r,e.name),i=tr(e.updateTime),s=e.createTime?tr(e.createTime):be.min(),a=new cr({mapValue:{fields:e.fields}}),o=Tt.newFoundDocument(n,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function VT(r,e){return"found"in e?function(n,i){ke(!!i.found),i.found.name,i.found.updateTime;const s=qn(n,i.found.name),a=tr(i.found.updateTime),o=i.found.createTime?tr(i.found.createTime):be.min(),c=new cr({mapValue:{fields:i.found.fields}});return Tt.newFoundDocument(s,a,o,c)}(r,e):"missing"in e?function(n,i){ke(!!i.missing),ke(!!i.readTime);const s=qn(n,i.missing),a=tr(i.readTime);return Tt.newNoDocument(s,a)}(r,e):Se()}function BT(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Se()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(ke(u===void 0||typeof u=="string"),Bt.fromBase64String(u||"")):(ke(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Bt.fromUint8Array(u||new Uint8Array))}(r,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(l){const u=l.code===void 0?te.UNKNOWN:m_(l.code);return new fe(u,l.message||"")}(a);t=new g_(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=qn(r,n.document.name),s=tr(n.document.updateTime),a=n.document.createTime?tr(n.document.createTime):be.min(),o=new cr({mapValue:{fields:n.document.fields}}),c=Tt.newFoundDocument(i,s,a,o),l=n.targetIds||[],u=n.removedTargetIds||[];t=new vl(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=qn(r,n.document),s=n.readTime?tr(n.readTime):be.min(),a=Tt.newNoDocument(i,s),o=n.removedTargetIds||[];t=new vl([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=qn(r,n.document),s=n.removedTargetIds||[];t=new vl([],s,i,null)}else{if(!("filter"in e))return Se();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new CT(i,s),o=n.targetId;t=new p_(o,a)}}return t}function Wo(r,e){let t;if(e instanceof Na)t={update:Um(r,e.key,e.value)};else if(e instanceof dc)t={delete:Go(r,e.key)};else if(e instanceof ei)t={update:Um(r,e.key,e.data),updateMask:$T(e.fieldMask)};else{if(!(e instanceof L0))return Se();t={verify:Go(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof ya)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof ms)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof wa)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ea)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Se()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:LT(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Se()}(r,e.precondition)),t}function Jf(r,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Vt.updateTime(tr(s.updateTime)):s.exists!==void 0?Vt.exists(s.exists):Vt.none()}(e.currentDocument):Vt.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(a,o){let c=null;if("setToServerValue"in o)ke(o.setToServerValue==="REQUEST_TIME"),c=new ya;else if("appendMissingElements"in o){const u=o.appendMissingElements.values||[];c=new ms(u)}else if("removeAllFromArray"in o){const u=o.removeAllFromArray.values||[];c=new wa(u)}else"increment"in o?c=new Ea(a,o.increment):Se();const l=It.fromServerFormat(o.fieldPath);return new mu(l,c)}(r,i)):[];if(e.update){e.update.name;const i=qn(r,e.update.name),s=new cr({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(c){const l=c.fieldPaths||[];return new Nr(l.map(u=>It.fromServerFormat(u)))}(e.updateMask);return new ei(i,s,a,t,n)}return new Na(i,s,t,n)}if(e.delete){const i=qn(r,e.delete);return new dc(i,t)}if(e.verify){const i=qn(r,e.verify);return new L0(i,t)}return Se()}function UT(r,e){return r&&r.length>0?(ke(e!==void 0),r.map(t=>function(i,s){let a=i.updateTime?tr(i.updateTime):tr(s);return a.isEqual(be.min())&&(a=tr(s)),new ST(a,i.transformResults||[])}(t,e))):[]}function E_(r,e){return{documents:[v_(r,e.path)]}}function T_(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=v_(r,i);const s=function(l){if(l.length!==0)return I_(ct.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const a=function(l){if(l.length!==0)return l.map(u=>function(d){return{field:Js(d.field),direction:WT(d.dir)}}(u))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=Xf(r,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function A_(r){let e=y_(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){ke(n===1);const u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=function(h){const d=S_(h);return d instanceof ct&&D0(d)?d.getFilters():[d]}(t.where));let a=[];t.orderBy&&(a=function(h){return h.map(d=>function(g){return new Uo(Zs(g.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(t.orderBy));let o=null;t.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,lc(d)?null:d}(t.limit));let c=null;t.startAt&&(c=function(h){const d=!!h.before,m=h.values||[];return new Ii(m,d)}(t.startAt));let l=null;return t.endAt&&(l=function(h){const d=!h.before,m=h.values||[];return new Ii(m,d)}(t.endAt)),J1(e,i,a,s,o,"F",c,l)}function GT(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function S_(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Zs(t.unaryFilter.field);return Ke.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Zs(t.unaryFilter.field);return Ke.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Zs(t.unaryFilter.field);return Ke.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Zs(t.unaryFilter.field);return Ke.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Se()}}(r):r.fieldFilter!==void 0?function(t){return Ke.create(Zs(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Se()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return ct.create(t.compositeFilter.filters.map(n=>S_(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Se()}}(t.compositeFilter.op))}(r):Se()}function WT(r){return DT[r]}function HT(r){return PT[r]}function zT(r){return NT[r]}function Js(r){return{fieldPath:r.canonicalString()}}function Zs(r){return It.fromServerFormat(r.fieldPath)}function I_(r){return r instanceof Ke?function(t){if(t.op==="=="){if(Tm(t.value))return{unaryFilter:{field:Js(t.field),op:"IS_NAN"}};if(Em(t.value))return{unaryFilter:{field:Js(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Tm(t.value))return{unaryFilter:{field:Js(t.field),op:"IS_NOT_NAN"}};if(Em(t.value))return{unaryFilter:{field:Js(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Js(t.field),op:HT(t.op),value:t.value}}}(r):r instanceof ct?function(t){const n=t.getFilters().map(i=>I_(i));return n.length===1?n[0]:{compositeFilter:{op:zT(t.op),filters:n}}}(r):Se()}function $T(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function k_(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,t,n,i,s=be.min(),a=be.min(),o=Bt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new jn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new jn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new jn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new jn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e){this.ct=e}}function jT(r,e){let t;if(e.document)t=MT(r.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=we.fromSegments(e.noDocument.path),i=gs(e.noDocument.readTime);t=Tt.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Se();{const n=we.fromSegments(e.unknownDocument.path),i=gs(e.unknownDocument.version);t=Tt.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Ct(i[0],i[1]);return be.fromTimestamp(s)}(e.readTime)),t}function Gm(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Fl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,a){return{name:Go(s,a.key),fields:a.data.value.mapValue.fields,updateTime:Ta(s,a.version.toTimestamp()),createTime:Ta(s,a.createTime.toTimestamp())}}(r.ct,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:ps(e.version)};else{if(!e.isUnknownDocument())return Se();n.unknownDocument={path:t.path.toArray(),version:ps(e.version)}}return n}function Fl(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function ps(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function gs(r){const e=new Ct(r.seconds,r.nanoseconds);return be.fromTimestamp(e)}function es(r,e){const t=(e.baseMutations||[]).map(s=>Jf(r.ct,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>Jf(r.ct,s)),i=Ct.fromMillis(e.localWriteTimeMs);return new M0(e.batchId,i,t,n)}function uo(r){const e=gs(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?gs(r.lastLimboFreeSnapshotVersion):be.min();let n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){return ke(s.documents.length===1),$r(fc(y_(s.documents[0])))}(r.query):function(s){return $r(A_(s))}(r.query),new jn(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Bt.fromBase64String(r.resumeToken))}function b_(r,e){const t=ps(e.snapshotVersion),n=ps(e.lastLimboFreeSnapshotVersion);let i;i=Cl(e.target)?E_(r.ct,e.target):T_(r.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ds(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function R_(r){const e=A_({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Rl(e,e.limit,"L"):e}function of(r,e){return new B0(e.largestBatchId,Jf(r.ct,e.overlayMutation))}function Wm(r,e){const t=e.path.lastSegment();return[r,kr(e.path.popLast()),t]}function Hm(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:ps(n.readTime),documentKey:kr(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{getBundleMetadata(e,t){return zm(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:gs(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return zm(e).put(function(i){return{bundleId:i.id,createTime:ps(tr(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return $m(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:R_(s.bundledQuery),readTime:gs(s.readTime)}}(n)})}saveNamedQuery(e,t){return $m(e).put(function(i){return{name:i.name,readTime:ps(tr(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function zm(r){return qt(r,"bundles")}function $m(r){return qt(r,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new gu(e,n)}getOverlay(e,t){return to(e).get(Wm(this.userId,t)).next(n=>n?of(this.serializer,n):null)}getOverlays(e,t){const n=Cn();return q.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((s,a)=>{const o=new B0(t,a);i.push(this.ht(e,o))}),q.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(a=>i.add(kr(a.getCollectionPath())));const s=[];return i.forEach(a=>{const o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,n+1],!1,!0);s.push(to(e).j("collectionPathOverlayIndex",o))}),q.waitFor(s)}getOverlaysForCollection(e,t,n){const i=Cn(),s=kr(t),a=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return to(e).U("collectionPathOverlayIndex",a).next(o=>{for(const c of o){const l=of(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const s=Cn();let a;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return to(e).J({index:"collectionGroupOverlayIndex",range:o},(c,l,u)=>{const h=of(this.serializer,l);s.size()<i||h.largestBatchId===a?(s.set(h.getKey(),h),a=h.largestBatchId):u.done()}).next(()=>s)}ht(e,t){return to(e).put(function(i,s,a){const[o,c,l]=Wm(s,a.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Wo(i.ct,a.mutation)}}(this.serializer,this.userId,t))}}function to(r){return qt(r,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{Pt(e){return qt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?Bt.fromUint8Array(n):Bt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Et(e.integerValue));else if("doubleValue"in e){const n=Et(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Lo(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),typeof n=="string"&&(n=Jn(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ai(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?W1(e)?this.dt(t,Number.MAX_SAFE_INTEGER):fu(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Se()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const i of Object.keys(n))this.Vt(i,t),this.Tt(n[i],t)}wt(e,t){var n,i;const s=e.fields||{};this.dt(t,53);const a="value",o=((i=(n=s[a].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Et(o)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const i of n)this.Tt(i,t)}yt(e,t){this.dt(t,37),we.fromName(e).path.forEach(n=>{this.dt(t,60),this.Dt(n,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}ts.vt=new ts;function XT(r){if(r===0)return 8;let e=0;return!(r>>4)&&(e+=4,r<<=4),!(r>>6)&&(e+=2,r<<=2),!(r>>7)&&(e+=1),e}function jm(r){const e=64-function(n){let i=0;for(let s=0;s<8;++s){const a=XT(255&n[s]);if(i+=a,a!==8)break}return i}(r);return Math.ceil(e/8)}class QT{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const t=this.qt(e),n=jm(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),n=jm(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),n=(128&t[0])!=0;t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class YT{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class JT{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ro{constructor(){this.jt=new QT,this.Ht=new YT(this.jt),this.Jt=new JT(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new rs(this.indexId,this.documentKey,this.arrayValue,n)}}function ci(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=Km(r.arrayValue,e.arrayValue),t!==0?t:(t=Km(r.directionalValue,e.directionalValue),t!==0?t:we.comparator(r.documentKey,e.documentKey)))}function Km(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(e){this.Xt=new ft((t,n)=>It.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const n=t;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(ke(e.collectionGroup===this.collectionId),this.nn)return!1;const t=Gf(e);if(t!==void 0&&!this.sn(t))return!1;const n=Ji(e);let i=new Set,s=0,a=0;for(;s<n.length&&this.sn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const o=this.Xt.getIterator().getNext();if(!i.has(o.field.canonicalString())){const c=n[s];if(!this.on(o,c)||!this._n(this.en[a++],c))return!1}++s}for(;s<n.length;++s){const o=n[s];if(a>=this.en.length||!this._n(this.en[a++],o))return!1}return!0}an(){if(this.nn)return null;let e=new ft(It.comparator);const t=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new ml(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new ml(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new ml(n.field,n.dir==="asc"?0:1)));return new kl(kl.UNKNOWN_ID,this.collectionId,t,Oo.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F_(r){var e,t;if(ke(r instanceof Ke||r instanceof ct),r instanceof Ke){if(r instanceof Y1){const i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Ke.create(r.field,"==",s)))||[];return ct.create(i,"or")}return r}const n=r.filters.map(i=>F_(i));return ct.create(n,r.op)}function ZT(r){if(r.getFilters().length===0)return[];const e=t0(F_(r));return ke(D_(e)),Zf(e)||e0(e)?[e]:e.getFilters()}function Zf(r){return r instanceof Ke}function e0(r){return r instanceof ct&&D0(r)}function D_(r){return Zf(r)||e0(r)||function(t){if(t instanceof ct&&$f(t)){for(const n of t.getFilters())if(!Zf(n)&&!e0(n))return!1;return!0}return!1}(r)}function t0(r){if(ke(r instanceof Ke||r instanceof ct),r instanceof Ke)return r;if(r.filters.length===1)return t0(r.filters[0]);const e=r.filters.map(n=>t0(n));let t=ct.create(e,r.op);return t=Dl(t),D_(t)?t:(ke(t instanceof ct),ke(va(t)),ke(t.filters.length>1),t.filters.reduce((n,i)=>W0(n,i)))}function W0(r,e){let t;return ke(r instanceof Ke||r instanceof ct),ke(e instanceof Ke||e instanceof ct),t=r instanceof Ke?e instanceof Ke?function(i,s){return ct.create([i,s],"and")}(r,e):Xm(r,e):e instanceof Ke?Xm(e,r):function(i,s){if(ke(i.filters.length>0&&s.filters.length>0),va(i)&&va(s))return q1(i,s.getFilters());const a=$f(i)?i:s,o=$f(i)?s:i,c=a.filters.map(l=>W0(l,o));return ct.create(c,"or")}(r,e),Dl(t)}function Xm(r,e){if(va(e))return q1(e,r.getFilters());{const t=e.filters.map(n=>W0(r,n));return ct.create(t,"or")}}function Dl(r){if(ke(r instanceof Ke||r instanceof ct),r instanceof Ke)return r;const e=r.getFilters();if(e.length===1)return Dl(e[0]);if(j1(r))return r;const t=e.map(i=>Dl(i)),n=[];return t.forEach(i=>{i instanceof Ke?n.push(i):i instanceof ct&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:ct.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(){this.un=new H0}addToCollectionParentIndex(e,t){return this.un.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(Kr.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(Kr.min())}updateCollectionGroup(e,t,n){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class H0{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new ft(Je.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ft(Je.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=new Uint8Array(0);class tA{constructor(e,t){this.databaseId=t,this.cn=new H0,this.ln=new Mi(n=>ds(n),(n,i)=>uc(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const s={collectionId:n,parent:kr(i)};return Qm(e).put(s)}return q.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[b1(t),""],!1,!0);return Qm(e).U(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;n.push(kn(a.parent))}return n})}addFieldIndex(e,t){const n=no(e),i=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;const s=n.add(i);if(t.indexState){const a=$s(e);return s.next(o=>{a.put(Hm(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=no(e),i=$s(e),s=zs(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=no(e),n=zs(e),i=$s(e);return t.j().next(()=>n.j()).next(()=>i.j())}createTargetIndexes(e,t){return q.forEach(this.hn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){const s=new qm(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const n=zs(e);let i=!0;const s=new Map;return q.forEach(this.hn(t),a=>this.Pn(e,a).next(o=>{i&&(i=!!o),s.set(a,o)})).next(()=>{if(i){let a=He();const o=[];return q.forEach(s,(c,l)=>{ce("IndexedDbIndexManager",`Using index ${function(w){return`id=${w.indexId}|cg=${w.collectionGroup}|f=${w.fields.map(F=>`${F.fieldPath}:${F.kind}`).join(",")}`}(c)} to execute ${ds(t)}`);const u=function(w,F){const L=Gf(F);if(L===void 0)return null;for(const O of bl(w,L.fieldPath))switch(O.op){case"array-contains-any":return O.value.arrayValue.values||[];case"array-contains":return[O.value]}return null}(l,c),h=function(w,F){const L=new Map;for(const O of Ji(F))for(const v of bl(w,O.fieldPath))switch(v.op){case"==":case"in":L.set(O.fieldPath.canonicalString(),v.value);break;case"not-in":case"!=":return L.set(O.fieldPath.canonicalString(),v.value),Array.from(L.values())}return null}(l,c),d=function(w,F){const L=[];let O=!0;for(const v of Ji(F)){const A=v.kind===0?Cm(w,v.fieldPath,w.startAt):bm(w,v.fieldPath,w.startAt);L.push(A.value),O&&(O=A.inclusive)}return new Ii(L,O)}(l,c),m=function(w,F){const L=[];let O=!0;for(const v of Ji(F)){const A=v.kind===0?bm(w,v.fieldPath,w.endAt):Cm(w,v.fieldPath,w.endAt);L.push(A.value),O&&(O=A.inclusive)}return new Ii(L,O)}(l,c),g=this.In(c,l,d),p=this.In(c,l,m),x=this.Tn(c,l,h),T=this.En(c.indexId,u,g,d.inclusive,p,m.inclusive,x);return q.forEach(T,C=>n.G(C,t.limit).next(w=>{w.forEach(F=>{const L=we.fromSegments(F.documentKey);a.has(L)||(a=a.add(L),o.push(L))})}))}).next(()=>o)}return q.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=ZT(ct.create(e.filters,"and")).map(n=>Kf(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,n,i,s,a,o){const c=(t!=null?t.length:1)*Math.max(n.length,s.length),l=c/(t!=null?t.length:1),u=[];for(let h=0;h<c;++h){const d=t?this.dn(t[h/l]):Xc,m=this.An(e,d,n[h%l],i),g=this.Rn(e,d,s[h%l],a),p=o.map(x=>this.An(e,d,x,!0));u.push(...this.createRange(m,g,p))}return u}An(e,t,n,i){const s=new rs(e,we.empty(),t,n);return i?s:s.Zt()}Rn(e,t,n,i){const s=new rs(e,we.empty(),t,n);return i?s.Zt():s}Pn(e,t){const n=new qm(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const o of s)n.rn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a})}getIndexType(e,t){let n=2;const i=this.hn(t);return q.forEach(i,s=>this.Pn(e,s).next(a=>{a?n!==0&&a.fields.length<function(c){let l=new ft(It.comparator),u=!1;for(const h of c.filters)for(const d of h.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?u=!0:l=l.add(d.field));for(const h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(u?1:0)}(s)&&(n=1):n=0})).next(()=>function(a){return a.limit!==null}(t)&&i.length>1&&n===2?1:n)}Vn(e,t){const n=new ro;for(const i of Ji(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=n.Yt(i.kind);ts.vt.It(s,a)}return n.zt()}dn(e){const t=new ro;return ts.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const n=new ro;return ts.vt.It(hs(this.databaseId,t),n.Yt(function(s){const a=Ji(s);return a.length===0?0:a[a.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(n===null)return[];let i=[];i.push(new ro);let s=0;for(const a of Ji(e)){const o=n[s++];for(const c of i)if(this.fn(t,a.fieldPath)&&Bo(o))i=this.gn(i,a,o);else{const l=c.Yt(a.kind);ts.vt.It(o,l)}}return this.pn(i)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){const i=[...e],s=[];for(const a of n.arrayValue.values||[])for(const o of i){const c=new ro;c.seed(o.zt()),ts.vt.It(a,c.Yt(t.kind)),s.push(c)}return s}fn(e,t){return!!e.filters.find(n=>n instanceof Ke&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=no(e),i=$s(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(s=>{const a=[];return q.forEach(s,o=>i.get([o.indexId,this.uid]).next(c=>{a.push(function(u,h){const d=h?new Oo(h.sequenceNumber,new Kr(gs(h.readTime),new we(kn(h.documentKey)),h.largestBatchId)):Oo.empty(),m=u.fields.map(([g,p])=>new ml(It.fromServerFormat(g),p));return new kl(u.indexId,u.collectionGroup,m,d)}(o,c))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{const s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Me(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=no(e),s=$s(e);return this.yn(e).next(a=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(o=>q.forEach(o,c=>s.put(Hm(c.indexId,this.uid,a,n)))))}updateIndexEntries(e,t){const n=new Map;return q.forEach(t,(i,s)=>{const a=n.get(i.collectionGroup);return(a?q.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(o=>(n.set(i.collectionGroup,o),q.forEach(o,c=>this.wn(e,i,c).next(l=>{const u=this.Sn(s,c);return l.isEqual(u)?q.resolve():this.bn(e,s,c,l,u)}))))})}Dn(e,t,n,i){return zs(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,i){return zs(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){const i=zs(e);let s=new ft(ci);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},(a,o)=>{s=s.add(new rs(n.indexId,t,o.arrayValue,o.directionalValue))}).next(()=>s)}Sn(e,t){let n=new ft(ci);const i=this.Vn(t,e);if(i==null)return n;const s=Gf(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Bo(a))for(const o of a.arrayValue.values||[])n=n.add(new rs(t.indexId,e.key,this.dn(o),i))}else n=n.add(new rs(t.indexId,e.key,Xc,i));return n}bn(e,t,n,i,s){ce("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(c,l,u,h,d){const m=c.getIterator(),g=l.getIterator();let p=Hs(m),x=Hs(g);for(;p||x;){let T=!1,C=!1;if(p&&x){const w=u(p,x);w<0?C=!0:w>0&&(T=!0)}else p!=null?C=!0:T=!0;T?(h(x),x=Hs(g)):C?(d(p),p=Hs(m)):(p=Hs(m),x=Hs(g))}}(i,s,ci,o=>{a.push(this.Dn(e,t,n,o))},o=>{a.push(this.vn(e,t,n,o))}),q.waitFor(a)}yn(e){let t=1;return $s(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((a,o)=>ci(a,o)).filter((a,o,c)=>!o||ci(a,c[o-1])!==0);const i=[];i.push(e);for(const a of n){const o=ci(a,e),c=ci(a,t);if(o===0)i[0]=e.Zt();else if(o>0&&c<0)i.push(a),i.push(a.Zt());else if(c>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Cn(i[a],i[a+1]))return[];const o=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Xc,[]],c=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Xc,[]];s.push(IDBKeyRange.bound(o,c))}return s}Cn(e,t){return ci(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ym)}getMinOffset(e,t){return q.mapArray(this.hn(t),n=>this.Pn(e,n).next(i=>i||Se())).next(Ym)}}function Qm(r){return qt(r,"collectionParents")}function zs(r){return qt(r,"indexEntries")}function no(r){return qt(r,"indexConfiguration")}function $s(r){return qt(r,"indexState")}function Ym(r){ke(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;C0(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Kr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Dr{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Dr(e,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(r,e,t){const n=r.store("mutations"),i=r.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const c=n.J({range:a},(u,h,d)=>(o++,d.delete()));s.push(c.next(()=>{ke(o===1)}));const l=[];for(const u of t.mutations){const h=L1(e,u.key.path,t.batchId);s.push(i.delete(h)),l.push(u.key)}return q.waitFor(s).next(()=>l)}function Pl(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Se();e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dr.DEFAULT_COLLECTION_PERCENTILE=10,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dr.DEFAULT=new Dr(41943040,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dr.DISABLED=new Dr(-1,0,0);class _u{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Fn={}}static lt(e,t,n,i){ke(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new _u(s,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return li(e).J({index:"userMutationsIndex",range:n},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const s=ea(e),a=li(e);return a.add({}).next(o=>{ke(typeof o=="number");const c=new M0(o,t,n,i),l=function(m,g,p){const x=p.baseMutations.map(C=>Wo(m.ct,C)),T=p.mutations.map(C=>Wo(m.ct,C));return{userId:g,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:T}}(this.serializer,this.userId,c),u=[];let h=new ft((d,m)=>Me(d.canonicalString(),m.canonicalString()));for(const d of i){const m=L1(this.userId,d.key.path,o);h=h.add(d.key.path.popLast()),u.push(a.put(l)),u.push(s.put(m,U2))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Fn[o]=c.keys()}),q.waitFor(u).next(()=>c)})}lookupMutationBatch(e,t){return li(e).get(t).next(n=>n?(ke(n.userId===this.userId),es(this.serializer,n)):null)}Mn(e,t){return this.Fn[t]?q.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const i=n.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return li(e).J({index:"userMutationsIndex",range:i},(a,o,c)=>{o.userId===this.userId&&(ke(o.batchId>=n),s=es(this.serializer,o)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return li(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{n=s.batchId,a.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return li(e).U("userMutationsIndex",t).next(n=>n.map(i=>es(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=pl(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return ea(e).J({range:i},(a,o,c)=>{const[l,u,h]=a,d=kn(u);if(l===this.userId&&t.path.isEqual(d))return li(e).get(h).next(m=>{if(!m)throw Se();ke(m.userId===this.userId),s.push(es(this.serializer,m))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ft(Me);const i=[];return t.forEach(s=>{const a=pl(this.userId,s.path),o=IDBKeyRange.lowerBound(a),c=ea(e).J({range:o},(l,u,h)=>{const[d,m,g]=l,p=kn(m);d===this.userId&&s.path.isEqual(p)?n=n.add(g):h.done()});i.push(c)}),q.waitFor(i).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,s=pl(this.userId,n),a=IDBKeyRange.lowerBound(s);let o=new ft(Me);return ea(e).J({range:a},(c,l,u)=>{const[h,d,m]=c,g=kn(d);h===this.userId&&n.isPrefixOf(g)?g.length===i&&(o=o.add(m)):u.done()}).next(()=>this.xn(e,o))}xn(e,t){const n=[],i=[];return t.forEach(s=>{i.push(li(e).get(s).next(a=>{if(a===null)throw Se();ke(a.userId===this.userId),n.push(es(this.serializer,a))}))}),q.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return P_(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),q.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return q.resolve();const n=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return ea(e).J({range:n},(s,a,o)=>{if(s[0]===this.userId){const c=kn(s[1]);i.push(c)}else o.done()}).next(()=>{ke(i.length===0)})})}containsKey(e,t){return N_(e,this.userId,t)}Nn(e){return O_(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function N_(r,e,t){const n=pl(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n);let a=!1;return ea(r).J({range:s,H:!0},(o,c,l)=>{const[u,h,d]=o;u===e&&h===i&&(a=!0),l.done()}).next(()=>a)}function li(r){return qt(r,"mutations")}function ea(r){return qt(r,"documentMutations")}function O_(r){return qt(r,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new _s(0)}static kn(){return new _s(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const n=new _s(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>be.fromTimestamp(new Ct(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>js(e).delete(t.targetId)).next(()=>this.qn(e)).next(n=>(ke(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,t,n){let i=0;const s=[];return js(e).J((a,o)=>{const c=uo(o);c.sequenceNumber<=t&&n.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>q.waitFor(s)).next(()=>i)}forEachTarget(e,t){return js(e).J((n,i)=>{const s=uo(i);t(s)})}qn(e){return Zm(e).get("targetGlobalKey").next(t=>(ke(t!==null),t))}Qn(e,t){return Zm(e).put("targetGlobalKey",t)}Kn(e,t){return js(e).put(b_(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=ds(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return js(e).J({range:i,index:"queryTargetsIndex"},(a,o,c)=>{const l=uo(o);uc(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,n){const i=[],s=fi(e);return t.forEach(a=>{const o=kr(a.path);i.push(s.put({targetId:n,path:o})),i.push(this.referenceDelegate.addReference(e,n,a))}),q.waitFor(i)}removeMatchingKeys(e,t,n){const i=fi(e);return q.forEach(t,s=>{const a=kr(s.path);return q.waitFor([i.delete([n,a]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=fi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=fi(e);let s=He();return i.J({range:n,H:!0},(a,o,c)=>{const l=kn(a[1]),u=new we(l);s=s.add(u)}).next(()=>s)}containsKey(e,t){const n=kr(t.path),i=IDBKeyRange.bound([n],[b1(n)],!1,!0);let s=0;return fi(e).J({index:"documentTargetsIndex",H:!0,range:i},([a,o],c,l)=>{a!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return js(e).get(t).next(n=>n?uo(n):null)}}function js(r){return qt(r,"targets")}function Zm(r){return qt(r,"targetGlobal")}function fi(r){return qt(r,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep([r,e],[t,n]){const i=Me(r,t);return i===0?Me(e,n):i}class nA{constructor(e){this.Un=e,this.buffer=new ft(ep),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();ep(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class iA{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){ce("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Oi(t)?ce("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Ni(t)}await this.Hn(3e5)})}}class sA{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return q.resolve(Pr.oe);const n=new nA(t);return this.Jn.forEachTarget(e,i=>n.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>n.zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(Jm)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Jm):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,i,s,a,o,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,a=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(l=Date.now(),Qs()<=Qe.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-u}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(c-o)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function aA(r,e){return new sA(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,t){this.db=e,this.garbageCollector=aA(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}er(e){let t=0;return this.Zn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(n,i)=>t(i))}addReference(e,t,n){return Qc(e,n)}removeReference(e,t,n){return Qc(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Qc(e,t)}nr(e,t){return function(i,s){let a=!1;return O_(i).Y(o=>N_(i,o,s).next(c=>(c&&(a=!0),q.resolve(!c)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(a,o)=>{if(o<=t){const c=this.nr(e,a).next(l=>{if(!l)return s++,n.getEntry(e,a).next(()=>(n.removeEntry(a,be.min()),fi(e).delete(function(h){return[0,kr(h.path)]}(a))))});i.push(c)}}).next(()=>q.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Qc(e,t)}tr(e,t){const n=fi(e);let i,s=Pr.oe;return n.J({index:"documentTargetsIndex"},([a,o],{path:c,sequenceNumber:l})=>{a===0?(s!==Pr.oe&&t(new we(kn(i)),s),s=l,i=c):s=Pr.oe}).next(()=>{s!==Pr.oe&&t(new we(kn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Qc(r,e){return fi(r).put(function(n,i){return{targetId:0,path:kr(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(){this.changes=new Mi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Tt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?q.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Xi(e).put(n)}removeEntry(e,t,n){return Xi(e).delete(function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Fl(a),o[o.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.rr(e,n)))}getEntry(e,t){let n=Tt.newInvalidDocument(t);return Xi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(io(t))},(i,s)=>{n=this.ir(t,s)}).next(()=>n)}sr(e,t){let n={size:0,document:Tt.newInvalidDocument(t)};return Xi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(io(t))},(i,s)=>{n={document:this.ir(t,s),size:Pl(s)}}).next(()=>n)}getEntries(e,t){let n=zr();return this._r(e,t,(i,s)=>{const a=this.ir(i,s);n=n.insert(i,a)}).next(()=>n)}ar(e,t){let n=zr(),i=new pt(we.comparator);return this._r(e,t,(s,a)=>{const o=this.ir(s,a);n=n.insert(s,o),i=i.insert(s,Pl(a))}).next(()=>({documents:n,ur:i}))}_r(e,t,n){if(t.isEmpty())return q.resolve();let i=new ft(np);t.forEach(c=>i=i.add(c));const s=IDBKeyRange.bound(io(i.first()),io(i.last())),a=i.getIterator();let o=a.getNext();return Xi(e).J({index:"documentKeyIndex",range:s},(c,l,u)=>{const h=we.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;o&&np(o,h)<0;)n(o,null),o=a.getNext();o&&o.isEqual(h)&&(n(o,l),o=a.hasNext()?a.getNext():null),o?u.$(io(o)):u.done()}).next(()=>{for(;o;)n(o,null),o=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),Fl(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xi(e).U(IDBKeyRange.bound(o,c,!0)).next(l=>{s==null||s.incrementDocumentReadCount(l.length);let u=zr();for(const h of l){const d=this.ir(we.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);d.isFoundDocument()&&(hc(t,d)||i.has(d.key))&&(u=u.insert(d.key,d))}return u})}getAllFromCollectionGroup(e,t,n,i){let s=zr();const a=rp(t,n),o=rp(t,Kr.max());return Xi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,o,!0)},(c,l,u)=>{const h=this.ir(we.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new lA(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return tp(e).get("remoteDocumentGlobalKey").next(t=>(ke(!!t),t))}rr(e,t){return tp(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const n=jT(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(be.min())))return n}return Tt.newInvalidDocument(e)}}function M_(r){return new cA(r)}class lA extends L_{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Mi(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const t=[];let n=0,i=new ft((s,a)=>Me(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const o=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const c=Gm(this.cr.serializer,a);i=i.add(s.path.popLast());const l=Pl(c);n+=l-o.size,t.push(this.cr.addEntry(e,s,c))}else if(n-=o.size,this.trackRemovals){const c=Gm(this.cr.serializer,a.convertToNoDocument(be.min()));t.push(this.cr.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,n)),q.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(n=>(this.lr.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:n,ur:i})=>(i.forEach((s,a)=>{this.lr.set(s,{size:a,readTime:n.get(s).readTime})}),n))}}function tp(r){return qt(r,"remoteDocumentGlobal")}function Xi(r){return qt(r,"remoteDocumentsV14")}function io(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function rp(r,e){const t=e.documentKey.path.toArray();return[r,Fl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function np(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=Me(t[s],n[s]),i)return i;return i=Me(t.length,n.length),i||(i=Me(t[t.length-2],n[n.length-2]),i||Me(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&vo(n.mutation,i,Nr.empty(),Ct.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,He()).next(()=>n))}getLocalViewOfDocuments(e,t,n=He()){const i=Cn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let a=co();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const n=Cn();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,He()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,n,i){let s=zr();const a=xo(),o=function(){return xo()}();return t.forEach((c,l)=>{const u=n.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof ei)?s=s.insert(l.key,l):u!==void 0?(a.set(l.key,u.mutation.getFieldMask()),vo(u.mutation,l,u.mutation.getFieldMask(),Ct.now())):a.set(l.key,Nr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>a.set(l,u)),t.forEach((l,u)=>{var h;return o.set(l,new uA(u,(h=a.get(l))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,t){const n=xo();let i=new pt((a,o)=>a-o),s=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(c=>{const l=t.get(c);if(l===null)return;let u=n.get(c)||Nr.empty();u=o.applyToLocalView(l,u),n.set(c,u);const h=(i.get(o.batchId)||He()).add(c);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,u=c.value,h=i_();u.forEach(d=>{if(!s.has(d)){const m=f_(t.get(d),n.get(d));m!==null&&h.set(d,m),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,h))}return q.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(a){return we.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):P0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):q.resolve(Cn());let o=-1,c=s;return a.next(l=>q.forEach(l,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(u)?q.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,He())).next(u=>({batchId:o,changes:n_(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next(n=>{let i=co();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let a=co();return this.indexManager.getCollectionParents(e,s).next(o=>q.forEach(o,c=>{const l=function(h,d){return new Li(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(u=>{u.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(a=>{s.forEach((c,l)=>{const u=l.getKey();a.get(u)===null&&(a=a.insert(u,Tt.newInvalidDocument(u)))});let o=co();return a.forEach((c,l)=>{const u=s.get(c);u!==void 0&&vo(u.mutation,l,Nr.empty(),Ct.now()),hc(t,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return q.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:tr(i.createTime)}}(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:R_(i.bundledQuery),readTime:tr(i.readTime)}}(t)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(){this.overlays=new pt(we.comparator),this.Ir=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Cn();return q.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.ht(e,t,s)}),q.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),q.resolve()}getOverlaysForCollection(e,t,n){const i=Cn(),s=t.length+1,a=new we(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return q.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new pt((l,u)=>l-u);const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let u=s.get(l.largestBatchId);u===null&&(u=Cn(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const o=Cn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>o.set(l,u)),!(o.size()>=i)););return q.resolve(o)}ht(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new B0(t,n));let s=this.Ir.get(t);s===void 0&&(s=He(),this.Ir.set(t,s)),this.Ir.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(){this.sessionToken=Bt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(){this.Tr=new ft(Qt.Er),this.dr=new ft(Qt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Qt(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Vr(new Qt(e,t))}mr(e,t){e.forEach(n=>this.removeReference(n,t))}gr(e){const t=new we(new Je([])),n=new Qt(t,e),i=new Qt(t,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new we(new Je([])),n=new Qt(t,e),i=new Qt(t,e+1);let s=He();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new Qt(e,0),n=this.Tr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Qt{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return we.comparator(e.key,t.key)||Me(e.wr,t.wr)}static Ar(e,t){return Me(e.wr,t.wr)||we.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new ft(Qt.Er)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new M0(s,t,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Qt(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return q.resolve(a)}lookupMutationBatch(e,t){return q.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.vr(n),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Qt(t,0),i=new Qt(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ft(Me);return t.forEach(i=>{const s=new Qt(i,0),a=new Qt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),q.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;we.isDocumentKey(s)||(s=s.child(""));const a=new Qt(new we(s),0);let o=new ft(Me);return this.br.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.wr)),!0)},a),q.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ke(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return q.forEach(t.mutations,i=>{const s=new Qt(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new Qt(t,0),i=this.br.firstAfterOrEqual(n);return q.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(e){this.Mr=e,this.docs=function(){return new pt(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return q.resolve(n?n.document.mutableCopy():Tt.newInvalidDocument(t))}getEntries(e,t){let n=zr();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Tt.newInvalidDocument(i))}),q.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=zr();const a=t.path,o=new we(a.child("")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||C0(F1(u),n)<=0||(i.has(u.key)||hc(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,t,n,i){Se()}Or(e,t){return q.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new gA(this)}getSize(e){return q.resolve(this.size)}}class gA extends L_{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),q.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e){this.persistence=e,this.Nr=new Mi(t=>ds(t),uc),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.Lr=0,this.Br=new z0,this.targetCount=0,this.kr=_s.Bn()}forEachTarget(e,t){return this.Nr.forEach((n,i)=>t(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),q.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new _s(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.Kn(t),q.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return q.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),q.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return q.resolve(n)}containsKey(e,t){return q.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Pr(0),this.Kr=!1,this.Kr=!0,this.$r=new dA,this.referenceDelegate=e(this),this.Ur=new _A(this),this.indexManager=new eA,this.remoteDocumentCache=function(i){return new pA(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new C_(t),this.Gr=new fA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new hA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new mA(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){ce("MemoryPersistence","Starting transaction:",e);const i=new xA(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return q.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class xA extends P1{constructor(e){super(),this.currentSequenceNumber=e}}class xu{constructor(e){this.persistence=e,this.Jr=new z0,this.Yr=null}static Zr(e){return new xu(e)}get Xr(){if(this.Yr)return this.Yr;throw Se()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),q.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),q.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.Xr,n=>{const i=we.fromPath(n);return this.ei(e,i).next(s=>{s||t.removeEntry(i,be.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(n=>{n?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return q.or([()=>q.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e){this.serializer=e}O(e,t,n,i){const s=new lu("createOrUpgrade",t);n<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",_m,{unique:!0}),c.createObjectStore("documentMutations")}(e),ip(e),function(c){c.createObjectStore("remoteDocuments")}(e));let a=q.resolve();return n<3&&i>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),ip(e)),a=a.next(()=>function(c){const l=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:be.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(s))),n<4&&i>=4&&(n!==0&&(a=a.next(()=>function(c,l){return l.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",_m,{unique:!0});const h=l.store("mutations"),d=u.map(m=>h.put(m));return q.waitFor(d)})}(e,s))),a=a.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&i>=5&&(a=a.next(()=>this.ni(s))),n<6&&i>=6&&(a=a.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&i>=7&&(a=a.next(()=>this.ii(s))),n<8&&i>=8&&(a=a.next(()=>this.si(e,s))),n<9&&i>=9&&(a=a.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(a=a.next(()=>this.oi(s))),n<11&&i>=11&&(a=a.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&i>=12&&(a=a.next(()=>{(function(c){const l=c.createObjectStore("documentOverlays",{keyPath:J2});l.createIndex("collectionPathOverlayIndex",Z2,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",eT,{unique:!1})})(e)})),n<13&&i>=13&&(a=a.next(()=>function(c){const l=c.createObjectStore("remoteDocumentsV14",{keyPath:G2});l.createIndex("documentKeyIndex",W2),l.createIndex("collectionGroupIndex",H2)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&i>=14&&(a=a.next(()=>this.ai(e,s))),n<15&&i>=15&&(a=a.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:q2}).createIndex("sequenceNumberIndex",X2,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:Q2}).createIndex("documentKeyIndex",Y2,{unique:!1})}(e))),n<16&&i>=16&&(a=a.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),n<17&&i>=17&&(a=a.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),a}ri(e){let t=0;return e.store("remoteDocuments").J((n,i)=>{t+=Pl(i)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(i=>q.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",a).next(o=>q.forEach(o,c=>{ke(c.userId===s.userId);const l=es(this.serializer,c);return P_(e,s.userId,l).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return n.J((a,o)=>{const c=new Je(a),l=function(h){return[0,kr(h)]}(c);s.push(t.get(l).next(u=>u?q.resolve():(h=>t.put({targetId:0,path:kr(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>q.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:K2});const n=t.store("collectionParents"),i=new H0,s=a=>{if(i.add(a)){const o=a.lastSegment(),c=a.popLast();return n.put({collectionId:o,parent:kr(c)})}};return t.store("remoteDocuments").J({H:!0},(a,o)=>{const c=new Je(a);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([a,o,c],l)=>{const u=kn(o);return s(u.popLast())}))}oi(e){const t=e.store("targets");return t.J((n,i)=>{const s=uo(i),a=b_(this.serializer,s);return t.put(a)})}_i(e,t){const n=t.store("remoteDocuments"),i=[];return n.J((s,a)=>{const o=t.store("remoteDocumentsV14"),c=function(h){return h.document?new we(Je.fromString(h.document.name).popFirst(5)):h.noDocument?we.fromSegments(h.noDocument.path):h.unknownDocument?we.fromSegments(h.unknownDocument.path):Se()}(a).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(l))}).next(()=>q.waitFor(i))}ai(e,t){const n=t.store("mutations"),i=M_(this.serializer),s=new B_(xu.Zr,this.serializer.ct);return n.U().next(a=>{const o=new Map;return a.forEach(c=>{var l;let u=(l=o.get(c.userId))!==null&&l!==void 0?l:He();es(this.serializer,c).keys().forEach(h=>u=u.add(h)),o.set(c.userId,u)}),q.forEach(o,(c,l)=>{const u=new mr(l),h=gu.lt(this.serializer,u),d=s.getIndexManager(u),m=_u.lt(u,this.serializer,d,s.referenceDelegate);return new V_(i,m,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Wf(t,Pr.oe),c).next()})})}}function ip(r){r.createObjectStore("targetDocuments",{keyPath:$2}).createIndex("documentTargetsIndex",j2,{unique:!0}),r.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",z2,{unique:!0}),r.createObjectStore("targetGlobal")}const cf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class $0{constructor(e,t,n,i,s,a,o,c,l,u,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=s,this.window=a,this.document=o,this.ci=l,this.li=u,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=d=>Promise.resolve(),!$0.D())throw new fe(te.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oA(this,i),this.Ai=t+"main",this.serializer=new C_(c),this.Ri=new Ei(this.Ai,this.hi,new vA(this.serializer)),this.$r=new qT,this.Ur=new rA(this.referenceDelegate,this.serializer),this.remoteDocumentCache=M_(this.serializer),this.Gr=new KT,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&Mt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new fe(te.FAILED_PRECONDITION,cf);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Pr(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Yc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Oi(e))return ce("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ce("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return so(e).get("owner").next(t=>q.resolve(this.vi(t)))}Ci(e){return Yc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=qt(t,"clientMetadata");return n.U().next(i=>{const s=this.xi(i,18e5),a=i.filter(o=>s.indexOf(o)===-1);return q.forEach(a,o=>n.delete(o.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?q.resolve(!0):so(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new fe(te.FAILED_PRECONDITION,cf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Yc(e).U().next(n=>this.xi(n,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&ce("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Wf(e,Pr.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(n=>this.Mi(n.updateTimeMs,t)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Yc(e).U().next(t=>this.xi(t,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return _u.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new tA(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return gu.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){ce("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?nT:c===16?rT:c===15?R0:c===14?B1:c===13?V1:c===12?tT:c===11?M1:void Se()}(this.hi);let a;return this.Ri.runTransaction(e,i,s,o=>(a=new Wf(o,this.Qr?this.Qr.next():Pr.oe),t==="readwrite-primary"?this.wi(a).next(c=>!!c||this.Si(a)).next(c=>{if(!c)throw Mt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new fe(te.FAILED_PRECONDITION,D1);return n(a)}).next(c=>this.Di(a).next(()=>c)):this.Ki(a).next(()=>n(a)))).then(o=>(a.raiseOnCommittedEvent(),o))}Ki(e){return so(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new fe(te.FAILED_PRECONDITION,cf)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return so(e).put("owner",t)}static D(){return Ei.D()}bi(e){const t=so(e);return t.get("owner").next(n=>this.vi(n)?(ce("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):q.resolve())}Mi(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Mt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;f1()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const n=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return ce("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Mt("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Mt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function so(r){return qt(r,"owner")}function Yc(r){return qt(r,"clientMetadata")}function U_(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=He(),i=He();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new j0(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return f1()?8:N1(Sl())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new yA;return this.Xi(e,t,a).next(o=>{if(s.result=o,this.zi)return this.es(e,t,a,o.size)})}).next(()=>s.result)}es(e,t,n,i){return n.documentReadCount<this.ji?(Qs()<=Qe.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",Ys(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),q.resolve()):(Qs()<=Qe.DEBUG&&ce("QueryEngine","Query:",Ys(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Qs()<=Qe.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",Ys(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$r(t))):q.resolve())}Yi(e,t){if(Rm(t))return q.resolve(null);let n=$r(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Rl(t,null,"F"),n=$r(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=He(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ts(t,o);return this.ns(t,l,a,c.readTime)?this.Yi(e,Rl(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,n,i){return Rm(t)||i.isEqual(be.min())?q.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(t,s);return this.ns(t,a,n,i)?q.resolve(null):(Qs()<=Qe.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ys(t)),this.rs(e,a,t,R1(i,-1)).next(o=>o))})}ts(e,t){let n=new ft(t_(e));return t.forEach((i,s)=>{hc(e,s)&&(n=n.add(s))}),n}ns(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,n){return Qs()<=Qe.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",Ys(t)),this.Ji.getDocumentsMatchingQuery(e,t,Kr.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new pt(Me),this._s=new Mi(s=>ds(s),uc),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new V_(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function W_(r,e,t,n){return new wA(r,e,t,n)}async function H_(r,e){const t=Ie(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let c=He();for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(n,c).next(l=>({hs:l,removedBatchIds:a,addedBatchIds:o}))})})}function EA(r,e){const t=Ie(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(o,c,l,u){const h=l.batch,d=h.keys();let m=q.resolve();return d.forEach(g=>{m=m.next(()=>u.getEntry(c,g)).next(p=>{const x=l.docVersions.get(g);ke(x!==null),p.version.compareTo(x)<0&&(h.applyToRemoteDocument(p,l),p.isValidDocument()&&(p.setReadTime(l.commitVersion),u.addEntry(p)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=He();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function z_(r){const e=Ie(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function TA(r,e){const t=Ie(r),n=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const o=[];e.targetChanges.forEach((u,h)=>{const d=i.get(h);if(!d)return;o.push(t.Ur.removeMatchingKeys(s,u.removedDocuments,h).next(()=>t.Ur.addMatchingKeys(s,u.addedDocuments,h)));let m=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Bt.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,n)),i=i.insert(h,m),function(p,x,T){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,m,u)&&o.push(t.Ur.updateTargetData(s,m))});let c=zr(),l=He();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(AA(s,a,e.documentUpdates).next(u=>{c=u.Ps,l=u.Is})),!n.isEqual(be.min())){const u=t.Ur.getLastRemoteSnapshotVersion(s).next(h=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(u)}return q.waitFor(o).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.os=i,s))}function AA(r,e,t){let n=He(),i=He();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let a=zr();return t.forEach((o,c)=>{const l=s.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(be.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):ce("LocalStore","Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{Ps:a,Is:i}})}function SA(r,e){const t=Ie(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Nl(r,e){const t=Ie(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Ur.getTargetData(n,e).next(s=>s?(i=s,q.resolve(i)):t.Ur.allocateTargetId(n).next(a=>(i=new jn(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(n.targetId,n),t._s.set(e,n.targetId)),n})}async function Aa(r,e,t){const n=Ie(r),i=n.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Oi(a))throw a;ce("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function r0(r,e,t){const n=Ie(r);let i=be.min(),s=He();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,l,u){const h=Ie(c),d=h._s.get(u);return d!==void 0?q.resolve(h.os.get(d)):h.Ur.getTargetData(l,u)}(n,a,$r(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,t?i:be.min(),t?s:He())).next(o=>(K_(n,e_(e),o),{documents:o,Ts:s})))}function $_(r,e){const t=Ie(r),n=Ie(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.ot(s,e).next(a=>a?a.target:null))}function j_(r,e){const t=Ie(r),n=t.us.get(e)||be.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,R1(n,-1),Number.MAX_SAFE_INTEGER)).then(i=>(K_(t,e,i),i))}function K_(r,e,t){let n=r.us.get(e)||be.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.us.set(e,n)}function sp(r,e){return`firestore_clients_${r}_${e}`}function ap(r,e,t){let n=`firestore_mutations_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function lf(r,e){return`firestore_targets_${r}_${e}`}class Ol{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Rs(e,t,n){const i=JSON.parse(n);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new fe(i.error.code,i.error.message))),a?new Ol(e,t,i.state,s):(Mt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class yo{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Rs(e,t){const n=JSON.parse(t);let i,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(i=new fe(n.error.code,n.error.message))),s?new yo(e,n.state,i):(Mt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ll{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,s=N0();for(let a=0;i&&a<n.activeTargetIds.length;++a)i=O1(n.activeTargetIds[a]),s=s.add(n.activeTargetIds[a]);return i?new Ll(e,s):(Mt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class K0{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new K0(t.clientId,t.onlineState):(Mt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class n0{constructor(){this.activeTargetIds=N0()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uf{constructor(e,t,n,i,s){this.window=e,this.ui=t,this.persistenceKey=n,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new pt(Me),this.started=!1,this.bs=[];const a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=sp(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new n0),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const n of e){if(n===this.ps)continue;const i=this.getItem(sp(this.persistenceKey,n));if(i){const s=Ll.Rs(n,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const n=this.Ls(t);n&&this.Bs(n)}for(const n of this.bs)this.ws(n);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,n){this.qs(e,t,n),this.Qs(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(lf(this.persistenceKey,e));if(i){const s=yo.Rs(e,i);s&&(n=s.state)}}return t&&this.Ks.fs(e),this.Ns(),n}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(lf(this.persistenceKey,e))}updateQueryState(e,t,n){this.$s(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ce("SharedClientState","READ",e,t),t}setItem(e,t){ce("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){ce("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(ce("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Mt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const n=this.Gs(t.key);return this.zs(n,null)}{const n=this.js(t.key,t.newValue);if(n)return this.zs(n.clientId,n)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const n=this.Hs(t.key,t.newValue);if(n)return this.Js(n)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const n=this.Ys(t.key,t.newValue);if(n)return this.Zs(n)}}else if(t.key===this.xs){if(t.newValue!==null){const n=this.Ls(t.newValue);if(n)return this.Bs(n)}}else if(t.key===this.vs){const n=function(s){let a=Pr.oe;if(s!=null)try{const o=JSON.parse(s);ke(typeof o=="number"),a=o}catch(o){Mt("SharedClientState","Failed to read sequence number from WebStorage",o)}return a}(t.newValue);n!==Pr.oe&&this.sequenceNumberHandler(n)}else if(t.key===this.Os){const n=this.Xs(t.newValue);await Promise.all(n.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,n){const i=new Ol(this.currentUser,e,t,n),s=ap(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const t=ap(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,n){const i=lf(this.persistenceKey,e),s=new yo(e,t,n);this.setItem(i,s.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const n=this.Gs(e);return Ll.Rs(n,t)}Hs(e,t){const n=this.Fs.exec(e),i=Number(n[1]),s=n[2]!==void 0?n[2]:null;return Ol.Rs(new mr(s),i,t)}Ys(e,t){const n=this.Ms.exec(e),i=Number(n[1]);return yo.Rs(i,t)}Ls(e){return K0.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);ce("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const n=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(n),a=[],o=[];return s.forEach(c=>{i.has(c)||a.push(c)}),i.forEach(c=>{s.has(c)||o.push(c)}),this.syncEngine.io(a,o).then(()=>{this.Ss=n})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=N0();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class q_{constructor(){this.so=new n0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new n0,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ce("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ce("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jc=null;function ff(){return Jc===null?Jc=function(){return 268435456+Math.round(2147483648*Math.random())}():Jc++,"0x"+Jc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hr="WebChannelConnection";class bA extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,n,i,s,a){const o=ff(),c=this.xo(t,n.toUriEncodedString());ce("RestConnection",`Sending RPC '${t}' ${o}:`,c,i);const l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,a),this.No(t,c,l,i).then(u=>(ce("RestConnection",`Received RPC '${t}' ${o}: `,u),u),u=>{throw Po("RestConnection",`RPC '${t}' ${o} failed with error: `,u,"url: ",c,"request:",i),u})}Lo(t,n,i,s,a,o){return this.Mo(t,n,i,s,a)}Oo(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pa}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,n){const i=kA[t];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){const s=ff();return new Promise((a,o)=>{const c=new T1;c.setWithCredentials(!0),c.listenOnce(A1.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case dl.NO_ERROR:const u=c.getResponseJson();ce(hr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),a(u);break;case dl.TIMEOUT:ce(hr,`RPC '${e}' ${s} timed out`),o(new fe(te.DEADLINE_EXCEEDED,"Request time out"));break;case dl.HTTP_ERROR:const h=c.getStatus();if(ce(hr,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);const m=d==null?void 0:d.error;if(m&&m.status&&m.message){const g=function(x){const T=x.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(T)>=0?T:te.UNKNOWN}(m.status);o(new fe(g,m.message))}else o(new fe(te.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new fe(te.UNAVAILABLE,"Connection failed."));break;default:Se()}}finally{ce(hr,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);ce(hr,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,n,15)})}Bo(e,t,n){const i=ff(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=k1(),o=I1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const u=s.join("");ce(hr,`Creating RPC '${e}' stream ${i}: ${u}`,c);const h=a.createWebChannel(u,c);let d=!1,m=!1;const g=new CA({Io:x=>{m?ce(hr,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(d||(ce(hr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),ce(hr,`RPC '${e}' stream ${i} sending:`,x),h.send(x))},To:()=>h.close()}),p=(x,T,C)=>{x.listen(T,w=>{try{C(w)}catch(F){setTimeout(()=>{throw F},0)}})};return p(h,oo.EventType.OPEN,()=>{m||(ce(hr,`RPC '${e}' stream ${i} transport opened.`),g.yo())}),p(h,oo.EventType.CLOSE,()=>{m||(m=!0,ce(hr,`RPC '${e}' stream ${i} transport closed`),g.So())}),p(h,oo.EventType.ERROR,x=>{m||(m=!0,Po(hr,`RPC '${e}' stream ${i} transport errored:`,x),g.So(new fe(te.UNAVAILABLE,"The operation could not be completed")))}),p(h,oo.EventType.MESSAGE,x=>{var T;if(!m){const C=x.data[0];ke(!!C);const w=C,F=w.error||((T=w[0])===null||T===void 0?void 0:T.error);if(F){ce(hr,`RPC '${e}' stream ${i} received error:`,F);const L=F.status;let O=function(y){const I=Ht[y];if(I!==void 0)return m_(I)}(L),v=F.message;O===void 0&&(O=te.INTERNAL,v="Unknown error status: "+L+" with message "+F.message),m=!0,g.So(new fe(O,v)),h.close()}else ce(hr,`RPC '${e}' stream ${i} received:`,C),g.bo(C)}}),p(o,S1.STAT_EVENT,x=>{x.stat===Uf.PROXY?ce(hr,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Uf.NOPROXY&&ce(hr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(){return typeof window<"u"?window:null}function yl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(r){return new OT(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&ce("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e,t,n,i,s,a,o,c){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new q0(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===te.RESOURCE_EXHAUSTED?(Mt(t.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===t&&this.P_(n,i)},n=>{e(()=>{const i=new fe(te.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ce("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(ce("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RA extends Q_{constructor(e,t,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=BT(this.serializer,e),n=function(s){if(!("targetChange"in s))return be.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?be.min():a.readTime?tr(a.readTime):be.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Yf(this.serializer),t.addTarget=function(s,a){let o;const c=a.target;if(o=Cl(c)?{documents:E_(s,c)}:{query:T_(s,c)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=__(s,a.resumeToken);const l=Xf(s,a.expectedCount);l!==null&&(o.expectedCount=l)}else if(a.snapshotVersion.compareTo(be.min())>0){o.readTime=Ta(s,a.snapshotVersion.toTimestamp());const l=Xf(s,a.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=GT(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Yf(this.serializer),t.removeTarget=e,this.a_(t)}}class FA extends Q_{constructor(e,t,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ke(!!e.streamToken),this.lastStreamToken=e.streamToken,ke(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ke(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=UT(e.writeResults,e.commitTime),n=tr(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Yf(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Wo(this.serializer,n))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new fe(te.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Qf(t,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new fe(te.UNKNOWN,s.toString())})}Lo(e,t,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Qf(t,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new fe(te.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class PA{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Mt(t),this.D_=!1):ce("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Cs(this)&&(ce("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=Ie(c);l.L_.add(4),await gc(l),l.q_.set("Unknown"),l.L_.delete(4),await yu(l)}(this))})}),this.q_=new PA(n,i)}}async function yu(r){if(Cs(r))for(const e of r.B_)await e(!0)}async function gc(r){for(const e of r.B_)await e(!1)}function wu(r,e){const t=Ie(r);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Y0(t)?Q0(t):La(t).r_()&&X0(t,e))}function Sa(r,e){const t=Ie(r),n=La(t);t.N_.delete(e),n.r_()&&Y_(t,e),t.N_.size===0&&(n.r_()?n.o_():Cs(t)&&t.q_.set("Unknown"))}function X0(r,e){if(r.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(be.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}La(r).A_(e)}function Y_(r,e){r.Q_.xe(e),La(r).R_(e)}function Q0(r){r.Q_=new FT({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>r.N_.get(e)||null,tt:()=>r.datastore.serializer.databaseId}),La(r).start(),r.q_.v_()}function Y0(r){return Cs(r)&&!La(r).n_()&&r.N_.size>0}function Cs(r){return Ie(r).L_.size===0}function J_(r){r.Q_=void 0}async function OA(r){r.q_.set("Online")}async function LA(r){r.N_.forEach((e,t)=>{X0(r,e)})}async function MA(r,e){J_(r),Y0(r)?(r.q_.M_(e),Q0(r)):r.q_.set("Unknown")}async function VA(r,e,t){if(r.q_.set("Online"),e instanceof g_&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(r,e)}catch(n){ce("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ml(r,n)}else if(e instanceof vl?r.Q_.Ke(e):e instanceof p_?r.Q_.He(e):r.Q_.We(e),!t.isEqual(be.min()))try{const n=await z_(r.localStore);t.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.N_.get(l);u&&s.N_.set(l,u.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,l)=>{const u=s.N_.get(c);if(!u)return;s.N_.set(c,u.withResumeToken(Bt.EMPTY_BYTE_STRING,u.snapshotVersion)),Y_(s,c);const h=new jn(u.target,c,l,u.sequenceNumber);X0(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(r,t)}catch(n){ce("RemoteStore","Failed to raise snapshot:",n),await Ml(r,n)}}async function Ml(r,e,t){if(!Oi(e))throw e;r.L_.add(1),await gc(r),r.q_.set("Offline"),t||(t=()=>z_(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{ce("RemoteStore","Retrying IndexedDB access"),await t(),r.L_.delete(1),await yu(r)})}function Z_(r,e){return e().catch(t=>Ml(r,t,e))}async function Oa(r){const e=Ie(r),t=ki(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;BA(e);)try{const i=await SA(e.localStore,n);if(i===null){e.O_.length===0&&t.o_();break}n=i.batchId,UA(e,i)}catch(i){await Ml(e,i)}ex(e)&&tx(e)}function BA(r){return Cs(r)&&r.O_.length<10}function UA(r,e){r.O_.push(e);const t=ki(r);t.r_()&&t.V_&&t.m_(e.mutations)}function ex(r){return Cs(r)&&!ki(r).n_()&&r.O_.length>0}function tx(r){ki(r).start()}async function GA(r){ki(r).p_()}async function WA(r){const e=ki(r);for(const t of r.O_)e.m_(t.mutations)}async function HA(r,e,t){const n=r.O_.shift(),i=V0.from(n,e,t);await Z_(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await Oa(r)}async function zA(r,e){e&&ki(r).V_&&await async function(n,i){if(function(a){return d_(a)&&a!==te.ABORTED}(i.code)){const s=n.O_.shift();ki(n).s_(),await Z_(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Oa(n)}}(r,e),ex(r)&&tx(r)}async function cp(r,e){const t=Ie(r);t.asyncQueue.verifyOperationInProgress(),ce("RemoteStore","RemoteStore received new credentials");const n=Cs(t);t.L_.add(3),await gc(t),n&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await yu(t)}async function i0(r,e){const t=Ie(r);e?(t.L_.delete(2),await yu(t)):e||(t.L_.add(2),await gc(t),t.q_.set("Unknown"))}function La(r){return r.K_||(r.K_=function(t,n,i){const s=Ie(t);return s.w_(),new RA(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Eo:OA.bind(null,r),Ro:LA.bind(null,r),mo:MA.bind(null,r),d_:VA.bind(null,r)}),r.B_.push(async e=>{e?(r.K_.s_(),Y0(r)?Q0(r):r.q_.set("Unknown")):(await r.K_.stop(),J_(r))})),r.K_}function ki(r){return r.U_||(r.U_=function(t,n,i){const s=Ie(t);return s.w_(),new FA(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Eo:()=>Promise.resolve(),Ro:GA.bind(null,r),mo:zA.bind(null,r),f_:WA.bind(null,r),g_:HA.bind(null,r)}),r.B_.push(async e=>{e?(r.U_.s_(),await Oa(r)):(await r.U_.stop(),r.O_.length>0&&(ce("RemoteStore",`Stopping write stream with ${r.O_.length} pending writes`),r.O_=[]))})),r.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new _n,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const a=Date.now()+n,o=new J0(e,t,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Z0(r,e){if(Mt("AsyncQueue",`${e}: ${r}`),Oi(r))return new fe(te.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e){this.comparator=e?(t,n)=>e(t,n)||we.comparator(t.key,n.key):(t,n)=>we.comparator(t.key,n.key),this.keyedMap=co(),this.sortedSet=new pt(this.comparator)}static emptySet(e){return new oa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof oa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new oa;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(){this.W_=new pt(we.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(t,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(t):e.type===1&&n.type===2?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Se():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class Ia{constructor(e,t,n,i,s,a,o,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,s){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new Ia(e,t,oa.emptySet(t),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class jA{constructor(){this.queries=up(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,n){const i=Ie(t),s=i.queries;i.queries=up(),s.forEach((a,o)=>{for(const c of o.j_)c.onError(n)})})(this,new fe(te.ABORTED,"Firestore shutting down"))}}function up(){return new Mi(r=>Z1(r),hu)}async function eh(r,e){const t=Ie(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new $A,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=Z0(a,`Initialization of query '${Ys(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&rh(t)}async function th(r,e){const t=Ie(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function KA(r,e){const t=Ie(r);let n=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&rh(t)}function qA(r,e,t){const n=Ie(r),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(t);n.queries.delete(e)}function rh(r){r.Y_.forEach(e=>{e.next()})}var s0,fp;(fp=s0||(s0={})).ea="default",fp.Cache="cache";class nh{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Ia(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const n=t!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==s0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e){this.key=e}}class nx{constructor(e){this.key=e}}class XA{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=He(),this.mutatedKeys=He(),this.Aa=t_(e),this.Ra=new oa(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new lp,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const d=i.get(u),m=hc(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),p=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;d&&m?d.data.isEqual(m.data)?g!==p&&(n.track({type:3,doc:m}),x=!0):this.ga(d,m)||(n.track({type:2,doc:m}),x=!0,(c&&this.Aa(m,c)>0||l&&this.Aa(m,l)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),x=!0):d&&!m&&(n.track({type:1,doc:d}),x=!0,(c||l)&&(o=!0)),x&&(m?(a=a.add(m),s=p?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,h)=>function(m,g){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se()}};return p(m)-p(g)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,a.length!==0||l?{snapshot:new Ia(this.query,e.Ra,s,a,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new lp,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=He(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const t=[];return e.forEach(n=>{this.da.has(n)||t.push(new nx(n))}),this.da.forEach(n=>{e.has(n)||t.push(new rx(n))}),t}ba(e){this.Ta=e.Ts,this.da=He();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ia.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class QA{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class YA{constructor(e){this.key=e,this.va=!1}}class JA{constructor(e,t,n,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Mi(o=>Z1(o),hu),this.Ma=new Map,this.xa=new Set,this.Oa=new pt(we.comparator),this.Na=new Map,this.La=new z0,this.Ba={},this.ka=new Map,this.qa=_s.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function ZA(r,e,t=!0){const n=Eu(r);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await ix(n,e,t,!0),i}async function eS(r,e){const t=Eu(r);await ix(t,e,!0,!1)}async function ix(r,e,t,n){const i=await Nl(r.localStore,$r(e)),s=i.targetId,a=r.sharedClientState.addLocalQueryTarget(s,t);let o;return n&&(o=await ih(r,e,s,a==="current",i.resumeToken)),r.isPrimaryClient&&t&&wu(r.remoteStore,i),o}async function ih(r,e,t,n,i){r.Ka=(h,d,m)=>async function(p,x,T,C){let w=x.view.ma(T);w.ns&&(w=await r0(p.localStore,x.query,!1).then(({documents:v})=>x.view.ma(v,w)));const F=C&&C.targetChanges.get(x.targetId),L=C&&C.targetMismatches.get(x.targetId)!=null,O=x.view.applyChanges(w,p.isPrimaryClient,F,L);return a0(p,x.targetId,O.wa),O.snapshot}(r,h,d,m);const s=await r0(r.localStore,e,!0),a=new XA(e,s.Ts),o=a.ma(s.documents),c=pc.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),l=a.applyChanges(o,r.isPrimaryClient,c);a0(r,t,l.wa);const u=new QA(e,t,a);return r.Fa.set(e,u),r.Ma.has(t)?r.Ma.get(t).push(e):r.Ma.set(t,[e]),l.snapshot}async function tS(r,e,t){const n=Ie(r),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!hu(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Aa(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Sa(n.remoteStore,i.targetId),ka(n,i.targetId)}).catch(Ni)):(ka(n,i.targetId),await Aa(n.localStore,i.targetId,!0))}async function rS(r,e){const t=Ie(r),n=t.Fa.get(e),i=t.Ma.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Sa(t.remoteStore,n.targetId))}async function nS(r,e,t){const n=ch(r);try{const i=await function(a,o){const c=Ie(a),l=Ct.now(),u=o.reduce((m,g)=>m.add(g.key),He());let h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=zr(),p=He();return c.cs.getEntries(m,u).next(x=>{g=x,g.forEach((T,C)=>{C.isValidDocument()||(p=p.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(x=>{h=x;const T=[];for(const C of o){const w=kT(C,h.get(C.key).overlayedDocument);w!=null&&T.push(new ei(C.key,w,z1(w.value.mapValue),Vt.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,T,o)}).next(x=>{d=x;const T=x.applyToLocalDocumentSet(h,p);return c.documentOverlayCache.saveOverlays(m,x.batchId,T)})}).then(()=>({batchId:d.batchId,changes:n_(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let l=a.Ba[a.currentUser.toKey()];l||(l=new pt(Me)),l=l.insert(o,c),a.Ba[a.currentUser.toKey()]=l}(n,i.batchId,t),await Vi(n,i.changes),await Oa(n.remoteStore)}catch(i){const s=Z0(i,"Failed to persist write");t.reject(s)}}async function sx(r,e){const t=Ie(r);try{const n=await TA(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.Na.get(s);a&&(ke(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ke(a.va):i.removedDocuments.size>0&&(ke(a.va),a.va=!1))}),await Vi(t,n,e)}catch(n){await Ni(n)}}function hp(r,e,t){const n=Ie(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const c=Ie(a);c.onlineState=o;let l=!1;c.queries.forEach((u,h)=>{for(const d of h.j_)d.Z_(o)&&(l=!0)}),l&&rh(c)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function iS(r,e,t){const n=Ie(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new pt(we.comparator);a=a.insert(s,Tt.newNoDocument(s,be.min()));const o=He().add(s),c=new mc(be.min(),new Map,new pt(Me),a,o);await sx(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),oh(n)}else await Aa(n.localStore,e,!1).then(()=>ka(n,e,t)).catch(Ni)}async function sS(r,e){const t=Ie(r),n=e.batch.batchId;try{const i=await EA(t.localStore,e);ah(t,n,null),sh(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Vi(t,i)}catch(i){await Ni(i)}}async function aS(r,e,t){const n=Ie(r);try{const i=await function(a,o){const c=Ie(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,o).next(h=>(ke(h!==null),u=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(n.localStore,e);ah(n,e,t),sh(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Vi(n,i)}catch(i){await Ni(i)}}function sh(r,e){(r.ka.get(e)||[]).forEach(t=>{t.resolve()}),r.ka.delete(e)}function ah(r,e,t){const n=Ie(r);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function ka(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Ma.get(e))r.Fa.delete(n),t&&r.Ca.$a(n,t);r.Ma.delete(e),r.isPrimaryClient&&r.La.gr(e).forEach(n=>{r.La.containsKey(n)||ax(r,n)})}function ax(r,e){r.xa.delete(e.path.canonicalString());const t=r.Oa.get(e);t!==null&&(Sa(r.remoteStore,t),r.Oa=r.Oa.remove(e),r.Na.delete(t),oh(r))}function a0(r,e,t){for(const n of t)n instanceof rx?(r.La.addReference(n.key,e),oS(r,n)):n instanceof nx?(ce("SyncEngine","Document no longer in limbo: "+n.key),r.La.removeReference(n.key,e),r.La.containsKey(n.key)||ax(r,n.key)):Se()}function oS(r,e){const t=e.key,n=t.path.canonicalString();r.Oa.get(t)||r.xa.has(n)||(ce("SyncEngine","New document in limbo: "+t),r.xa.add(n),oh(r))}function oh(r){for(;r.xa.size>0&&r.Oa.size<r.maxConcurrentLimboResolutions;){const e=r.xa.values().next().value;r.xa.delete(e);const t=new we(Je.fromString(e)),n=r.qa.next();r.Na.set(n,new YA(t)),r.Oa=r.Oa.insert(t,n),wu(r.remoteStore,new jn($r(fc(t.path)),n,"TargetPurposeLimboResolution",Pr.oe))}}async function Vi(r,e,t){const n=Ie(r),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,c)=>{a.push(n.Ka(c,e,t).then(l=>{var u;if((l||t)&&n.isPrimaryClient){const h=l?!l.fromCache:(u=t==null?void 0:t.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){i.push(l);const h=j0.Wi(c.targetId,l);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(c,l){const u=Ie(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>q.forEach(l,d=>q.forEach(d.$i,m=>u.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>q.forEach(d.Ui,m=>u.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!Oi(h))throw h;ce("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const d=h.targetId;if(!h.fromCache){const m=u.os.get(d),g=m.snapshotVersion,p=m.withLastLimboFreeSnapshotVersion(g);u.os=u.os.insert(d,p)}}}(n.localStore,s))}async function cS(r,e){const t=Ie(r);if(!t.currentUser.isEqual(e)){ce("SyncEngine","User change. New user:",e.toKey());const n=await H_(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(c=>{c.reject(new fe(te.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Vi(t,n.hs)}}function lS(r,e){const t=Ie(r),n=t.Na.get(e);if(n&&n.va)return He().add(n.key);{let i=He();const s=t.Ma.get(e);if(!s)return i;for(const a of s){const o=t.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}async function uS(r,e){const t=Ie(r),n=await r0(t.localStore,e.query,!0),i=e.view.ba(n);return t.isPrimaryClient&&a0(t,e.targetId,i.wa),i}async function fS(r,e){const t=Ie(r);return j_(t.localStore,e).then(n=>Vi(t,n))}async function hS(r,e,t,n){const i=Ie(r),s=await function(o,c){const l=Ie(o),u=Ie(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.Mn(h,c).next(d=>d?l.localDocuments.getDocuments(h,d):q.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await Oa(i.remoteStore):t==="acknowledged"||t==="rejected"?(ah(i,e,n||null),sh(i,e),function(o,c){Ie(Ie(o).mutationQueue).On(c)}(i.localStore,e)):Se(),await Vi(i,s)):ce("SyncEngine","Cannot apply mutation batch with id: "+e)}async function dS(r,e){const t=Ie(r);if(Eu(t),ch(t),e===!0&&t.Qa!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await dp(t,n.toArray());t.Qa=!0,await i0(t.remoteStore,!0);for(const s of i)wu(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){const n=[];let i=Promise.resolve();t.Ma.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?n.push(a):i=i.then(()=>(ka(t,a),Aa(t.localStore,a,!0))),Sa(t.remoteStore,a)}),await i,await dp(t,n),function(a){const o=Ie(a);o.Na.forEach((c,l)=>{Sa(o.remoteStore,l)}),o.La.pr(),o.Na=new Map,o.Oa=new pt(we.comparator)}(t),t.Qa=!1,await i0(t.remoteStore,!1)}}async function dp(r,e,t){const n=Ie(r),i=[],s=[];for(const a of e){let o;const c=n.Ma.get(a);if(c&&c.length!==0){o=await Nl(n.localStore,$r(c[0]));for(const l of c){const u=n.Fa.get(l),h=await uS(n,u);h.snapshot&&s.push(h.snapshot)}}else{const l=await $_(n.localStore,a);o=await Nl(n.localStore,l),await ih(n,ox(l),a,!1,o.resumeToken)}i.push(o)}return n.Ca.d_(s),i}function ox(r){return J1(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function mS(r){return function(t){return Ie(Ie(t).persistence).Qi()}(Ie(r).localStore)}async function pS(r,e,t,n){const i=Ie(r);if(i.Qa)return void ce("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=await j_(i.localStore,e_(s[0])),o=mc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Bt.EMPTY_BYTE_STRING);await Vi(i,a,o);break}case"rejected":await Aa(i.localStore,e,!0),ka(i,e,n);break;default:Se()}}async function gS(r,e,t){const n=Eu(r);if(n.Qa){for(const i of e){if(n.Ma.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){ce("SyncEngine","Adding an already active target "+i);continue}const s=await $_(n.localStore,i),a=await Nl(n.localStore,s);await ih(n,ox(s),a.targetId,!1,a.resumeToken),wu(n.remoteStore,a)}for(const i of t)n.Ma.has(i)&&await Aa(n.localStore,i,!1).then(()=>{Sa(n.remoteStore,i),ka(n,i)}).catch(Ni)}}function Eu(r){const e=Ie(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=sx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lS.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=iS.bind(null,e),e.Ca.d_=KA.bind(null,e.eventManager),e.Ca.$a=qA.bind(null,e.eventManager),e}function ch(r){const e=Ie(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sS.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aS.bind(null,e),e}class Ho{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return W_(this.persistence,new G_,e.initialUser,this.serializer)}Ga(e){return new B_(xu.Zr,this.serializer)}Wa(e){return new q_}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ho.provider={build:()=>new Ho};class cx extends Ho{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await ch(this.Ja.syncEngine),await Oa(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return W_(this.persistence,new G_,e.initialUser,this.serializer)}ja(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new iA(n,e.asyncQueue,t)}Ha(e,t){const n=new V2(t,this.persistence);return new M2(e.asyncQueue,n)}Ga(e){const t=U_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Dr.withCacheSize(this.cacheSizeBytes):Dr.DEFAULT;return new $0(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,X_(),yl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new q_}}class _S extends cx{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof uf&&(this.sharedClientState.syncEngine={no:hS.bind(null,t),ro:pS.bind(null,t),io:gS.bind(null,t),Qi:mS.bind(null,t),eo:fS.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async n=>{await dS(this.Ja.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}Wa(e){const t=X_();if(!uf.D(t))throw new fe(te.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=U_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new uf(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class zo{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>hp(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=cS.bind(null,this.syncEngine),await i0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new jA}()}createDatastore(e){const t=vu(e.databaseInfo.databaseId),n=function(s){return new bA(s)}(e.databaseInfo);return function(s,a,o,c){return new DA(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,a,o){return new NA(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>hp(this.syncEngine,t,0),function(){return op.D()?new op:new IA}())}createSyncEngine(e,t){return function(i,s,a,o,c,l,u){const h=new JA(i,s,a,o,c,l);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Ie(i);ce("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await gc(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}zo.provider={build:()=>new zo};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Mt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new fe(te.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const a=Ie(i),o={documents:s.map(h=>Go(a.serializer,h))},c=await a.Lo("BatchGetDocuments",a.serializer.databaseId,Je.emptyPath(),o,s.length),l=new Map;c.forEach(h=>{const d=VT(a.serializer,h);l.set(d.key.toString(),d)});const u=[];return s.forEach(h=>{const d=l.get(h.toString());ke(!!d),u.push(d)}),u}(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new dc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{const i=we.fromPath(n);this.mutations.push(new L0(i,this.precondition(i)))}),await async function(n,i){const s=Ie(n),a={writes:i.map(o=>Wo(s.serializer,o))};await s.Mo("Commit",s.serializer.databaseId,Je.emptyPath(),a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Se();t=be.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new fe(te.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(be.min())?Vt.exists(!1):Vt.updateTime(t):Vt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(be.min()))throw new fe(te.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Vt.updateTime(t)}return Vt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(e,t,n,i,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=s,this._u=n.maxAttempts,this.t_=new q0(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new xS(this.datastore),t=this.cu(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(i=>{this.lu(i)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const t=this.updateFunction(e);return!lc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!d_(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=mr.UNAUTHENTICATED,this.clientId=C1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{ce("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(ce("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _n;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Z0(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function hf(r,e){r.asyncQueue.verifyOperationInProgress(),ce("FirestoreClient","Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await H_(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function mp(r,e){r.asyncQueue.verifyOperationInProgress();const t=await wS(r);ce("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>cp(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>cp(e.remoteStore,i)),r._onlineComponents=e}async function wS(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){ce("FirestoreClient","Using user provided OfflineComponentProvider");try{await hf(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===te.FAILED_PRECONDITION||i.code===te.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Po("Error using user provided cache. Falling back to memory cache: "+t),await hf(r,new Ho)}}else ce("FirestoreClient","Using default OfflineComponentProvider"),await hf(r,new Ho);return r._offlineComponents}async function uh(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(ce("FirestoreClient","Using user provided OnlineComponentProvider"),await mp(r,r._uninitializedComponentsProvider._online)):(ce("FirestoreClient","Using default OnlineComponentProvider"),await mp(r,new zo))),r._onlineComponents}function ES(r){return uh(r).then(e=>e.syncEngine)}function TS(r){return uh(r).then(e=>e.datastore)}async function Vl(r){const e=await uh(r),t=e.eventManager;return t.onListen=ZA.bind(null,e.syncEngine),t.onUnlisten=tS.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=eS.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=rS.bind(null,e.syncEngine),t}function AS(r,e,t={}){const n=new _n;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,l){const u=new lh({next:d=>{u.Za(),a.enqueueAndForget(()=>th(s,h));const m=d.docs.has(o);!m&&d.fromCache?l.reject(new fe(te.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&c&&c.source==="server"?l.reject(new fe(te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new nh(fc(o.path),u,{includeMetadataChanges:!0,_a:!0});return eh(s,h)}(await Vl(r),r.asyncQueue,e,t,n)),n.promise}function SS(r,e,t={}){const n=new _n;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,l){const u=new lh({next:d=>{u.Za(),a.enqueueAndForget(()=>th(s,h)),d.fromCache&&c.source==="server"?l.reject(new fe(te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new nh(o,u,{includeMetadataChanges:!0,_a:!0});return eh(s,h)}(await Vl(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lx(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pp=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(r,e,t){if(!t)throw new fe(te.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function IS(r,e,t,n){if(e===!0&&n===!0)throw new fe(te.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function gp(r){if(!we.isDocumentKey(r))throw new fe(te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function _p(r){if(we.isDocumentKey(r))throw new fe(te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Tu(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Se()}function xn(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new fe(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Tu(r);throw new fe(te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function kS(r,e){if(e<=0)throw new fe(te.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new fe(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new fe(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lx((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new fe(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new fe(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new fe(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fh{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xp({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xp(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new k2;switch(n.type){case"firstParty":return new R2(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new fe(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=pp.get(t);n&&(ce("ComponentProvider","Removing Datastore"),pp.delete(t),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new wn(this.firestore,e,this._query)}}class vr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ti(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vr(this.firestore,e,this._key)}}class Ti extends wn{constructor(e,t,n){super(e,t,fc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vr(this.firestore,null,new we(e))}withConverter(e){return new Ti(this.firestore,e,this._path)}}function Or(r,e,...t){if(r=Mr(r),ux("collection","path",e),r instanceof fh){const n=Je.fromString(e,...t);return _p(n),new Ti(r,null,n)}{if(!(r instanceof vr||r instanceof Ti))throw new fe(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Je.fromString(e,...t));return _p(n),new Ti(r.firestore,null,n)}}function Cr(r,e,...t){if(r=Mr(r),arguments.length===1&&(e=C1.newId()),ux("doc","path",e),r instanceof fh){const n=Je.fromString(e,...t);return gp(n),new vr(r,null,new we(n))}{if(!(r instanceof vr||r instanceof Ti))throw new fe(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Je.fromString(e,...t));return gp(n),new vr(r.firestore,r instanceof Ti?r.converter:null,new we(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new q0(this,"async_queue_retry"),this.Vu=()=>{const n=yl();n&&ce("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const t=yl();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=yl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new _n;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Oi(e))throw e;ce("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Mt("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=J0.createAndSchedule(this,e,t,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Se()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function yp(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class Ci extends fh{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new vp,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vp(e),this._firestoreClient=void 0,await e}}}function CS(r,e,t){t||(t="(default)");const n=_1(r,"firestore");if(n.isInitialized(t)){const i=n.getImmediate({identifier:t}),s=n.getOptions(t);if(Ro(s,e))return i;throw new fe(te.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new fe(te.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new fe(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return n.initialize({options:e,instanceIdentifier:t})}function Ma(r){if(r._terminated)throw new fe(te.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||bS(r),r._firestoreClient}function bS(r){var e,t,n;const i=r._freezeSettings(),s=function(o,c,l,u){return new sT(o,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,lx(u.experimentalLongPollingOptions),u.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new yS(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xs(Bt.fromBase64String(e))}catch(t){throw new fe(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new xs(Bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new It(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=/^__.*__$/;class FS{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new ei(e,this.data,this.fieldMask,t,this.fieldTransforms):new Na(e,this.data,t,this.fieldTransforms)}}class fx{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ei(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hx(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se()}}class Au{constructor(e,t,n,i,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Au(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Bl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(hx(this.Cu)&&RS.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class DS{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||vu(e)}Qu(e,t,n,i=!1){return new Au({Cu:e,methodName:t,qu:n,path:It.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xc(r){const e=r._freezeSettings(),t=vu(r._databaseId);return new DS(r._databaseId,!!e.ignoreUndefinedProperties,t)}function mh(r,e,t,n,i,s={}){const a=r.Qu(s.merge||s.mergeFields?2:0,e,t,i);xh("Data must be an object, but it was:",a,n);const o=gx(n,a);let c,l;if(s.merge)c=new Nr(a.fieldMask),l=a.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=o0(e,h,t);if(!a.contains(d))throw new fe(te.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);xx(u,d)||u.push(d)}c=new Nr(u),l=a.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=a.fieldTransforms;return new FS(new cr(o),c,l)}class Su extends Va{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Su}}function PS(r,e,t){return new Au({Cu:3,qu:e.settings.qu,methodName:r._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ph extends Va{_toFieldTransform(e){return new mu(e.path,new ya)}isEqual(e){return e instanceof ph}}class gh extends Va{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=PS(this,e,!0),n=this.Ku.map(s=>Ba(s,t)),i=new ms(n);return new mu(e.path,i)}isEqual(e){return e instanceof gh&&Ro(this.Ku,e.Ku)}}class _h extends Va{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Ea(e.serializer,a_(e.serializer,this.$u));return new mu(e.path,t)}isEqual(e){return e instanceof _h&&this.$u===e.$u}}function dx(r,e,t,n){const i=r.Qu(1,e,t);xh("Data must be an object, but it was:",i,n);const s=[],a=cr.empty();ks(n,(c,l)=>{const u=vh(e,c,t);l=Mr(l);const h=i.Nu(u);if(l instanceof Su)s.push(u);else{const d=Ba(l,h);d!=null&&(s.push(u),a.set(u,d))}});const o=new Nr(s);return new fx(a,o,i.fieldTransforms)}function mx(r,e,t,n,i,s){const a=r.Qu(1,e,t),o=[o0(e,n,t)],c=[i];if(s.length%2!=0)throw new fe(te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(o0(e,s[d])),c.push(s[d+1]);const l=[],u=cr.empty();for(let d=o.length-1;d>=0;--d)if(!xx(l,o[d])){const m=o[d];let g=c[d];g=Mr(g);const p=a.Nu(m);if(g instanceof Su)l.push(m);else{const x=Ba(g,p);x!=null&&(l.push(m),u.set(m,x))}}const h=new Nr(l);return new fx(u,h,a.fieldTransforms)}function px(r,e,t,n=!1){return Ba(t,r.Qu(n?4:3,e))}function Ba(r,e){if(_x(r=Mr(r)))return xh("Unsupported field value:",e,r),gx(r,e);if(r instanceof Va)return function(n,i){if(!hx(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let c=Ba(o,i.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=Mr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return a_(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Ct.fromDate(n);return{timestampValue:Ta(i.serializer,s)}}if(n instanceof Ct){const s=new Ct(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ta(i.serializer,s)}}if(n instanceof hh)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof xs)return{bytesValue:__(i.serializer,n._byteString)};if(n instanceof vr){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:G0(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof dh)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw o.Bu("VectorValues must only contain numeric values.");return O0(o.serializer,c)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Tu(n)}`)}(r,e)}function gx(r,e){const t={};return U1(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ks(r,(n,i)=>{const s=Ba(i,e.Mu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function _x(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Ct||r instanceof hh||r instanceof xs||r instanceof vr||r instanceof Va||r instanceof dh)}function xh(r,e,t){if(!_x(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=Tu(t);throw n==="an object"?e.Bu(r+" a custom object"):e.Bu(r+" "+n)}}function o0(r,e,t){if((e=Mr(e))instanceof _c)return e._internalPath;if(typeof e=="string")return vh(r,e);throw Bl("Field path arguments must be of type string or ",r,!1,void 0,t)}const NS=new RegExp("[~\\*/\\[\\]]");function vh(r,e,t){if(e.search(NS)>=0)throw Bl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new _c(...e.split("."))._internalPath}catch{throw Bl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Bl(r,e,t,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new fe(te.INVALID_ARGUMENT,o+r+c)}function xx(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new vr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new OS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(yh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class OS extends $o{data(){return super.data()}}function yh(r,e){return typeof e=="string"?vh(r,e):e instanceof _c?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new fe(te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wh{}class vc extends wh{}function ln(r,e,...t){let n=[];e instanceof wh&&n.push(e),n=n.concat(t),function(s){const a=s.filter(c=>c instanceof Th).length,o=s.filter(c=>c instanceof Eh).length;if(a>1||a>0&&o>0)throw new fe(te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Eh extends vc{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Eh(e,t,n)}_apply(e){const t=this._parse(e);return wx(e._query,t),new wn(e.firestore,e.converter,qf(e._query,t))}_parse(e){const t=xc(e.firestore);return function(s,a,o,c,l,u,h){let d;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new fe(te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Ep(h,u);const m=[];for(const g of h)m.push(wp(c,s,g));d={arrayValue:{values:m}}}else d=wp(c,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Ep(h,u),d=px(o,a,h,u==="in"||u==="not-in");return Ke.create(l,u,d)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Th extends wh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Th(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:ct.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const c of o)wx(a,c),a=qf(a,c)}(e._query,t),new wn(e.firestore,e.converter,qf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ah extends vc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ah(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new fe(te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new fe(te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Uo(s,a)}(e._query,this._field,this._direction);return new wn(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new Li(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function un(r,e="asc"){const t=e,n=yh("orderBy",r);return Ah._create(n,t)}class Sh extends vc{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Sh(e,t,n)}_apply(e){return new wn(e.firestore,e.converter,Rl(e._query,this._limit,this._limitType))}}function fn(r){return kS("limit",r),Sh._create("limit",r,"F")}class Iu extends vc{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Iu(e,t,n)}_apply(e){const t=yx(e,this.type,this._docOrFields,this._inclusive);return new wn(e.firestore,e.converter,function(i,s){return new Li(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function Ul(...r){return Iu._create("startAt",r,!0)}function ku(...r){return Iu._create("startAfter",r,!1)}class Ih extends vc{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Ih(e,t,n)}_apply(e){const t=yx(e,this.type,this._docOrFields,this._inclusive);return new wn(e.firestore,e.converter,function(i,s){return new Li(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function Gl(...r){return Ih._create("endAt",r,!0)}function yx(r,e,t,n){if(t[0]=Mr(t[0]),t[0]instanceof $o)return function(s,a,o,c,l){if(!c)throw new fe(te.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const h of aa(s))if(h.field.isKeyField())u.push(hs(a,c.key));else{const d=c.data.field(h.field);if(uu(d))throw new fe(te.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){const m=h.field.canonicalString();throw new fe(te.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}u.push(d)}return new Ii(u,l)}(r._query,r.firestore._databaseId,e,t[0]._document,n);{const i=xc(r.firestore);return function(a,o,c,l,u,h){const d=a.explicitOrderBy;if(u.length>d.length)throw new fe(te.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let g=0;g<u.length;g++){const p=u[g];if(d[g].field.isKeyField()){if(typeof p!="string")throw new fe(te.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof p}`);if(!P0(a)&&p.indexOf("/")!==-1)throw new fe(te.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${p}' contains a slash.`);const x=a.path.child(Je.fromString(p));if(!we.isDocumentKey(x))throw new fe(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);const T=new we(x);m.push(hs(o,T))}else{const x=px(c,l,p);m.push(x)}}return new Ii(m,h)}(r._query,r.firestore._databaseId,i,e,t,n)}}function wp(r,e,t){if(typeof(t=Mr(t))=="string"){if(t==="")throw new fe(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!P0(e)&&t.indexOf("/")!==-1)throw new fe(te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Je.fromString(t));if(!we.isDocumentKey(n))throw new fe(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return hs(r,new we(n))}if(t instanceof vr)return hs(r,t._key);throw new fe(te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Tu(t)}.`)}function Ep(r,e){if(!Array.isArray(r)||r.length===0)throw new fe(te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wx(r,e){const t=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new fe(te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Ex{convertValue(e,t="none"){switch(fs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ai(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Se()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ks(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Et(a.doubleValue));return new dh(s)}convertGeoPoint(e){return new hh(Et(e.latitude),Et(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=F0(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Mo(e));default:return null}}convertTimestamp(e){const t=Jn(e);return new Ct(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Je.fromString(e);ke(k_(n));const i=new us(n.get(1),n.get(3)),s=new we(n.popFirst(5));return i.isEqual(t)||Mt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class LS extends Ex{constructor(e){super(),this.firestore=e}convertBytes(e){return new xs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vr(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ch extends $o{constructor(e,t,n,i,s,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(yh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class wl extends Ch{data(e={}){return super.data(e)}}class Tx{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ra(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new wl(this._firestore,this._userDataWriter,n.key,n,new ra(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const c=new wl(i._firestore,i._userDataWriter,o.doc.key,o.doc,new ra(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const c=new wl(i._firestore,i._userDataWriter,o.doc.key,o.doc,new ra(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return o.type!==0&&(l=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:MS(o.type),doc:c,oldIndex:l,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function MS(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(r){r=xn(r,vr);const e=xn(r.firestore,Ci);return AS(Ma(e),r._key).then(t=>Ix(e,r,t))}class Cu extends Ex{constructor(e){super(),this.firestore=e}convertBytes(e){return new xs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vr(this.firestore,null,t)}}function Zn(r){r=xn(r,wn);const e=xn(r.firestore,Ci),t=Ma(e),n=new Cu(e);return vx(r._query),SS(t,r._query).then(i=>new Tx(e,n,r,i))}function yc(r,e,t){r=xn(r,vr);const n=xn(r.firestore,Ci),i=kh(r.converter,e,t);return Sx(n,[mh(xc(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,Vt.none())])}function Ax(r,...e){var t,n,i;r=Mr(r);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||yp(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(yp(e[a])){const h=e[a];e[a]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,u;if(r instanceof vr)l=xn(r.firestore,Ci),u=fc(r._key.path),c={next:h=>{e[a]&&e[a](Ix(l,r,h))},error:e[a+1],complete:e[a+2]};else{const h=xn(r,wn);l=xn(h.firestore,Ci),u=h._query;const d=new Cu(l);c={next:m=>{e[a]&&e[a](new Tx(l,d,h,m))},error:e[a+1],complete:e[a+2]},vx(r._query)}return function(d,m,g,p){const x=new lh(p),T=new nh(m,x,g);return d.asyncQueue.enqueueAndForget(async()=>eh(await Vl(d),T)),()=>{x.Za(),d.asyncQueue.enqueueAndForget(async()=>th(await Vl(d),T))}}(Ma(l),u,o,c)}function Sx(r,e){return function(n,i){const s=new _n;return n.asyncQueue.enqueueAndForget(async()=>nS(await ES(n),i,s)),s.promise}(Ma(r),e)}function Ix(r,e,t){const n=t.docs.get(e._key),i=new Cu(r);return new Ch(r,i,e._key,n,new ra(t.hasPendingWrites,t.fromCache),e.converter)}class VS{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=WS(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function BS(r){return new VS(r)}class US{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=zo.provider,this._offlineComponentProvider={build:t=>new cx(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class GS{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=zo.provider,this._offlineComponentProvider={build:t=>new _S(t,e==null?void 0:e.cacheSizeBytes)}}}function WS(r){return new US(void 0)}function HS(){return new GS}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=xc(e)}set(e,t,n){this._verifyNotCommitted();const i=hi(e,this._firestore),s=kh(i.converter,t,n),a=mh(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(a.toMutation(i._key,Vt.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=hi(e,this._firestore);let a;return a=typeof(t=Mr(t))=="string"||t instanceof _c?mx(this._dataReader,"WriteBatch.update",s._key,t,n,i):dx(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Vt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=hi(e,this._firestore);return this._mutations=this._mutations.concat(new dc(t._key,Vt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new fe(te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function hi(r,e){if((r=Mr(r)).firestore!==e)throw new fe(te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS extends class{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=xc(t)}get(t){const n=hi(t,this._firestore),i=new LS(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return Se();const a=s[0];if(a.isFoundDocument())return new $o(this._firestore,i,a.key,a,n.converter);if(a.isNoDocument())return new $o(this._firestore,i,n._key,null,n.converter);throw Se()})}set(t,n,i){const s=hi(t,this._firestore),a=kh(s.converter,n,i),o=mh(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,o),this}update(t,n,i,...s){const a=hi(t,this._firestore);let o;return o=typeof(n=Mr(n))=="string"||n instanceof _c?mx(this._dataReader,"Transaction.update",a._key,n,i,s):dx(this._dataReader,"Transaction.update",a._key,n),this._transaction.update(a._key,o),this}delete(t){const n=hi(t,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=hi(e,this._firestore),n=new Cu(this._firestore);return super.get(e).then(i=>new Ch(this._firestore,n,t._key,i._document,new ra(!1,!1),t.converter))}}function KS(r,e,t){r=xn(r,Ci);const n=Object.assign(Object.assign({},zS),t);return function(s){if(s.maxAttempts<1)throw new fe(te.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,a,o){const c=new _n;return s.asyncQueue.enqueueAndForget(async()=>{const l=await TS(s);new vS(s.asyncQueue,l,o,a,c).au()}),c.promise}(Ma(r),i=>e(new jS(r,i)),n)}function qS(){return new ph("serverTimestamp")}function XS(...r){return new gh("arrayUnion",r)}function kx(r){return new _h("increment",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wl(r){return Ma(r=xn(r,Ci)),new $S(r,e=>Sx(r,e))}(function(e,t=!0){(function(i){Pa=i})(x1),Fo(new ga("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Ci(new C2(n.getProvider("auth-internal")),new D2(n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new fe(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new us(l.options.projectId,u)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),wi(mm,"4.7.3",e),wi(mm,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="firebasestorage.googleapis.com",QS="storageBucket",YS=2*60*1e3,JS=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On extends Is{constructor(e,t,n=0){super(df(e),`Firebase Storage: ${t} (${df(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,On.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return df(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Dn;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Dn||(Dn={}));function df(r){return"storage/"+r}function ZS(){const r="An unknown error occurred, please check the error payload for server response.";return new On(Dn.UNKNOWN,r)}function eI(){return new On(Dn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function tI(){return new On(Dn.CANCELED,"User canceled the upload/download.")}function rI(r){return new On(Dn.INVALID_URL,"Invalid URL '"+r+"'.")}function nI(r){return new On(Dn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function Tp(r){return new On(Dn.INVALID_ARGUMENT,r)}function bx(){return new On(Dn.APP_DELETED,"The Firebase app was deleted.")}function iI(r){return new On(Dn.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=pn.makeFromUrl(e,t)}catch{return new pn(e,"")}if(n.path==="")return n;throw nI(e)}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),c={bucket:1,path:3};function l(F){F.path_=decodeURIComponent(F.path)}const u="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${u}/b/${i}/o${d}`,"i"),g={bucket:1,path:3},p=t===Cx?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",T=new RegExp(`^https?://${p}/${i}/${x}`,"i"),w=[{regex:o,indices:c,postModify:s},{regex:m,indices:g,postModify:l},{regex:T,indices:{bucket:1,path:2},postModify:l}];for(let F=0;F<w.length;F++){const L=w[F],O=L.regex.exec(e);if(O){const v=O[L.indices.bucket];let A=O[L.indices.path];A||(A=""),n=new pn(v,A),L.postModify(n);break}}if(n==null)throw rI(e);return n}}class sI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(r,e,t){let n=1,i=null,s=null,a=!1,o=0;function c(){return o===2}let l=!1;function u(...x){l||(l=!0,e.apply(null,x))}function h(x){i=setTimeout(()=>{i=null,r(m,c())},x)}function d(){s&&clearTimeout(s)}function m(x,...T){if(l){d();return}if(x){d(),u.call(null,x,...T);return}if(c()||a){d(),u.call(null,x,...T);return}n<64&&(n*=2);let w;o===1?(o=2,w=0):w=(n+Math.random())*1e3,h(w)}let g=!1;function p(x){g||(g=!0,d(),!l&&(i!==null?(x||(o=2),clearTimeout(i),h(0)):x||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,p(!0)},t),p}function oI(r){r(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(r){return r!==void 0}function Ap(r,e,t,n){if(n<e)throw Tp(`Invalid value for '${r}'. Expected ${e} or greater.`);if(n>t)throw Tp(`Invalid value for '${r}'. Expected ${t} or less.`)}function lI(r){const e=encodeURIComponent;let t="?";for(const n in r)if(r.hasOwnProperty(n)){const i=e(n)+"="+e(r[n]);t=t+i+"&"}return t=t.slice(0,-1),t}var Hl;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(Hl||(Hl={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uI(r,e){const t=r>=500&&r<600,i=[408,429].indexOf(r)!==-1,s=e.indexOf(r)!==-1;return t||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e,t,n,i,s,a,o,c,l,u,h,d=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,g)=>{this.resolve_=m,this.reject_=g,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Zc(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const c=o.loaded,l=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Hl.NO_ERROR,c=s.getStatus();if(!o||uI(c,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Hl.ABORT;n(!1,new Zc(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;n(!0,new Zc(l,s))})},t=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(o,o.getResponse());cI(c)?s(c):s()}catch(c){a(c)}else if(o!==null){const c=ZS();c.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,c)):a(c)}else if(i.canceled){const c=this.appDelete_?bx():tI();a(c)}else{const c=eI();a(c)}};this.canceled_?t(!1,new Zc(!1,null,!0)):this.backoffId_=aI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&oI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Zc{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function hI(r,e){e!==null&&e.length>0&&(r.Authorization="Firebase "+e)}function dI(r,e){r["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function mI(r,e){e&&(r["X-Firebase-GMPID"]=e)}function pI(r,e){e!==null&&(r["X-Firebase-AppCheck"]=e)}function gI(r,e,t,n,i,s,a=!0){const o=lI(r.urlParams),c=r.url+o,l=Object.assign({},r.headers);return mI(l,e),hI(l,t),dI(l,s),pI(l,n),new fI(c,r.method,l,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(r){if(r.length===0)return null;const e=r.lastIndexOf("/");return e===-1?"":r.slice(0,e)}function xI(r){const e=r.lastIndexOf("/",r.length-2);return e===-1?r:r.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,t){this._service=e,t instanceof pn?this._location=t:this._location=pn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new zl(e,t)}get root(){const e=new pn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return xI(this._location.path)}get storage(){return this._service}get parent(){const e=_I(this._location.path);if(e===null)return null;const t=new pn(this._location.bucket,e);return new zl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw iI(e)}}function Sp(r,e){const t=e==null?void 0:e[QS];return t==null?null:pn.makeFromBucketSpec(t,r)}function vI(r,e,t,n={}){r.host=`${e}:${t}`,r._protocol="http";const{mockUserToken:i}=n;i&&(r._overrideAuthToken=typeof i=="string"?i:uE(i,r.app.options.projectId))}class yI{constructor(e,t,n,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=Cx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=YS,this._maxUploadRetryTime=JS,this._requests=new Set,i!=null?this._bucket=pn.makeFromBucketSpec(i,this._host):this._bucket=Sp(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=pn.makeFromBucketSpec(this._url,e):this._bucket=Sp(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ap("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ap("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new zl(this,e)}_makeRequest(e,t,n,i,s=!0){if(this._deleted)return new sI(bx());{const a=gI(e,this._appId,n,i,t,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const Ip="@firebase/storage",kp="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx="storage";function wI(r=m2(),e){r=Mr(r);const n=_1(r,Rx).getImmediate({identifier:e}),i=cE("storage");return i&&EI(n,...i),n}function EI(r,e,t,n={}){vI(r,e,t,n)}function TI(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),i=r.getProvider("app-check-internal");return new yI(t,n,i,e,x1)}function AI(){Fo(new ga(Rx,TI,"PUBLIC").setMultipleInstances(!0)),wi(Ip,kp,""),wi(Ip,kp,"esm2017")}AI();const SI={apiKey:"AIzaSyCwHJ1VIqM9s4tfh2hn8KZxqunuYySzuwQ",authDomain:"shadow-app-b3fb3.firebaseapp.com",projectId:"shadow-app-b3fb3",storageBucket:"shadow-app-b3fb3.appspot.com",messagingSenderId:"725156533083",appId:"1:725156533083:web:e372fd32d1d0abff4f3f92"},Fx=v1(SI),et=CS(Fx,{localCache:BS({tabManager:HS()}),experimentalAutoDetectLongPolling:!0});wI(Fx);async function Ca(){try{const r=Cr(et,"globals","ridePlan"),e=await Ua(r),t=e.exists()?e.data():{};return(Array.isArray(t.plannedDates)?t.plannedDates:[]).filter(Boolean)}catch(r){return console.error("Kon plannedDates niet laden:",r),[]}}function Cp(r){try{if(!r)return"";if(typeof r=="object"&&r.seconds)return new Date(r.seconds*1e3).toISOString().slice(0,10);if(typeof r=="string"){const t=r.match(/\d{4}-\d{2}-\d{2}/);if(t)return t[0]}const e=new Date(r);return isNaN(e.getTime())?"":e.toISOString().slice(0,10)}catch{return""}}function $l(r,e){const t=r.map(Cp).filter(Boolean),n=new Set((Array.isArray(e)?e:[]).map(Cp).filter(Boolean)),i=t.map(a=>n.has(a)?"":"").join(""),s=t.map((a,o)=>`${o+1}: ${a}  ${n.has(a)?"Geregistreerd":"Niet geregistreerd"}`).join("\\n");return{stars:i,tooltip:s,planned:t}}let bp=5;async function II(){try{const r=Cr(et,"globals","starConfig"),e=await Ua(r),t=e.exists()&&typeof e.data().max=="number"?e.data().max:5;bp=Math.max(1,Math.floor(t))}catch{bp=5}}function kI(r){try{let o=function(){try{document.removeEventListener("keydown",c)}catch{}i.remove()},c=function(l){l.key==="Escape"&&o()};var e=o,t=c;const n=r.toDataURL("image/png"),i=document.createElement("div");i.id="qrFullscreenOverlay",i.style.position="fixed",i.style.inset="0",i.style.background="rgba(0,0,0,0.95)",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.zIndex="9999",i.style.cursor="zoom-out",i.setAttribute("role","dialog"),i.setAttribute("aria-label","QR-code fullscreen");const s=document.createElement("img");s.src=n,s.alt="QR-code",s.style.width="100vmin",s.style.height="100vmin",s.style.imageRendering="pixelated";const a=document.createElement("div");a.textContent="Klik of druk op Esc om te sluiten",a.style.position="fixed",a.style.bottom="24px",a.style.left="50%",a.style.transform="translateX(-50%)",a.style.color="#e5e7eb",a.style.fontSize="14px",a.style.opacity="0.8",i.addEventListener("click",o,{passive:!0}),document.addEventListener("keydown",c),i.appendChild(s),i.appendChild(a),document.body.appendChild(i)}catch(n){console.error("QR fullscreen overlay faalde:",n)}}async function CI(){try{await II()}catch{}const r=K=>document.getElementById(K),e=r("nameInput");let t=null;const n=r("suggestions"),i=r("result"),s=r("error"),a=r("rName"),o=r("rMemberNo"),c=r("rRidesCount"),l=r("qrCanvas"),u=r("rRegion");let h=document.getElementById("yearhangerRow"),d=null,m=null,g="Ja";function p(){const K=document.getElementById("nameInput");K&&(h||(h=document.createElement("div"),h.id="yearhangerRow",h.style.marginTop="8px",h.style.display="none",h.innerHTML='<div class="seg-wrap"><div class="seg-label"><strong>Wilt u een Jaarhanger?</strong></div><div class="seg-toggle" id="yearhangerToggle" role="radiogroup" aria-label="Jaarhanger"><button type="button" id="yearhangerYes" class="seg-btn" role="radio" aria-checked="false">Ja</button><button type="button" id="yearhangerNo" class="seg-btn" role="radio" aria-checked="false">Nee</button></div></div>',K.insertAdjacentElement("afterend",h),d=document.getElementById("yearhangerYes"),m=document.getElementById("yearhangerNo")))}p();function x(K){p();const Z=K==="Ja"||K===!0?"Ja":K==="Nee"||K===!1?"Nee":null;g=Z,h&&(h.style.display="block"),d&&m&&(d.classList.toggle("active",Z==="Ja"),m.classList.toggle("active",Z==="Nee"),d.setAttribute("aria-checked",String(Z==="Ja")),m.setAttribute("aria-checked",String(Z==="Nee")))}async function T(K){try{if(!C||!C.id)return;const Z=K==="Ja"||K===!0?"Ja":K==="Nee"||K===!1?"Nee":null;g=Z,await yc(Cr(et,"members",String(C.id)),{Jaarhanger:Z},{merge:!0});try{C&&await Rp(C)}catch{}}catch(Z){console.error("Jaarhanger opslaan mislukt",Z)}}document.addEventListener("click",K=>{if(!h)return;const Z=K.target;Z&&Z.id==="yearhangerYes"?(x("Ja"),T("Ja")):Z&&Z.id==="yearhangerNo"&&(x("Nee"),T("Nee"))},{passive:!0});let C=null,w=null;h&&(h.style.display="none");function F(K){const Z=(K["Tussen voegsel"]||"").trim();return[K["Voor naam"]||"",K["Voor letters"]?`(${K["Voor letters"]})`:"",Z||"",K.Naam||""].filter(Boolean).join(" ").replace(/\\s+/g," ").trim()}function L(){n&&(n.innerHTML="",n.style.display="none")}function O(K){if(n){n.innerHTML="";for(const Z of K){const ge=document.createElement("li");ge.textContent=F(Z.data)+`  ${Z.id}`,ge.addEventListener("click",async()=>{C=Z,await R(Z),L()}),n.appendChild(ge)}n.style.display=K.length?"block":"none"}}async function v(K){if(!K)return[];const Z=8;try{const ge=ln(Or(et,"members"),un("Naam"),Ul(K),Gl(K+""),fn(Z)),de=ln(Or(et,"members"),un("Voor naam"),Ul(K),Gl(K+""),fn(Z)),[ze,Y]=await Promise.all([Zn(ge),Zn(de)]),Ce=new Map;return ze.forEach(B=>{Ce.has(B.id)||Ce.set(B.id,{id:B.id,data:B.data()})}),Y.forEach(B=>{Ce.has(B.id)||Ce.set(B.id,{id:B.id,data:B.data()})}),Array.from(Ce.values()).slice(0,Z)}catch(ge){return console.error("queryByLastNamePrefix failed",ge),[]}}function A(){i&&(i.style.display="none");const K=document.getElementById("qrPrivacy");K&&(K.style.display="none")}function y(){C=null,A(),s&&(s.style.display="none");try{w&&w()}catch{}w=null,h&&(h.style.display="none"),c&&(c.textContent="",c.removeAttribute("title"),c.removeAttribute("aria-label"),c.style.letterSpacing="",c.style.fontSize=""),u&&(u.textContent="")}async function I(){y();const K=(e&&e.value?e.value:"").trim();if(K.length>=1)try{const Z=await v(K);Z&&Z.length?O(Z):L()}catch{L()}else L()}async function k(){t&&clearTimeout(t),t=setTimeout(async()=>{try{y();const K=(e&&e.value?e.value:"").trim();if(K.length<2){L();return}const Z=await v(K);if(!Z||!Z.length){s&&(s.textContent="Geen lid met uw achternaam gevonden  ga naar de inschrijfbalie voor meer informatie.",s.style.display="block"),L();return}O(Z)}catch{L(),s&&(s.textContent="Er ging iets mis tijdens het zoeken. Probeer het opnieuw of ga naar de inschrijfbalie.",s.style.display="block")}},250)}async function b(){s&&(s.style.display="none");try{const K=(e&&e.value?e.value:"").trim();if(!K){L();return}const Z=await v(K);if(!Z.length){s&&(s.textContent="Geen lid met uw achternaam gevonden  ga naar de inschrijfbalie voor meer informatie.",s.style.display="block"),L();return}O(Z)}catch{s&&(s.textContent="Er ging iets mis tijdens het zoeken. Probeer het opnieuw of ga naar de inschrijfbalie.",s.style.display="block")}}async function R(K){var B,z;const Z=K.data||{};u&&(u.textContent=Z["Regio Omschrijving"]||""),a&&(a.textContent=F(Z)),o&&(o.textContent=K.id);const ge=((B=K==null?void 0:K.data)==null?void 0:B.Jaarhanger)==="Nee"?"Nee":((z=K==null?void 0:K.data)==null?void 0:z.Jaarhanger)==="Ja"?"Ja":"";x(ge||null);const de=await Ca(),ze=Array.isArray(Z.ScanDatums)?Z.ScanDatums:[],{stars:Y,tooltip:Ce,planned:Fe}=$l(de,ze);c&&(c.textContent=Y||"",c.setAttribute("title",Y?Ce:"Geen ingeplande datums"),c.setAttribute("aria-label",Y?`Sterren per datum (gepland: ${Fe.length})`:"Geen ingeplande datums"),c.style.letterSpacing="3px",c.style.fontSize="20px");try{w&&w()}catch{}if(w=Ax(Cr(et,"members",K.id),W=>{const H=W.exists()?W.data():{};typeof H.ridesCount=="number"&&H.ridesCount;const se=Array.isArray(H.ScanDatums)?H.ScanDatums:[];Ca().then(me=>{const{stars:le,tooltip:oe,planned:Oe}=$l(me,se);c&&(c.textContent=le||"",c.setAttribute("title",le?oe:"Geen ingeplande datums"),c.setAttribute("aria-label",le?`Sterren per datum (gepland: ${Oe.length})`:"Geen ingeplande datums"),c.style.letterSpacing="3px",c.style.fontSize="20px")}).catch(()=>{});const he=H&&typeof H.Jaarhanger=="string"?H.Jaarhanger:"";x(he||g||null)}),ge)try{await Rp(K)}catch(W){console.error("QR creation failed",W)}else{i&&(i.style.display="none");const W=document.getElementById("qrPrivacy");W&&(W.style.display="none"),h&&(h.style.display="block")}}e==null||e.addEventListener("focus",I),e==null||e.addEventListener("input",k),e==null||e.addEventListener("keydown",K=>{K.key==="Escape"&&L(),K.key==="Enter"&&(K.preventDefault(),b())}),l&&(l.style.cursor="zoom-in",l.addEventListener("click",()=>kI(l),{passive:!0}),l.setAttribute("title","Klik om fullscreen te openen"))}async function Rp(r){try{if(!r)return;const e=JSON.stringify({t:"member",uid:r.id}),t=document.getElementById("qrCanvas"),n=document.getElementById("result"),i=document.getElementById("error");return new Promise((s,a)=>{if(!t)return s();oc.toCanvas(t,e,{width:220,margin:1},o=>{if(o){i&&(i.textContent="QR genereren mislukte.",i.style.display="block"),a(o);return}n&&(n.style.display="grid");const c=document.getElementById("qrPrivacy");c&&(c.style.display="block"),s()})})}catch(e){console.error("generateQrForEntry failed",e)}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jo={};jo.version="0.18.5";var jr=1200,vs=1252,bI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},bu=function(r){bI.indexOf(r)!=-1&&(vs=bh[0]=r)};function RI(){bu(1252)}var on=function(r){jr=r,bu(r)};function Ru(){on(1200),RI()}function jl(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function FI(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function Dx(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var na=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?FI(r.slice(2)):e==254&&t==255?Dx(r.slice(2)):e==65279?r.slice(1):r},fo=function(e){return String.fromCharCode(e)},c0=function(e){return String.fromCharCode(e)},Ye;function DI(r){Ye=r,on=function(e){jr=e,bu(e)},na=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?Ye.utils.decode(1200,jl(e.slice(2))):e},fo=function(t){return jr===1200?String.fromCharCode(t):Ye.utils.decode(jr,[t&255,t>>8])[0]},c0=function(t){return Ye.utils.decode(vs,[t])[0]},ov()}var pi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ko(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0,c=0,l=0;l<r.length;)t=r.charCodeAt(l++),s=t>>2,n=r.charCodeAt(l++),a=(t&3)<<4|n>>4,i=r.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=pi.charAt(s)+pi.charAt(a)+pi.charAt(o)+pi.charAt(c);return e}function qr(r){var e="",t=0,n=0,i=0,s=0,a=0,o=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<r.length;)s=pi.indexOf(r.charAt(l++)),a=pi.indexOf(r.charAt(l++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=pi.indexOf(r.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=pi.indexOf(r.charAt(l++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var We=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ti=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function bi(r){return We?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Fp(r){return We?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Wr=function(e){return We?ti(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function wc(r){if(typeof ArrayBuffer>"u")return Wr(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Bi(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function PI(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function Rh(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return Rh(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var Zt=We?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:ti(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function NI(r){for(var e=[],t=0,n=r.length+250,i=bi(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>n&&(e.push(i.slice(0,t)),t=0,i=bi(65535),n=65530)}return e.push(i.slice(0,t)),Zt(e)}var yr=/\u0000/g,ho=/[\u0001-\u0006]/g;function ca(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function gn(r,e){var t=""+r;return t.length>=e?t:Ft("0",e-t.length)+t}function Fh(r,e){var t=""+r;return t.length>=e?t:Ft(" ",e-t.length)+t}function Kl(r,e){var t=""+r;return t.length>=e?t:t+Ft(" ",e-t.length)}function OI(r,e){var t=""+Math.round(r);return t.length>=e?t:Ft("0",e-t.length)+t}function LI(r,e){var t=""+r;return t.length>=e?t:Ft("0",e-t.length)+t}var Dp=Math.pow(2,32);function Ks(r,e){if(r>Dp||r<-Dp)return OI(r,e);var t=Math.round(r);return LI(t,e)}function ql(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Pp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],mf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function MI(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Np={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},VI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xl(r,e,t){for(var n=r<0?-1:1,i=r*n,s=0,a=1,o=0,c=1,l=0,u=0,h=Math.floor(i);l<e&&(h=Math.floor(i),o=h*a+s,u=h*l+c,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,c=l,l=u;if(u>e&&(l>e?(u=c,o=s):(u=l,o=a)),!t)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function gi(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),s=0,a=[],o={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),t&&(s=zI(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Px=new Date(1899,11,31,0,0,0),BI=Px.getTime(),UI=new Date(1900,2,1,0,0,0);function Nx(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=UI&&(t+=24*60*60*1e3),(t-(BI+(r.getTimezoneOffset()-Px.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Dh(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function GI(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function WI(r){var e=r<0?12:11,t=Dh(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function HI(r){var e=Dh(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function qo(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=WI(r):e===10?t=r.toFixed(10).substr(0,12):t=HI(r),Dh(GI(t.toUpperCase()))}function ys(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):qo(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Xr(14,Nx(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function zI(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function $I(r,e,t,n){var i="",s=0,a=0,o=t.y,c,l=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=t.m,l=e.length;break;case 3:return mf[t.m-1][1];case 5:return mf[t.m-1][0];default:return mf[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=t.d,l=e.length;break;case 3:return Pp[t.q][0];default:return Pp[t.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(t.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=t.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=t.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?gn(t.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=gn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var u=l>0?gn(c,l):"";return u}function _i(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var Ox=/%/g;function jI(r,e,t){var n=e.replace(Ox,""),i=e.length-n.length;return Xn(r,n,t*Math.pow(10,2*i))+Ft("%",i)}function KI(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Xn(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function Lx(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Lx(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Mx=/# (\?+)( ?)\/( ?)(\d+)/;function qI(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return t+(s===0?"":""+s)+" "+(a===0?Ft(" ",r[1].length+1+r[4].length):Fh(a,r[1].length)+r[2]+"/"+r[3]+gn(o,r[4].length))}function XI(r,e,t){return t+(e===0?"":""+e)+Ft(" ",r[1].length+2+r[4].length)}var Vx=/^#*0*\.([0#]+)/,Bx=/\).*[0#]/,Ux=/\(###\) ###\\?-####/;function Sr(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Op(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Lp(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function QI(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function YI(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function tn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Bx)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?tn("n",n,t):"("+tn("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return KI(r,e,t);if(e.indexOf("%")!==-1)return jI(r,e,t);if(e.indexOf("E")!==-1)return Lx(e,t);if(e.charCodeAt(0)===36)return"$"+tn(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,c=Math.abs(t),l=t<0?"-":"";if(e.match(/^00+$/))return l+Ks(c,e.length);if(e.match(/^[#?]+$/))return i=Ks(t,0),i==="0"&&(i=""),i.length>e.length?i:Sr(e.substr(0,e.length-i.length))+i;if(s=e.match(Mx))return qI(s,c,l);if(e.match(/^#+0+$/))return l+Ks(c,e.length-e.indexOf("0"));if(s=e.match(Vx))return i=Op(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Sr(s[1])).replace(/\.$/,"."+Sr(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+Ft("0",Sr(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+Op(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+_i(Ks(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+tn(r,e,-t):_i(""+(Math.floor(t)+QI(t,s[1].length)))+"."+gn(Lp(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return tn(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ca(tn(r,e.replace(/[\\-]/g,""),t)),a=0,ca(ca(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(Ux))return i=tn(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Xl(c,Math.pow(10,a)-1,!1),i=""+l,u=Xn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Kl(o[2],a),u.length<s[4].length&&(u=Sr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Xl(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Fh(o[1],a)+s[2]+"/"+s[3]+Kl(o[2],a):Ft(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Ks(t,0),e.length<=i.length?i:Sr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Sr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Lp(t,s[1].length),t<0?"-"+tn(r,e,-t):_i(YI(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?gn(0,3-g.length):"")+g})+"."+gn(a,s[1].length);switch(e){case"###,##0.00":return tn(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var m=_i(Ks(c,0));return m!=="0"?l+m:"";case"###,###.00":return tn(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return tn(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function JI(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Xn(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function ZI(r,e,t){var n=e.replace(Ox,""),i=e.length-n.length;return Xn(r,n,t*Math.pow(10,2*i))+Ft("%",i)}function Gx(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Gx(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Sn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Bx)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Sn("n",n,t):"("+Sn("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return JI(r,e,t);if(e.indexOf("%")!==-1)return ZI(r,e,t);if(e.indexOf("E")!==-1)return Gx(e,t);if(e.charCodeAt(0)===36)return"$"+Sn(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,c=Math.abs(t),l=t<0?"-":"";if(e.match(/^00+$/))return l+gn(c,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:Sr(e.substr(0,e.length-i.length))+i;if(s=e.match(Mx))return XI(s,c,l);if(e.match(/^#+0+$/))return l+gn(c,e.length-e.indexOf("0"));if(s=e.match(Vx))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Sr(s[1])).replace(/\.$/,"."+Sr(s[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+Ft("0",Sr(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+_i(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Sn(r,e,-t):_i(""+t)+"."+Ft("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Sn(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ca(Sn(r,e.replace(/[\\-]/g,""),t)),a=0,ca(ca(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(Ux))return i=Sn(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Xl(c,Math.pow(10,a)-1,!1),i=""+l,u=Xn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Kl(o[2],a),u.length<s[4].length&&(u=Sr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Xl(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Fh(o[1],a)+s[2]+"/"+s[3]+Kl(o[2],a):Ft(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:Sr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Sr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Sn(r,e,-t):_i(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?gn(0,3-g.length):"")+g})+"."+gn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=_i(""+c);return m!=="0"?l+m:"";default:if(e.match(/\.[0#?]*$/))return Sn(r,e.slice(0,e.lastIndexOf(".")),t)+Sr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Xn(r,e,t){return(t|0)===t?Sn(r,e,t):tn(r,e,t)}function ek(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var Wx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function bs(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":ql(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(Wx))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function tk(r,e,t,n){for(var i=[],s="",a=0,o="",c="t",l,u,h,d="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!ql(r,a))throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=r.charAt(++a),g=m==="("||m===")"?m:"t";i[i.length]={t:g,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(l==null&&(l=gi(e,t,r.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:r.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=gi(e,t),l==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var p={t:o,v:o};if(l==null&&(l=gi(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",a+=5,d="h"):r.substr(a,5).toUpperCase()==="/"?(l!=null&&(p.v=l.H>=12?"":""),p.t="T",a+=5,d="h"):(p.t="t",++a),l==null&&p.t==="T")return"";i[i.length]=p,c=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Wx)){if(l==null&&(l=gi(e,t),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",bs(r)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"t",v:o},++a;break}var x=0,T=0,C;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,c="h",x<1&&(x=1);break;case"s":(C=i[a].v.match(/\.0+$/))&&(T=Math.max(T,C[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&i[a].v.match(/[Hh]/)&&(x=1),x<2&&i[a].v.match(/[Mm]/)&&(x=2),x<3&&i[a].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var w="",F;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=$I(i[a].t.charCodeAt(0),i[a].v,l,T),i[a].t="t";break;case"n":case"?":for(F=a+1;i[F]!=null&&((o=i[F].t)==="?"||o==="D"||(o===" "||o==="t")&&i[F+1]!=null&&(i[F+1].t==="?"||i[F+1].t==="t"&&i[F+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[F].v==="/"||i[F].v===" "&&i[F+1]!=null&&i[F+1].t=="?"));)i[a].v+=i[F].v,i[F]={v:"",t:";"},++F;w+=i[a].v,a=F-1;break;case"G":i[a].t="t",i[a].v=ys(e,t);break}var L="",O,v;if(w.length>0){w.charCodeAt(0)==40?(O=e<0&&w.charCodeAt(0)===45?-e:e,v=Xn("n",w,O)):(O=e<0&&n>1?-e:e,v=Xn("n",w,O),O<0&&i[0]&&i[0].t=="t"&&(v=v.substr(1),i[0].v="-"+i[0].v)),F=v.length-1;var A=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){A=a;break}var y=i.length;if(A===i.length&&v.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(F>=i[a].v.length-1?(F-=i[a].v.length,i[a].v=v.substr(F+1,i[a].v.length)):F<0?i[a].v="":(i[a].v=v.substr(0,F+1),F=-1),i[a].t="t",y=a);F>=0&&y<i.length&&(i[y].v=v.substr(0,F+1)+i[y].v)}else if(A!==i.length&&v.indexOf("E")===-1){for(F=v.indexOf(".")-1,a=A;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")-1:i[a].v.length-1,L=i[a].v.substr(u+1);u>=0;--u)F>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(L=v.charAt(F--)+L);i[a].v=L,i[a].t="t",y=a}for(F>=0&&y<i.length&&(i[y].v=v.substr(0,F+1)+i[y].v),F=v.indexOf(".")+1,a=A;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==A)){for(u=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")+1:0,L=i[a].v.substr(0,u);u<i[a].v.length;++u)F<v.length&&(L+=v.charAt(F++));i[a].v=L,i[a].t="t",y=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(O=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Xn(i[a].t,i[a].v,O),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var Mp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vp(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function rk(r,e){var t=ek(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(Mp),o=t[1].match(Mp);return Vp(e,a)?[n,t[0]]:Vp(e,o)?[n,t[1]]:[n,t[a!=null&&o!=null?2:1]]}return[n,s]}function Xr(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:De)[r],n==null&&(n=t.table&&t.table[Np[r]]||De[Np[r]]),n==null&&(n=VI[r]||"General");break}if(ql(n,0))return ys(e,t);e instanceof Date&&(e=Nx(e,t.date1904));var i=rk(n,e);if(ql(i[1]))return ys(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return tk(i[1],e,t,i[0])}function Rn(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(De[t]==null){e<0&&(e=t);continue}if(De[t]==r){e=t;break}}e<0&&(e=391)}return De[e]=r,e}function Ec(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Rn(r[e],e)}function Ga(){De=MI()}var Hx={format:Xr,load:Rn,_table:De,load_table:Ec,parse_date_code:gi,is_date:bs,get_table:function(){return Hx._table=De}},nk={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},zx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ik(r){var e=typeof r=="number"?De[r]:r;return e=e.replace(zx,"(\\d+)"),new RegExp("^"+e+"$")}function sk(r,e,t){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(zx)||[]).forEach(function(h,d){var m=parseInt(t[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":c=m;break;case"m":a>=0?o=m:i=m;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&s==-1?u:l+"T"+u}var ak=function(){var r={};r.version="1.2.0";function e(){for(var v=0,A=new Array(256),y=0;y!=256;++y)v=y,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,A[y]=v;return typeof Int32Array<"u"?new Int32Array(A):A}var t=e();function n(v){var A=0,y=0,I=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)k[I]=v[I];for(I=0;I!=256;++I)for(y=v[I],A=256+I;A<4096;A+=256)y=k[A]=y>>>8^v[y&255];var b=[];for(I=1;I!=16;++I)b[I-1]=typeof Int32Array<"u"?k.subarray(I*256,I*256+256):k.slice(I*256,I*256+256);return b}var i=n(t),s=i[0],a=i[1],o=i[2],c=i[3],l=i[4],u=i[5],h=i[6],d=i[7],m=i[8],g=i[9],p=i[10],x=i[11],T=i[12],C=i[13],w=i[14];function F(v,A){for(var y=A^-1,I=0,k=v.length;I<k;)y=y>>>8^t[(y^v.charCodeAt(I++))&255];return~y}function L(v,A){for(var y=A^-1,I=v.length-15,k=0;k<I;)y=w[v[k++]^y&255]^C[v[k++]^y>>8&255]^T[v[k++]^y>>16&255]^x[v[k++]^y>>>24]^p[v[k++]]^g[v[k++]]^m[v[k++]]^d[v[k++]]^h[v[k++]]^u[v[k++]]^l[v[k++]]^c[v[k++]]^o[v[k++]]^a[v[k++]]^s[v[k++]]^t[v[k++]];for(I+=15;k<I;)y=y>>>8^t[(y^v[k++])&255];return~y}function O(v,A){for(var y=A^-1,I=0,k=v.length,b=0,R=0;I<k;)b=v.charCodeAt(I++),b<128?y=y>>>8^t[(y^b)&255]:b<2048?(y=y>>>8^t[(y^(192|b>>6&31))&255],y=y>>>8^t[(y^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,R=v.charCodeAt(I++)&1023,y=y>>>8^t[(y^(240|b>>8&7))&255],y=y>>>8^t[(y^(128|b>>2&63))&255],y=y>>>8^t[(y^(128|R>>6&15|(b&3)<<4))&255],y=y>>>8^t[(y^(128|R&63))&255]):(y=y>>>8^t[(y^(224|b>>12&15))&255],y=y>>>8^t[(y^(128|b>>6&63))&255],y=y>>>8^t[(y^(128|b&63))&255]);return~y}return r.table=t,r.bstr=F,r.buf=L,r.str=O,r}(),Re=function(){var e={};e.version="1.2.1";function t(S,M){for(var P=S.split("/"),N=M.split("/"),V=0,U=0,X=Math.min(P.length,N.length);V<X;++V){if(U=P[V].length-N[V].length)return U;if(P[V]!=N[V])return P[V]<N[V]?-1:1}return P.length-N.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var M=S.lastIndexOf("/");return M===-1?S:S.slice(0,M+1)}function i(S){if(S.charAt(S.length-1)=="/")return i(S.slice(0,-1));var M=S.lastIndexOf("/");return M===-1?S:S.slice(M+1)}function s(S,M){typeof M=="string"&&(M=new Date(M));var P=M.getHours();P=P<<6|M.getMinutes(),P=P<<5|M.getSeconds()>>>1,S.write_shift(2,P);var N=M.getFullYear()-1980;N=N<<4|M.getMonth()+1,N=N<<5|M.getDate(),S.write_shift(2,N)}function a(S){var M=S.read_shift(2)&65535,P=S.read_shift(2)&65535,N=new Date,V=P&31;P>>>=5;var U=P&15;P>>>=4,N.setMilliseconds(0),N.setFullYear(P+1980),N.setMonth(U-1),N.setDate(V);var X=M&31;M>>>=5;var ne=M&63;return M>>>=6,N.setHours(M),N.setMinutes(ne),N.setSeconds(X<<1),N}function o(S){or(S,0);for(var M={},P=0;S.l<=S.length-4;){var N=S.read_shift(2),V=S.read_shift(2),U=S.l+V,X={};switch(N){case 21589:P=S.read_shift(1),P&1&&(X.mtime=S.read_shift(4)),V>5&&(P&2&&(X.atime=S.read_shift(4)),P&4&&(X.ctime=S.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}S.l=U,M[N]=X}return M}var c;function l(){return c||(c={})}function u(S,M){if(S[0]==80&&S[1]==75)return ja(S,M);if((S[0]|32)==109&&(S[1]|32)==105)return Dc(S,M);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var P=3,N=512,V=0,U=0,X=0,ne=0,Q=0,J=[],ee=S.slice(0,512);or(ee,0);var ue=h(ee);switch(P=ue[0],P){case 3:N=512;break;case 4:N=4096;break;case 0:if(ue[1]==0)return ja(S,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}N!==512&&(ee=S.slice(0,N),or(ee,28));var ve=S.slice(0,N);d(ee,P);var Ae=ee.read_shift(4,"i");if(P===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);ee.l+=4,X=ee.read_shift(4,"i"),ee.l+=4,ee.chk("00100000","Mini Stream Cutoff Size: "),ne=ee.read_shift(4,"i"),V=ee.read_shift(4,"i"),Q=ee.read_shift(4,"i"),U=ee.read_shift(4,"i");for(var pe=-1,Te=0;Te<109&&(pe=ee.read_shift(4,"i"),!(pe<0));++Te)J[Te]=pe;var Le=m(S,N);x(Q,U,Le,N,J);var ht=C(Le,X,J,N);ht[X].name="!Directory",V>0&&ne!==R&&(ht[ne].name="!MiniFAT"),ht[J[0]].name="!FAT",ht.fat_addrs=J,ht.ssz=N;var st={},wt=[],Un=[],ji=[];w(X,ht,Le,wt,V,st,Un,ne),g(Un,ji,wt),wt.shift();var si={FileIndex:Un,FullPaths:ji};return M&&M.raw&&(si.raw={header:ve,sectors:Le}),si}function h(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(K,"Header Signature: "),S.l+=16;var M=S.read_shift(2,"u");return[S.read_shift(2,"u"),M]}function d(S,M){var P=9;switch(S.l+=2,P=S.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function m(S,M){for(var P=Math.ceil(S.length/M)-1,N=[],V=1;V<P;++V)N[V-1]=S.slice(V*M,(V+1)*M);return N[P-1]=S.slice(P*M),N}function g(S,M,P){for(var N=0,V=0,U=0,X=0,ne=0,Q=P.length,J=[],ee=[];N<Q;++N)J[N]=ee[N]=N,M[N]=P[N];for(;ne<ee.length;++ne)N=ee[ne],V=S[N].L,U=S[N].R,X=S[N].C,J[N]===N&&(V!==-1&&J[V]!==V&&(J[N]=J[V]),U!==-1&&J[U]!==U&&(J[N]=J[U])),X!==-1&&(J[X]=N),V!==-1&&N!=J[N]&&(J[V]=J[N],ee.lastIndexOf(V)<ne&&ee.push(V)),U!==-1&&N!=J[N]&&(J[U]=J[N],ee.lastIndexOf(U)<ne&&ee.push(U));for(N=1;N<Q;++N)J[N]===N&&(U!==-1&&J[U]!==U?J[N]=J[U]:V!==-1&&J[V]!==V&&(J[N]=J[V]));for(N=1;N<Q;++N)if(S[N].type!==0){if(ne=N,ne!=J[ne])do ne=J[ne],M[N]=M[ne]+"/"+M[N];while(ne!==0&&J[ne]!==-1&&ne!=J[ne]);J[N]=-1}for(M[0]+="/",N=1;N<Q;++N)S[N].type!==2&&(M[N]+="/")}function p(S,M,P){for(var N=S.start,V=S.size,U=[],X=N;P&&V>0&&X>=0;)U.push(M.slice(X*b,X*b+b)),V-=b,X=ns(P,X*4);return U.length===0?ie(0):Zt(U).slice(0,S.size)}function x(S,M,P,N,V){var U=R;if(S===R){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var X=P[S],ne=(N>>>2)-1;if(!X)return;for(var Q=0;Q<ne&&(U=ns(X,Q*4))!==R;++Q)V.push(U);x(ns(X,N-4),M-1,P,N,V)}}function T(S,M,P,N,V){var U=[],X=[];V||(V=[]);var ne=N-1,Q=0,J=0;for(Q=M;Q>=0;){V[Q]=!0,U[U.length]=Q,X.push(S[Q]);var ee=P[Math.floor(Q*4/N)];if(J=Q*4&ne,N<4+J)throw new Error("FAT boundary crossed: "+Q+" 4 "+N);if(!S[ee])break;Q=ns(S[ee],J)}return{nodes:U,data:Qp([X])}}function C(S,M,P,N){var V=S.length,U=[],X=[],ne=[],Q=[],J=N-1,ee=0,ue=0,ve=0,Ae=0;for(ee=0;ee<V;++ee)if(ne=[],ve=ee+M,ve>=V&&(ve-=V),!X[ve]){Q=[];var pe=[];for(ue=ve;ue>=0;){pe[ue]=!0,X[ue]=!0,ne[ne.length]=ue,Q.push(S[ue]);var Te=P[Math.floor(ue*4/N)];if(Ae=ue*4&J,N<4+Ae)throw new Error("FAT boundary crossed: "+ue+" 4 "+N);if(!S[Te]||(ue=ns(S[Te],Ae),pe[ue]))break}U[ve]={nodes:ne,data:Qp([Q])}}return U}function w(S,M,P,N,V,U,X,ne){for(var Q=0,J=N.length?2:0,ee=M[S].data,ue=0,ve=0,Ae;ue<ee.length;ue+=128){var pe=ee.slice(ue,ue+128);or(pe,64),ve=pe.read_shift(2),Ae=Nu(pe,0,ve-J),N.push(Ae);var Te={name:Ae,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Le=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Le!==0&&(Te.ct=F(pe,pe.l-8));var ht=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);ht!==0&&(Te.mt=F(pe,pe.l-8)),Te.start=pe.read_shift(4,"i"),Te.size=pe.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=R,Te.name=""),Te.type===5?(Q=Te.start,V>0&&Q!==R&&(M[Q].name="!StreamData")):Te.size>=4096?(Te.storage="fat",M[Te.start]===void 0&&(M[Te.start]=T(P,Te.start,M.fat_addrs,M.ssz)),M[Te.start].name=Te.name,Te.content=M[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:Q!==R&&Te.start!==R&&M[Q]&&(Te.content=p(Te,M[Q].data,(M[ne]||{}).data))),Te.content&&or(Te.content,0),U[Ae]=Te,X.push(Te)}}function F(S,M){return new Date((Jt(S,M+4)/1e7*Math.pow(2,32)+Jt(S,M)/1e7-11644473600)*1e3)}function L(S,M){return l(),u(c.readFileSync(S),M)}function O(S,M){var P=M&&M.type;switch(P||We&&Buffer.isBuffer(S)&&(P="buffer"),P||"base64"){case"file":return L(S,M);case"base64":return u(Wr(qr(S)),M);case"binary":return u(Wr(S),M)}return u(S,M)}function v(S,M){var P=M||{},N=P.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=N+"/",S.FileIndex[0]={name:N,type:5}),P.CLSID&&(S.FileIndex[0].clsid=P.CLSID),A(S)}function A(S){var M="Sh33tJ5";if(!Re.find(S,"/"+M)){var P=ie(4);P[0]=55,P[1]=P[3]=50,P[2]=54,S.FileIndex.push({name:M,type:2,content:P,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+M),y(S)}}function y(S,M){v(S);for(var P=!1,N=!1,V=S.FullPaths.length-1;V>=0;--V){var U=S.FileIndex[V];switch(U.type){case 0:N?P=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(U.R*U.L*U.C)&&(P=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!M)){var X=new Date(1987,1,19),ne=0,Q=Object.create?Object.create(null):{},J=[];for(V=0;V<S.FullPaths.length;++V)Q[S.FullPaths[V]]=!0,S.FileIndex[V].type!==0&&J.push([S.FullPaths[V],S.FileIndex[V]]);for(V=0;V<J.length;++V){var ee=n(J[V][0]);N=Q[ee],N||(J.push([ee,{name:i(ee).replace("/",""),type:1,clsid:ge,ct:X,mt:X,content:null}]),Q[ee]=!0)}for(J.sort(function(Ae,pe){return t(Ae[0],pe[0])}),S.FullPaths=[],S.FileIndex=[],V=0;V<J.length;++V)S.FullPaths[V]=J[V][0],S.FileIndex[V]=J[V][1];for(V=0;V<J.length;++V){var ue=S.FileIndex[V],ve=S.FullPaths[V];if(ue.name=i(ve).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||ge,V===0)ue.C=J.length>1?1:-1,ue.size=0,ue.type=5;else if(ve.slice(-1)=="/"){for(ne=V+1;ne<J.length&&n(S.FullPaths[ne])!=ve;++ne);for(ue.C=ne>=J.length?-1:ne,ne=V+1;ne<J.length&&n(S.FullPaths[ne])!=n(ve);++ne);ue.R=ne>=J.length?-1:ne,ue.type=1}else n(S.FullPaths[V+1]||"")==n(ve)&&(ue.R=V+1),ue.type=2}}}function I(S,M){var P=M||{};if(P.fileType=="mad")return nr(S,P);switch(y(S),P.fileType){case"zip":return Ka(S,P)}var N=function(Ae){for(var pe=0,Te=0,Le=0;Le<Ae.FileIndex.length;++Le){var ht=Ae.FileIndex[Le];if(ht.content){var st=ht.content.length;st>0&&(st<4096?pe+=st+63>>6:Te+=st+511>>9)}}for(var wt=Ae.FullPaths.length+3>>2,Un=pe+7>>3,ji=pe+127>>7,si=Un+Te+wt+ji,Tn=si+127>>7,Bs=Tn<=109?0:Math.ceil((Tn-109)/127);si+Tn+Bs+127>>7>Tn;)Bs=++Tn<=109?0:Math.ceil((Tn-109)/127);var Br=[1,Bs,Tn,ji,wt,Te,pe,0];return Ae.FileIndex[0].size=pe<<6,Br[7]=(Ae.FileIndex[0].start=Br[0]+Br[1]+Br[2]+Br[3]+Br[4]+Br[5])+(Br[6]+7>>3),Br}(S),V=ie(N[7]<<9),U=0,X=0;{for(U=0;U<8;++U)V.write_shift(1,Z[U]);for(U=0;U<8;++U)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),U=0;U<3;++U)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,N[2]),V.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:R),V.write_shift(4,N[3]),V.write_shift(-4,N[1]?N[0]-1:R),V.write_shift(4,N[1]),U=0;U<109;++U)V.write_shift(-4,U<N[2]?N[1]+U:-1)}if(N[1])for(X=0;X<N[1];++X){for(;U<236+X*127;++U)V.write_shift(-4,U<N[2]?N[1]+U:-1);V.write_shift(-4,X===N[1]-1?R:X+1)}var ne=function(Ae){for(X+=Ae;U<X-1;++U)V.write_shift(-4,U+1);Ae&&(++U,V.write_shift(-4,R))};for(X=U=0,X+=N[1];U<X;++U)V.write_shift(-4,de.DIFSECT);for(X+=N[2];U<X;++U)V.write_shift(-4,de.FATSECT);ne(N[3]),ne(N[4]);for(var Q=0,J=0,ee=S.FileIndex[0];Q<S.FileIndex.length;++Q)ee=S.FileIndex[Q],ee.content&&(J=ee.content.length,!(J<4096)&&(ee.start=X,ne(J+511>>9)));for(ne(N[6]+7>>3);V.l&511;)V.write_shift(-4,de.ENDOFCHAIN);for(X=U=0,Q=0;Q<S.FileIndex.length;++Q)ee=S.FileIndex[Q],ee.content&&(J=ee.content.length,!(!J||J>=4096)&&(ee.start=X,ne(J+63>>6)));for(;V.l&511;)V.write_shift(-4,de.ENDOFCHAIN);for(U=0;U<N[4]<<2;++U){var ue=S.FullPaths[U];if(!ue||ue.length===0){for(Q=0;Q<17;++Q)V.write_shift(4,0);for(Q=0;Q<3;++Q)V.write_shift(4,-1);for(Q=0;Q<12;++Q)V.write_shift(4,0);continue}ee=S.FileIndex[U],U===0&&(ee.start=ee.size?ee.start-1:R);var ve=U===0&&P.root||ee.name;if(J=2*(ve.length+1),V.write_shift(64,ve,"utf16le"),V.write_shift(2,J),V.write_shift(1,ee.type),V.write_shift(1,ee.color),V.write_shift(-4,ee.L),V.write_shift(-4,ee.R),V.write_shift(-4,ee.C),ee.clsid)V.write_shift(16,ee.clsid,"hex");else for(Q=0;Q<4;++Q)V.write_shift(4,0);V.write_shift(4,ee.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,ee.start),V.write_shift(4,ee.size),V.write_shift(4,0)}for(U=1;U<S.FileIndex.length;++U)if(ee=S.FileIndex[U],ee.size>=4096)if(V.l=ee.start+1<<9,We&&Buffer.isBuffer(ee.content))ee.content.copy(V,V.l,0,ee.size),V.l+=ee.size+511&-512;else{for(Q=0;Q<ee.size;++Q)V.write_shift(1,ee.content[Q]);for(;Q&511;++Q)V.write_shift(1,0)}for(U=1;U<S.FileIndex.length;++U)if(ee=S.FileIndex[U],ee.size>0&&ee.size<4096)if(We&&Buffer.isBuffer(ee.content))ee.content.copy(V,V.l,0,ee.size),V.l+=ee.size+63&-64;else{for(Q=0;Q<ee.size;++Q)V.write_shift(1,ee.content[Q]);for(;Q&63;++Q)V.write_shift(1,0)}if(We)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function k(S,M){var P=S.FullPaths.map(function(Q){return Q.toUpperCase()}),N=P.map(function(Q){var J=Q.split("/");return J[J.length-(Q.slice(-1)=="/"?2:1)]}),V=!1;M.charCodeAt(0)===47?(V=!0,M=P[0].slice(0,-1)+M):V=M.indexOf("/")!==-1;var U=M.toUpperCase(),X=V===!0?P.indexOf(U):N.indexOf(U);if(X!==-1)return S.FileIndex[X];var ne=!U.match(ho);for(U=U.replace(yr,""),ne&&(U=U.replace(ho,"!")),X=0;X<P.length;++X)if((ne?P[X].replace(ho,"!"):P[X]).replace(yr,"")==U||(ne?N[X].replace(ho,"!"):N[X]).replace(yr,"")==U)return S.FileIndex[X];return null}var b=64,R=-2,K="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],ge="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ze(S,M,P){l();var N=I(S,P);c.writeFileSync(M,N)}function Y(S){for(var M=new Array(S.length),P=0;P<S.length;++P)M[P]=String.fromCharCode(S[P]);return M.join("")}function Ce(S,M){var P=I(S,M);switch(M&&M.type||"buffer"){case"file":return l(),c.writeFileSync(M.filename,P),P;case"binary":return typeof P=="string"?P:Y(P);case"base64":return Ko(typeof P=="string"?P:Y(P));case"buffer":if(We)return Buffer.isBuffer(P)?P:ti(P);case"array":return typeof P=="string"?Wr(P):P}return P}var Fe;function B(S){try{var M=S.InflateRaw,P=new M;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)Fe=S;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function z(S,M){if(!Fe)return Ms(S,M);var P=Fe.InflateRaw,N=new P,V=N._processChunk(S.slice(S.l),N._finishFlushFlag);return S.l+=N.bytesRead,V}function W(S){return Fe?Fe.deflateRawSync(S):Be(S)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(S){var M=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(M>>16|M>>8|M)&255}for(var le=typeof Uint8Array<"u",oe=le?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)oe[Oe]=me(Oe);function G(S,M){var P=oe[S&255];return M<=8?P>>>8-M:(P=P<<8|oe[S>>8&255],M<=16?P>>>16-M:(P=P<<8|oe[S>>16&255],P>>>24-M))}function it(S,M){var P=M&7,N=M>>>3;return(S[N]|(P<=6?0:S[N+1]<<8))>>>P&3}function $e(S,M){var P=M&7,N=M>>>3;return(S[N]|(P<=5?0:S[N+1]<<8))>>>P&7}function nt(S,M){var P=M&7,N=M>>>3;return(S[N]|(P<=4?0:S[N+1]<<8))>>>P&15}function Ge(S,M){var P=M&7,N=M>>>3;return(S[N]|(P<=3?0:S[N+1]<<8))>>>P&31}function Ee(S,M){var P=M&7,N=M>>>3;return(S[N]|(P<=1?0:S[N+1]<<8))>>>P&127}function At(S,M,P){var N=M&7,V=M>>>3,U=(1<<P)-1,X=S[V]>>>N;return P<8-N||(X|=S[V+1]<<8-N,P<16-N)||(X|=S[V+2]<<16-N,P<24-N)||(X|=S[V+3]<<24-N),X&U}function Ar(S,M,P){var N=M&7,V=M>>>3;return N<=5?S[V]|=(P&7)<<N:(S[V]|=P<<N&255,S[V+1]=(P&7)>>8-N),M+3}function Rr(S,M,P){var N=M&7,V=M>>>3;return P=(P&1)<<N,S[V]|=P,M+1}function Yr(S,M,P){var N=M&7,V=M>>>3;return P<<=N,S[V]|=P&255,P>>>=8,S[V+1]=P,M+8}function Wi(S,M,P){var N=M&7,V=M>>>3;return P<<=N,S[V]|=P&255,P>>>=8,S[V+1]=P&255,S[V+2]=P>>>8,M+16}function Jr(S,M){var P=S.length,N=2*P>M?2*P:M+5,V=0;if(P>=M)return S;if(We){var U=Fp(N);if(S.copy)S.copy(U);else for(;V<S.length;++V)U[V]=S[V];return U}else if(le){var X=new Uint8Array(N);if(X.set)X.set(S);else for(;V<P;++V)X[V]=S[V];return X}return S.length=N,S}function rr(S){for(var M=new Array(S),P=0;P<S;++P)M[P]=0;return M}function Zr(S,M,P){var N=1,V=0,U=0,X=0,ne=0,Q=S.length,J=le?new Uint16Array(32):rr(32);for(U=0;U<32;++U)J[U]=0;for(U=Q;U<P;++U)S[U]=0;Q=S.length;var ee=le?new Uint16Array(Q):rr(Q);for(U=0;U<Q;++U)J[V=S[U]]++,N<V&&(N=V),ee[U]=0;for(J[0]=0,U=1;U<=N;++U)J[U+16]=ne=ne+J[U-1]<<1;for(U=0;U<Q;++U)ne=S[U],ne!=0&&(ee[U]=J[ne+16]++);var ue=0;for(U=0;U<Q;++U)if(ue=S[U],ue!=0)for(ne=G(ee[U],N)>>N-ue,X=(1<<N+4-ue)-1;X>=0;--X)M[ne|X<<ue]=ue&15|U<<4;return N}var gt=le?new Uint16Array(512):rr(512),Ot=le?new Uint16Array(32):rr(32);if(!le){for(var Gt=0;Gt<512;++Gt)gt[Gt]=0;for(Gt=0;Gt<32;++Gt)Ot[Gt]=0}(function(){for(var S=[],M=0;M<32;M++)S.push(5);Zr(S,Ot,32);var P=[];for(M=0;M<=143;M++)P.push(8);for(;M<=255;M++)P.push(9);for(;M<=279;M++)P.push(7);for(;M<=287;M++)P.push(8);Zr(P,gt,288)})();var Vr=function(){for(var M=le?new Uint8Array(32768):[],P=0,N=0;P<he.length-1;++P)for(;N<he[P+1];++N)M[N]=P;for(;N<32768;++N)M[N]=29;var V=le?new Uint8Array(259):[];for(P=0,N=0;P<se.length-1;++P)for(;N<se[P+1];++N)V[N]=P;function U(ne,Q){for(var J=0;J<ne.length;){var ee=Math.min(65535,ne.length-J),ue=J+ee==ne.length;for(Q.write_shift(1,+ue),Q.write_shift(2,ee),Q.write_shift(2,~ee&65535);ee-- >0;)Q[Q.l++]=ne[J++]}return Q.l}function X(ne,Q){for(var J=0,ee=0,ue=le?new Uint16Array(32768):[];ee<ne.length;){var ve=Math.min(65535,ne.length-ee);if(ve<10){for(J=Ar(Q,J,+(ee+ve==ne.length)),J&7&&(J+=8-(J&7)),Q.l=J/8|0,Q.write_shift(2,ve),Q.write_shift(2,~ve&65535);ve-- >0;)Q[Q.l++]=ne[ee++];J=Q.l*8;continue}J=Ar(Q,J,+(ee+ve==ne.length)+2);for(var Ae=0;ve-- >0;){var pe=ne[ee];Ae=(Ae<<5^pe)&32767;var Te=-1,Le=0;if((Te=ue[Ae])&&(Te|=ee&-32768,Te>ee&&(Te-=32768),Te<ee))for(;ne[Te+Le]==ne[ee+Le]&&Le<250;)++Le;if(Le>2){pe=V[Le],pe<=22?J=Yr(Q,J,oe[pe+1]>>1)-1:(Yr(Q,J,3),J+=5,Yr(Q,J,oe[pe-23]>>5),J+=3);var ht=pe<8?0:pe-4>>2;ht>0&&(Wi(Q,J,Le-se[pe]),J+=ht),pe=M[ee-Te],J=Yr(Q,J,oe[pe]>>3),J-=3;var st=pe<4?0:pe-2>>1;st>0&&(Wi(Q,J,ee-Te-he[pe]),J+=st);for(var wt=0;wt<Le;++wt)ue[Ae]=ee&32767,Ae=(Ae<<5^ne[ee])&32767,++ee;ve-=Le-1}else pe<=143?pe=pe+48:J=Rr(Q,J,1),J=Yr(Q,J,oe[pe]),ue[Ae]=ee&32767,++ee}J=Yr(Q,J,0)-1}return Q.l=(J+7)/8|0,Q.l}return function(Q,J){return Q.length<8?U(Q,J):X(Q,J)}}();function Be(S){var M=ie(50+Math.floor(S.length*1.1)),P=Vr(S,M);return M.slice(0,P)}var St=le?new Uint16Array(32768):rr(32768),Xt=le?new Uint16Array(32768):rr(32768),bt=le?new Uint16Array(128):rr(128),En=1,Ls=1;function Gu(S,M){var P=Ge(S,M)+257;M+=5;var N=Ge(S,M)+1;M+=5;var V=nt(S,M)+4;M+=4;for(var U=0,X=le?new Uint8Array(19):rr(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Q=1,J=le?new Uint8Array(8):rr(8),ee=le?new Uint8Array(8):rr(8),ue=X.length,ve=0;ve<V;++ve)X[H[ve]]=U=$e(S,M),Q<U&&(Q=U),J[U]++,M+=3;var Ae=0;for(J[0]=0,ve=1;ve<=Q;++ve)ee[ve]=Ae=Ae+J[ve-1]<<1;for(ve=0;ve<ue;++ve)(Ae=X[ve])!=0&&(ne[ve]=ee[Ae]++);var pe=0;for(ve=0;ve<ue;++ve)if(pe=X[ve],pe!=0){Ae=oe[ne[ve]]>>8-pe;for(var Te=(1<<7-pe)-1;Te>=0;--Te)bt[Ae|Te<<pe]=pe&7|ve<<3}var Le=[];for(Q=1;Le.length<P+N;)switch(Ae=bt[Ee(S,M)],M+=Ae&7,Ae>>>=3){case 16:for(U=3+it(S,M),M+=2,Ae=Le[Le.length-1];U-- >0;)Le.push(Ae);break;case 17:for(U=3+$e(S,M),M+=3;U-- >0;)Le.push(0);break;case 18:for(U=11+Ee(S,M),M+=7;U-- >0;)Le.push(0);break;default:Le.push(Ae),Q<Ae&&(Q=Ae);break}var ht=Le.slice(0,P),st=Le.slice(P);for(ve=P;ve<286;++ve)ht[ve]=0;for(ve=N;ve<30;++ve)st[ve]=0;return En=Zr(ht,St,286),Ls=Zr(st,Xt,30),M}function Wu(S,M){if(S[0]==3&&!(S[1]&3))return[bi(M),2];for(var P=0,N=0,V=Fp(M||1<<18),U=0,X=V.length>>>0,ne=0,Q=0;!(N&1);){if(N=$e(S,P),P+=3,N>>>1)N>>1==1?(ne=9,Q=5):(P=Gu(S,P),ne=En,Q=Ls);else{P&7&&(P+=8-(P&7));var J=S[P>>>3]|S[(P>>>3)+1]<<8;if(P+=32,J>0)for(!M&&X<U+J&&(V=Jr(V,U+J),X=V.length);J-- >0;)V[U++]=S[P>>>3],P+=8;continue}for(;;){!M&&X<U+32767&&(V=Jr(V,U+32767),X=V.length);var ee=At(S,P,ne),ue=N>>>1==1?gt[ee]:St[ee];if(P+=ue&15,ue>>>=4,!(ue>>>8&255))V[U++]=ue;else{if(ue==256)break;ue-=257;var ve=ue<8?0:ue-4>>2;ve>5&&(ve=0);var Ae=U+se[ue];ve>0&&(Ae+=At(S,P,ve),P+=ve),ee=At(S,P,Q),ue=N>>>1==1?Ot[ee]:Xt[ee],P+=ue&15,ue>>>=4;var pe=ue<4?0:ue-2>>1,Te=he[ue];for(pe>0&&(Te+=At(S,P,pe),P+=pe),!M&&X<Ae&&(V=Jr(V,Ae+100),X=V.length);U<Ae;)V[U]=V[U-Te],++U}}}return M?[V,P+7>>>3]:[V.slice(0,U),P+7>>>3]}function Ms(S,M){var P=S.slice(S.l||0),N=Wu(P,M);return S.l+=N[1],N[0]}function $a(S,M){if(S)typeof console<"u"&&console.error(M);else throw new Error(M)}function ja(S,M){var P=S;or(P,0);var N=[],V=[],U={FileIndex:N,FullPaths:V};v(U,{root:M.root});for(var X=P.length-4;(P[X]!=80||P[X+1]!=75||P[X+2]!=5||P[X+3]!=6)&&X>=0;)--X;P.l=X+4,P.l+=4;var ne=P.read_shift(2);P.l+=6;var Q=P.read_shift(4);for(P.l=Q,X=0;X<ne;++X){P.l+=20;var J=P.read_shift(4),ee=P.read_shift(4),ue=P.read_shift(2),ve=P.read_shift(2),Ae=P.read_shift(2);P.l+=8;var pe=P.read_shift(4),Te=o(P.slice(P.l+ue,P.l+ue+ve));P.l+=ue+ve+Ae;var Le=P.l;P.l=pe+4,Hi(P,J,ee,U,Te),P.l=Le}return U}function Hi(S,M,P,N,V){S.l+=2;var U=S.read_shift(2),X=S.read_shift(2),ne=a(S);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var Q=S.read_shift(4),J=S.read_shift(4),ee=S.read_shift(4),ue=S.read_shift(2),ve=S.read_shift(2),Ae="",pe=0;pe<ue;++pe)Ae+=String.fromCharCode(S[S.l++]);if(ve){var Te=o(S.slice(S.l,S.l+ve));(Te[21589]||{}).mt&&(ne=Te[21589].mt),((V||{})[21589]||{}).mt&&(ne=V[21589].mt)}S.l+=ve;var Le=S.slice(S.l,S.l+J);switch(X){case 8:Le=z(S,ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var ht=!1;U&8&&(Q=S.read_shift(4),Q==134695760&&(Q=S.read_shift(4),ht=!0),J=S.read_shift(4),ee=S.read_shift(4)),J!=M&&$a(ht,"Bad compressed size: "+M+" != "+J),ee!=P&&$a(ht,"Bad uncompressed size: "+P+" != "+ee),Bn(N,Ae,Le,{unsafe:!0,mt:ne})}function Ka(S,M){var P=M||{},N=[],V=[],U=ie(1),X=P.compression?8:0,ne=0,Q=0,J=0,ee=0,ue=0,ve=S.FullPaths[0],Ae=ve,pe=S.FileIndex[0],Te=[],Le=0;for(Q=1;Q<S.FullPaths.length;++Q)if(Ae=S.FullPaths[Q].slice(ve.length),pe=S.FileIndex[Q],!(!pe.size||!pe.content||Ae=="Sh33tJ5")){var ht=ee,st=ie(Ae.length);for(J=0;J<Ae.length;++J)st.write_shift(1,Ae.charCodeAt(J)&127);st=st.slice(0,st.l),Te[ue]=ak.buf(pe.content,0);var wt=pe.content;X==8&&(wt=W(wt)),U=ie(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,ne),U.write_shift(2,X),pe.mt?s(U,pe.mt):U.write_shift(4,0),U.write_shift(-4,Te[ue]),U.write_shift(4,wt.length),U.write_shift(4,pe.content.length),U.write_shift(2,st.length),U.write_shift(2,0),ee+=U.length,N.push(U),ee+=st.length,N.push(st),ee+=wt.length,N.push(wt),U=ie(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,ne),U.write_shift(2,X),U.write_shift(4,0),U.write_shift(-4,Te[ue]),U.write_shift(4,wt.length),U.write_shift(4,pe.content.length),U.write_shift(2,st.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,ht),Le+=U.l,V.push(U),Le+=st.length,V.push(st),++ue}return U=ie(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,ue),U.write_shift(2,ue),U.write_shift(4,Le),U.write_shift(4,ee),U.write_shift(2,0),Zt([Zt(N),Zt(V),U])}var ii={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Vn(S,M){if(S.ctype)return S.ctype;var P=S.name||"",N=P.match(/\.([^\.]+)$/);return N&&ii[N[1]]||M&&(N=(P=M).match(/[\.\\]([^\.\\])+$/),N&&ii[N[1]])?ii[N[1]]:"application/octet-stream"}function Rc(S){for(var M=Ko(S),P=[],N=0;N<M.length;N+=76)P.push(M.slice(N,N+76));return P.join(`\r
`)+`\r
`}function Vs(S){var M=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(J){var ee=J.charCodeAt(0).toString(16).toUpperCase();return"="+(ee.length==1?"0"+ee:ee)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],N=M.split(`\r
`),V=0;V<N.length;++V){var U=N[V];if(U.length==0){P.push("");continue}for(var X=0;X<U.length;){var ne=76,Q=U.slice(X,X+ne);Q.charAt(ne-1)=="="?ne--:Q.charAt(ne-2)=="="?ne-=2:Q.charAt(ne-3)=="="&&(ne-=3),Q=U.slice(X,X+ne),X+=ne,X<U.length&&(Q+="="),P.push(Q)}}return P.join(`\r
`)}function Fc(S){for(var M=[],P=0;P<S.length;++P){for(var N=S[P];P<=S.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+S[++P];M.push(N)}for(var V=0;V<M.length;++V)M[V]=M[V].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Wr(M.join(`\r
`))}function zi(S,M,P){for(var N="",V="",U="",X,ne=0;ne<10;++ne){var Q=M[ne];if(!Q||Q.match(/^\s*$/))break;var J=Q.match(/^(.*?):\s*([^\s].*)$/);if(J)switch(J[1].toLowerCase()){case"content-location":N=J[2].trim();break;case"content-type":U=J[2].trim();break;case"content-transfer-encoding":V=J[2].trim();break}}switch(++ne,V.toLowerCase()){case"base64":X=Wr(qr(M.slice(ne).join("")));break;case"quoted-printable":X=Fc(M.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var ee=Bn(S,N.slice(P.length),X,{unsafe:!0});U&&(ee.ctype=U)}function Dc(S,M){if(Y(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=M&&M.root||"",N=(We&&Buffer.isBuffer(S)?S.toString("binary"):Y(S)).split(`\r
`),V=0,U="";for(V=0;V<N.length;++V)if(U=N[V],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),P||(P=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),U.slice(0,P.length)!=P););var X=(N[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var ne="--"+(X[1]||""),Q=[],J=[],ee={FileIndex:Q,FullPaths:J};v(ee);var ue,ve=0;for(V=0;V<N.length;++V){var Ae=N[V];Ae!==ne&&Ae!==ne+"--"||(ve++&&zi(ee,N.slice(ue,V),P),ue=V)}return ee}function nr(S,M){var P=M||{},N=P.boundary||"SheetJS";N="------="+N;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],U=S.FullPaths[0],X=U,ne=S.FileIndex[0],Q=1;Q<S.FullPaths.length;++Q)if(X=S.FullPaths[Q].slice(U.length),ne=S.FileIndex[Q],!(!ne.size||!ne.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var J=ne.content,ee=We&&Buffer.isBuffer(J)?J.toString("binary"):Y(J),ue=0,ve=Math.min(1024,ee.length),Ae=0,pe=0;pe<=ve;++pe)(Ae=ee.charCodeAt(pe))>=32&&Ae<128&&++ue;var Te=ue>=ve*4/5;V.push(N),V.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+X),V.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),V.push("Content-Type: "+Vn(ne,X)),V.push(""),V.push(Te?Vs(ee):Rc(ee))}return V.push(N+`--\r
`),V.join(`\r
`)}function Pc(S){var M={};return v(M,S),M}function Bn(S,M,P,N){var V=N&&N.unsafe;V||v(S);var U=!V&&Re.find(S,M);if(!U){var X=S.FullPaths[0];M.slice(0,X.length)==X?X=M:(X.slice(-1)!="/"&&(X+="/"),X=(X+M).replace("//","/")),U={name:i(M),type:2},S.FileIndex.push(U),S.FullPaths.push(X),V||Re.utils.cfb_gc(S)}return U.content=P,U.size=P?P.length:0,N&&(N.CLSID&&(U.clsid=N.CLSID),N.mt&&(U.mt=N.mt),N.ct&&(U.ct=N.ct)),U}function $i(S,M){v(S);var P=Re.find(S,M);if(P){for(var N=0;N<S.FileIndex.length;++N)if(S.FileIndex[N]==P)return S.FileIndex.splice(N,1),S.FullPaths.splice(N,1),!0}return!1}function Hu(S,M,P){v(S);var N=Re.find(S,M);if(N){for(var V=0;V<S.FileIndex.length;++V)if(S.FileIndex[V]==N)return S.FileIndex[V].name=i(P),S.FullPaths[V]=P,!0}return!1}function zu(S){y(S,!0)}return e.find=k,e.read=O,e.parse=u,e.write=Ce,e.writeFile=ze,e.utils={cfb_new:Pc,cfb_add:Bn,cfb_del:$i,cfb_mov:Hu,cfb_gc:zu,ReadShift:wo,CheckField:cv,prep_blob:or,bconcat:Zt,use_zlib:B,_deflateRaw:Be,_inflateRaw:Ms,consts:de},e}();let xi;function ok(r){xi=r}function ck(r){return typeof r=="string"?wc(r):Array.isArray(r)?PI(r):r}function Tc(r,e,t){if(typeof xi<"u"&&xi.writeFileSync)return t?xi.writeFileSync(r,e,t):xi.writeFileSync(r,e);if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=wc(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?bn(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var i=new Blob([ck(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Bi(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function lk(r){if(typeof xi<"u")return xi.readFileSync(r);if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Nt(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function Bp(r,e){for(var t=[],n=Nt(r),i=0;i!==n.length;++i)t[r[n[i]][e]]==null&&(t[r[n[i]][e]]=n[i]);return t}function Fu(r){for(var e=[],t=Nt(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function Du(r){for(var e=[],t=Nt(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function uk(r){for(var e=[],t=Nt(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var Ql=new Date(1899,11,30,0,0,0);function Kt(r,e){var t=r.getTime(),n=Ql.getTime()+(r.getTimezoneOffset()-Ql.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var $x=new Date,fk=Ql.getTime()+($x.getTimezoneOffset()-Ql.getTimezoneOffset())*6e4,Up=$x.getTimezoneOffset();function Pu(r){var e=new Date;return e.setTime(r*24*60*60*1e3+fk),e.getTimezoneOffset()!==Up&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Up)*6e4),e}function hk(r){var e=0,t=0,n=!1,i=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(i[s],10)}return e}var Gp=new Date("2017-02-19T19:06:09.000Z"),jx=isNaN(Gp.getFullYear())?new Date("2/19/17"):Gp,dk=jx.getFullYear()==2017;function yt(r,e){var t=new Date(r);if(dk)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(jx.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ws(r,e){if(We&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return bn(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return bn(Dx(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return bn(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return bn(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function mt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=mt(r[t]));return e}function Ft(r,e){for(var t="";t.length<e;)t+=r;return t}function vn(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var mk=["january","february","march","april","may","june","july","august","september","october","november","december"];function ba(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&mk.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var pk=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function Kx(r){return r?r.content&&r.type?ws(r.content,!0):r.data?na(r.data):r.asNodeBuffer&&We?na(r.asNodeBuffer().toString("binary")):r.asBinary?na(r.asBinary()):r._data&&r._data.getContent?na(ws(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function qx(r){if(!r)return null;if(r.data)return jl(r.data);if(r.asNodeBuffer&&We)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?jl(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function gk(r){return r&&r.name.slice(-4)===".bin"?qx(r):Kx(r)}function sn(r,e){for(var t=r.FullPaths||Nt(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function Ph(r,e){var t=sn(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function zt(r,e,t){if(!t)return gk(Ph(r,e));if(!e)return null;try{return zt(r,e)}catch{return null}}function Hr(r,e,t){if(!t)return Kx(Ph(r,e));if(!e)return null;try{return Hr(r,e)}catch{return null}}function _k(r,e,t){return qx(Ph(r,e))}function Wp(r){for(var e=r.FullPaths||Nt(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Ue(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return We?n=ti(t):n=NI(t),Re.utils.cfb_add(r,e,n)}Re.utils.cfb_add(r,e,t)}else r.file(e,t)}function Nh(){return Re.utils.cfb_new()}function Xx(r,e){switch(e.type){case"base64":return Re.read(r,{type:"base64"});case"binary":return Re.read(r,{type:"binary"});case"buffer":case"array":return Re.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function mo(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var Ut=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xk=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Hp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,vk=/<[^>]*>/g,Tr=Ut.match(Hp)?Hp:vk,yk=/<\w*:/,wk=/<(\/?)\w+:/;function Ne(r,e,t){for(var n={},i=0,s=0;i!==r.length&&!((s=r.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=r.slice(0,i)),i===r.length)return n;var a=r.match(xk),o=0,c="",l=0,u="",h="",d=1;if(a)for(l=0;l!=a.length;++l){for(h=a[l],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,c=h.slice(s+1+d,h.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var m=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[m]&&u.slice(o-3,o)=="ext")continue;n[m]=c,n[m.toLowerCase()]=c}}return n}function Ln(r){return r.replace(wk,"<$1")}var Qx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Oh=Fu(Qx),Ze=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(r,function(o,c){return Qx[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,a)+t(i.slice(a+3))}}(),Lh=/[&<>'"]/g,Ek=/[\u0000-\u0008\u000b-\u001f]/g;function lt(r){var e=r+"";return e.replace(Lh,function(t){return Oh[t]}).replace(Ek,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function zp(r){return lt(r).replace(/ /g,"_x0020_")}var Yx=/[\u0000-\u001f]/g;function Mh(r){var e=r+"";return e.replace(Lh,function(t){return Oh[t]}).replace(/\n/g,"<br/>").replace(Yx,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Tk(r){var e=r+"";return e.replace(Lh,function(t){return Oh[t]}).replace(Yx,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var $p=function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}}();function Ak(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function xt(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function pf(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=r.charCodeAt(t++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function jp(r){var e=bi(2*r.length),t,n,i=1,s=0,a=0,o;for(n=0;n<r.length;n+=i)i=1,(o=r.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(n+1)&63),i=2):o<240?(t=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function Kp(r){return ti(r,"binary").toString("utf8")}var el="foo bar baz",ut=We&&(Kp(el)==pf(el)&&Kp||jp(el)==pf(el)&&jp)||pf,bn=We?function(r){return ti(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Xo=function(){var r={};return function(t,n){var i=t+"|"+(n||"");return r[i]?r[i]:r[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Jx=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}}(),Sk=function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Ik=/<\/?(?:vt:)?variant>/g,kk=/<(?:vt:)([^>]*)>([\s\S]*)</;function qp(r,e){var t=Ne(r),n=r.match(Sk(t.baseType))||[],i=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(s){var a=s.replace(Ik,"").match(kk);a&&i.push({v:ut(a[2]),t:a[1]})}),i}var Zx=/(^\s|\s$|\n)/;function lr(r,e){return"<"+r+(e.match(Zx)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function Qo(r){return Nt(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function _e(r,e,t){return"<"+r+(t!=null?Qo(t):"")+(e!=null?(e.match(Zx)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function l0(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function Ck(r,e){switch(typeof r){case"string":var t=_e("vt:lpwstr",lt(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return _e((r|0)==r?"vt:i4":"vt:r8",lt(String(r)));case"boolean":return _e("vt:bool",r?"true":"false")}if(r instanceof Date)return _e("vt:filetime",l0(r));throw new Error("Unable to serialize "+r)}function Vh(r){if(We&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return ut(Bi(Rh(r)));throw new Error("Bad input format: expected Buffer or string")}var Yo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,jt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Rs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Gr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bk(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,s=5;s>=0;--s)i=i*256+r[e+s];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function Rk(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(i&15)<<4|s&15,r[t+7]=i>>4|n}var Xp=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,s=r[0][n].length;i<s;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},Qp=We?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:ti(e)})):Xp(r)}:Xp,Yp=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(Kn(r,i)));return n.join("").replace(yr,"")},Nu=We?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(yr,""):Yp(r,e,t)}:Yp,Jp=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},ev=We?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):Jp(r,e,t)}:Jp,Zp=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(ta(r,i)));return n.join("")},Wa=We?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):Zp(e,t,n)}:Zp,tv=function(r,e){var t=Jt(r,e);return t>0?Wa(r,e+4,e+4+t-1):""},Bh=tv,rv=function(r,e){var t=Jt(r,e);return t>0?Wa(r,e+4,e+4+t-1):""},Uh=rv,nv=function(r,e){var t=2*Jt(r,e);return t>0?Wa(r,e+4,e+4+t-1):""},Gh=nv,iv=function(e,t){var n=Jt(e,t);return n>0?Nu(e,t+4,t+4+n):""},Wh=iv,sv=function(r,e){var t=Jt(r,e);return t>0?Wa(r,e+4,e+4+t):""},Hh=sv,av=function(r,e){return bk(r,e)},Yl=av,zh=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};We&&(Bh=function(e,t){if(!Buffer.isBuffer(e))return tv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Uh=function(e,t){if(!Buffer.isBuffer(e))return rv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Gh=function(e,t){if(!Buffer.isBuffer(e))return nv(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},Wh=function(e,t){if(!Buffer.isBuffer(e))return iv(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Hh=function(e,t){if(!Buffer.isBuffer(e))return sv(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Yl=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):av(e,t)},zh=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function ov(){Nu=function(r,e,t){return Ye.utils.decode(1200,r.slice(e,t)).replace(yr,"")},Wa=function(r,e,t){return Ye.utils.decode(65001,r.slice(e,t))},Bh=function(r,e){var t=Jt(r,e);return t>0?Ye.utils.decode(vs,r.slice(e+4,e+4+t-1)):""},Uh=function(r,e){var t=Jt(r,e);return t>0?Ye.utils.decode(jr,r.slice(e+4,e+4+t-1)):""},Gh=function(r,e){var t=2*Jt(r,e);return t>0?Ye.utils.decode(1200,r.slice(e+4,e+4+t-1)):""},Wh=function(r,e){var t=Jt(r,e);return t>0?Ye.utils.decode(1200,r.slice(e+4,e+4+t)):""},Hh=function(r,e){var t=Jt(r,e);return t>0?Ye.utils.decode(65001,r.slice(e+4,e+4+t)):""}}typeof Ye<"u"&&ov();var ta=function(r,e){return r[e]},Kn=function(r,e){return r[e+1]*256+r[e]},Fk=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},Jt=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},ns=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},Dk=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function wo(r,e){var t="",n,i,s=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,We&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)t+=String.fromCharCode(Kn(this,l)),l+=2;r*=2;break;case"utf8":t=Wa(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Nu(this,this.l,this.l+r);break;case"wstr":if(typeof Ye<"u")t=Ye.utils.decode(jr,this.slice(this.l,this.l+2*r));else return wo.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":t=Bh(this,this.l),r=4+Jt(this,this.l);break;case"lpstr-cp":t=Uh(this,this.l),r=4+Jt(this,this.l);break;case"lpwstr":t=Gh(this,this.l),r=4+2*Jt(this,this.l);break;case"lpp4":r=4+Jt(this,this.l),t=Wh(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Jt(this,this.l),t=Hh(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=ta(this,this.l+r++))!==0;)s.push(fo(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=Kn(this,this.l+r))!==0;)s.push(fo(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=ta(this,l),this.l=l+1,o=wo.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(fo(Kn(this,l))),l+=2}t=s.join(""),r*=2;break;case"cpstr":if(typeof Ye<"u"){t=Ye.utils.decode(jr,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(t="",l=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=ta(this,l),this.l=l+1,o=wo.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(fo(ta(this,l))),l+=1}t=s.join("");break;default:switch(r){case 1:return n=ta(this,this.l),this.l++,n;case 2:return n=(e==="i"?Fk:Kn)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(r>0?ns:Dk)(this,this.l),this.l+=4,n):(i=Jt(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=Yl(this,this.l):i=Yl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=ev(this,this.l,r);break}}return this.l+=r,t}var Pk=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},Nk=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},Ok=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function Lk(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)Ok(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){if(typeof Ye<"u"&&vs==874)for(i=0;i!=e.length;++i){var s=Ye.utils.encode(vs,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Pk(this,e,this.l);break;case 8:if(n=8,t==="f"){Rk(this,e,this.l);break}case 16:break;case-4:n=4,Nk(this,e,this.l);break}return this.l+=n,this}function cv(r,e){var t=ev(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function or(r,e){r.l=e,r.read_shift=wo,r.chk=cv,r.write_shift=Lk}function Er(r,e){r.l+=e}function ie(r){var e=bi(r);return or(e,0),e}function ri(r,e,t){if(r){var n,i,s;or(r,r.l||0);for(var a=r.length,o=0,c=0;r.l<a;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var l=nc[o]||nc[65535];for(n=r.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=r.read_shift(1))&127)<<7*i;c=r.l+s;var u=l.f&&l.f(r,s,t);if(r.l=c,e(u,l,o))return}}}function Lr(){var r=[],e=We?256:2048,t=function(l){var u=ie(l);return or(u,0),u},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(i(),n=t(Math.max(l+1,e)))},a=function(){return i(),Zt(r)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:r}}function ae(r,e,t,n){var i=+e,s;if(!isNaN(i)){n||(n=nc[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=r.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&zh(t)&&r.push(t)}}function Eo(r,e,t){var n=mt(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function eg(r,e,t){var n=mt(r);return n.s=Eo(n.s,e.s,t),n.e=Eo(n.e,e.s,t),n}function To(r,e){if(r.cRel&&r.c<0)for(r=mt(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=mt(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=Pe(r);return!r.cRel&&r.cRel!=null&&(t=Bk(t)),!r.rRel&&r.rRel!=null&&(t=Mk(t)),t}function gf(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+vt(r.s.c)+":"+(r.e.cRel?"":"$")+vt(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Dt(r.s.r)+":"+(r.e.rRel?"":"$")+Dt(r.e.r):To(r.s,e.biff)+":"+To(r.e,e.biff)}function $h(r){return parseInt(Vk(r),10)-1}function Dt(r){return""+(r+1)}function Mk(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Vk(r){return r.replace(/\$(\d+)$/,"$1")}function jh(r){for(var e=Uk(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function vt(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function Bk(r){return r.replace(/^([A-Z])/,"$$$1")}function Uk(r){return r.replace(/^\$([A-Z])/,"$1")}function Gk(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kt(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Pe(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function br(r){var e=r.indexOf(":");return e==-1?{s:kt(r),e:kt(r)}:{s:kt(r.slice(0,e)),e:kt(r.slice(e+1))}}function Ve(r,e){return typeof e>"u"||typeof e=="number"?Ve(r.s,r.e):(typeof r!="string"&&(r=Pe(r)),typeof e!="string"&&(e=Pe(e)),r==e?r:r+":"+e)}function qe(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=r.length;for(t=0;n<s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function tg(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Xr(r.z,t?Kt(e):e)}catch{}try{return r.w=Xr((r.XF||{}).numFmtId||(t?14:0),t?Kt(e):e)}catch{return""+e}}function Pn(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?ni[r.v]||r.v:e==null?tg(r,r.v):tg(r,e))}function Ui(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function lv(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,s=r||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?kt(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=qe(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),a==-1&&(l.e.r=a=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},g=a+h,p=o+d;if(l.s.r>g&&(l.s.r=g),l.s.c>p&&(l.s.c=p),l.e.r<g&&(l.e.r=g),l.e.c<p&&(l.e.c=p),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||De[14],n.cellDates?(m.t="d",m.w=Xr(m.z,Kt(m.v))):(m.t="n",m.v=Kt(m.v),m.w=Xr(m.z,m.v))):m.t="s";if(i)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(m.z=s[g][p].z),s[g][p]=m;else{var x=Pe({c:p,r:g});s[x]&&s[x].z&&(m.z=s[x].z),s[x]=m}}}return l.s.c<1e7&&(s["!ref"]=Ve(l)),s}function Ha(r,e){return lv(null,r,e)}function Wk(r){return r.read_shift(4,"i")}function yn(r,e){return e||(e=ie(4)),e.write_shift(4,r),e}function wr(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function er(r,e){var t=!1;return e==null&&(t=!0,e=ie(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function Hk(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function zk(r,e){return e||(e=ie(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Kh(r,e){var t=r.l,n=r.read_shift(1),i=wr(r),s=[],a={t:i,h:i};if(n&1){for(var o=r.read_shift(4),c=0;c!=o;++c)s.push(Hk(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}function $k(r,e){var t=!1;return e==null&&(t=!0,e=ie(15+4*r.t.length)),e.write_shift(1,0),er(r.t,e),t?e.slice(0,e.l):e}var jk=Kh;function Kk(r,e){var t=!1;return e==null&&(t=!0,e=ie(23+4*r.t.length)),e.write_shift(1,1),er(r.t,e),e.write_shift(4,1),zk({},e),t?e.slice(0,e.l):e}function hn(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Fs(r,e){return e==null&&(e=ie(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function Ds(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Ps(r,e){return e==null&&(e=ie(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var qk=wr,uv=er;function qh(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function Jl(r,e){var t=!1;return e==null&&(t=!0,e=ie(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var Xk=wr,u0=qh,Xh=Jl;function Qh(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?Yl([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ns(e,0)>>2;return t?i/100:i}function fv(r,e){e==null&&(e=ie(4));var t=0,n=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function hv(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function Qk(r,e){return e||(e=ie(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Ns=hv,za=Qk;function xr(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Es(r,e){return(e||ie(8)).write_shift(8,r,"f")}function Yk(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var l=ss[i];l&&(e.rgb=Zo(l));break;case 2:e.rgb=Zo([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Zl(r,e){if(e||(e=ie(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Jk(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Zk(r,e){e||(e=ie(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function dv(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function e4(r){return dv(r,1)}function t4(r){return dv(r,2)}var Yh=2,Fr=3,tl=11,rg=12,eu=19,rl=64,r4=65,n4=71,i4=4108,s4=4126,Yt=80,mv=81,a4=[Yt,mv],f0={1:{n:"CodePage",t:Yh},2:{n:"Category",t:Yt},3:{n:"PresentationFormat",t:Yt},4:{n:"ByteCount",t:Fr},5:{n:"LineCount",t:Fr},6:{n:"ParagraphCount",t:Fr},7:{n:"SlideCount",t:Fr},8:{n:"NoteCount",t:Fr},9:{n:"HiddenCount",t:Fr},10:{n:"MultimediaClipCount",t:Fr},11:{n:"ScaleCrop",t:tl},12:{n:"HeadingPairs",t:i4},13:{n:"TitlesOfParts",t:s4},14:{n:"Manager",t:Yt},15:{n:"Company",t:Yt},16:{n:"LinksUpToDate",t:tl},17:{n:"CharacterCount",t:Fr},19:{n:"SharedDoc",t:tl},22:{n:"HyperlinksChanged",t:tl},23:{n:"AppVersion",t:Fr,p:"version"},24:{n:"DigSig",t:r4},26:{n:"ContentType",t:Yt},27:{n:"ContentStatus",t:Yt},28:{n:"Language",t:Yt},29:{n:"Version",t:Yt},255:{},2147483648:{n:"Locale",t:eu},2147483651:{n:"Behavior",t:eu},1919054434:{}},h0={1:{n:"CodePage",t:Yh},2:{n:"Title",t:Yt},3:{n:"Subject",t:Yt},4:{n:"Author",t:Yt},5:{n:"Keywords",t:Yt},6:{n:"Comments",t:Yt},7:{n:"Template",t:Yt},8:{n:"LastAuthor",t:Yt},9:{n:"RevNumber",t:Yt},10:{n:"EditTime",t:rl},11:{n:"LastPrinted",t:rl},12:{n:"CreatedDate",t:rl},13:{n:"ModifiedDate",t:rl},14:{n:"PageCount",t:Fr},15:{n:"WordCount",t:Fr},16:{n:"CharCount",t:Fr},17:{n:"Thumbnail",t:n4},18:{n:"Application",t:Yt},19:{n:"DocSecurity",t:Fr},255:{},2147483648:{n:"Locale",t:eu},2147483651:{n:"Behavior",t:eu},1919054434:{}},ng={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},o4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function c4(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var l4=c4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ss=mt(l4),ni={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},pv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},d0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},nl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Jh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function u4(r){var e=Jh();if(!r||!r.match)return e;var t={};if((r.match(Tr)||[]).forEach(function(n){var i=Ne(n);switch(i[0].replace(yk,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":e[d0[i.ContentType]]!==void 0&&e[d0[i.ContentType]].push(i.PartName);break}}),e.xmlns!==jt.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function gv(r,e){var t=uk(d0),n=[],i;n[n.length]=Ut,n[n.length]=_e("Types",null,{xmlns:jt.CT,"xmlns:xsd":jt.xsd,"xmlns:xsi":jt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return _e("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){r[c]&&r[c].length>0&&(i=r[c][0],n[n.length]=_e("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:nl[c][e.bookType]||nl[c].xlsx}))},a=function(c){(r[c]||[]).forEach(function(l){n[n.length]=_e("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:nl[c][e.bookType]||nl[c].xlsx})})},o=function(c){(r[c]||[]).forEach(function(l){n[n.length]=_e("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var je={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Jo(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Ao(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(Tr)||[]).forEach(function(i){var s=Ne(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:mo(s.Target,e);t[o]=a,n[s.Id]=a}}),t["!id"]=n,t}function la(r){var e=[Ut,_e("Relationships",null,{xmlns:jt.RELS})];return Nt(r["!id"]).forEach(function(t){e[e.length]=_e("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ot(r,e,t,n,i,s){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=t,[je.HLINK,je.XPATH,je.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}var f4="application/vnd.oasis.opendocument.spreadsheet";function h4(r,e){for(var t=Vh(r),n,i;n=Yo.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ne(n[0],!1),i.path=="/"&&i.type!==f4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function d4(r){var e=[Ut];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function ig(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function m4(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function p4(r){var e=[Ut];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(ig(r[t][0],r[t][1])),e.push(m4("",r[t][0]));return e.push(ig("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function _v(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+jo.version+"</meta:generator></office:meta></office:document-meta>"}var cn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],g4=function(){for(var r=new Array(cn.length),e=0;e<cn.length;++e){var t=cn[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r}();function xv(r){var e={};r=ut(r);for(var t=0;t<cn.length;++t){var n=cn[t],i=r.match(g4[t]);i!=null&&i.length>0&&(e[n[1]]=Ze(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=yt(e[n[1]]))}return e}function _f(r,e,t,n,i){i[r]!=null||e==null||e===""||(i[r]=e,e=lt(e),n[n.length]=t?_e(r,e,t):lr(r,e))}function vv(r,e){var t=e||{},n=[Ut,_e("cp:coreProperties",null,{"xmlns:cp":jt.CORE_PROPS,"xmlns:dc":jt.dc,"xmlns:dcterms":jt.dcterms,"xmlns:dcmitype":jt.dcmitype,"xmlns:xsi":jt.xsi})],i={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&_f("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:l0(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),r.ModifiedDate!=null&&_f("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:l0(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=cn.length;++s){var a=cn[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&_f(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var as=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],yv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wv(r,e,t,n){var i=[];if(typeof r=="string")i=qp(r,n);else for(var s=0;s<r.length;++s)i=i.concat(r[s].map(function(u){return{v:u}}));var a=typeof e=="string"?qp(e,n).map(function(u){return u.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=c,t.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=a.slice(o,o+c);break}o+=c}}function _4(r,e,t){var n={};return e||(e={}),r=ut(r),as.forEach(function(i){var s=(r.match(Xo(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Ze(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=r.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wv(n.HeadingPairs,n.TitlesOfParts,e,t),e}function Ev(r){var e=[],t=_e;return r||(r={}),r.Application="SheetJS",e[e.length]=Ut,e[e.length]=_e("Properties",null,{xmlns:jt.EXT_PROPS,"xmlns:vt":jt.vt}),as.forEach(function(n){if(r[n[1]]!==void 0){var i;switch(n[2]){case"string":i=lt(String(r[n[1]]));break;case"bool":i=r[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(n[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+lt(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var x4=/<[^>]+>[^<]*/g;function v4(r,e){var t={},n="",i=r.match(x4);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Ne(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ze(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[n]=Ze(u);break;case"bool":t[n]=xt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(u);break;case"filetime":case"date":t[n]=yt(u);break;case"cy":case"error":t[n]=Ze(u);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}function Tv(r){var e=[Ut,_e("Properties",null,{xmlns:jt.CUST_PROPS,"xmlns:vt":jt.vt})];if(!r)return e.join("");var t=1;return Nt(r).forEach(function(i){++t,e[e.length]=_e("property",Ck(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:lt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var m0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},xf;function y4(r,e,t){xf||(xf=Fu(m0)),e=xf[e]||e,r[e]=t}function w4(r,e){var t=[];return Nt(m0).map(function(n){for(var i=0;i<cn.length;++i)if(cn[i][1]==n)return cn[i];for(i=0;i<as.length;++i)if(as[i][1]==n)return as[i];throw n}).forEach(function(n){if(r[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(lr(m0[n[1]]||n[1],i))}}),_e("DocumentProperties",t.join(""),{xmlns:Gr.o})}function E4(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return r&&Nt(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<cn.length;++a)if(s==cn[a][1])return;for(a=0;a<as.length;++a)if(s==as[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=r[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(_e(zp(s),o,{"dt:dt":c}))}}),e&&Nt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(_e(zp(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Gr.o+'">'+i.join("")+"</"+n+">"}function Zh(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function T4(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ie(8);return a.write_shift(4,n),a.write_shift(4,i),a}function Av(r,e,t){var n=r.l,i=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return i}function Sv(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function Iv(r,e,t){return e===31?Sv(r):Av(r,e,t)}function p0(r,e,t){return Iv(r,e,t===!1?0:4)}function A4(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Iv(r,e,0)}function S4(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var i=r.l;t[n]=r.read_shift(0,"lpwstr").replace(yr,""),r.l-i&2&&(r.l+=2)}return t}function I4(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(yr,"");return t}function k4(r){var e=r.l,t=tu(r,mv);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=tu(r,Fr);return[t,n]}function C4(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(k4(r));return t}function sg(r,e){for(var t=r.read_shift(4),n={},i=0;i!=t;++i){var s=r.read_shift(4),a=r.read_shift(4);n[s]=r.read_shift(a,e===1200?"utf16le":"utf8").replace(yr,"").replace(ho,"!"),e===1200&&a%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function kv(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function b4(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function tu(r,e,t){var n=r.read_shift(2),i,s=t||{};if(r.l+=2,e!==rg&&n!==e&&a4.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===rg?n:e){case 2:return i=r.read_shift(2,"i"),s.raw||(r.l+=2),i;case 3:return i=r.read_shift(4,"i"),i;case 11:return r.read_shift(4)!==0;case 19:return i=r.read_shift(4),i;case 30:return Av(r,n,4).replace(yr,"");case 31:return Sv(r);case 64:return Zh(r);case 65:return kv(r);case 71:return b4(r);case 80:return p0(r,n,!s.raw).replace(yr,"");case 81:return A4(r,n).replace(yr,"");case 4108:return C4(r);case 4126:case 4127:return n==4127?S4(r):I4(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function ag(r,e){var t=ie(4),n=ie(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=ie(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=T4(e);break;case 31:case 80:for(n=ie(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return Zt([t,n])}function og(r,e){var t=r.l,n=r.read_shift(4),i=r.read_shift(4),s=[],a=0,o=0,c=-1,l={};for(a=0;a!=i;++a){var u=r.read_shift(4),h=r.read_shift(4);s[a]=[u,h+t]}s.sort(function(C,w){return C[1]-w[1]});var d={};for(a=0;a!=i;++a){if(r.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:r.l+2===s[a][1]&&(r.l+=2,m=!1);break;case 80:r.l<=s[a][1]&&(r.l=s[a][1],m=!1);break;case 4108:r.l<=s[a][1]&&(r.l=s[a][1],m=!1);break}if((!e||a==0)&&r.l<=s[a][1]&&(m=!1,r.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+r.l+" :"+a)}if(e){var g=e[s[a][0]];if(d[g.n]=tu(r,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:on(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(s[a][0]===1){if(o=d.CodePage=tu(r,Yh),on(o),c!==-1){var p=r.l;r.l=s[c][1],l=sg(r,o),r.l=p}}else if(s[a][0]===0){if(o===0){c=a,r.l=s[a+1][1];continue}l=sg(r,o)}else{var x=l[s[a][0]],T;switch(r[r.l]){case 65:r.l+=4,T=kv(r);break;case 30:r.l+=4,T=p0(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,T=p0(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,T=r.read_shift(4,"i");break;case 19:r.l+=4,T=r.read_shift(4);break;case 5:r.l+=4,T=r.read_shift(8,"f");break;case 11:r.l+=4,T=Lt(r,4);break;case 64:r.l+=4,T=yt(Zh(r));break;default:throw new Error("unparsed value: "+r[r.l])}d[x]=T}}return r.l=t+n,d}var Cv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function R4(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function cg(r,e,t){var n=ie(8),i=[],s=[],a=8,o=0,c=ie(8),l=ie(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),i.push(l),a+=8+c.length,!e){l=ie(8),l.write_shift(4,0),i.unshift(l);var u=[ie(4)];for(u[0].write_shift(4,r.length),o=0;o<r.length;++o){var h=r[o][0];for(c=ie(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Zt(u),s.unshift(c),a+=8+c.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(Cv.indexOf(r[o][0])>-1||yv.indexOf(r[o][0])>-1)&&r[o][1]!=null){var d=r[o][1],m=0;if(e){m=+e[r[o][0]];var g=t[m];if(g.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}c=ag(g.t,d)}else{var x=R4(d);x==-1&&(x=31,d=String(d)),c=ag(x,d)}s.push(c),l=ie(8),l.write_shift(4,e?m:2+o),i.push(l),a+=8+c.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Zt([n].concat(i).concat(s))}function lg(r,e,t){var n=r.content;if(!n)return{};or(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),u=n.read_shift(16);if(u!==Re.utils.consts.HEADER_CLSID&&u!==t)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var h=og(n,e),d={SystemIdentifier:l};for(var m in h)d[m]=h[m];if(d.FMTID=s,i===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=og(n,null)}catch{}for(m in g)d[m]=g[m];return d.FMTID=[s,a],d}function ug(r,e,t,n,i,s){var a=ie(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Re.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var c=cg(r,t,n);if(o.push(c),i){var l=cg(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return Zt(o)}function ui(r,e){return r.read_shift(e),null}function F4(r,e){e||(e=ie(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function D4(r,e,t){for(var n=[],i=r.l+e;r.l<i;)n.push(t(r,i-r.l));if(i!==r.l)throw new Error("Slurp error");return n}function Lt(r,e){return r.read_shift(e)===1}function Ir(r,e){return e||(e=ie(2)),e.write_shift(2,+!!r),e}function $t(r){return r.read_shift(2,"u")}function an(r,e){return e||(e=ie(2)),e.write_shift(2,r),e}function bv(r,e){return D4(r,e,$t)}function P4(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function Rv(r,e,t){return t||(t=ie(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function Ac(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=jr;if(t&&t.biff>=8&&(jr=1200),!t||t.biff==8){var a=r.read_shift(1);a&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=n?r.read_shift(n,i):"";return jr=s,o}function N4(r){var e=jr;jr=1200;var t=r.read_shift(2),n=r.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,c,l={};s&&(o=r.read_shift(2)),i&&(c=r.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",h=t===0?"":r.read_shift(t,u);return s&&(r.l+=4*o),i&&(r.l+=c),l.t=h,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),jr=e,l}function O4(r){var e=r.t||"",t=ie(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=ie(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[t,n];return Zt(i)}function Ts(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function Sc(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):Ts(r,n,t)}function Os(r,e,t){if(t.biff>5)return Sc(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function Fv(r,e,t){return t||(t=ie(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function L4(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function M4(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var i=r.read_shift((n?e-24:e)>>1,"utf16le").replace(yr,"");return n&&(r.l+=24),i}function V4(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=r.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=r.read_shift(s>>1,"utf16le").replace(yr,"");return t+a}function B4(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return M4(r);case"0303000000000000c000000000000046":return V4(r);default:throw new Error("Unsupported Moniker "+t)}}function il(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(yr,""):"";return t}function fg(r,e){e||(e=ie(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function U4(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=r.read_shift(2);r.l+=2;var s,a,o,c,l="",u,h;i&16&&(s=il(r,t-r.l)),i&128&&(a=il(r,t-r.l)),(i&257)===257&&(o=il(r,t-r.l)),(i&257)===1&&(c=B4(r,t-r.l)),i&8&&(l=il(r,t-r.l)),i&32&&(u=r.read_shift(16)),i&64&&(h=Zh(r)),r.l=t;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return u&&(m.guid=u),h&&(m.time=h),s&&(m.Tooltip=s),m}function G4(r){var e=ie(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)n=n.slice(1),fg(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&fg(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),t=0;t<n.length-3*c;++t)e.write_shift(1,n.charCodeAt(t+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Dv(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),i=r.read_shift(1);return[e,t,n,i]}function Pv(r,e){var t=Dv(r);return t[3]=0,t}function Mn(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function As(r,e,t,n){return n||(n=ie(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function W4(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function H4(r,e,t){return e===0?"":Os(r,e,t)}function z4(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),s=r.read_shift(n,"i"),a=r.read_shift(n,"i");return[i,s,a]}function Nv(r){var e=r.read_shift(2),t=Qh(r);return[e,t]}function $4(r,e,t){r.l+=4,e-=4;var n=r.l+e,i=Ac(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,i}function Ou(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function Ov(r,e){return e||(e=ie(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function Lv(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),i=r.read_shift(1);return{s:{c:n,r:e},e:{c:i,r:t}}}var j4=Lv;function Mv(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function K4(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function q4(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function dr(r){r.l+=2,r.l+=r.read_shift(2)}var X4={0:dr,4:dr,5:dr,6:dr,7:q4,8:dr,9:dr,10:dr,11:dr,12:dr,13:K4,14:dr,15:dr,16:dr,17:dr,18:dr,19:dr,20:dr,21:Mv};function Q4(r,e){for(var t=r.l+e,n=[];r.l<t;){var i=r.read_shift(2);r.l-=2;try{n.push(X4[i](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function sl(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function ed(r,e,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ie(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Y4(r,e){return e===0||r.read_shift(2),1200}function J4(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,i=Os(r,0,t);return r.read_shift(e+n-r.l),i}function Z4(r,e){var t=!e||e.biff==8,n=ie(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function eC(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function tC(r,e,t){var n=r.read_shift(4),i=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Ac(r,0,t);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function rC(r,e){var t=!e||e.biff>=8?2:1,n=ie(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function nC(r,e){for(var t=r.l+e,n=r.read_shift(4),i=r.read_shift(4),s=[],a=0;a!=i&&r.l<t;++a)s.push(N4(r));return s.Count=n,s.Unique=i,s}function iC(r,e){var t=ie(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],i=0;i<r.length;++i)n[i]=O4(r[i]);var s=Zt([t].concat(n));return s.parts=[t.length].concat(n.map(function(a){return a.length})),s}function sC(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function aC(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function oC(r){var e=W4(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function cC(r){return r.read_shift(2),r.read_shift(4)}function hg(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var i=r.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function lC(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=r.read_shift(2),c=r.read_shift(2),l=r.read_shift(2);return{Pos:[e,t],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function uC(){var r=ie(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function fC(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function hC(r){var e=ie(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function dC(){}function mC(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=Ac(r,0,t),n}function pC(r,e){var t=r.name||"Arial",n=e&&e.biff==5,i=n?15+t.length:16+2*t.length,s=ie(i);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function gC(r){var e=Mn(r);return e.isst=r.read_shift(4),e}function _C(r,e,t,n){var i=ie(10);return As(r,e,n,i),i.write_shift(4,t),i}function xC(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,i=Mn(r);t.biff==2&&r.l++;var s=Sc(r,n-r.l,t);return i.val=s,i}function vC(r,e,t,n,i){var s=!i||i.biff==8,a=ie(8+ +s+(1+s)*t.length);return As(r,e,n,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function yC(r,e,t){var n=r.read_shift(2),i=Os(r,0,t);return[n,i]}function wC(r,e,t,n){var i=t&&t.biff==5;n||(n=ie(i?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var EC=Os;function dg(r,e,t){var n=r.l+e,i=t.biff==8||!t.biff?4:2,s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(2),c=r.read_shift(2);return r.l=n,{s:{r:s,c:o},e:{r:a,c}}}function TC(r,e){var t=e.biff==8||!e.biff?4:2,n=ie(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function AC(r){var e=r.read_shift(2),t=r.read_shift(2),n=Nv(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function SC(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(Nv(r));if(r.l!==t)throw new Error("MulRK read error");var a=r.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function IC(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var a=r.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function kC(r,e,t,n){var i={},s=r.read_shift(4),a=r.read_shift(4),o=r.read_shift(4),c=r.read_shift(2);return i.patternType=o4[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function CC(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=kC(r,e,n.fStyle,t),n}function mg(r,e,t,n){var i=t&&t.biff==5;n||(n=ie(i?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function bC(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function RC(r){var e=ie(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function pg(r,e,t){var n=Mn(r);(t.biff==2||e==9)&&++r.l;var i=P4(r);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function FC(r,e,t,n,i,s){var a=ie(8);return As(r,e,n,a),Rv(t,s,a),a}function DC(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Mn(r),i=xr(r);return n.val=i,n}function PC(r,e,t,n){var i=ie(14);return As(r,e,n,i),Es(t,i),i}var gg=H4;function NC(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ts(r,s),o=[];n>r.l;)o.push(Sc(r));return[s,i,a,o]}function _g(r,e,t){var n=r.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=$4(r,e-2,t)),s.body=i||r.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var OC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function xg(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(1),a=r.read_shift(1),o=r.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),c=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var l=Ts(r,a,t);i&32&&(l=OC[l.charCodeAt(0)]);var u=n-r.l;t&&t.biff==2&&--u;var h=n==r.l||o===0||!(u>0)?[]:QD(r,u,t,o);return{chKey:s,Name:l,itab:c,rgce:h}}function Vv(r,e,t){if(t.biff<8)return LC(r,e,t);for(var n=[],i=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(z4(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function LC(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=Ac(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function MC(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),i=r.read_shift(2),s=Ts(r,n,t),a=Ts(r,i,t);return[s,a]}function VC(r,e,t){var n=Lv(r);r.l++;var i=r.read_shift(1);return e-=8,[YD(r,e,t),i,n]}function vg(r,e,t){var n=j4(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,qD(r,e,t)]}function BC(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function UC(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=Os(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:i},o,a,s]}}function GC(r,e,t){return UC(r,e,t)}function WC(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(Ou(r));return t}function HC(r){var e=ie(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)Ov(r[t],e);return e}function zC(r,e,t){if(t&&t.biff<8)return jC(r,e,t);var n=Mv(r),i=Q4(r,e-22,n[1]);return{cmo:n,ft:i}}var $C={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var i=r.read_shift(1);return r.l+=i,r.l=t,{fmt:n}}};function jC(r,e,t){r.l+=4;var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var a=[];return a.push(($C[n]||Er)(r,e,t)),{cmo:[i,n,s],ft:a}}function KC(r,e,t){var n=r.l,i="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:a=L4(r,6,t);var o=r.read_shift(2);r.read_shift(2),$t(r,2);var c=r.read_shift(2);r.l+=c;for(var l=1;l<r.lens.length-1;++l){if(r.l-n!=r.lens[l])throw new Error("TxO: bad continue record");var u=r[r.l],h=Ts(r,r.lens[l+1]-r.lens[l]-1);if(i+=h,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return r.l=n+e,{t:i}}catch{return r.l=n+e,{t:i}}}function qC(r,e){var t=Ou(r);r.l+=16;var n=U4(r,e-24);return[t,n]}function XC(r){var e=ie(24),t=kt(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Zt([e,G4(r[1])])}function QC(r,e){r.read_shift(2);var t=Ou(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(yr,""),[t,n]}function YC(r){var e=r[1].Tooltip,t=ie(10+2*(e.length+1));t.write_shift(2,2048);var n=kt(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function JC(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=ng[t]||t,t=r.read_shift(2),e[1]=ng[t]||t,e}function ZC(r){return r||(r=ie(4)),r.write_shift(2,1),r.write_shift(2,1),r}function eb(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(Pv(r));return t}function tb(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(Pv(r));return t}function rb(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function Bv(r,e,t){if(!t.cellStyles)return Er(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),s=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(n),c=r.read_shift(2);n==2&&(r.l+=2);var l={s:i,e:s,w:a,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function nb(r,e){var t=ie(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function ib(r,e){var t={};return e<32||(r.l+=16,t.header=xr(r),t.footer=xr(r),r.l+=2),t}function sb(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var i=r.read_shift(1);return r.l+=3,i&16&&(n.area=!0),n}function ab(r){for(var e=ie(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var ob=Mn,cb=bv,lb=Sc;function ub(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,i}function fb(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Mn(r);++r.l;var i=Os(r,e-7,t);return n.t="str",n.val=i,n}function hb(r){var e=Mn(r);++r.l;var t=xr(r);return e.t="n",e.val=t,e}function db(r,e,t){var n=ie(15);return bc(n,r,e),n.write_shift(8,t,"f"),n}function mb(r){var e=Mn(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function pb(r,e,t){var n=ie(9);return bc(n,r,e),n.write_shift(2,t),n}function gb(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function _b(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function xb(r,e,t){var n=r.l+e,i=Mn(r),s=r.read_shift(2),a=Ts(r,s,t);return r.l=n,i.t="str",i.val=a,i}var vb=[2,3,48,49,131,139,140,245],g0=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Fu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],u=bi(1);switch(c.type){case"base64":u=Wr(qr(o));break;case"binary":u=Wr(o);break;case"buffer":case"array":u=o;break}or(u,0);var h=u.read_shift(1),d=!!(h&136),m=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,x=521;h==2&&(p=u.read_shift(2)),u.l+=3,h!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(x=u.read_shift(2));var T=u.read_shift(2),C=c.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(C=r[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var w=[],F={},L=Math.min(u.length,h==2?521:x-10-(m?264:0)),O=g?32:11;u.l<L&&u[u.l]!=13;)switch(F={},F.name=Ye.utils.decode(C,u.slice(u.l,u.l+O)).replace(/[\u0000\r\n].*$/g,""),u.l+=O,F.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(F.offset=u.read_shift(4)),F.len=u.read_shift(1),h==2&&(F.offset=u.read_shift(2)),F.dec=u.read_shift(1),F.name.length&&w.push(F),h!=2&&(u.l+=g?13:14),F.type){case"B":(!m||F.len!=8)&&c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var v=0,A=0;for(l[0]=[],A=0;A!=w.length;++A)l[0][A]=w[A].name;for(;p-- >0;){if(u[u.l]===42){u.l+=T;continue}for(++u.l,l[++v]=[],A=0,A=0;A!=w.length;++A){var y=u.slice(u.l,u.l+w[A].len);u.l+=w[A].len,or(y,0);var I=Ye.utils.decode(C,y);switch(w[A].type){case"C":I.trim().length&&(l[v][A]=I.replace(/\s+$/,""));break;case"D":I.length===8?l[v][A]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):l[v][A]=I;break;case"F":l[v][A]=parseFloat(I.trim());break;case"+":case"I":l[v][A]=g?y.read_shift(-4,"i")^2147483648:y.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":l[v][A]=!0;break;case"N":case"F":l[v][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[v][A]="##MEMO##"+(g?parseInt(I.trim(),10):y.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(l[v][A]=+I||0);break;case"@":l[v][A]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":l[v][A]=new Date((y.read_shift(4)-2440588)*864e5+y.read_shift(4));break;case"Y":l[v][A]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[v][A]=-y.read_shift(-8,"f");break;case"B":if(m&&w[A].len==8){l[v][A]=y.read_shift(8,"f");break}case"G":case"P":y.l+=w[A].len;break;case"0":if(w[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[A].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=w,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var u=Ha(t(o,l),l);return u["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,u}function i(o,c){try{return Ui(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&on(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var u=Lr(),h=iu(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),g=o["!cols"]||[],p=0,x=0,T=0,C=1;for(p=0;p<d.length;++p){if(((g[p]||{}).DBF||{}).name){d[p]=g[p].DBF.name,++T;continue}if(d[p]!=null){if(++T,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(x=0;x<1024;++x)if(d.indexOf(d[p]+"_"+x)==-1){d[p]+="_"+x;break}}}}var w=qe(o["!ref"]),F=[],L=[],O=[];for(p=0;p<=w.e.c-w.s.c;++p){var v="",A="",y=0,I=[];for(x=0;x<m.length;++x)m[x][p]!=null&&I.push(m[x][p]);if(I.length==0||d[p]==null){F[p]="?";continue}for(x=0;x<I.length;++x){switch(typeof I[x]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=I[x]instanceof Date?"D":"C";break;default:A="C"}y=Math.max(y,String(I[x]).length),v=v&&v!=A?"C":A}y>250&&(y=250),A=((g[p]||{}).DBF||{}).type,A=="C"&&g[p].DBF.len>y&&(y=g[p].DBF.len),v=="B"&&A=="N"&&(v="N",O[p]=g[p].DBF.dec,y=g[p].DBF.len),L[p]=v=="C"||A=="N"?y:s[v]||0,C+=L[p],F[p]=v}var k=u.next(32);for(k.write_shift(4,318902576),k.write_shift(4,m.length),k.write_shift(2,296+32*T),k.write_shift(2,C),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+e[vs]||3)<<8),p=0,x=0;p<d.length;++p)if(d[p]!=null){var b=u.next(32),R=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,R,"sbcs"),b.write_shift(1,F[p]=="?"?"C":F[p],"sbcs"),b.write_shift(4,x),b.write_shift(1,L[p]||s[F[p]]||0),b.write_shift(1,O[p]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),x+=L[p]||s[F[p]]||0}var K=u.next(264);for(K.write_shift(4,13),p=0;p<65;++p)K.write_shift(4,0);for(p=0;p<m.length;++p){var Z=u.next(C);for(Z.write_shift(1,0),x=0;x<d.length;++x)if(d[x]!=null)switch(F[x]){case"L":Z.write_shift(1,m[p][x]==null?63:m[p][x]?84:70);break;case"B":Z.write_shift(8,m[p][x]||0,"f");break;case"N":var ge="0";for(typeof m[p][x]=="number"&&(ge=m[p][x].toFixed(O[x]||0)),T=0;T<L[x]-ge.length;++T)Z.write_shift(1,32);Z.write_shift(1,ge,"sbcs");break;case"D":m[p][x]?(Z.write_shift(4,("0000"+m[p][x].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(m[p][x].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+m[p][x].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var de=String(m[p][x]!=null?m[p][x]:"").slice(0,L[x]);for(Z.write_shift(1,de,"sbcs"),T=0;T<L[x]-de.length;++T)Z.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),Uv=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Nt(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,m){var g=r[m];return typeof g=="number"?c0(g):g},n=function(d,m,g){var p=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?d:c0(p)};r["|"]=254;function i(d,m){switch(m.type){case"base64":return s(qr(d),m);case"binary":return s(d,m);case"buffer":return s(We&&Buffer.isBuffer(d)?d.toString("binary"):Bi(d),m);case"array":return s(ws(d),m)}throw new Error("Unrecognized type "+m.type)}function s(d,m){var g=d.split(/[\n\r]+/),p=-1,x=-1,T=0,C=0,w=[],F=[],L=null,O={},v=[],A=[],y=[],I=0,k;for(+m.codepage>=0&&on(+m.codepage);T!==g.length;++T){I=0;var b=g[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),R=b.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),K=R[0],Z;if(b.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&F.push(b.slice(3).replace(/;;/g,";"));break;case"C":var ge=!1,de=!1,ze=!1,Y=!1,Ce=-1,Fe=-1;for(C=1;C<R.length;++C)switch(R[C].charAt(0)){case"A":break;case"X":x=parseInt(R[C].slice(1))-1,de=!0;break;case"Y":for(p=parseInt(R[C].slice(1))-1,de||(x=0),k=w.length;k<=p;++k)w[k]=[];break;case"K":Z=R[C].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(vn(Z))?isNaN(ba(Z).getDate())||(Z=yt(Z)):(Z=vn(Z),L!==null&&bs(L)&&(Z=Pu(Z))),typeof Ye<"u"&&typeof Z=="string"&&(m||{}).type!="string"&&(m||{}).codepage&&(Z=Ye.utils.decode(m.codepage,Z)),ge=!0;break;case"E":Y=!0;var B=ua(R[C].slice(1),{r:p,c:x});w[p][x]=[w[p][x],B];break;case"S":ze=!0,w[p][x]=[w[p][x],"S5S"];break;case"G":break;case"R":Ce=parseInt(R[C].slice(1))-1;break;case"C":Fe=parseInt(R[C].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+b)}if(ge&&(w[p][x]&&w[p][x].length==2?w[p][x][0]=Z:w[p][x]=Z,L=null),ze){if(Y)throw new Error("SYLK shared formula cannot have own formula");var z=Ce>-1&&w[Ce][Fe];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");w[p][x][1]=iy(z[1],{r:p-Ce,c:x-Fe})}break;case"F":var W=0;for(C=1;C<R.length;++C)switch(R[C].charAt(0)){case"X":x=parseInt(R[C].slice(1))-1,++W;break;case"Y":for(p=parseInt(R[C].slice(1))-1,k=w.length;k<=p;++k)w[k]=[];break;case"M":I=parseInt(R[C].slice(1))/20;break;case"F":break;case"G":break;case"P":L=F[parseInt(R[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(y=R[C].slice(1).split(" "),k=parseInt(y[0],10);k<=parseInt(y[1],10);++k)I=parseInt(y[2],10),A[k-1]=I===0?{hidden:!0}:{wch:I},Ri(A[k-1]);break;case"C":x=parseInt(R[C].slice(1))-1,A[x]||(A[x]={});break;case"R":p=parseInt(R[C].slice(1))-1,v[p]||(v[p]={}),I>0?(v[p].hpt=I,v[p].hpx=Fa(I)):I===0&&(v[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+b)}W<1&&(L=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+b)}}return v.length>0&&(O["!rows"]=v),A.length>0&&(O["!cols"]=A),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,O]}function a(d,m){var g=i(d,m),p=g[0],x=g[1],T=Ha(p,m);return Nt(x).forEach(function(C){T[C]=x[C]}),T}function o(d,m){return Ui(a(d,m),m)}function c(d,m,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(d.t){case"n":x+=d.v||0,d.f&&!d.F&&(x+=";E"+ad(d.f,{r:g,c:p}));break;case"b":x+=d.v?"TRUE":"FALSE";break;case"e":x+=d.w||d.v;break;case"d":x+='"'+(d.w||d.v)+'"';break;case"s":x+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function l(d,m){m.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=ec(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=tc(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&d.push(x)})}function u(d,m){m.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*rc(g.hpx)+";"),x.length>2&&d.push(x+"R"+(p+1))})}function h(d,m){var g=["ID;PWXL;N;E"],p=[],x=qe(d["!ref"]),T,C=Array.isArray(d),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&l(g,d["!cols"]),d["!rows"]&&u(g,d["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var F=x.s.r;F<=x.e.r;++F)for(var L=x.s.c;L<=x.e.c;++L){var O=Pe({r:F,c:L});T=C?(d[F]||[])[L]:d[O],!(!T||T.v==null&&(!T.f||T.F))&&p.push(c(T,d,F,L))}return g.join(w)+w+p.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),Gv=function(){function r(s,a){switch(a.type){case"base64":return e(qr(s),a);case"binary":return e(s,a);case"buffer":return e(We&&Buffer.isBuffer(s)?s.toString("binary"):Bi(s),a);case"array":return e(ws(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,l=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++c]=[],l=0;continue}if(!(c<0)){var d=o[u].trim().split(","),m=d[0],g=d[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+m){case-1:if(p==="BOT"){h[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[c][l]=!0:p==="FALSE"?h[c][l]=!1:isNaN(vn(g))?isNaN(ba(g).getDate())?h[c][l]=g:h[c][l]=yt(g):h[c][l]=vn(g),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function t(s,a){return Ha(r(s,a),a)}function n(s,a){return Ui(t(s,a),a)}var i=function(){var s=function(c,l,u,h,d){c.push(l),c.push(u+","+h),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,u,h){c.push(l+","+u),c.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var l=[],u=qe(c["!ref"]),h,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,u.e.r-u.s.r+1,""),s(l,"TUPLES",0,u.e.c-u.s.c+1,""),s(l,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){a(l,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=Pe({r:m,c:g});if(h=d?(c[m]||[])[g]:c[p],!h){a(l,1,0,"");continue}switch(h.t){case"n":var x=h.w;!x&&h.v!=null&&(x=h.v),x==null?h.f&&!h.F?a(l,1,0,"="+h.f):a(l,1,0,""):a(l,0,x,"V");break;case"b":a(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Xr(h.z||De[14],Kt(yt(h.v)))),a(l,0,h.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var T=`\r
`,C=l.join(T);return C}}();return{to_workbook:n,to_sheet:t,from_sheet:i}}(),Wv=function(){function r(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(h,d){for(var m=h.split(`
`),g=-1,p=-1,x=0,T=[];x!==m.length;++x){var C=m[x].trim().split(":");if(C[0]==="cell"){var w=kt(C[1]);if(T.length<=w.r)for(g=T.length;g<=w.r;++g)T[g]||(T[g]=[]);switch(g=w.r,p=w.c,C[2]){case"t":T[g][p]=r(C[3]);break;case"v":T[g][p]=+C[3];break;case"vtf":var F=C[C.length-1];case"vtc":switch(C[3]){case"nl":T[g][p]=!!+C[4];break;default:T[g][p]=+C[4];break}C[2]=="vtf"&&(T[g][p]=[T[g][p],F])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return Ha(t(h,d),d)}function i(h,d){return Ui(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],g,p="",x=br(h["!ref"]),T=Array.isArray(h),C=x.s.r;C<=x.e.r;++C)for(var w=x.s.c;w<=x.e.c;++w)if(p=Pe({r:C,c:w}),g=T?(h[C]||[])[w]:h[p],!(!g||g.v==null||g.t==="z")){switch(m=["cell",p,"t"],g.t){case"s":case"str":m.push(e(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=e(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var F=Kt(yt(g.v));m[2]="vtc",m[3]="nd",m[4]=""+F,m[5]=g.w||Xr(g.z||De[14],F);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[s,a,o,a,l(h),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),Ra=function(){function r(u,h,d,m,g){g.raw?h[d][m]=u:u===""||(u==="TRUE"?h[d][m]=!0:u==="FALSE"?h[d][m]=!1:isNaN(vn(u))?isNaN(ba(u).getDate())?h[d][m]=u:h[d][m]=yt(u):h[d][m]=vn(u))}function e(u,h){var d=h||{},m=[];if(!u||u.length===0)return m;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,T=0,C=0;C<=p;++C)T=g[C].indexOf(" "),T==-1?T=g[C].length:T++,x=Math.max(x,T);for(C=0;C<=p;++C){m[C]=[];var w=0;for(r(g[C].slice(0,x).trim(),m,C,w,d),w=1;w<=(g[C].length-x)/10+1;++w)r(g[C].slice(x+(w-1)*10,x+w*10).trim(),m,C,w,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},d=!1,m=0,g=0;m<u.length;++m)(g=u.charCodeAt(m))==34?d=!d:!d&&g in t&&(h[g]=(h[g]||0)+1);g=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m]);if(!g.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m])}return g.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),t[g.pop()[1]]||44}function s(u,h){var d=h||{},m="",g=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=i(u.slice(0,1024)):d&&d.FS?m=d.FS:m=i(u.slice(0,1024));var x=0,T=0,C=0,w=0,F=0,L=m.charCodeAt(0),O=!1,v=0,A=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var y=d.dateNF!=null?ik(d.dateNF):null;function I(){var k=u.slice(w,F),b={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)b.t="z";else if(d.raw)b.t="s",b.v=k;else if(k.trim().length===0)b.t="s",b.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(b.t="s",b.v=k.slice(2,-1).replace(/""/g,'"')):NF(k)?(b.t="n",b.f=k.slice(1)):(b.t="s",b.v=k);else if(k=="TRUE")b.t="b",b.v=!0;else if(k=="FALSE")b.t="b",b.v=!1;else if(!isNaN(C=vn(k)))b.t="n",d.cellText!==!1&&(b.w=k),b.v=C;else if(!isNaN(ba(k).getDate())||y&&k.match(y)){b.z=d.dateNF||De[14];var R=0;y&&k.match(y)&&(k=sk(k,d.dateNF,k.match(y)||[]),R=1),d.cellDates?(b.t="d",b.v=yt(k,R)):(b.t="n",b.v=Kt(yt(k,R))),d.cellText!==!1&&(b.w=Xr(b.z,b.v instanceof Date?Kt(b.v):b.v)),d.cellNF||delete b.z}else b.t="s",b.v=k;if(b.t=="z"||(d.dense?(g[x]||(g[x]=[]),g[x][T]=b):g[Pe({c:T,r:x})]=b),w=F+1,A=u.charCodeAt(w),p.e.c<T&&(p.e.c=T),p.e.r<x&&(p.e.r=x),v==L)++T;else if(T=0,++x,d.sheetRows&&d.sheetRows<=x)return!0}e:for(;F<u.length;++F)switch(v=u.charCodeAt(F)){case 34:A===34&&(O=!O);break;case L:case 10:case 13:if(!O&&I())break e;break}return F-w>0&&I(),g["!ref"]=Ve(p),g}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):Ha(e(u,h),h)}function o(u,h){var d="",m=h.type=="string"?[0,0,0,0]:pd(u,h);switch(h.type){case"base64":d=qr(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof Ye<"u"?d=Ye.utils.decode(h.codepage,u):d=We&&Buffer.isBuffer(u)?u.toString("binary"):Bi(u);break;case"array":d=ws(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=ut(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=ut(d):h.type=="binary"&&typeof Ye<"u"&&h.codepage&&(d=Ye.utils.decode(h.codepage,Ye.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?Wv.to_sheet(h.type=="string"?d:ut(d),h):a(d,h)}function c(u,h){return Ui(o(u,h),h)}function l(u){for(var h=[],d=qe(u["!ref"]),m,g=Array.isArray(u),p=d.s.r;p<=d.e.r;++p){for(var x=[],T=d.s.c;T<=d.e.c;++T){var C=Pe({r:p,c:T});if(m=g?(u[p]||[])[T]:u[C],!m||m.v==null){x.push("          ");continue}for(var w=(m.w||(Pn(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";x.push(w+(T===0?" ":""))}h.push(x.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function yb(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var i=Uv.to_workbook(r,t);return t.WTF=n,i}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ra.to_workbook(r,e)}}var os=function(){function r(B,z,W){if(B){or(B,B.l||0);for(var H=W.Enum||Ce;B.l<B.length;){var se=B.read_shift(2),he=H[se]||H[65535],me=B.read_shift(2),le=B.l+me,oe=he.f&&he.f(B,me,W);if(B.l=le,z(oe,he,se))return}}}function e(B,z){switch(z.type){case"base64":return t(Wr(qr(B)),z);case"binary":return t(Wr(B),z);case"buffer":case"array":return t(B,z)}throw"Unsupported type "+z.type}function t(B,z){if(!B)return B;var W=z||{},H=W.dense?[]:{},se="Sheet1",he="",me=0,le={},oe=[],Oe=[],G={s:{r:0,c:0},e:{r:0,c:0}},it=W.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)W.Enum=Ce,r(B,function(Ee,At,Ar){switch(Ar){case 0:W.vers=Ee,Ee>=4096&&(W.qpro=!0);break;case 6:G=Ee;break;case 204:Ee&&(he=Ee);break;case 222:he=Ee;break;case 15:case 51:W.qpro||(Ee[1].v=Ee[1].v.slice(1));case 13:case 14:case 16:Ar==14&&(Ee[2]&112)==112&&(Ee[2]&15)>1&&(Ee[2]&15)<15&&(Ee[1].z=W.dateNF||De[14],W.cellDates&&(Ee[1].t="d",Ee[1].v=Pu(Ee[1].v))),W.qpro&&Ee[3]>me&&(H["!ref"]=Ve(G),le[se]=H,oe.push(se),H=W.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},me=Ee[3],se=he||"Sheet"+(me+1),he="");var Rr=W.dense?(H[Ee[0].r]||[])[Ee[0].c]:H[Pe(Ee[0])];if(Rr){Rr.t=Ee[1].t,Rr.v=Ee[1].v,Ee[1].z!=null&&(Rr.z=Ee[1].z),Ee[1].f!=null&&(Rr.f=Ee[1].f);break}W.dense?(H[Ee[0].r]||(H[Ee[0].r]=[]),H[Ee[0].r][Ee[0].c]=Ee[1]):H[Pe(Ee[0])]=Ee[1];break}},W);else if(B[2]==26||B[2]==14)W.Enum=Fe,B[2]==14&&(W.qpro=!0,B.l=0),r(B,function(Ee,At,Ar){switch(Ar){case 204:se=Ee;break;case 22:Ee[1].v=Ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ee[3]>me&&(H["!ref"]=Ve(G),le[se]=H,oe.push(se),H=W.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},me=Ee[3],se="Sheet"+(me+1)),it>0&&Ee[0].r>=it)break;W.dense?(H[Ee[0].r]||(H[Ee[0].r]=[]),H[Ee[0].r][Ee[0].c]=Ee[1]):H[Pe(Ee[0])]=Ee[1],G.e.c<Ee[0].c&&(G.e.c=Ee[0].c),G.e.r<Ee[0].r&&(G.e.r=Ee[0].r);break;case 27:Ee[14e3]&&(Oe[Ee[14e3][0]]=Ee[14e3][1]);break;case 1537:Oe[Ee[0]]=Ee[1],Ee[0]==me&&(se=Ee[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(H["!ref"]=Ve(G),le[he||se]=H,oe.push(he||se),!Oe.length)return{SheetNames:oe,Sheets:le};for(var $e={},nt=[],Ge=0;Ge<Oe.length;++Ge)le[oe[Ge]]?(nt.push(Oe[Ge]||oe[Ge]),$e[Oe[Ge]]=le[Oe[Ge]]||le[oe[Ge]]):(nt.push(Oe[Ge]),$e[Oe[Ge]]={"!ref":"A1"});return{SheetNames:nt,Sheets:$e}}function n(B,z){var W=z||{};if(+W.codepage>=0&&on(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Lr(),se=qe(B["!ref"]),he=Array.isArray(B),me=[];xe(H,0,s(1030)),xe(H,6,c(se));for(var le=Math.min(se.e.r,8191),oe=se.s.r;oe<=le;++oe)for(var Oe=Dt(oe),G=se.s.c;G<=se.e.c;++G){oe===se.s.r&&(me[G]=vt(G));var it=me[G]+Oe,$e=he?(B[oe]||[])[G]:B[it];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?xe(H,13,m(oe,G,$e.v)):xe(H,14,p(oe,G,$e.v));else{var nt=Pn($e);xe(H,15,h(oe,G,nt.slice(0,239)))}}return xe(H,1),H.end()}function i(B,z){var W=z||{};if(+W.codepage>=0&&on(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Lr();xe(H,0,a(B));for(var se=0,he=0;se<B.SheetNames.length;++se)(B.Sheets[B.SheetNames[se]]||{})["!ref"]&&xe(H,27,Y(B.SheetNames[se],he++));var me=0;for(se=0;se<B.SheetNames.length;++se){var le=B.Sheets[B.SheetNames[se]];if(!(!le||!le["!ref"])){for(var oe=qe(le["!ref"]),Oe=Array.isArray(le),G=[],it=Math.min(oe.e.r,8191),$e=oe.s.r;$e<=it;++$e)for(var nt=Dt($e),Ge=oe.s.c;Ge<=oe.e.c;++Ge){$e===oe.s.r&&(G[Ge]=vt(Ge));var Ee=G[Ge]+nt,At=Oe?(le[$e]||[])[Ge]:le[Ee];if(!(!At||At.t=="z"))if(At.t=="n")xe(H,23,I($e,Ge,me,At.v));else{var Ar=Pn(At);xe(H,22,v($e,Ge,me,Ar.slice(0,239)))}}++me}}return xe(H,1),H.end()}function s(B){var z=ie(2);return z.write_shift(2,B),z}function a(B){var z=ie(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var W=0,H=0,se=0,he=0;he<B.SheetNames.length;++he){var me=B.SheetNames[he],le=B.Sheets[me];if(!(!le||!le["!ref"])){++se;var oe=br(le["!ref"]);W<oe.e.r&&(W=oe.e.r),H<oe.e.c&&(H=oe.e.c)}}return W>8191&&(W=8191),z.write_shift(2,W),z.write_shift(1,se),z.write_shift(1,H),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(B,z,W){var H={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&W.qpro?(H.s.c=B.read_shift(1),B.l++,H.s.r=B.read_shift(2),H.e.c=B.read_shift(1),B.l++,H.e.r=B.read_shift(2),H):(H.s.c=B.read_shift(2),H.s.r=B.read_shift(2),z==12&&W.qpro&&(B.l+=2),H.e.c=B.read_shift(2),H.e.r=B.read_shift(2),z==12&&W.qpro&&(B.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(B){var z=ie(8);return z.write_shift(2,B.s.c),z.write_shift(2,B.s.r),z.write_shift(2,B.e.c),z.write_shift(2,B.e.r),z}function l(B,z,W){var H=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(H[0].c=B.read_shift(1),H[3]=B.read_shift(1),H[0].r=B.read_shift(2),B.l+=2):(H[2]=B.read_shift(1),H[0].c=B.read_shift(2),H[0].r=B.read_shift(2)),H}function u(B,z,W){var H=B.l+z,se=l(B,z,W);if(se[1].t="s",W.vers==20768){B.l++;var he=B.read_shift(1);return se[1].v=B.read_shift(he,"utf8"),se}return W.qpro&&B.l++,se[1].v=B.read_shift(H-B.l,"cstr"),se}function h(B,z,W){var H=ie(7+W.length);H.write_shift(1,255),H.write_shift(2,z),H.write_shift(2,B),H.write_shift(1,39);for(var se=0;se<H.length;++se){var he=W.charCodeAt(se);H.write_shift(1,he>=128?95:he)}return H.write_shift(1,0),H}function d(B,z,W){var H=l(B,z,W);return H[1].v=B.read_shift(2,"i"),H}function m(B,z,W){var H=ie(7);return H.write_shift(1,255),H.write_shift(2,z),H.write_shift(2,B),H.write_shift(2,W,"i"),H}function g(B,z,W){var H=l(B,z,W);return H[1].v=B.read_shift(8,"f"),H}function p(B,z,W){var H=ie(13);return H.write_shift(1,255),H.write_shift(2,z),H.write_shift(2,B),H.write_shift(8,W,"f"),H}function x(B,z,W){var H=B.l+z,se=l(B,z,W);if(se[1].v=B.read_shift(8,"f"),W.qpro)B.l=H;else{var he=B.read_shift(2);F(B.slice(B.l,B.l+he),se),B.l+=he}return se}function T(B,z,W){var H=z&32768;return z&=-32769,z=(H?B:0)+(z>=8192?z-16384:z),(H?"":"$")+(W?vt(z):Dt(z))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(B,z){or(B,0);for(var W=[],H=0,se="",he="",me="",le="";B.l<B.length;){var oe=B[B.l++];switch(oe){case 0:W.push(B.read_shift(8,"f"));break;case 1:he=T(z[0].c,B.read_shift(2),!0),se=T(z[0].r,B.read_shift(2),!1),W.push(he+se);break;case 2:{var Oe=T(z[0].c,B.read_shift(2),!0),G=T(z[0].r,B.read_shift(2),!1);he=T(z[0].c,B.read_shift(2),!0),se=T(z[0].r,B.read_shift(2),!1),W.push(Oe+G+":"+he+se)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(B.read_shift(2));break;case 6:{for(var it="";oe=B[B.l++];)it+=String.fromCharCode(oe);W.push('"'+it.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:le=W.pop(),me=W.pop(),W.push(["AND","OR"][oe-20]+"("+me+","+le+")");break;default:if(oe<32&&w[oe])le=W.pop(),me=W.pop(),W.push(me+w[oe]+le);else if(C[oe]){if(H=C[oe][1],H==69&&(H=B[B.l++]),H>W.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+W.join("|")+"|");return}var $e=W.slice(-H);W.length-=H,W.push(C[oe][0]+"("+$e.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}W.length==1?z[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function L(B){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=B.read_shift(2),z[3]=B[B.l++],z[0].c=B[B.l++],z}function O(B,z){var W=L(B);return W[1].t="s",W[1].v=B.read_shift(z-4,"cstr"),W}function v(B,z,W,H){var se=ie(6+H.length);se.write_shift(2,B),se.write_shift(1,W),se.write_shift(1,z),se.write_shift(1,39);for(var he=0;he<H.length;++he){var me=H.charCodeAt(he);se.write_shift(1,me>=128?95:me)}return se.write_shift(1,0),se}function A(B,z){var W=L(B);W[1].v=B.read_shift(2);var H=W[1].v>>1;if(W[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return W[1].v=H,W}function y(B,z){var W=L(B),H=B.read_shift(4),se=B.read_shift(4),he=B.read_shift(2);if(he==65535)return H===0&&se===3221225472?(W[1].t="e",W[1].v=15):H===0&&se===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var me=he&32768;return he=(he&32767)-16446,W[1].v=(1-me*2)*(se*Math.pow(2,he+32)+H*Math.pow(2,he)),W}function I(B,z,W,H){var se=ie(14);if(se.write_shift(2,B),se.write_shift(1,W),se.write_shift(1,z),H==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var he=0,me=0,le=0,oe=0;return H<0&&(he=1,H=-H),me=Math.log2(H)|0,H/=Math.pow(2,me-31),oe=H>>>0,oe&2147483648||(H/=2,++me,oe=H>>>0),H-=oe,oe|=2147483648,oe>>>=0,H*=Math.pow(2,32),le=H>>>0,se.write_shift(4,le),se.write_shift(4,oe),me+=16383+(he?32768:0),se.write_shift(2,me),se}function k(B,z){var W=y(B);return B.l+=z-14,W}function b(B,z){var W=L(B),H=B.read_shift(4);return W[1].v=H>>6,W}function R(B,z){var W=L(B),H=B.read_shift(8,"f");return W[1].v=H,W}function K(B,z){var W=R(B);return B.l+=z-10,W}function Z(B,z){return B[B.l+z-1]==0?B.read_shift(z,"cstr"):""}function ge(B,z){var W=B[B.l++];W>z-1&&(W=z-1);for(var H="";H.length<W;)H+=String.fromCharCode(B[B.l++]);return H}function de(B,z,W){if(!(!W.qpro||z<21)){var H=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var se=B.read_shift(z-21,"cstr");return[H,se]}}function ze(B,z){for(var W={},H=B.l+z;B.l<H;){var se=B.read_shift(2);if(se==14e3){for(W[se]=[0,""],W[se][0]=B.read_shift(2);B[B.l];)W[se][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return W}function Y(B,z){var W=ie(5+B.length);W.write_shift(2,14e3),W.write_shift(2,z);for(var H=0;H<B.length;++H){var se=B.charCodeAt(H);W[W.l++]=se>127?95:se}return W[W.l++]=0,W}var Ce={0:{n:"BOF",f:$t},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:ge},65535:{n:""}},Fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:y},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ze},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function wb(r){var e={},t=r.match(Tr),n=0,i=!1;if(t)for(;n!=t.length;++n){var s=Ne(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=bh[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var Eb=function(){var r=Xo("t"),e=Xo("rPr");function t(s){var a=s.match(r);if(!a)return{t:"s",v:""};var o={t:"s",v:Ze(a[1])},c=s.match(e);return c&&(o.s=wb(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(t).filter(function(o){return o.v})}}(),Tb=function(){var e=/(\r\n|\n)/g;function t(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Ab=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Sb=/<(?:\w+:)?r>/,Ib=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function td(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ze(ut(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ut(r),t&&(n.h=Mh(n.t))):r.match(Sb)&&(n.r=ut(r),n.t=Ze(ut((r.replace(Ib,"").match(Ab)||[]).join("").replace(Tr,""))),t&&(n.h=Tb(Eb(n.r)))),n):{t:""}}var kb=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Cb=/<(?:\w+:)?(?:si|sstItem)>/g,bb=/<\/(?:\w+:)?(?:si|sstItem)>/;function Rb(r,e){var t=[],n="";if(!r)return t;var i=r.match(kb);if(i){n=i[2].replace(Cb,"").split(bb);for(var s=0;s!=n.length;++s){var a=td(n[s].trim(),e);a!=null&&(t[t.length]=a)}i=Ne(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}var Fb=/^\s|\s$|[\t\n\r]/;function Hv(r,e){if(!e.bookSST)return"";var t=[Ut];t[t.length]=_e("sst",null,{xmlns:Rs[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var i=r[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Fb)&&(s+=' xml:space="preserve"'),s+=">"+lt(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function Db(r){return[r.read_shift(4),r.read_shift(4)]}function Pb(r,e){var t=[],n=!1;return ri(r,function(s,a,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function Nb(r,e){return e||(e=ie(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var Ob=$k;function Lb(r){var e=Lr();ae(e,159,Nb(r));for(var t=0;t<r.length;++t)ae(e,19,Ob(r[t]));return ae(e,160),e.end()}function zv(r){if(typeof Ye<"u")return Ye.utils.encode(vs,r);for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Qn(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function Mb(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Qn(r,4),e.U=Qn(r,4),e.W=Qn(r,4),e}function Vb(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},i=r.read_shift(4),s=[];i-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function Bb(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(Vb(r));return e}function Ub(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function Gb(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Qn(r,4),e.U=Qn(r,4),e.W=Qn(r,4),e}function Wb(r){var e=Gb(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function $v(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function jv(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function Hb(r){var e=Qn(r);switch(e.Minor){case 2:return[e.Minor,zb(r)];case 3:return[e.Minor,$b()];case 4:return[e.Minor,jb(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function zb(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=$v(r,t),i=jv(r,r.length-r.l);return{t:"Std",h:n,v:i}}function $b(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jb(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(Tr,function(s){var a=Ne(s);switch(Ln(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function Kb(r,e){var t={},n=t.EncryptionVersionInfo=Qn(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var i=r.read_shift(4);return e-=4,t.EncryptionHeader=$v(r,i),e-=i,t.EncryptionVerifier=jv(r,e),t}function qb(r){var e={},t=e.EncryptionVersionInfo=Qn(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function rd(r){var e=0,t,n=zv(r),i=n.length+1,s,a,o,c,l;for(t=bi(i),t[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)a=t[s],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var Kv=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var u=a[l],h=0;h!=7;++h)u&64&&(o^=t[c]),u*=2,--c;return o};return function(a){for(var o=zv(a),c=s(o),l=o.length,u=bi(16),h=0;h!=16;++h)u[h]=0;var d,m,g;for((l&1)===1&&(d=c>>8,u[l]=i(r[0],d),--l,d=c&255,m=o[o.length-1],u[l]=i(m,d));l>0;)--l,d=c>>8,u[l]=i(o[l],d),--l,d=c&255,u[l]=i(o[l],d);for(l=15,g=15-o.length;g>0;)d=c>>8,u[l]=i(r[g],d),--l,--g,d=c&255,u[l]=i(o[l],d),--l,--g;return u}}(),Xb=function(r,e,t,n,i){i||(i=e),n||(n=Kv(r));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[t],a=(a>>5|a<<3)&255,i[s]=a,++t;return[i,t,n]},Qb=function(r){var e=0,t=Kv(r);return function(n){var i=Xb("",n,e,t);return e=i[1],i[0]}};function Yb(r,e,t,n){var i={key:$t(r),verificationBytes:$t(r)};return t.password&&(i.verifier=rd(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Qb(t.password)),i}function Jb(r,e,t){var n=t||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=qb(r):n.Data=Kb(r,e),n}function Zb(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?Jb(r,e-2,n):Yb(r,t.biff>=8?e:e-2,t,n),n}var qv=function(){function r(i,s){switch(s.type){case"base64":return e(qr(i),s);case"binary":return e(i,s);case"buffer":return e(We&&Buffer.isBuffer(i)?i.toString("binary"):Bi(i),s);case"array":return e(ws(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,g,p=-1;g=d.exec(u);){switch(g[0]){case"\\cell":var x=u.slice(m,d.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var T={v:x,t:"s"};Array.isArray(o)?o[h][p]=T:o[Pe({r:h,c:p})]=T}break}m=d.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=Ve(l),o}function t(i,s){return Ui(r(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=qe(i["!ref"]),o,c=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=Pe({r:l,c:u});o=c?(i[l]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Pn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function eR(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Zo(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function tR(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.max(e,t,n),s=Math.min(e,t,n),a=i-s;if(a===0)return[0,0,e];var o=0,c=0,l=i+s;switch(c=a/(l>1?2-l:l),i){case e:o=((t-n)/a+6)%6;break;case t:o=(n-e)/a+2;break;case n:o=(e-t)/a+4;break}return[o/6,c,l/2]}function rR(r){var e=r[0],t=r[1],n=r[2],i=t*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,c;if(t!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function ru(r,e){if(e===0)return r;var t=tR(eR(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),Zo(rR(t))}var Xv=6,nR=15,iR=1,_r=Xv;function ec(r){return Math.floor((r+Math.round(128/_r)/256)*_r)}function tc(r){return Math.floor((r-5)/_r*100+.5)/100}function nu(r){return Math.round((r*_r+5)/_r*256)/256}function vf(r){return nu(tc(ec(r)))}function nd(r){var e=Math.abs(r-vf(r)),t=_r;if(e>.005)for(_r=iR;_r<nR;++_r)Math.abs(r-vf(r))<=e&&(e=Math.abs(r-vf(r)),t=_r);_r=t}function Ri(r){r.width?(r.wpx=ec(r.width),r.wch=tc(r.wpx),r.MDW=_r):r.wpx?(r.wch=tc(r.wpx),r.width=nu(r.wch),r.MDW=_r):typeof r.wch=="number"&&(r.width=nu(r.wch),r.wpx=ec(r.width),r.MDW=_r),r.customWidth&&delete r.customWidth}var sR=96,Qv=sR;function rc(r){return r*96/Qv}function Fa(r){return r*Qv/96}var aR={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function oR(r,e,t,n){e.Borders=[];var i={},s=!1;(r[0].match(Tr)||[]).forEach(function(a){var o=Ne(a);switch(Ln(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=xt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=xt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function cR(r,e,t,n){e.Fills=[];var i={},s=!1;(r[0].match(Tr)||[]).forEach(function(a){var o=Ne(a);switch(Ln(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function lR(r,e,t,n){e.Fonts=[];var i={},s=!1;(r[0].match(Tr)||[]).forEach(function(a){var o=Ne(a);switch(Ln(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=ut(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?xt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?xt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?xt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?xt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?xt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?xt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?xt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=bh[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=xt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=ss[i.color.index];i.color.index==81&&(c=ss[1]),c||(c=ss[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=ru(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function uR(r,e,t){e.NumberFmt=[];for(var n=Nt(De),i=0;i<n.length;++i)e.NumberFmt[n[i]]=De[n[i]];var s=r[0].match(Tr);if(s)for(i=0;i<s.length;++i){var a=Ne(s[i]);switch(Ln(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ze(ut(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}Rn(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function fR(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=_e("numFmt",null,{numFmtId:n,formatCode:lt(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=_e("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var al=["numFmtId","fillId","fontId","borderId","xfId"],ol=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hR(r,e,t){e.CellXf=[];var n,i=!1;(r[0].match(Tr)||[]).forEach(function(s){var a=Ne(s),o=0;switch(Ln(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<al.length;++o)n[al[o]]&&(n[al[o]]=parseInt(n[al[o]],10));for(o=0;o<ol.length;++o)n[ol[o]]&&(n[ol[o]]=xt(n[ol[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=xt(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function dR(r){var e=[];return e[e.length]=_e("cellXfs",null),r.forEach(function(t){e[e.length]=_e("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=_e("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var mR=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&uR(h,u,l),(h=o.match(i))&&lR(h,u,c,l),(h=o.match(n))&&cR(h,u,c,l),(h=o.match(s))&&oR(h,u,c,l),(h=o.match(t))&&hR(h,u,l),u}}();function Yv(r,e){var t=[Ut,_e("styleSheet",null,{xmlns:Rs[0],"xmlns:vt":jt.vt})],n;return r.SSF&&(n=fR(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=dR(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function pR(r,e){var t=r.read_shift(2),n=wr(r);return[t,n]}function gR(r,e,t){t||(t=ie(6+4*e.length)),t.write_shift(2,r),er(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function _R(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=Jk(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(n.underline=a);var o=r.read_shift(1);o>0&&(n.family=o);var c=r.read_shift(1);switch(c>0&&(n.charset=c),r.l++,n.color=Yk(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=wr(r),n}function xR(r,e){e||(e=ie(25+4*32)),e.write_shift(2,r.sz*20),Zk(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),Zl(r.color,e);var n=0;return n=2,e.write_shift(1,n),er(r.name,e),e.length>e.l?e.slice(0,e.l):e}var vR=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],yf,yR=Er;function yg(r,e){e||(e=ie(4*3+8*7+16*1)),yf||(yf=Fu(vR));var t=yf[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(Zl({auto:1},e),Zl({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function wR(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}function Jv(r,e,t){t||(t=ie(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function ao(r,e){return e||(e=ie(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var ER=Er;function TR(r,e){return e||(e=ie(51)),e.write_shift(1,0),ao(null,e),ao(null,e),ao(null,e),ao(null,e),ao(null,e),e.length>e.l?e.slice(0,e.l):e}function AR(r,e){return e||(e=ie(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Jl(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function SR(r,e,t){var n=ie(2052);return n.write_shift(4,r),Jl(e,n),Jl(t,n),n.length>n.l?n.slice(0,n.l):n}function IR(r,e,t){var n={};n.NumberFmt=[];for(var i in De)n.NumberFmt[i]=De[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return ri(r,function(c,l,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],Rn(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=ru(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(l.T>0)s.push(u);else if(l.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function kR(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++t}),t!=0&&(ae(r,615,yn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ae(r,44,gR(i,e[i]))}),ae(r,616))}}function CR(r){var e=1;ae(r,611,yn(e)),ae(r,43,xR({sz:12,color:{theme:1},name:"Calibri",family:2})),ae(r,612)}function bR(r){var e=2;ae(r,603,yn(e)),ae(r,45,yg({patternType:"none"})),ae(r,45,yg({patternType:"gray125"})),ae(r,604)}function RR(r){var e=1;ae(r,613,yn(e)),ae(r,46,TR()),ae(r,614)}function FR(r){var e=1;ae(r,626,yn(e)),ae(r,47,Jv({numFmtId:0},65535)),ae(r,627)}function DR(r,e){ae(r,617,yn(e.length)),e.forEach(function(t){ae(r,47,Jv(t,0))}),ae(r,618)}function PR(r){var e=1;ae(r,619,yn(e)),ae(r,48,AR({xfId:0,name:"Normal"})),ae(r,620)}function NR(r){var e=0;ae(r,505,yn(e)),ae(r,506)}function OR(r){var e=0;ae(r,508,SR(e,"TableStyleMedium9","PivotStyleMedium4")),ae(r,509)}function LR(r,e){var t=Lr();return ae(t,278),kR(t,r.SSF),CR(t),bR(t),RR(t),FR(t),DR(t,e.cellXfs),PR(t),NR(t),OR(t),ae(t,279),t.end()}var MR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function VR(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(Tr)||[]).forEach(function(i){var s=Ne(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[MR.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function BR(){}function UR(){}var GR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,WR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,HR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function zR(r,e,t){e.themeElements={};var n;[["clrScheme",GR,VR],["fontScheme",WR,BR],["fmtScheme",HR,UR]].forEach(function(i){if(!(n=r.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,t)})}var $R=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Zv(r,e){(!r||r.length===0)&&(r=id());var t,n={};if(!(t=r.match($R)))throw new Error("themeElements not found in theme");return zR(t[0],n,e),n.raw=r,n}function id(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Ut];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function jR(r,e,t){var n=r.l+e,i=r.read_shift(4);if(i!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var a;try{a=Xx(s,{type:"array"})}catch{return}var o=Hr(a,"theme/theme/theme1.xml",!0);if(o)return Zv(o,t)}}function KR(r){return r.read_shift(4)}function qR(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=XR(r,4);break;case 2:e.xclrValue=Dv(r);break;case 3:e.xclrValue=KR(r);break;case 4:r.l+=4;break}return r.l+=8,e}function XR(r,e){return Er(r,e)}function QR(r,e){return Er(r,e)}function YR(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=qR(r);break;case 6:n[1]=QR(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function JR(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var i=r.read_shift(2),s=[];i-- >0;)s.push(YR(r,t-r.l));return{ixfe:n,ext:s}}function ZR(r,e){e.forEach(function(t){switch(t[0]){}})}function eF(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:wr(r)}}function tF(r){var e=ie(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),er(r.name,e),e.slice(0,e.l)}function rF(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function nF(r){var e=ie(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function iF(r,e){var t=ie(8+2*e.length);return t.write_shift(4,r),er(e,t),t.slice(0,t.l)}function sF(r){return r.l+=4,r.read_shift(4)!=0}function aF(r,e){var t=ie(8);return t.write_shift(4,r),t.write_shift(4,1),t}function oF(r,e,t){var n={Types:[],Cell:[],Value:[]},i=t||{},s=[],a=!1,o=2;return ri(r,function(c,l,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!l.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function cF(){var r=Lr();return ae(r,332),ae(r,334,yn(1)),ae(r,335,tF({name:"XLDAPR",version:12e4,flags:3496657072})),ae(r,336),ae(r,339,iF(1,"XLDAPR")),ae(r,52),ae(r,35,yn(514)),ae(r,4096,yn(0)),ae(r,4097,an(1)),ae(r,36),ae(r,53),ae(r,340),ae(r,337,aF(1)),ae(r,51,nF([[1,0]])),ae(r,338),ae(r,333),r.end()}function lF(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var i=!1,s=2,a;return r.replace(Tr,function(o){var c=Ne(o);switch(Ln(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function ey(){var r=[Ut];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function uF(r){var e=[];if(!r)return e;var t=1;return(r.match(Tr)||[]).forEach(function(n){var i=Ne(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,e.push(i);break}}),e}function fF(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=Pe(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function hF(r,e,t){var n=[];return ri(r,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function dF(r,e,t,n){if(!r)return r;var i=n||{},s=!1;ri(r,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},i)}function mF(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var ia=1024;function ty(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[_e("xml",null,{"xmlns:v":Gr.v,"xmlns:o":Gr.o,"xmlns:x":Gr.x,"xmlns:mv":Gr.mv}).replace(/\/>/,">"),_e("o:shapelayout",_e("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),_e("v:shapetype",[_e("v:stroke",null,{joinstyle:"miter"}),_e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];ia<r*1e3;)ia+=1e3;return e.forEach(function(s){var a=kt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?_e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=_e("v:fill",c,o),u={on:"t",obscured:"t"};++ia,i=i.concat(["<v:shape"+Qo({id:"_x0000_s"+ia,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,_e("v:shadow",null,u),_e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",lr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),lr("x:AutoFill","False"),lr("x:Row",String(a.r)),lr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function wg(r,e,t,n){var i=Array.isArray(r),s;e.forEach(function(a){var o=kt(a.ref);if(i?(r[o.r]||(r[o.r]=[]),s=r[o.r][o.c]):s=r[a.ref],!s){s={t:"z"},i?r[o.r][o.c]=s:r[a.ref]=s;var c=qe(r["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ve(c);l!==r["!ref"]&&(r["!ref"]=l)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:t};a.h&&(u.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!t&&s.c[h].T)return;t&&!s.c[h].T&&s.c.splice(h,1)}if(t&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function pF(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ne(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=kt(c.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&td(h[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function ry(r){var e=[Ut,_e("comments",null,{xmlns:Rs[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(i){var s=lt(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=t.indexOf(lt(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(lr("t",lt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(lr("t",lt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function gF(r,e){var t=[],n=!1,i={},s=0;return r.replace(Tr,function(o,c){var l=Ne(o);switch(Ln(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=r.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function _F(r,e,t){var n=[Ut,_e("ThreadedComments",null,{xmlns:jt.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(_e("threadedComment",lr("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function xF(r,e){var t=[],n=!1;return r.replace(Tr,function(s){var a=Ne(s);switch(Ln(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function vF(r){var e=[Ut,_e("personList",null,{xmlns:jt.TCMNT,"xmlns:x":Rs[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(_e("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function yF(r){var e={};e.iauthor=r.read_shift(4);var t=Ns(r);return e.rfx=t.s,e.ref=Pe(t.s),r.l+=16,e}function wF(r,e){return e==null&&(e=ie(36)),e.write_shift(4,r[1].iauthor),za(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var EF=wr;function TF(r){return er(r.slice(0,54))}function AF(r,e){var t=[],n=[],i={},s=!1;return ri(r,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}function SF(r){var e=Lr(),t=[];return ae(e,628),ae(e,630),r.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),ae(e,632,TF(i.a)))})}),ae(e,631),ae(e,633),r.forEach(function(n){n[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:kt(n[0]),e:kt(n[0])};ae(e,635,wF([s,i])),i.t&&i.t.length>0&&ae(e,637,Kk(i)),ae(e,636),delete i.iauthor})}),ae(e,634),ae(e,629),e.end()}var IF="application/vnd.ms-office.vbaProject";function kF(r){var e=Re.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Re.utils.cfb_add(e,i,r.FileIndex[n].content)}}),Re.write(e)}function CF(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Re.utils.cfb_add(r,i,e.FileIndex[n].content)}})}var ny=["xlsb","xlsm","xlam","biff8","xla"];function bF(){return{"!type":"dialog"}}function RF(){return{"!type":"dialog"}}function FF(){return{"!type":"macro"}}function DF(){return{"!type":"macro"}}var ua=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,c?l+=e.r:--l,i+(o?"":"$")+vt(u)+(c?"":"$")+Dt(l)}return function(i,s){return e=s,i.replace(r,t)}}(),sd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ad=function(){return function(e,t){return e.replace(sd,function(n,i,s,a,o,c){var l=jh(a)-(s?0:t.c),u=$h(c)-(o?0:t.r),h=u==0?"":o?u+1:"["+u+"]",d=l==0?"":s?l+1:"["+l+"]";return i+"R"+h+"C"+d})}}();function iy(r,e){return r.replace(sd,function(t,n,i,s,a,o){return n+(i=="$"?i+s:vt(jh(s)+e.c))+(a=="$"?a+o:Dt($h(o)+e.r))})}function PF(r,e,t){var n=br(e),i=n.s,s=kt(t),a={r:s.r-i.r,c:s.c-i.c};return iy(r,a)}function NF(r){return r.length!=1}function Eg(r){return r.replace(/_xlfn\./g,"")}function Wt(r){r.l+=1}function Fi(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function sy(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return ay(r);t.biff==12&&(n=4)}var i=r.read_shift(n),s=r.read_shift(n),a=Fi(r),o=Fi(r);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ay(r){var e=Fi(r),t=Fi(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function OF(r,e,t){if(t.biff<8)return ay(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),s=Fi(r),a=Fi(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function oy(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return LF(r);var n=r.read_shift(t&&t.biff==12?4:2),i=Fi(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function LF(r){var e=Fi(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function MF(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function VF(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return BF(r);var i=r.read_shift(n>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function BF(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function UF(r,e,t){var n=(r[r.l++]&96)>>5,i=sy(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function GF(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=sy(r,s,t);return[n,i,a]}function WF(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function HF(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,i]}function zF(r,e,t){var n=(r[r.l++]&96)>>5,i=OF(r,e-1,t);return[n,i]}function $F(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Tg(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function jF(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function KF(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function qF(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function XF(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function QF(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function cy(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function YF(r){return r.read_shift(2),cy(r)}function JF(r){return r.read_shift(2),cy(r)}function ZF(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=oy(r,0,t);return[n,i]}function eD(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=VF(r,0,t);return[n,i]}function tD(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=oy(r,0,t);return[n,i,s]}function rD(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[sP[i],fy[i],n]}function nD(r,e,t){var n=r[r.l++],i=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:iD(r);return[i,(s[0]===0?fy:iP)[s[1]]]}function iD(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function sD(r,e,t){r.l+=t&&t.biff==2?3:4}function aD(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function oD(r){return r.l++,ni[r.read_shift(1)]}function cD(r){return r.l++,r.read_shift(2)}function lD(r){return r.l++,r.read_shift(1)!==0}function uD(r){return r.l++,xr(r)}function fD(r,e,t){return r.l++,Ac(r,e-1,t)}function hD(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Lt(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=ni[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=xr(r);break;case 2:t[1]=Os(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function dD(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((t.biff==12?Ns:Ou)(r));return i}function mD(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=hD(r,t.biff);return a}function pD(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function gD(r,e,t){if(t.biff==5)return _D(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),s=r.read_shift(4);return[n,i,s]}function _D(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function xD(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function vD(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function yD(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function wD(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,i]}var ED=Er,TD=Er,AD=Er;function Ic(r,e,t){return r.l+=2,[MF(r)]}function od(r){return r.l+=6,[]}var SD=Ic,ID=od,kD=od,CD=Ic;function ly(r){return r.l+=2,[$t(r),r.read_shift(2)&1]}var bD=Ic,RD=ly,FD=od,DD=Ic,PD=Ic,ND=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function OD(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),s=r.read_shift(2),a=ND[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:n,c:i,C:s}}function LD(r){return r.l+=2,[r.read_shift(4)]}function MD(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function VD(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function BD(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function UD(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function GD(r){return r.l+=4,[0,0]}var Ag={1:{n:"PtgExp",f:aD},2:{n:"PtgTbl",f:AD},3:{n:"PtgAdd",f:Wt},4:{n:"PtgSub",f:Wt},5:{n:"PtgMul",f:Wt},6:{n:"PtgDiv",f:Wt},7:{n:"PtgPower",f:Wt},8:{n:"PtgConcat",f:Wt},9:{n:"PtgLt",f:Wt},10:{n:"PtgLe",f:Wt},11:{n:"PtgEq",f:Wt},12:{n:"PtgGe",f:Wt},13:{n:"PtgGt",f:Wt},14:{n:"PtgNe",f:Wt},15:{n:"PtgIsect",f:Wt},16:{n:"PtgUnion",f:Wt},17:{n:"PtgRange",f:Wt},18:{n:"PtgUplus",f:Wt},19:{n:"PtgUminus",f:Wt},20:{n:"PtgPercent",f:Wt},21:{n:"PtgParen",f:Wt},22:{n:"PtgMissArg",f:Wt},23:{n:"PtgStr",f:fD},26:{n:"PtgSheet",f:MD},27:{n:"PtgEndSheet",f:VD},28:{n:"PtgErr",f:oD},29:{n:"PtgBool",f:lD},30:{n:"PtgInt",f:cD},31:{n:"PtgNum",f:uD},32:{n:"PtgArray",f:$F},33:{n:"PtgFunc",f:rD},34:{n:"PtgFuncVar",f:nD},35:{n:"PtgName",f:pD},36:{n:"PtgRef",f:ZF},37:{n:"PtgArea",f:UF},38:{n:"PtgMemArea",f:xD},39:{n:"PtgMemErr",f:ED},40:{n:"PtgMemNoMem",f:TD},41:{n:"PtgMemFunc",f:vD},42:{n:"PtgRefErr",f:yD},43:{n:"PtgAreaErr",f:WF},44:{n:"PtgRefN",f:eD},45:{n:"PtgAreaN",f:zF},46:{n:"PtgMemAreaN",f:BD},47:{n:"PtgMemNoMemN",f:UD},57:{n:"PtgNameX",f:gD},58:{n:"PtgRef3d",f:tD},59:{n:"PtgArea3d",f:GF},60:{n:"PtgRefErr3d",f:wD},61:{n:"PtgAreaErr3d",f:HF},255:{}},WD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},HD={1:{n:"PtgElfLel",f:ly},2:{n:"PtgElfRw",f:DD},3:{n:"PtgElfCol",f:SD},6:{n:"PtgElfRwV",f:PD},7:{n:"PtgElfColV",f:CD},10:{n:"PtgElfRadical",f:bD},11:{n:"PtgElfRadicalS",f:FD},13:{n:"PtgElfColS",f:ID},15:{n:"PtgElfColSV",f:kD},16:{n:"PtgElfRadicalLel",f:RD},25:{n:"PtgList",f:OD},29:{n:"PtgSxName",f:LD},255:{}},zD={0:{n:"PtgAttrNoop",f:GD},1:{n:"PtgAttrSemi",f:QF},2:{n:"PtgAttrIf",f:qF},4:{n:"PtgAttrChoose",f:jF},8:{n:"PtgAttrGoto",f:KF},16:{n:"PtgAttrSum",f:sD},32:{n:"PtgAttrBaxcel",f:Tg},33:{n:"PtgAttrBaxcel",f:Tg},64:{n:"PtgAttrSpace",f:YF},65:{n:"PtgAttrSpaceSemi",f:JF},128:{n:"PtgAttrIfError",f:XF},255:{}};function kc(r,e,t,n){if(n.biff<8)return Er(r,e);for(var i=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=mD(r,0,n),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=dD(r,t[a][1],n),s.push(t[a][2]);break;case"PtgExp":n&&n.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-r.l,e!==0&&s.push(Er(r,e)),s}function Cc(r,e,t){for(var n=r.l+e,i,s,a=[];n!=r.l;)e=n-r.l,s=r[r.l],i=Ag[s]||Ag[WD[s]],(s===24||s===25)&&(i=(s===24?HD:zD)[r[r.l+1]]),!i||!i.f?Er(r,e):a.push([i.n,i.f(r,e,t)]);return a}function $D(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var jD={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KD(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function uy(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Sg(r,e,t){var n=uy(r,e,t);return n=="#REF"?n:KD(n,t)}function gr(r,e,t,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],c,l,u,h=0,d=0,m,g="";if(!r[0]||!r[0][0])return"";for(var p=-1,x="",T=0,C=r[0].length;T<C;++T){var w=r[0][T];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(r[0][p][1][0]){case 0:x=Ft(" ",r[0][p][1][1]);break;case 1:x=Ft("\r",r[0][p][1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}l=l+x,p=-1}o.push(l+jD[w[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Eo(w[1][1],a,i),o.push(To(u,s));break;case"PtgRefN":u=t?Eo(w[1][1],t,i):w[1][1],o.push(To(u,s));break;case"PtgRef3d":h=w[1][1],u=Eo(w[1][2],a,i),g=Sg(n,h,i),o.push(g+"!"+To(u,s));break;case"PtgFunc":case"PtgFuncVar":var F=w[1][0],L=w[1][1];F||(F=0),F&=127;var O=F==0?[]:o.slice(-F);o.length-=F,L==="User"&&(L=O.shift()),o.push(L+"("+O.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":m=eg(w[1][1],t?{s:t}:a,i),o.push(gf(m,i));break;case"PtgArea":m=eg(w[1][1],a,i),o.push(gf(m,i));break;case"PtgArea3d":h=w[1][1],m=w[1][2],g=Sg(n,h,i),o.push(g+"!"+gf(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var v=(n.names||[])[d-1]||(n[0]||[])[d],A=v?v.Name:"SH33TJSNAME"+String(d);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var y=w[1][1];d=w[1][2];var I;if(i.biff<=5)y<0&&(y=-y),n[y]&&(I=n[y][d]);else{var k="";if(((n[y]||[])[0]||[])[0]==14849||(((n[y]||[])[0]||[])[0]==1025?n[y][d]&&n[y][d].itab>0&&(k=n.SheetNames[n[y][d].itab-1]+"!"):k=n.SheetNames[d-1]+"!"),n[y]&&n[y][d])k+=n[y][d].Name;else if(n[0]&&n[0][d])k+=n[0][d].Name;else{var b=(uy(n,y,i)||"").split(";;");b[d-1]?k=b[d-1]:k+="SH33TJSERRX"}o.push(k);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var R="(",K=")";if(p>=0){switch(x="",r[0][p][1][0]){case 2:R=Ft(" ",r[0][p][1][1])+R;break;case 3:R=Ft("\r",r[0][p][1][1])+R;break;case 4:K=Ft(" ",r[0][p][1][1])+K;break;case 5:K=Ft("\r",r[0][p][1][1])+K;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}p=-1}o.push(R+o.pop()+K);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var Z={c:t.c,r:t.r};if(n.sharedf[Pe(u)]){var ge=n.sharedf[Pe(u)];o.push(gr(ge,a,Z,n,i))}else{var de=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(u.c<l[0].s.c||u.c>l[0].e.c)&&!(u.r<l[0].s.r||u.r>l[0].e.r)){o.push(gr(l[1],a,Z,n,i)),de=!0;break}de||o.push(w[1])}break;case"PtgArray":o.push("{"+$D(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ze=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&ze.indexOf(r[0][T][0])==-1){w=r[0][p];var Y=!0;switch(w[1][0]){case 4:Y=!1;case 0:x=Ft(" ",w[1][1]);break;case 5:Y=!1;case 1:x=Ft("\r",w[1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((Y?x:"")+o.pop()+(Y?"":x)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function qD(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,a=r.read_shift(i);if(a==65535)return[[],Er(r,e-2)];var o=Cc(r,a,t);return e!==a+i&&(s=kc(r,e-a-i,o,t)),r.l=n,[o,s]}function XD(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,a=r.read_shift(i);if(a==65535)return[[],Er(r,e-2)];var o=Cc(r,a,t);return e!==a+i&&(s=kc(r,e-a-i,o,t)),r.l=n,[o,s]}function QD(r,e,t,n){var i=r.l+e,s=Cc(r,n,t),a;return i!==r.l&&(a=kc(r,i-r.l,s,t)),[s,a]}function YD(r,e,t){var n=r.l+e,i,s=r.read_shift(2),a=Cc(r,s,t);return s==65535?[[],Er(r,e-2)]:(e!==s+2&&(i=kc(r,n-s-2,a,t)),[a,i])}function JD(r){var e;if(Kn(r,r.l+6)!==65535)return[xr(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function ZD(r){if(r==null){var e=ie(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return Es(r);return Es(0)}function wf(r,e,t){var n=r.l+e,i=Mn(r);t.biff==2&&++r.l;var s=JD(r),a=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var o=XD(r,n-r.l,t);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function eP(r,e,t,n,i){var s=As(e,t,i),a=ZD(r.v),o=ie(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=ie(r.bf.length),u=0;u<r.bf.length;++u)l[u]=r.bf[u];var h=Zt([s,a,o,l]);return h}function Lu(r,e,t){var n=r.read_shift(4),i=Cc(r,n,t),s=r.read_shift(4),a=s>0?kc(r,s,i,t):null;return[i,a]}var tP=Lu,Mu=Lu,rP=Lu,nP=Lu,iP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},fy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ig(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function aP(r){var e="of:="+r.replace(sd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Ef(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function oP(r){return r.replace(/\./,"!")}var So={},fa={},Io=typeof Map<"u";function cd(r,e,t){var n=0,i=r.length;if(t){if(Io?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Io?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<i;++n)if(r[n].t===e)return r.Count++,n;return r[i]={t:e},r.Count++,r.Unique++,t&&(Io?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Vu(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(_r=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=tc(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=nu(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function cs(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function Gi(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],i=60,s=r.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){Rn(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(r[i].numFmtId===n)return i;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function hy(r,e,t,n,i,s){try{n.cellNF&&(r.z=De[e])}catch(o){if(n.WTF)throw o}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=yt(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(De[e]==null&&Rn(nk[e]||"General",e),r.t==="e")r.w=r.w||ni[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=qo(r.v);else if(r.t==="d"){var a=Kt(r.v);(a|0)===a?r.w=a.toString(10):r.w=qo(a)}else{if(r.v===void 0)return"";r.w=ys(r.v,fa)}else r.t==="d"?r.w=Xr(e,Kt(r.v),fa):r.w=Xr(e,r.v,fa)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=ru(i.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=i.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=ru(i.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=i.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function cP(r,e,t){if(r&&r["!ref"]){var n=qe(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function lP(r,e){var t=qe(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=Ve(t))}var uP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hP=/<(?:\w:)?hyperlink [^>]*>/mg,dP=/"(\w*:\w*)"/,mP=/<(?:\w:)?col\b[^>]*[\/]?>/g,pP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,gP=/<(?:\w:)?pageMargins[^>]*\/>/g,dy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,_P=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,xP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vP(r,e,t,n,i,s,a){if(!r)return r;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",h=r.match(fP);h?(l=r.slice(0,h.index),u=r.slice(h.index+h[0].length)):l=u=r;var d=l.match(dy);d?ld(d[0],o,i,t):(d=l.match(_P))&&wP(d[0],d[1]||"",o,i,t);var m=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=l.slice(m,m+50).match(dP);g&&lP(o,g[1])}var p=l.match(xP);p&&p[1]&&NP(p[1],i);var x=[];if(e.cellStyles){var T=l.match(mP);T&&bP(x,T)}h&&MP(h[1],o,e,c,s,a);var C=u.match(pP);C&&(o["!autofilter"]=FP(C[0]));var w=[],F=u.match(uP);if(F)for(m=0;m!=F.length;++m)w[m]=qe(F[m].slice(F[m].indexOf('"')+1));var L=u.match(hP);L&&IP(o,L,n);var O=u.match(gP);if(O&&(o["!margins"]=kP(Ne(O[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ve(c)),e.sheetRows>0&&o["!ref"]){var v=qe(o["!ref"]);e.sheetRows<=+v.e.r&&(v.e.r=e.sheetRows-1,v.e.r>c.e.r&&(v.e.r=c.e.r),v.e.r<v.s.r&&(v.s.r=v.e.r),v.e.c>c.e.c&&(v.e.c=c.e.c),v.e.c<v.s.c&&(v.s.c=v.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ve(v))}return x.length>0&&(o["!cols"]=x),w.length>0&&(o["!merges"]=w),o}function yP(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+Ve(r[t])+'"/>';return e+"</mergeCells>"}function ld(r,e,t,n){var i=Ne(r);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=Ze(ut(i.codeName)))}function wP(r,e,t,n,i){ld(r.slice(0,r.indexOf(">")),t,n,i)}function EP(r,e,t,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[t];try{e.Workbook&&(c=e.Workbook.Sheets[t].CodeName||c)}catch{}s=!0,a.codeName=bn(lt(c))}if(r&&r["!outline"]){var l={summaryBelow:1,summaryRight:1};r["!outline"].above&&(l.summaryBelow=0),r["!outline"].left&&(l.summaryRight=0),o=(o||"")+_e("outlinePr",null,l)}!s&&!o||(i[i.length]=_e("sheetPr",o,a))}var TP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],AP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function SP(r){var e={sheet:1};return TP.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),AP.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=rd(r.password).toString(16).toUpperCase()),_e("sheetProtection",null,e)}function IP(r,e,t){for(var n=Array.isArray(r),i=0;i!=e.length;++i){var s=Ne(ut(e[i]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Ze(s.location))):(s.Target="#"+Ze(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=qe(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=Pe({c:l,r:c});n?(r[c]||(r[c]=[]),r[c][l]||(r[c][l]={t:"z",v:void 0}),r[c][l].l=s):(r[u]||(r[u]={t:"z",v:void 0}),r[u].l=s)}}}function kP(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function CP(r){return cs(r),_e("pageMargins",null,r)}function bP(r,e){for(var t=!1,n=0;n!=e.length;++n){var i=Ne(e[n],!0);i.hidden&&(i.hidden=xt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,nd(i.width)),Ri(i);s<=a;)r[s++]=mt(i)}}function RP(r,e){for(var t=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(t[t.length]=_e("col",null,Vu(i,n)));return t[t.length]="</cols>",t.join("")}function FP(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function DP(r,e,t,n){var i=typeof r.ref=="string"?r.ref:Ve(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=br(i);a.s.r==a.e.r&&(a.e.r=br(e["!ref"]).e.r,i=Ve(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+t.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),_e("autoFilter",null,{ref:i})}var PP=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function NP(r,e){e.Views||(e.Views=[{}]),(r.match(PP)||[]).forEach(function(t,n){var i=Ne(t);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),xt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function OP(r,e,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),_e("sheetViews",_e("sheetView",null,i),{})}function LP(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=ni[r.v];break;case"d":n&&n.cellDates?i=yt(r.v,-1).toISOString():(r=mt(r),r.t="n",i=""+(r.v=Kt(yt(r.v)))),typeof r.z>"u"&&(r.z=De[14]);break;default:i=r.v;break}var o=lr("v",lt(i)),c={r:e},l=Gi(n.cellXfs,r,n);switch(l!==0&&(c.s=l),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=lr("v",""+cd(n.Strings,r.v,n.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var u=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=_e("f",lt(r.f),u)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(c.cm=1),_e("c",o,c)}var MP=function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Xo("v"),a=Xo("f");return function(c,l,u,h,d,m){for(var g=0,p="",x=[],T=[],C=0,w=0,F=0,L="",O,v,A=0,y=0,I,k,b=0,R=0,K=Array.isArray(m.CellXf),Z,ge=[],de=[],ze=Array.isArray(l),Y=[],Ce={},Fe=!1,B=!!u.sheetStubs,z=c.split(e),W=0,H=z.length;W!=H;++W){p=z[W].trim();var se=p.length;if(se!==0){var he=0;e:for(g=0;g<se;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(v=Ne(p.slice(he,g),!0),A=v.r!=null?parseInt(v.r,10):A+1,y=-1,u.sheetRows&&u.sheetRows<A)continue;Ce={},Fe=!1,v.ht&&(Fe=!0,Ce.hpt=parseFloat(v.ht),Ce.hpx=Fa(Ce.hpt)),v.hidden=="1"&&(Fe=!0,Ce.hidden=!0),v.outlineLevel!=null&&(Fe=!0,Ce.level=+v.outlineLevel),Fe&&(Y[A-1]=Ce)}break;case"<":he=g;break}if(he>=g)break;if(v=Ne(p.slice(he,g),!0),A=v.r!=null?parseInt(v.r,10):A+1,y=-1,!(u.sheetRows&&u.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),u&&u.cellStyles&&(Ce={},Fe=!1,v.ht&&(Fe=!0,Ce.hpt=parseFloat(v.ht),Ce.hpx=Fa(Ce.hpt)),v.hidden=="1"&&(Fe=!0,Ce.hidden=!0),v.outlineLevel!=null&&(Fe=!0,Ce.level=+v.outlineLevel),Fe&&(Y[A-1]=Ce)),x=p.slice(g).split(r);for(var me=0;me!=x.length&&x[me].trim().charAt(0)=="<";++me);for(x=x.slice(me),g=0;g!=x.length;++g)if(p=x[g].trim(),p.length!==0){if(T=p.match(t),C=g,w=0,F=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,T!=null&&T.length===2){for(C=0,L=T[1],w=0;w!=L.length&&!((F=L.charCodeAt(w)-64)<1||F>26);++w)C=26*C+F;--C,y=C}else++y;for(w=0;w!=p.length&&p.charCodeAt(w)!==62;++w);if(++w,v=Ne(p.slice(0,w),!0),v.r||(v.r=Pe({r:A-1,c:y})),L=p.slice(w),O={t:""},(T=L.match(s))!=null&&T[1]!==""&&(O.v=Ze(T[1])),u.cellFormula){if((T=L.match(a))!=null&&T[1]!==""){if(O.f=Ze(ut(T[1])).replace(/\r\n/g,`
`),u.xlfn||(O.f=Eg(O.f)),T[0].indexOf('t="array"')>-1)O.F=(L.match(i)||[])[1],O.F.indexOf(":")>-1&&ge.push([qe(O.F),O.F]);else if(T[0].indexOf('t="shared"')>-1){k=Ne(T[0]);var le=Ze(ut(T[1]));u.xlfn||(le=Eg(le)),de[parseInt(k.si,10)]=[k,le,v.r]}}else(T=L.match(/<f[^>]*\/>/))&&(k=Ne(T[0]),de[k.si]&&(O.f=PF(de[k.si][1],de[k.si][2],v.r)));var oe=kt(v.r);for(w=0;w<ge.length;++w)oe.r>=ge[w][0].s.r&&oe.r<=ge[w][0].e.r&&oe.c>=ge[w][0].s.c&&oe.c<=ge[w][0].e.c&&(O.F=ge[w][1])}if(v.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(B)O.t="z";else continue;else O.t=v.t||"n";switch(h.s.c>y&&(h.s.c=y),h.e.c<y&&(h.e.c=y),O.t){case"n":if(O.v==""||O.v==null){if(!B)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!B)continue;O.t="z"}else I=So[parseInt(O.v,10)],O.v=I.t,O.r=I.r,u.cellHTML&&(O.h=I.h);break;case"str":O.t="s",O.v=O.v!=null?ut(O.v):"",u.cellHTML&&(O.h=Mh(O.v));break;case"inlineStr":T=L.match(n),O.t="s",T!=null&&(I=td(T[1]))?(O.v=I.t,u.cellHTML&&(O.h=I.h)):O.v="";break;case"b":O.v=xt(O.v);break;case"d":u.cellDates?O.v=yt(O.v,1):(O.v=Kt(yt(O.v,1)),O.t="n");break;case"e":(!u||u.cellText!==!1)&&(O.w=O.v),O.v=pv[O.v];break}if(b=R=0,Z=null,K&&v.s!==void 0&&(Z=m.CellXf[v.s],Z!=null&&(Z.numFmtId!=null&&(b=Z.numFmtId),u.cellStyles&&Z.fillId!=null&&(R=Z.fillId))),hy(O,b,R,u,d,m),u.cellDates&&K&&O.t=="n"&&bs(De[b])&&(O.t="d",O.v=Pu(O.v)),v.cm&&u.xlmeta){var Oe=(u.xlmeta.Cell||[])[+v.cm-1];Oe&&Oe.type=="XLDAPR"&&(O.D=!0)}if(ze){var G=kt(v.r);l[G.r]||(l[G.r]=[]),l[G.r][G.c]=O}else l[v.r]=O}}}}Y.length>0&&(l["!rows"]=Y)}}();function VP(r,e,t,n){var i=[],s=[],a=qe(r["!ref"]),o="",c,l="",u=[],h=0,d=0,m=r["!rows"],g=Array.isArray(r),p={r:l},x,T=-1;for(d=a.s.c;d<=a.e.c;++d)u[d]=vt(d);for(h=a.s.r;h<=a.e.r;++h){for(s=[],l=Dt(h),d=a.s.c;d<=a.e.c;++d){c=u[d]+l;var C=g?(r[h]||[])[d]:r[c];C!==void 0&&(o=LP(C,c,r,e))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(p={r:l},m&&m[h]&&(x=m[h],x.hidden&&(p.hidden=1),T=-1,x.hpx?T=rc(x.hpx):x.hpt&&(T=x.hpt),T>-1&&(p.ht=T,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),i[i.length]=_e("row",s.join(""),p))}if(m)for(;h<m.length;++h)m&&m[h]&&(p={r:h+1},x=m[h],x.hidden&&(p.hidden=1),T=-1,x.hpx?T=rc(x.hpx):x.hpt&&(T=x.hpt),T>-1&&(p.ht=T,p.customHeight=1),x.level&&(p.outlineLevel=x.level),i[i.length]=_e("row","",p));return i.join("")}function my(r,e,t,n){var i=[Ut,_e("worksheet",null,{xmlns:Rs[0],"xmlns:r":jt.r})],s=t.SheetNames[r],a=0,o="",c=t.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",u=qe(l);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),l=Ve(u)}n||(n={}),c["!comments"]=[];var h=[];EP(c,t,r,e,i),i[i.length]=_e("dimension",null,{ref:l}),i[i.length]=OP(c,e,r,t),e.sheetFormat&&(i[i.length]=_e("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=RP(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=VP(c,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=SP(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=DP(c["!autofilter"],c,t,r)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=yP(c["!merges"]));var d=-1,m,g=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=ot(n,-1,lt(p[1].Target).replace(/#.*$/,""),je.HLINK),m["r:id"]="rId"+g),(d=p[1].Target.indexOf("#"))>-1&&(m.location=lt(p[1].Target.slice(d+1))),p[1].Tooltip&&(m.tooltip=lt(p[1].Tooltip)),i[i.length]=_e("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=CP(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=lr("ignoredErrors",_e("ignoredError",null,{numberStoredAsText:1,sqref:l}))),h.length>0&&(g=ot(n,-1,"../drawings/drawing"+(r+1)+".xml",je.DRAW),i[i.length]=_e("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=h),c["!comments"].length>0&&(g=ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",je.VML),i[i.length]=_e("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function BP(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function UP(r,e,t){var n=ie(145),i=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;i.hpx?s=rc(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,d=-1,m=u<<10;m<u+1<<10;++m){l.c=m;var g=Array.isArray(t)?(t[l.r]||[])[l.c]:t[Pe(l)];g&&(h<0&&(h=m),d=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var p=n.l;return n.l=c,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function GP(r,e,t,n){var i=UP(n,t,e);(i.length>17||(e["!rows"]||[])[n])&&ae(r,0,i)}var WP=Ns,HP=za;function zP(){}function $P(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=qk(r),t}function jP(r,e,t){t==null&&(t=ie(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return Zl({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),uv(r,t),t.slice(0,t.l)}function KP(r){var e=hn(r);return[e]}function qP(r,e,t){return t==null&&(t=ie(8)),Fs(e,t)}function XP(r){var e=Ds(r);return[e]}function QP(r,e,t){return t==null&&(t=ie(4)),Ps(e,t)}function YP(r){var e=hn(r),t=r.read_shift(1);return[e,t,"b"]}function JP(r,e,t){return t==null&&(t=ie(9)),Fs(e,t),t.write_shift(1,r.v?1:0),t}function ZP(r){var e=Ds(r),t=r.read_shift(1);return[e,t,"b"]}function e3(r,e,t){return t==null&&(t=ie(5)),Ps(e,t),t.write_shift(1,r.v?1:0),t}function t3(r){var e=hn(r),t=r.read_shift(1);return[e,t,"e"]}function r3(r,e,t){return t==null&&(t=ie(9)),Fs(e,t),t.write_shift(1,r.v),t}function n3(r){var e=Ds(r),t=r.read_shift(1);return[e,t,"e"]}function i3(r,e,t){return t==null&&(t=ie(8)),Ps(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function s3(r){var e=hn(r),t=r.read_shift(4);return[e,t,"s"]}function a3(r,e,t){return t==null&&(t=ie(12)),Fs(e,t),t.write_shift(4,e.v),t}function o3(r){var e=Ds(r),t=r.read_shift(4);return[e,t,"s"]}function c3(r,e,t){return t==null&&(t=ie(8)),Ps(e,t),t.write_shift(4,e.v),t}function l3(r){var e=hn(r),t=xr(r);return[e,t,"n"]}function u3(r,e,t){return t==null&&(t=ie(16)),Fs(e,t),Es(r.v,t),t}function py(r){var e=Ds(r),t=xr(r);return[e,t,"n"]}function f3(r,e,t){return t==null&&(t=ie(12)),Ps(e,t),Es(r.v,t),t}function h3(r){var e=hn(r),t=Qh(r);return[e,t,"n"]}function d3(r,e,t){return t==null&&(t=ie(12)),Fs(e,t),fv(r.v,t),t}function m3(r){var e=Ds(r),t=Qh(r);return[e,t,"n"]}function p3(r,e,t){return t==null&&(t=ie(8)),Ps(e,t),fv(r.v,t),t}function g3(r){var e=hn(r),t=Kh(r);return[e,t,"is"]}function _3(r){var e=hn(r),t=wr(r);return[e,t,"str"]}function x3(r,e,t){return t==null&&(t=ie(12+4*r.v.length)),Fs(e,t),er(r.v,t),t.length>t.l?t.slice(0,t.l):t}function v3(r){var e=Ds(r),t=wr(r);return[e,t,"str"]}function y3(r,e,t){return t==null&&(t=ie(8+4*r.v.length)),Ps(e,t),er(r.v,t),t.length>t.l?t.slice(0,t.l):t}function w3(r,e,t){var n=r.l+e,i=hn(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"b"];if(t.cellFormula){r.l+=2;var o=Mu(r,n-r.l,t);a[3]=gr(o,null,i,t.supbooks,t)}else r.l=n;return a}function E3(r,e,t){var n=r.l+e,i=hn(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"e"];if(t.cellFormula){r.l+=2;var o=Mu(r,n-r.l,t);a[3]=gr(o,null,i,t.supbooks,t)}else r.l=n;return a}function T3(r,e,t){var n=r.l+e,i=hn(r);i.r=t["!row"];var s=xr(r),a=[i,s,"n"];if(t.cellFormula){r.l+=2;var o=Mu(r,n-r.l,t);a[3]=gr(o,null,i,t.supbooks,t)}else r.l=n;return a}function A3(r,e,t){var n=r.l+e,i=hn(r);i.r=t["!row"];var s=wr(r),a=[i,s,"str"];if(t.cellFormula){r.l+=2;var o=Mu(r,n-r.l,t);a[3]=gr(o,null,i,t.supbooks,t)}else r.l=n;return a}var S3=Ns,I3=za;function k3(r,e){return e==null&&(e=ie(4)),e.write_shift(4,r),e}function C3(r,e){var t=r.l+e,n=Ns(r),i=qh(r),s=wr(r),a=wr(r),o=wr(r);r.l=t;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function b3(r,e){var t=ie(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));za({s:kt(r[0]),e:kt(r[0])},t),Xh("rId"+e,t);var n=r[1].Target.indexOf("#"),i=n==-1?"":r[1].Target.slice(n+1);return er(i||"",t),er(r[1].Tooltip||"",t),er("",t),t.slice(0,t.l)}function R3(){}function F3(r,e,t){var n=r.l+e,i=hv(r),s=r.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=tP(r,n-r.l,t);a[1]=o}else r.l=n;return a}function D3(r,e,t){var n=r.l+e,i=Ns(r),s=[i];if(t.cellFormula){var a=nP(r,n-r.l,t);s[1]=a,r.l=n}else r.l=n;return s}function P3(r,e,t){t==null&&(t=ie(18));var n=Vu(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var gy=["left","right","top","bottom","header","footer"];function N3(r){var e={};return gy.forEach(function(t){e[t]=xr(r)}),e}function O3(r,e){return e==null&&(e=ie(6*8)),cs(r),gy.forEach(function(t){Es(r[t],e)}),e}function L3(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function M3(r,e,t){t==null&&(t=ie(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function V3(r){var e=ie(24);return e.write_shift(4,4),e.write_shift(4,1),za(r,e),e}function B3(r,e){return e==null&&(e=ie(16*4+2)),e.write_shift(2,r.password?rd(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function U3(){}function G3(){}function W3(r,e,t,n,i,s,a){if(!r)return r;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,g,p,x,T,C,w,F,L,O=[];o.biff=12,o["!row"]=0;var v=0,A=!1,y=[],I={},k=o.supbooks||i.supbooks||[[]];if(k.sharedf=I,k.arrayf=y,k.SheetNames=i.SheetNames||i.Sheets.map(function(ze){return ze.name}),!o.supbooks&&(o.supbooks=k,i.Names))for(var b=0;b<i.Names.length;++b)k[0][b+1]=i.Names[b];var R=[],K=[],Z=!1;nc[16]={n:"BrtShortReal",f:py};var ge;if(ri(r,function(Y,Ce,Fe){if(!d)switch(Fe){case 148:l=Y;break;case 0:m=Y,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),F=Dt(x=m.r),o["!row"]=m.r,(Y.hidden||Y.hpt||Y.level!=null)&&(Y.hpt&&(Y.hpx=Fa(Y.hpt)),K[Y.r]=Y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:Y[2]},Y[2]){case"n":g.v=Y[1];break;case"s":w=So[Y[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!Y[1];break;case"e":g.v=Y[1],o.cellText!==!1&&(g.w=ni[g.v]);break;case"str":g.t="s",g.v=Y[1];break;case"is":g.t="s",g.v=Y[1].t;break}if((p=a.CellXf[Y[0].iStyleRef])&&hy(g,p.numFmtId,null,o,s,a),T=Y[0].c==-1?T+1:Y[0].c,o.dense?(c[x]||(c[x]=[]),c[x][T]=g):c[vt(T)+F]=g,o.cellFormula){for(A=!1,v=0;v<y.length;++v){var B=y[v];m.r>=B[0].s.r&&m.r<=B[0].e.r&&T>=B[0].s.c&&T<=B[0].e.c&&(g.F=Ve(B[0]),A=!0)}!A&&Y.length>3&&(g.f=Y[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>T&&(u.s.c=T),u.e.r<m.r&&(u.e.r=m.r),u.e.c<T&&(u.e.c=T),o.cellDates&&p&&g.t=="n"&&bs(De[p.numFmtId])){var z=gi(g.v);z&&(g.t="d",g.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}ge&&(ge.type=="XLDAPR"&&(g.D=!0),ge=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},T=Y[0].c==-1?T+1:Y[0].c,o.dense?(c[x]||(c[x]=[]),c[x][T]=g):c[vt(T)+F]=g,u.s.r>m.r&&(u.s.r=m.r),u.s.c>T&&(u.s.c=T),u.e.r<m.r&&(u.e.r=m.r),u.e.c<T&&(u.e.c=T),ge&&(ge.type=="XLDAPR"&&(g.D=!0),ge=void 0);break;case 176:O.push(Y);break;case 49:ge=((o.xlmeta||{}).Cell||[])[Y-1];break;case 494:var W=n["!id"][Y.relId];for(W?(Y.Target=W.Target,Y.loc&&(Y.Target+="#"+Y.loc),Y.Rel=W):Y.relId==""&&(Y.Target="#"+Y.loc),x=Y.rfx.s.r;x<=Y.rfx.e.r;++x)for(T=Y.rfx.s.c;T<=Y.rfx.e.c;++T)o.dense?(c[x]||(c[x]=[]),c[x][T]||(c[x][T]={t:"z",v:void 0}),c[x][T].l=Y):(C=Pe({c:T,r:x}),c[C]||(c[C]={t:"z",v:void 0}),c[C].l=Y);break;case 426:if(!o.cellFormula)break;y.push(Y),L=o.dense?c[x][T]:c[vt(T)+F],L.f=gr(Y[1],u,{r:m.r,c:T},k,o),L.F=Ve(Y[0]);break;case 427:if(!o.cellFormula)break;I[Pe(Y[0].s)]=Y[1],L=o.dense?c[x][T]:c[vt(T)+F],L.f=gr(Y[1],u,{r:m.r,c:T},k,o);break;case 60:if(!o.cellStyles)break;for(;Y.e>=Y.s;)R[Y.e--]={width:Y.w/256,hidden:!!(Y.flags&1),level:Y.level},Z||(Z=!0,nd(Y.w/256)),Ri(R[Y.e+1]);break;case 161:c["!autofilter"]={ref:Ve(Y)};break;case 476:c["!margins"]=Y;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),Y.name&&(i.Sheets[t].CodeName=Y.name),(Y.above||Y.left)&&(c["!outline"]={above:Y.above,left:Y.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Y.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Ce.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Fe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(u.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ve(l||u)),o.sheetRows&&c["!ref"]){var de=qe(c["!ref"]);o.sheetRows<=+de.e.r&&(de.e.r=o.sheetRows-1,de.e.r>u.e.r&&(de.e.r=u.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>u.e.c&&(de.e.c=u.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ve(de))}return O.length>0&&(c["!merges"]=O),R.length>0&&(c["!cols"]=R),K.length>0&&(c["!rows"]=K),c}function H3(r,e,t,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=mt(e),e.z=e.z||De[14],e.v=Kt(yt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r:t,c:n};switch(c.s=Gi(i.cellXfs,e,i),e.l&&s["!links"].push([Pe(c),e.l]),e.c&&s["!comments"].push([Pe(c),e.c]),e.t){case"s":case"str":return i.bookSST?(o=cd(i.Strings,e.v,i.revStrings),c.t="s",c.v=o,a?ae(r,18,c3(e,c)):ae(r,7,a3(e,c))):(c.t="str",a?ae(r,17,y3(e,c)):ae(r,6,x3(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ae(r,13,p3(e,c)):ae(r,2,d3(e,c)):a?ae(r,16,f3(e,c)):ae(r,5,u3(e,c)),!0;case"b":return c.t="b",a?ae(r,15,e3(e,c)):ae(r,4,JP(e,c)),!0;case"e":return c.t="e",a?ae(r,14,i3(e,c)):ae(r,3,r3(e,c)),!0}return a?ae(r,12,QP(e,c)):ae(r,1,qP(e,c)),!0}function z3(r,e,t,n){var i=qe(e["!ref"]||"A1"),s,a="",o=[];ae(r,145);var c=Array.isArray(e),l=i.e.r;e["!rows"]&&(l=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=l;++u){a=Dt(u),GP(r,e,i,u);var h=!1;if(u<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(o[d]=vt(d)),s=o[d]+a;var m=c?(e[u]||[])[d]:e[s];if(!m){h=!1;continue}h=H3(r,m,u,d,n,e,h)}}ae(r,146)}function $3(r,e){!e||!e["!merges"]||(ae(r,177,k3(e["!merges"].length)),e["!merges"].forEach(function(t){ae(r,176,I3(t))}),ae(r,178))}function j3(r,e){!e||!e["!cols"]||(ae(r,390),e["!cols"].forEach(function(t,n){t&&ae(r,60,P3(n,t))}),ae(r,391))}function K3(r,e){!e||!e["!ref"]||(ae(r,648),ae(r,649,V3(qe(e["!ref"]))),ae(r,650))}function q3(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var i=ot(t,-1,n[1].Target.replace(/#.*$/,""),je.HLINK);ae(r,494,b3(n,i))}}),delete e["!links"]}function X3(r,e,t,n){if(e["!comments"].length>0){var i=ot(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",je.VML);ae(r,551,Xh("rId"+i)),e["!legacy"]=i}}function Q3(r,e,t,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Ve(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=br(s);o.s.r==o.e.r&&(o.e.r=br(e["!ref"]).e.r,s=Ve(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),ae(r,161,za(qe(s))),ae(r,162)}}function Y3(r,e,t){ae(r,133),ae(r,137,M3(e,t)),ae(r,138),ae(r,134)}function J3(r,e){e["!protect"]&&ae(r,535,B3(e["!protect"]))}function Z3(r,e,t,n){var i=Lr(),s=t.SheetNames[r],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var c=qe(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ae(i,129),(t.vbaraw||a["!outline"])&&ae(i,147,jP(o,a["!outline"])),ae(i,148,HP(c)),Y3(i,a,t.Workbook),j3(i,a),z3(i,a,r,e),J3(i,a),Q3(i,a,t,r),$3(i,a),q3(i,a,n),a["!margins"]&&ae(i,476,O3(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&K3(i,a),X3(i,a,r,n),ae(i,130),i.end()}function eN(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var i=Ze((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function tN(r,e,t,n,i,s){var a=s||{"!type":"chart"};if(!r)return s;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=eN(h);u.s.r=u.s.c=0,u.e.c=o,l=vt(o),d[0].forEach(function(m,g){a[l+Dt(g)]={t:"n",v:m,z:d[1]},c=g}),u.e.r<c&&(u.e.r=c),++o}),o>0&&(a["!ref"]=Ve(u)),a}function rN(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=r.match(dy);return o&&ld(o[0],s,i,t),(a=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function nN(r,e){r.l+=10;var t=wr(r);return{name:t}}function iN(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ri(r,function(c,l,u){switch(u){case 550:s["!rel"]=c;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),c.name&&(i.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ud=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],sN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],aN=[],oN=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function kg(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=xt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Cg(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=xt(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function _y(r){Cg(r.WBProps,ud),Cg(r.CalcPr,oN),kg(r.WBView,sN),kg(r.Sheets,aN),fa.date1904=xt(r.WBProps.date1904)}function cN(r){return!r.Workbook||!r.Workbook.WBProps?"false":xt(r.Workbook.WBProps.date1904)?"true":"false"}var lN="][*?/\\".split("");function xy(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return lN.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function uN(r,e,t){r.forEach(function(n,i){xy(n);for(var s=0;s<i;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function vy(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];uN(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)cP(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var fN=/<\w+:workbook/;function hN(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(r.replace(Tr,function(c,l){var u=Ne(c);switch(Ln(u[0])){case"<?xml":break;case"<workbook":c.match(fN)&&(i="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],t.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ud.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":t.WBProps[h[0]]=xt(u[h[0]]);break;case"int":t.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:t.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(t.WBProps.CodeName=ut(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],t.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ze(ut(u.name)),delete u[0],t.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=ut(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),xt(u.hidden||"0")&&(s.Hidden=!0),a=l+c.length;break;case"</definedName>":s.Ref=Ze(ut(r.slice(a,l))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],t.CalcPr=u;break;case"<calcPr/>":delete u[0],t.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Rs.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return _y(t),t}function yy(r){var e=[Ut];e[e.length]=_e("workbook",null,{xmlns:Rs[0],"xmlns:r":jt.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(ud.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=_e("workbookPr",null,n);var i=r.Workbook&&r.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:lt(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=_e("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=_e("definedName",lt(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function dN(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=u0(r),t.name=wr(r),t}function mN(r,e){return e||(e=ie(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Xh(r.strRelID,e),er(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function pN(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?wr(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function gN(r,e){e||(e=ie(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),uv(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function _N(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function xN(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),s=Xk(r),a=rP(r,0,t),o=qh(r);r.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function vN(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],nc[16]={n:"BrtFRTArchID$",f:_N},ri(r,function(c,l,u){switch(u){case 156:a.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=gr(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,c]):a[0]=[u,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),_y(t),t.Names=s,t.supbooks=a,t}function yN(r,e){ae(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};ae(r,156,mN(i))}ae(r,144)}function wN(r,e){e||(e=ie(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return er("SheetJS",e),er(jo.version,e),er(jo.version,e),er("7262",e),e.length>e.l?e.slice(0,e.l):e}function EN(r,e){e||(e=ie(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function TN(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,i=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&s==-1&&(s=n);s>i||(ae(r,135),ae(r,158,EN(i)),ae(r,136))}}function AN(r,e){var t=Lr();return ae(t,131),ae(t,128,wN()),ae(t,153,gN(r.Workbook&&r.Workbook.WBProps||null)),TN(t,r),yN(t,r),ae(t,132),t.end()}function SN(r,e,t){return e.slice(-4)===".bin"?vN(r,t):hN(r,t)}function IN(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?W3(r,n,t,i,s,a,o):vP(r,n,t,i,s,a,o)}function kN(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?iN(r,n,t,i,s):rN(r,n,t,i,s)}function CN(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?FF():DF()}function bN(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?bF():RF()}function RN(r,e,t,n){return e.slice(-4)===".bin"?IR(r,t,n):mR(r,t,n)}function FN(r,e,t){return Zv(r,t)}function DN(r,e,t){return e.slice(-4)===".bin"?Pb(r,t):Rb(r,t)}function PN(r,e,t){return e.slice(-4)===".bin"?AF(r,t):pF(r,t)}function NN(r,e,t){return e.slice(-4)===".bin"?hF(r):uF(r)}function ON(r,e,t,n){return t.slice(-4)===".bin"?dF(r,e,t,n):void 0}function LN(r,e,t){return e.slice(-4)===".bin"?oF(r,e,t):lF(r,e,t)}function MN(r,e,t){return(e.slice(-4)===".bin"?AN:yy)(r)}function VN(r,e,t,n,i){return(e.slice(-4)===".bin"?Z3:my)(r,t,n,i)}function BN(r,e,t){return(e.slice(-4)===".bin"?LR:Yv)(r,t)}function UN(r,e,t){return(e.slice(-4)===".bin"?Lb:Hv)(r,t)}function GN(r,e,t){return(e.slice(-4)===".bin"?SF:ry)(r)}function WN(r){return(r.slice(-4)===".bin"?cF:ey)()}var wy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ey=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mn(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=r.match(wy),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(Ey),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function HN(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(wy),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(Ey),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),t[a]=i[2].slice(1,i[2].length-1));return t}var ko;function zN(r,e){var t=ko[r]||Ze(r);return t==="General"?ys(e):Xr(t,e)}function $N(r,e,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=xt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=yt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[Ze(e)]=i}function jN(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||ni[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=qo(r.v):r.w=ys(r.v):r.w=zN(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=ko[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&bs(n)){var i=gi(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function KN(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=aR[n.Pattern]||n.Pattern)}r[e.ID]=e}function qN(r,e,t,n,i,s,a,o,c,l){var u="General",h=n.StyleID,d={};l=l||{};var m=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&m.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=xt(r);break;case"String":n.t="s",n.r=$p(Ze(r)),n.v=r.indexOf("<")>-1?Ze(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(yt(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ze(r):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=pv[r],l.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=$p(e||r));break}if(jN(n,u,l),l.cellFormula!==!1)if(n.Formula){var p=Ze(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=ua(p,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ua("RC:RC",i):n.ArrayRange&&(n.F=ua(n.ArrayRange,i),c.push([qe(n.F),n.F]))}else for(g=0;g<c.length;++g)i.r>=c[g][0].s.r&&i.r<=c[g][0].e.r&&i.c>=c[g][0].s.c&&i.c<=c[g][0].e.c&&(n.F=c[g][1]);l.cellStyles&&(m.forEach(function(x){!d.patternType&&x.patternType&&(d.patternType=x.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function XN(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function Tf(r,e){var t=e||{};Ga();var n=na(Vh(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof Ye<"u"?n=Ye.utils.decode(65001,jl(n)):n=ut(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=mt(t);return a.type="string",Ra.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(At){i.indexOf("<"+At)>=0&&(s=!0)}),s)return F6(n,t);ko={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,u={},h=[],d=t.dense?[]:{},m="",g={},p={},x=mn('<Data ss:Type="String">'),T=0,C=0,w=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},O={},v="",A=0,y=[],I={},k={},b=0,R=[],K=[],Z={},ge=[],de,ze=!1,Y=[],Ce=[],Fe={},B=0,z=0,W={Sheets:[],WBProps:{date1904:!1}},H={};Yo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";o=Yo.exec(n);)switch(o[3]=(se=o[3]).toLowerCase()){case"data":if(se=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?qN(n.slice(T,o.index),v,x,c[c.length-1][0]=="comment"?Z:g,{c:C,r:w},L,ge[C],p,Y,t):(v="",x=mn(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(K.length>0&&(g.c=K),(!t.sheetRows||t.sheetRows>w)&&g.v!==void 0&&(t.dense?(d[w]||(d[w]=[]),d[w][C]=g):d[vt(C)+Dt(w)]=g),g.HRef&&(g.l={Target:Ze(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(B=C+(parseInt(g.MergeAcross,10)|0),z=w+(parseInt(g.MergeDown,10)|0),y.push({s:{c:C,r:w},e:{c:B,r:z}})),!t.sheetStubs)g.MergeAcross?C=B+1:++C;else if(g.MergeAcross||g.MergeDown){for(var he=C;he<=B;++he)for(var me=w;me<=z;++me)(he>C||me>w)&&(t.dense?(d[me]||(d[me]=[]),d[me][he]={t:"z"}):d[vt(he)+Dt(me)]={t:"z"});C=B+1}else++C;else g=HN(o[0]),g.Index&&(C=+g.Index-1),C<F.s.c&&(F.s.c=C),C>F.e.c&&(F.e.c=C),o[0].slice(-2)==="/>"&&++C,K=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<F.s.r&&(F.s.r=w),w>F.e.r&&(F.e.r=w),o[0].slice(-2)==="/>"&&(p=mn(o[0]),p.Index&&(w=+p.Index-1)),C=0,++w):(p=mn(o[0]),p.Index&&(w=+p.Index-1),Fe={},(p.AutoFitHeight=="0"||p.Height)&&(Fe.hpx=parseInt(p.Height,10),Fe.hpt=rc(Fe.hpx),Ce[w]=Fe),p.Hidden=="1"&&(Fe.hidden=!0,Ce[w]=Fe));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));h.push(m),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(d["!ref"]=Ve(F),t.sheetRows&&t.sheetRows<=F.e.r&&(d["!fullref"]=d["!ref"],F.e.r=t.sheetRows-1,d["!ref"]=Ve(F))),y.length&&(d["!merges"]=y),ge.length>0&&(d["!cols"]=ge),Ce.length>0&&(d["!rows"]=Ce),u[m]=d}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=C=0,c.push([o[3],!1]),l=mn(o[0]),m=Ze(l.Name),d=t.dense?[]:{},y=[],Y=[],Ce=[],H={name:m,Hidden:0},W.Sheets.push(H);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ge=[],ze=!1}break;case"style":o[1]==="/"?KN(L,O,t):O=mn(o[0]);break;case"numberformat":O.nf=Ze(mn(o[0]).Format||"General"),ko[O.nf]&&(O.nf=ko[O.nf]);for(var le=0;le!=392&&De[le]!=O.nf;++le);if(le==392){for(le=57;le!=392;++le)if(De[le]==null){Rn(O.nf,le);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(de=mn(o[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!ze&&de.wpx>10){ze=!0,_r=Xv;for(var oe=0;oe<ge.length;++oe)ge[oe]&&Ri(ge[oe])}ze&&Ri(de),ge[de.Index-1||ge.length]=de;for(var Oe=0;Oe<+de.Span;++Oe)ge[ge.length]=mt(de);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var G=Ne(o[0]),it={Name:G.Name,Ref:ua(G.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(it.Sheet=W.Sheets.length-1),W.Names.push(it);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?v+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;O.Interior=mn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y4(I,se,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));XN(Z),K.push(Z)}else c.push([o[3],!1]),l=mn(o[0]),Z={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var $e=mn(o[0]);d["!autofilter"]={ref:ua($e.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Pg(n,t);var nt=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:nt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:nt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:nt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:nt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else b=o.index+o[0].length;break;case"header":d["!margins"]||cs(d["!margins"]={},"xlml"),isNaN(+Ne(o[0]).Margin)||(d["!margins"].header=+Ne(o[0]).Margin);break;case"footer":d["!margins"]||cs(d["!margins"]={},"xlml"),isNaN(+Ne(o[0]).Margin)||(d["!margins"].footer=+Ne(o[0]).Margin);break;case"pagemargins":var Ge=Ne(o[0]);d["!margins"]||cs(d["!margins"]={},"xlml"),isNaN(+Ge.Top)||(d["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(d["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(d["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(d["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:nt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:nt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:nt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:nt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:nt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:nt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:nt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:nt=!1}break;case"smarttags":break;default:nt=!1;break}if(nt||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$N(k,se,R,n.slice(b,o.index)):(R=o,b=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ee={};return!t.bookSheets&&!t.bookProps&&(Ee.Sheets=u),Ee.SheetNames=h,Ee.Workbook=W,Ee.SSF=mt(De),Ee.Props=I,Ee.Custprops=k,Ee}function _0(r,e){switch(dd(e=e||{}),e.type||"base64"){case"base64":return Tf(qr(r),e);case"binary":case"buffer":case"file":return Tf(r,e);case"array":return Tf(Bi(r),e)}}function QN(r,e){var t=[];return r.Props&&t.push(w4(r.Props,e)),r.Custprops&&t.push(E4(r.Props,r.Custprops)),t.join("")}function YN(){return""}function JN(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(_e("NumberFormat",null,{"ss:Format":lt(De[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(_e("Style",s.join(""),a))}),_e("Styles",t.join(""))}function Ty(r){return _e("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+ad(r.Ref,{r:0,c:0})})}function ZN(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(Ty(i)))}return _e("Names",t.join(""))}function e6(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(Ty(o)))}return s.join("")}function t6(r,e,t,n){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push(_e("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push(_e("Footer",null,{"x:Margin":r["!margins"].footer})),i.push(_e("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(_e("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(lr("ProtectContents","True")),r["!protect"].objects&&i.push(lr("ProtectObjects","True")),r["!protect"].scenarios&&i.push(lr("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(lr("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(lr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":_e("WorksheetOptions",i.join(""),{xmlns:Gr.x})}function r6(r){return r.map(function(e){var t=Ak(e.t||""),n=_e("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return _e("Comment",n,{"ss:Author":e.a})}).join("")}function n6(r,e,t,n,i,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+lt(ad(r.f,a))),r.F&&r.F.slice(0,e.length)==e){var c=kt(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=lt(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=lt(r.l.Tooltip))),t["!merges"])for(var l=t["!merges"],u=0;u!=l.length;++u)l[u].s.c!=a.c||l[u].s.r!=a.r||(l[u].e.c>l[u].s.c&&(o["ss:MergeAcross"]=l[u].e.c-l[u].s.c),l[u].e.r>l[u].s.r&&(o["ss:MergeDown"]=l[u].e.r-l[u].s.r));var h="",d="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(r.v);break;case"b":h="Boolean",d=r.v?"1":"0";break;case"e":h="Error",d=ni[r.v];break;case"d":h="DateTime",d=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||De[14]);break;case"s":h="String",d=Tk(r.v||"");break}var m=Gi(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var g=r.v!=null?d:"",p=r.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(r.c||[]).length>0&&(p+=r6(r.c)),_e("Cell",p,o)}function i6(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Fa(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function s6(r,e,t,n){if(!r["!ref"])return"";var i=qe(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(x,T){Ri(x);var C=!!x.width,w=Vu(T,x),F={"ss:Index":T+1};C&&(F["ss:Width"]=ec(w.width)),x.hidden&&(F["ss:Hidden"]="1"),o.push(_e("Column",null,F))});for(var c=Array.isArray(r),l=i.s.r;l<=i.e.r;++l){for(var u=[i6(l,(r["!rows"]||[])[l])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>l)&&!(s[a].e.c<h)&&!(s[a].e.r<l)){(s[a].s.c!=h||s[a].s.r!=l)&&(d=!0);break}if(!d){var m={r:l,c:h},g=Pe(m),p=c?(r[l]||[])[h]:r[g];u.push(n6(p,g,r,e,t,n,m))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function a6(r,e,t){var n=[],i=t.SheetNames[r],s=t.Sheets[i],a=s?e6(s,e,r,t):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?s6(s,e,r,t):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(t6(s,e,r,t)),n.join("")}function o6(r,e){e||(e={}),r.SSF||(r.SSF=mt(De)),r.SSF&&(Ga(),Ec(r.SSF),e.revssf=Du(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],Gi(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(QN(r,e)),t.push(YN()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(_e("Worksheet",a6(n,e,r),{"ss:Name":lt(r.SheetNames[n])}));return t[2]=JN(r,e),t[3]=ZN(r),Ut+_e("Workbook",t.join(""),{xmlns:Gr.ss,"xmlns:o":Gr.o,"xmlns:x":Gr.x,"xmlns:ss":Gr.ss,"xmlns:dt":Gr.dt,"xmlns:html":Gr.html})}function c6(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=e4(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=t4(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var l6=[60,1084,2066,2165,2175];function u6(r,e,t,n,i){var s=n,a=[],o=t.slice(t.l,t.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),t.l+=s;for(var c=Kn(t,t.l),l=x0[c],u=0;l!=null&&l6.indexOf(c)>-1;)s=Kn(t,t.l+2),u=t.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),o=t.slice(u,t.l+4+s),a.push(o),t.l+=4+s,l=x0[c=Kn(t,t.l)];var h=Zt(a);or(h,0);var d=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(d),d+=a[m].length;if(h.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function An(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=De[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||ni[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=qo(r.v):r.w=ys(r.v):r.w=Xr(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&bs(De[n]||String(n))){var i=gi(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function cl(r,e,t){return{v:r,ixfe:e,t}}function f6(r,e){var t={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,c=[],l="",u={},h,d="",m,g,p,x,T={},C=[],w,F,L=[],O=[],v={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},y=function(Be){return Be<8?ss[Be]:Be<64&&O[Be-8]||ss[Be]},I=function(Be,St,Xt){var bt=St.XF.data;if(!(!bt||!bt.patternType||!Xt||!Xt.cellStyles)){St.s={},St.s.patternType=bt.patternType;var En;(En=Zo(y(bt.icvFore)))&&(St.s.fgColor={rgb:En}),(En=Zo(y(bt.icvBack)))&&(St.s.bgColor={rgb:En})}},k=function(Be,St,Xt){if(!(Fe>1)&&!(Xt.sheetRows&&Be.r>=Xt.sheetRows)){if(Xt.cellStyles&&St.XF&&St.XF.data&&I(Be,St,Xt),delete St.ixfe,delete St.XF,h=Be,d=Pe(Be),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Be.r<a.s.r&&(a.s.r=Be.r),Be.c<a.s.c&&(a.s.c=Be.c),Be.r+1>a.e.r&&(a.e.r=Be.r+1),Be.c+1>a.e.c&&(a.e.c=Be.c+1),Xt.cellFormula&&St.f){for(var bt=0;bt<C.length;++bt)if(!(C[bt][0].s.c>Be.c||C[bt][0].s.r>Be.r)&&!(C[bt][0].e.c<Be.c||C[bt][0].e.r<Be.r)){St.F=Ve(C[bt][0]),(C[bt][0].s.c!=Be.c||C[bt][0].s.r!=Be.r)&&delete St.f,St.f&&(St.f=""+gr(C[bt][1],a,Be,Y,b));break}}Xt.dense?(i[Be.r]||(i[Be.r]=[]),i[Be.r][Be.c]=St):i[d]=St}},b={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(b.password=e.password);var R,K=[],Z=[],ge=[],de=[],ze=!1,Y=[];Y.SheetNames=b.snames,Y.sharedf=b.sharedf,Y.arrayf=b.arrayf,Y.names=[],Y.XTI=[];var Ce=0,Fe=0,B=0,z=[],W=[],H;b.codepage=1200,on(1200);for(var se=!1;r.l<r.length-1;){var he=r.l,me=r.read_shift(2);if(me===0&&Ce===10)break;var le=r.l===r.length?0:r.read_shift(2),oe=x0[me];if(oe&&oe.f){if(e.bookSheets&&Ce===133&&me!==133)break;if(Ce=me,oe.r===2||oe.r==12){var Oe=r.read_shift(2);if(le-=2,!b.enc&&Oe!==me&&((Oe&255)<<8|Oe>>8)!==me)throw new Error("rt mismatch: "+Oe+"!="+me);oe.r==12&&(r.l+=10,le-=10)}var G={};if(me===10?G=oe.f(r,le,b):G=u6(me,oe,r,le,b),Fe==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(me){case 34:t.opts.Date1904=v.WBProps.date1904=G;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(b.enc||(r.l=0),b.enc=G,!e.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=G;break;case 66:var it=Number(G);switch(it){case 21010:it=1200;break;case 32768:it=1e4;break;case 32769:it=1252;break}on(b.codepage=it),se=!0;break;case 317:b.rrtabid=G;break;case 25:b.winlocked=G;break;case 439:t.opts.RefreshAll=G;break;case 12:t.opts.CalcCount=G;break;case 16:t.opts.CalcDelta=G;break;case 17:t.opts.CalcIter=G;break;case 13:t.opts.CalcMode=G;break;case 14:t.opts.CalcPrecision=G;break;case 95:t.opts.CalcSaveRecalc=G;break;case 15:b.CalcRefMode=G;break;case 2211:t.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:L.push(G);break;case 430:Y.push([G]),Y[Y.length-1].XTI=[];break;case 35:case 547:Y[Y.length-1].push(G);break;case 24:case 536:H={Name:G.Name,Ref:gr(G.rgce,a,null,Y,b)},G.itab>0&&(H.Sheet=G.itab-1),Y.names.push(H),Y[0]||(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(W[G.itab-1]={ref:Ve(G.rgce[0][0][1][2])});break;case 22:b.ExternCount=G;break;case 23:Y.length==0&&(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].XTI=Y[Y.length-1].XTI.concat(G),Y.XTI=Y.XTI.concat(G);break;case 2196:if(b.biff<8)break;H!=null&&(H.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&b.WTF&&console.error("Password verifier: "+G);break;case 133:s[G.pos]=G,b.snames.push(G.name);break;case 10:{if(--Fe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Ve(a),e.sheetRows&&e.sheetRows<=a.e.r){var $e=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ve(a),a.e.r=$e}a.e.r++,a.e.c++}K.length>0&&(i["!merges"]=K),Z.length>0&&(i["!objects"]=Z),ge.length>0&&(i["!cols"]=ge),de.length>0&&(i["!rows"]=de),v.Sheets.push(A)}l===""?u=i:n[l]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),b.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(b.biff=5,se=!0,on(b.codepage=28591)),b.biff==8&&G.BIFFVer==0&&G.dt==16&&(b.biff=2),Fe++)break;if(i=e.dense?[]:{},b.biff<8&&!se&&(se=!0,on(b.codepage=e.codepage||1252)),b.biff<5||G.BIFFVer==0&&G.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var nt={pos:r.l-le,name:l};s[nt.pos]=nt,b.snames.push(l)}else l=(s[he]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),K=[],Z=[],b.arrayf=C=[],ge=[],de=[],ze=!1,A={Hidden:(s[he]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[G.r]||[])[G.c]:i[Pe({c:G.c,r:G.r})])&&++G.c,w={ixfe:G.ixfe,XF:L[G.ixfe]||{},v:G.val,t:"n"},B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k({c:G.c,r:G.r},w,e);break;case 5:case 517:w={ixfe:G.ixfe,XF:L[G.ixfe],v:G.val,t:G.t},B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k({c:G.c,r:G.r},w,e);break;case 638:w={ixfe:G.ixfe,XF:L[G.ixfe],v:G.rknum,t:"n"},B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k({c:G.c,r:G.r},w,e);break;case 189:for(var Ge=G.c;Ge<=G.C;++Ge){var Ee=G.rkrec[Ge-G.c][0];w={ixfe:Ee,XF:L[Ee],v:G.rkrec[Ge-G.c][1],t:"n"},B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k({c:Ge,r:G.r},w,e)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(w=cl(G.val,G.cell.ixfe,G.tt),w.XF=L[w.ixfe],e.cellFormula){var At=G.formula;if(At&&At[0]&&At[0][0]&&At[0][0][0]=="PtgExp"){var Ar=At[0][0][1][0],Rr=At[0][0][1][1],Yr=Pe({r:Ar,c:Rr});T[Yr]?w.f=""+gr(G.formula,a,G.cell,Y,b):w.F=((e.dense?(i[Ar]||[])[Rr]:i[Yr])||{}).F}else w.f=""+gr(G.formula,a,G.cell,Y,b)}B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k(G.cell,w,e),o=G}break;case 7:case 519:if(o)o.val=G,w=cl(G,o.cell.ixfe,"s"),w.XF=L[w.ixfe],e.cellFormula&&(w.f=""+gr(o.formula,a,o.cell,Y,b)),B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k(o.cell,w,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(G);var Wi=Pe(G[0].s);if(m=e.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[Wi],e.cellFormula&&m){if(!o||!Wi||!m)break;m.f=""+gr(G[1],a,G[0],Y,b),m.F=Ve(G[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Pe(o.cell)]=G[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Pe(o.cell)],(m||{}).f=""+gr(G[0],a,h,Y,b)}}break;case 253:w=cl(c[G.isst].t,G.ixfe,"s"),c[G.isst].h&&(w.h=c[G.isst].h),w.XF=L[w.ixfe],B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k({c:G.c,r:G.r},w,e);break;case 513:e.sheetStubs&&(w={ixfe:G.ixfe,XF:L[G.ixfe],t:"z"},B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k({c:G.c,r:G.r},w,e));break;case 190:if(e.sheetStubs)for(var Jr=G.c;Jr<=G.C;++Jr){var rr=G.ixfe[Jr-G.c];w={ixfe:rr,XF:L[rr],t:"z"},B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k({c:Jr,r:G.r},w,e)}break;case 214:case 516:case 4:w=cl(G.val,G.ixfe,"s"),w.XF=L[w.ixfe],B>0&&(w.z=z[w.ixfe>>8&63]),An(w,e,t.opts.Date1904),k({c:G.c,r:G.r},w,e);break;case 0:case 512:Fe===1&&(a=G);break;case 252:c=G;break;case 1054:if(b.biff==4){z[B++]=G[1];for(var Zr=0;Zr<B+163&&De[Zr]!=G[1];++Zr);Zr>=163&&Rn(G[1],B+163)}else Rn(G[1],G[0]);break;case 30:{z[B++]=G;for(var gt=0;gt<B+163&&De[gt]!=G;++gt);gt>=163&&Rn(G,B+163)}break;case 229:K=K.concat(G);break;case 93:Z[G.cmo[0]]=b.lastobj=G;break;case 438:b.lastobj.TxO=G;break;case 127:b.lastobj.ImData=G;break;case 440:for(x=G[0].s.r;x<=G[0].e.r;++x)for(p=G[0].s.c;p<=G[0].e.c;++p)m=e.dense?(i[x]||[])[p]:i[Pe({c:p,r:x})],m&&(m.l=G[1]);break;case 2048:for(x=G[0].s.r;x<=G[0].e.r;++x)for(p=G[0].s.c;p<=G[0].e.c;++p)m=e.dense?(i[x]||[])[p]:i[Pe({c:p,r:x})],m&&m.l&&(m.l.Tooltip=G[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;m=e.dense?(i[G[0].r]||[])[G[0].c]:i[Pe(G[0])];var Ot=Z[G[2]];m||(e.dense?(i[G[0].r]||(i[G[0].r]=[]),m=i[G[0].r][G[0].c]={t:"z"}):m=i[Pe(G[0])]={t:"z"},a.e.r=Math.max(a.e.r,G[0].r),a.s.r=Math.min(a.s.r,G[0].r),a.e.c=Math.max(a.e.c,G[0].c),a.s.c=Math.min(a.s.c,G[0].c)),m.c||(m.c=[]),g={a:G[1],t:Ot.TxO.t},m.c.push(g)}break;case 2173:ZR(L[G.ixfe],G.ext);break;case 125:{if(!b.cellStyles)break;for(;G.e>=G.s;)ge[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},ze||(ze=!0,nd(G.w/256)),Ri(ge[G.e+1])}break;case 520:{var Gt={};G.level!=null&&(de[G.r]=Gt,Gt.level=G.level),G.hidden&&(de[G.r]=Gt,Gt.hidden=!0),G.hpt&&(de[G.r]=Gt,Gt.hpt=G.hpt,Gt.hpx=Fa(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||cs(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[me]]=G;break;case 161:i["!margins"]||cs(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(v.Views[0].RTL=!0);break;case 146:O=G;break;case 2198:R=G;break;case 140:F=G;break;case 442:l?A.CodeName=G||A.name:v.WBProps.CodeName=G||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+me.toString(16)),r.l+=le}return t.SheetNames=Nt(s).sort(function(Vr,Be){return Number(Vr)-Number(Be)}).map(function(Vr){return s[Vr].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&u["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=u)):t.Preamble=u,t.Sheets&&W.forEach(function(Vr,Be){t.Sheets[t.SheetNames[Be]]["!autofilter"]=Vr}),t.Strings=c,t.SSF=mt(De),b.enc&&(t.Encryption=b.enc),R&&(t.Themes=R),t.Metadata={},F!==void 0&&(t.Metadata.Country=F),Y.names.length>0&&(v.Names=Y.names),t.Workbook=v,t}var Co={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function h6(r,e,t){var n=Re.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=lg(n,f0,Co.DSI);for(var s in i)e[s]=i[s]}catch(l){if(t.WTF)throw l}var a=Re.find(r,"/!SummaryInformation");if(a&&a.size>0)try{var o=lg(a,h0,Co.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(t.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(wv(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function d6(r,e){var t=[],n=[],i=[],s=0,a,o=Bp(f0,"n"),c=Bp(h0,"n");if(r.Props)for(a=Nt(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=Nt(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],r.Custprops[a[s]]]);var l=[];for(s=0;s<i.length;++s)Cv.indexOf(i[s][0])>-1||yv.indexOf(i[s][0])>-1||i[s][1]!=null&&l.push(i[s]);n.length&&Re.utils.cfb_add(e,"/SummaryInformation",ug(n,Co.SI,c,h0)),(t.length||l.length)&&Re.utils.cfb_add(e,"/DocumentSummaryInformation",ug(t,Co.DSI,o,f0,l.length?l:null,Co.UDI))}function fd(r,e){e||(e={}),dd(e),Ru(),e.codepage&&bu(e.codepage);var t,n;if(r.FullPaths){if(Re.find(r,"/encryption"))throw new Error("File is password-protected");t=Re.find(r,"!CompObj"),n=Re.find(r,"/Workbook")||Re.find(r,"/Book")}else{switch(e.type){case"base64":r=Wr(qr(r));break;case"binary":r=Wr(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}or(r,0),n={content:r}}var i,s;if(t&&c6(t),e.bookProps&&!e.bookSheets)i={};else{var a=We?"buffer":"array";if(n&&n.content)i=f6(n.content,e);else if((s=Re.find(r,"PerfectOffice_MAIN"))&&s.content)i=os.to_workbook(s.content,(e.type=a,e));else if((s=Re.find(r,"NativeContent_MAIN"))&&s.content)i=os.to_workbook(s.content,(e.type=a,e));else throw(s=Re.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&Re.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=kF(r))}var o={};return r.FullPaths&&h6(r,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=r),i}function m6(r,e){var t=e||{},n=Re.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Re.utils.cfb_add(n,i,Ay(r,t)),t.biff==8&&(r.Props||r.Custprops)&&d6(r,n),t.biff==8&&r.vbaraw&&CF(n,Re.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var nc={0:{f:BP},1:{f:KP},2:{f:h3},3:{f:t3},4:{f:YP},5:{f:l3},6:{f:_3},7:{f:s3},8:{f:A3},9:{f:T3},10:{f:w3},11:{f:E3},12:{f:XP},13:{f:m3},14:{f:n3},15:{f:ZP},16:{f:py},17:{f:v3},18:{f:o3},19:{f:Kh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:xN},40:{},42:{},43:{f:_R},44:{f:pR},45:{f:yR},46:{f:ER},47:{f:wR},48:{},49:{f:Wk},50:{},51:{f:rF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Bv},62:{f:g3},63:{f:fF},64:{f:U3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Er,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:L3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:$P},148:{f:WP,p:16},151:{f:R3},152:{},153:{f:pN},154:{},155:{},156:{f:dN},157:{},158:{},159:{T:1,f:Db},160:{T:-1},161:{T:1,f:Ns},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:S3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:eF},336:{T:-1},337:{f:sF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:u0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Vv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:F3},427:{f:D3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:N3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:zP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:C3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:u0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:EF},633:{T:1},634:{T:-1},635:{T:1,f:yF},636:{T:-1},637:{f:jk},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:nN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:G3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},x0={6:{f:wf},10:{f:ui},12:{f:$t},13:{f:$t},14:{f:Lt},15:{f:Lt},16:{f:xr},17:{f:Lt},18:{f:Lt},19:{f:$t},20:{f:gg},21:{f:gg},23:{f:Vv},24:{f:xg},25:{f:Lt},26:{},27:{},28:{f:GC},29:{},34:{f:Lt},35:{f:_g},38:{f:xr},39:{f:xr},40:{f:xr},41:{f:xr},42:{f:Lt},43:{f:Lt},47:{f:Zb},49:{f:mC},51:{f:$t},60:{},61:{f:lC},64:{f:Lt},65:{f:dC},66:{f:$t},77:{},80:{},81:{},82:{},85:{f:$t},89:{},90:{},91:{},92:{f:J4},93:{f:zC},94:{},95:{f:Lt},96:{},97:{},99:{f:Lt},125:{f:Bv},128:{f:bC},129:{f:eC},130:{f:$t},131:{f:Lt},132:{f:Lt},133:{f:tC},134:{},140:{f:JC},141:{f:$t},144:{},146:{f:tb},151:{},152:{},153:{},154:{},155:{},156:{f:$t},157:{},158:{},160:{f:cb},161:{f:ib},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:SC},190:{f:IC},193:{f:ui},197:{},198:{},199:{},200:{},201:{},202:{f:Lt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$t},220:{},221:{f:Lt},222:{},224:{f:CC},225:{f:Y4},226:{f:ui},227:{},229:{f:WC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:nC},253:{f:gC},255:{f:sC},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:bv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Lt},353:{f:ui},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:NC},431:{f:Lt},432:{},433:{},434:{},437:{},438:{f:KC},439:{f:Lt},440:{f:qC},441:{},442:{f:Sc},443:{},444:{f:$t},445:{},446:{},448:{f:ui},449:{f:cC,r:2},450:{f:ui},512:{f:dg},513:{f:ob},515:{f:DC},516:{f:xC},517:{f:pg},519:{f:lb},520:{f:aC},523:{},545:{f:vg},549:{f:hg},566:{},574:{f:fC},638:{f:AC},659:{},1048:{},1054:{f:yC},1084:{},1212:{f:VC},2048:{f:QC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:sl},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ui},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:rb,r:12},2173:{f:JR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Lt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:MC,r:12},2197:{},2198:{f:jR,r:12},2199:{},2200:{},2201:{},2202:{f:BC,r:12},2203:{f:ui},2204:{},2205:{},2206:{},2207:{},2211:{f:oC},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$t},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:sb},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:eb},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:dg},1:{},2:{f:mb},3:{f:hb},4:{f:fb},5:{f:pg},7:{f:gb},8:{},9:{f:sl},11:{},22:{f:$t},30:{f:EC},31:{},32:{},33:{f:vg},36:{},37:{f:hg},50:{f:_b},62:{},52:{},67:{},68:{f:$t},69:{},86:{},126:{},127:{f:ub},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:xb},223:{},234:{},354:{},421:{},518:{f:wf},521:{f:sl},536:{f:xg},547:{f:_g},561:{},579:{},1030:{f:wf},1033:{f:sl},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function xe(r,e,t,n){var i=e;if(!isNaN(i)){var s=n||(t||[]).length||0,a=r.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&zh(t)&&r.push(t)}}function p6(r,e,t,n){var i=(t||[]).length||0;if(i<=8224)return xe(r,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var u=r.next(4);for(u.write_shift(2,s),u.write_shift(2,l),r.push(t.slice(c,c+l)),c+=l;c<i;){for(u=r.next(4),u.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;u.write_shift(2,l),r.push(t.slice(c,c+l)),c+=l}}}function bc(r,e,t){return r||(r=ie(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function g6(r,e,t,n){var i=ie(9);return bc(i,r,e),Rv(t,n||"b",i),i}function _6(r,e,t){var n=ie(8+2*t.length);return bc(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function x6(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Kt(yt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?xe(r,2,pb(t,n,i)):xe(r,3,db(t,n,i));return;case"b":case"e":xe(r,5,g6(t,n,e.v,e.t));return;case"s":case"str":xe(r,4,_6(t,n,(e.v||"").slice(0,255)));return}xe(r,1,bc(null,t,n))}function v6(r,e,t,n){var i=Array.isArray(e),s=qe(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Ve(s)}for(var l=s.s.r;l<=s.e.r;++l){o=Dt(l);for(var u=s.s.c;u<=s.e.c;++u){l===s.s.r&&(c[u]=vt(u)),a=c[u]+o;var h=i?(e[l]||[])[u]:e[a];h&&x6(r,h,l,u)}}}function y6(r,e){for(var t=e||{},n=Lr(),i=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return xe(n,t.biff==4?1033:t.biff==3?521:9,ed(r,16,t)),v6(n,r.Sheets[r.SheetNames[i]],i,t),xe(n,10),n.end()}function w6(r,e,t){xe(r,49,pC({sz:12,name:"Arial"},t))}function E6(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&xe(r,1054,wC(i,e[i],t))})}function T6(r,e){var t=ie(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),xe(r,2151,t),t=ie(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Ov(qe(e["!ref"]||"A1"),t),t.write_shift(4,4),xe(r,2152,t)}function A6(r,e){for(var t=0;t<16;++t)xe(r,224,mg({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){xe(r,224,mg(n,0,e))})}function S6(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];xe(r,440,XC(n)),n[1].Tooltip&&xe(r,2048,YC(n))}delete e["!links"]}function I6(r,e){if(e){var t=0;e.forEach(function(n,i){++t<=256&&n&&xe(r,125,nb(Vu(i,n),i))})}}function k6(r,e,t,n,i){var s=16+Gi(i.cellXfs,e,i);if(e.v==null&&!e.bf){xe(r,513,As(t,n,s));return}if(e.bf)xe(r,6,eP(e,t,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Kt(yt(e.v)):e.v;xe(r,515,PC(t,n,a,s));break;case"b":case"e":xe(r,517,FC(t,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=cd(i.Strings,e.v,i.revStrings);xe(r,253,_C(t,n,o,s))}else xe(r,516,vC(t,n,(e.v||"").slice(0,255),s,i));break;default:xe(r,513,As(t,n,s))}}function C6(r,e,t){var n=Lr(),i=t.SheetNames[r],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[r]||{},c=Array.isArray(s),l=e.biff==8,u,h="",d=[],m=qe(s["!ref"]||"A1"),g=l?65536:16384;if(m.e.c>255||m.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,g-1)}xe(n,2057,ed(t,16,e)),xe(n,13,an(1)),xe(n,12,an(100)),xe(n,15,Ir(!0)),xe(n,17,Ir(!1)),xe(n,16,Es(.001)),xe(n,95,Ir(!0)),xe(n,42,Ir(!1)),xe(n,43,Ir(!1)),xe(n,130,an(1)),xe(n,128,RC()),xe(n,131,Ir(!1)),xe(n,132,Ir(!1)),l&&I6(n,s["!cols"]),xe(n,512,TC(m,e)),l&&(s["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){h=Dt(p);for(var x=m.s.c;x<=m.e.c;++x){p===m.s.r&&(d[x]=vt(x)),u=d[x]+h;var T=c?(s[p]||[])[x]:s[u];T&&(k6(n,T,p,x,e),l&&T.l&&s["!links"].push([u,T.l]))}}var C=o.CodeName||o.name||i;return l&&xe(n,574,hC((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&xe(n,229,HC(s["!merges"])),l&&S6(n,s),xe(n,442,Fv(C)),l&&T6(n,s),xe(n,10),n.end()}function b6(r,e,t){var n=Lr(),i=(r||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,c=t.biff==5;if(xe(n,2057,ed(r,5,t)),t.bookType=="xla"&&xe(n,135),xe(n,225,o?an(1200):null),xe(n,193,F4(2)),c&&xe(n,191),c&&xe(n,192),xe(n,226),xe(n,92,Z4("SheetJS",t)),xe(n,66,an(o?1200:1252)),o&&xe(n,353,an(0)),o&&xe(n,448),xe(n,317,ab(r.SheetNames.length)),o&&r.vbaraw&&xe(n,211),o&&r.vbaraw){var l=a.CodeName||"ThisWorkbook";xe(n,442,Fv(l))}xe(n,156,an(17)),xe(n,25,Ir(!1)),xe(n,18,Ir(!1)),xe(n,19,an(0)),o&&xe(n,431,Ir(!1)),o&&xe(n,444,an(0)),xe(n,61,uC()),xe(n,64,Ir(!1)),xe(n,141,an(0)),xe(n,34,Ir(cN(r)=="true")),xe(n,14,Ir(!0)),o&&xe(n,439,Ir(!1)),xe(n,218,an(0)),w6(n,r,t),E6(n,r.SSF,t),A6(n,t),o&&xe(n,352,Ir(!1));var u=n.end(),h=Lr();o&&xe(h,140,ZC()),o&&t.Strings&&p6(h,252,iC(t.Strings)),xe(h,10);var d=h.end(),m=Lr(),g=0,p=0;for(p=0;p<r.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*r.SheetNames[p].length;var x=u.length+g+d.length;for(p=0;p<r.SheetNames.length;++p){var T=s[p]||{};xe(m,133,rC({pos:x,hs:T.Hidden||0,dt:0,name:r.SheetNames[p]},t)),x+=e[p].length}var C=m.end();if(g!=C.length)throw new Error("BS8 "+g+" != "+C.length);var w=[];return u.length&&w.push(u),C.length&&w.push(C),d.length&&w.push(d),Zt(w)}function R6(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=mt(De)),r&&r.SSF&&(Ga(),Ec(r.SSF),t.revssf=Du(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,md(t),t.cellXfs=[],Gi(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)n[n.length]=C6(i,t,r);return n.unshift(b6(r,n,t)),Zt(n)}function Ay(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var i=br(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return R6(r,e);case 4:case 3:case 2:return y6(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function bg(r,e){var t=e||{},n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var i=r.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),a=i.index,o=s&&s.index||r.length,c=pk(r.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<c.length;++a){var p=c[a].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var T=p.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var C=T[o].trim();if(C.match(/<t[dh]/i)){for(var w=C,F=0;w.charAt(0)=="<"&&(F=w.indexOf(">"))>-1;)w=w.slice(F+1);for(var L=0;L<g.length;++L){var O=g[L];O.s.c==u&&O.s.r<l&&l<=O.e.r&&(u=O.e.c+1,L=-1)}var v=Ne(C.slice(0,C.indexOf(">")));d=v.colspan?+v.colspan:1,((h=+v.rowspan)>1||d>1)&&g.push({s:{r:l,c:u},e:{r:l+(h||1)-1,c:u+d-1}});var A=v.t||v["data-t"]||"";if(!w.length){u+=d;continue}if(w=Jx(w),m.s.r>l&&(m.s.r=l),m.e.r<l&&(m.e.r=l),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!w.length){u+=d;continue}var y={t:"s",v:w};t.raw||!w.trim().length||A=="s"||(w==="TRUE"?y={t:"b",v:!0}:w==="FALSE"?y={t:"b",v:!1}:isNaN(vn(w))?isNaN(ba(w).getDate())||(y={t:"d",v:yt(w)},t.cellDates||(y={t:"n",v:Kt(y.v)}),y.z=t.dateNF||De[14]):y={t:"n",v:vn(w)}),t.dense?(n[l]||(n[l]=[]),n[l][u]=y):n[Pe({r:l,c:u})]=y,u+=d}}}}return n["!ref"]=Ve(m),g.length&&(n["!merges"]=g),n}function Sy(r,e,t,n){for(var i=r["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>t||i[l].s.c>a)&&!(i[l].e.r<t||i[l].e.c<a)){if(i[l].s.r<t||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var u=Pe({r:t,c:a}),h=n.dense?(r[t]||[])[a]:r[u],d=h&&h.v!=null&&(h.h||Mh(h.w||(Pn(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+u,s.push(_e("td",d,m))}}var g="<tr>";return g+s.join("")+"</tr>"}var Iy='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ky="</body></html>";function F6(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ui(bg(t[0],e),e);var n=vd();return t.forEach(function(i,s){yd(n,bg(i,e),"Sheet"+(s+1))}),n}function Cy(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function by(r,e){var t=e||{},n=t.header!=null?t.header:Iy,i=t.footer!=null?t.footer:ky,s=[n],a=br(r["!ref"]);t.dense=Array.isArray(r),s.push(Cy(r,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(Sy(r,a,o,t));return s.push("</table>"+i),s.join("")}function Ry(r,e,t){var n=t||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?kt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(r["!ref"]){var u=br(r["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),i==-1&&(l.e.r=i=u.e.r+1)}var h=[],d=0,m=r["!rows"]||(r["!rows"]=[]),g=0,p=0,x=0,T=0,C=0,w=0;for(r["!cols"]||(r["!cols"]=[]);g<o.length&&p<c;++g){var F=o[g];if(Rg(F)){if(n.display)continue;m[p]={hidden:!0}}var L=F.children;for(x=T=0;x<L.length;++x){var O=L[x];if(!(n.display&&Rg(O))){var v=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):Jx(O.innerHTML),A=O.getAttribute("data-z")||O.getAttribute("z");for(d=0;d<h.length;++d){var y=h[d];y.s.c==T+s&&y.s.r<p+i&&p+i<=y.e.r&&(T=y.e.c+1-s,d=-1)}w=+O.getAttribute("colspan")||1,((C=+O.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:p+i,c:T+s},e:{r:p+i+(C||1)-1,c:T+s+(w||1)-1}});var I={t:"s",v},k=O.getAttribute("data-t")||O.getAttribute("t")||"";v!=null&&(v.length==0?I.t=k||"z":n.raw||v.trim().length==0||k=="s"||(v==="TRUE"?I={t:"b",v:!0}:v==="FALSE"?I={t:"b",v:!1}:isNaN(vn(v))?isNaN(ba(v).getDate())||(I={t:"d",v:yt(v)},n.cellDates||(I={t:"n",v:Kt(I.v)}),I.z=n.dateNF||De[14]):I={t:"n",v:vn(v)})),I.z===void 0&&A!=null&&(I.z=A);var b="",R=O.getElementsByTagName("A");if(R&&R.length)for(var K=0;K<R.length&&!(R[K].hasAttribute("href")&&(b=R[K].getAttribute("href"),b.charAt(0)!="#"));++K);b&&b.charAt(0)!="#"&&(I.l={Target:b}),n.dense?(r[p+i]||(r[p+i]=[]),r[p+i][T+s]=I):r[Pe({c:T+s,r:p+i})]=I,l.e.c<T+s&&(l.e.c=T+s),T+=w}}++p}return h.length&&(r["!merges"]=(r["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,p-1+i),r["!ref"]=Ve(l),p>=c&&(r["!fullref"]=Ve((l.e.r=o.length-g+p-1+i,l))),r}function Fy(r,e){var t=e||{},n=t.dense?[]:{};return Ry(n,r,e)}function D6(r,e){return Ui(Fy(r,e),e)}function Rg(r){var e="",t=P6(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function P6(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function N6(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Ze(e.replace(/<[^>]*>/g,""));return[t]}var Fg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Dy(r,e){var t=e||{},n=Vh(r),i=[],s,a,o={name:""},c="",l=0,u,h,d={},m=[],g=t.dense?[]:{},p,x,T={value:""},C="",w=0,F=[],L=-1,O=-1,v={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,y={},I=[],k={},b=0,R=0,K=[],Z=1,ge=1,de=[],ze={Names:[]},Y={},Ce=["",""],Fe=[],B={},z="",W=0,H=!1,se=!1,he=0;for(Yo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Yo.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(v.e.c>=v.s.c&&v.e.r>=v.s.r?g["!ref"]=Ve(v):g["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=v.e.r&&(g["!fullref"]=g["!ref"],v.e.r=t.sheetRows-1,g["!ref"]=Ve(v)),I.length&&(g["!merges"]=I),K.length&&(g["!rows"]=K),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),d[u.name]=g,se=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Ne(p[0],!1),L=O=-1,v.s.r=v.s.c=1e7,v.e.r=v.e.c=0,g=t.dense?[]:{},I=[],K=[],se=!0);break;case"table-row-group":p[1]==="/"?--A:++A;break;case"table-row":case"":if(p[1]==="/"){L+=Z,Z=1;break}if(h=Ne(p[0],!1),h.?L=h.-1:L==-1&&(L=0),Z=+h["number-rows-repeated"]||1,Z<10)for(he=0;he<Z;++he)A>0&&(K[L+he]={level:A});O=-1;break;case"covered-table-cell":p[1]!=="/"&&++O,t.sheetStubs&&(t.dense?(g[L]||(g[L]=[]),g[L][O]={t:"z"}):g[Pe({r:L,c:O})]={t:"z"}),C="",F=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++O,T=Ne(p[0],!1),ge=parseInt(T["number-columns-repeated"]||"1",10),x={t:"z",v:null},T.formula&&t.cellFormula!=!1&&(x.f=Ig(Ze(T.formula))),(T.||T["value-type"])=="string"&&(x.t="s",x.v=Ze(T["string-value"]||""),t.dense?(g[L]||(g[L]=[]),g[L][O]=x):g[Pe({r:L,c:O})]=x),O+=ge-1;else if(p[1]!=="/"){++O,C="",w=0,F=[],ge=1;var me=Z?L+Z-1:L;if(O>v.e.c&&(v.e.c=O),O<v.s.c&&(v.s.c=O),L<v.s.r&&(v.s.r=L),me>v.e.r&&(v.e.r=me),T=Ne(p[0],!1),Fe=[],B={},x={t:T.||T["value-type"],v:null},t.cellFormula)if(T.formula&&(T.formula=Ze(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(b=parseInt(T["number-matrix-rows-spanned"],10)||0,R=parseInt(T["number-matrix-columns-spanned"],10)||0,k={s:{r:L,c:O},e:{r:L+b-1,c:O+R-1}},x.F=Ve(k),de.push([k,x.F])),T.formula)x.f=Ig(T.formula);else for(he=0;he<de.length;++he)L>=de[he][0].s.r&&L<=de[he][0].e.r&&O>=de[he][0].s.c&&O<=de[he][0].e.c&&(x.F=de[he][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(b=parseInt(T["number-rows-spanned"],10)||0,R=parseInt(T["number-columns-spanned"],10)||0,k={s:{r:L,c:O},e:{r:L+b-1,c:O+R-1}},I.push(k)),T["number-columns-repeated"]&&(ge=parseInt(T["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=xt(T["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(T.value);break;case"percentage":x.t="n",x.v=parseFloat(T.value);break;case"currency":x.t="n",x.v=parseFloat(T.value);break;case"date":x.t="d",x.v=yt(T["date-value"]),t.cellDates||(x.t="n",x.v=Kt(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=hk(T["time-value"])/86400,t.cellDates&&(x.t="d",x.v=Pu(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(T.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",T["string-value"]!=null&&(C=Ze(T["string-value"]),F=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(H=!1,x.t==="s"&&(x.v=C||"",F.length&&(x.R=F),H=w==0),Y.Target&&(x.l=Y),Fe.length>0&&(x.c=Fe,Fe=[]),C&&t.cellText!==!1&&(x.w=C),H&&(x.t="z",delete x.v),(!H||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=L))for(var le=0;le<Z;++le){if(ge=parseInt(T["number-columns-repeated"]||"1",10),t.dense)for(g[L+le]||(g[L+le]=[]),g[L+le][O]=le==0?x:mt(x);--ge>0;)g[L+le][O+ge]=mt(x);else for(g[Pe({r:L+le,c:O})]=x;--ge>0;)g[Pe({r:L+le,c:O+ge})]=mt(x);v.e.c<=O&&(v.e.c=O)}ge=parseInt(T["number-columns-repeated"]||"1",10),O+=ge-1,ge=0,x={},C="",F=[]}Y={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s;B.t=C,F.length&&(B.R=F),B.a=z,Fe.push(B)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);z="",W=0,C="",w=0,F=[];break;case"creator":p[1]==="/"?z=n.slice(W,p.index):W=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);C="",w=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(y[o.name]=c,(s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=Ne(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ne(p[0],!1),c+=Fg[p[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ne(p[0],!1),c+=Fg[p[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":a=Ne(p[0],!1),Ce=Ef(a["cell-range-address"]);var oe={Name:a.name,Ref:Ce[0]+"!"+Ce[1]};se&&(oe.Sheet=m.length),ze.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!T||!T["string-value"])){var Oe=N6(n.slice(w,p.index));C=(C.length>0?C+`
`:"")+Oe[0]}else Ne(p[0],!1),w=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{Ce=Ef(Ne(p[0])["target-range-address"]),d[Ce[0]]["!autofilter"]={ref:Ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Y=Ne(p[0],!1),!Y.href)break;Y.Target=Ze(Y.href),delete Y.href,Y.Target.charAt(0)=="#"&&Y.Target.indexOf(".")>-1?(Ce=Ef(Y.Target.slice(1)),Y.Target="#"+Ce[0]+"!"+Ce[1]):Y.Target.match(/^\.\.[\\\/]/)&&(Y.Target=Y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(p)}}var G={Sheets:d,SheetNames:m,Workbook:ze};return t.bookSheets&&delete G.Sheets,G}function Dg(r,e){e=e||{},sn(r,"META-INF/manifest.xml")&&h4(zt(r,"META-INF/manifest.xml"),e);var t=Hr(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=Dy(ut(t),e);return sn(r,"meta.xml")&&(n.Props=xv(zt(r,"meta.xml"))),n}function Pg(r,e){return Dy(r,e)}var O6=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Ut+e}}(),Ng=function(){var r=function(s){return lt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+lt(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,u=0,h=br(s["!ref"]||"A1"),d=s["!merges"]||[],m=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)c.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(l=0;l<h.s.r;++l)p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=h.e.r;++l){for(p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<h.s.c;++u)c.push(e);for(;u<=h.e.c;++u){var T=!1,C={},w="";for(m=0;m!=d.length;++m)if(!(d[m].s.c>u)&&!(d[m].s.r>l)&&!(d[m].e.c<u)&&!(d[m].e.r<l)){(d[m].s.c!=u||d[m].s.r!=l)&&(T=!0),C["table:number-columns-spanned"]=d[m].e.c-d[m].s.c+1,C["table:number-rows-spanned"]=d[m].e.r-d[m].s.r+1;break}if(T){c.push(t);continue}var F=Pe({r:l,c:u}),L=g?(s[l]||[])[u]:s[F];if(L&&L.f&&(C["table:formula"]=lt(aP(L.f)),L.F&&L.F.slice(0,F.length)==F)){var O=br(L.F);C["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,C["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!L){c.push(e);continue}switch(L.t){case"b":w=L.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=L.v?"true":"false";break;case"n":w=L.w||String(L.v||0),C["office:value-type"]="float",C["office:value"]=L.v||0;break;case"s":case"str":w=L.v==null?"":L.v,C["office:value-type"]="string";break;case"d":w=L.w||yt(L.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=yt(L.v).toISOString(),C["table:style-name"]="ce1";break;default:c.push(e);continue}var v=r(w);if(L.l&&L.l.Target){var A=L.l.Target;A=A.charAt(0)=="#"?"#"+oP(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),v=_e("text:a",v,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+_e("table:table-cell",_e("text:p",v,{}),C)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var u=0;u<l["!cols"].length;++u)if(l["!cols"][u]){var h=l["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ri(h),h.ods=o;var d=l["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var u=0;u<l["!rows"].length;++u)if(l["!rows"][u]){l["!rows"][u].ods=c;var h=l["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[Ut],l=Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Qo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+u+`>
`),c.push(_v().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)c.push(n(a.Sheets[a.SheetNames[h]],a,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Py(r,e){if(e.bookType=="fods")return Ng(r,e);var t=Nh(),n="",i=[],s=[];return n="mimetype",Ue(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ue(t,n,Ng(r,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ue(t,n,O6(r,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ue(t,n,Ut+_v()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ue(t,n,p4(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ue(t,n,d4(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ss(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function v0(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):ut(Bi(r))}function L6(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Wr(bn(r))}function M6(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function Di(r){var e=r.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function Og(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function V6(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,i=e+13;i>=e;--i)n=n*256+r[i];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function B6(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)r[e+s]=i&255;r[e+15]|=t>=0?0:128}function ic(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function at(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Pt(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function rt(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=ic(r,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=t[0];r[t[0]++]>=128;);o=r.slice(c,t[0])}break;case 5:a=4,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=ic(r,t),o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:s};e[i]==null?e[i]=[l]:e[i].push(l)}return e}function sr(r){var e=[];return r.forEach(function(t,n){t.forEach(function(i){i.data&&(e.push(at(n*8+i.type)),i.type==2&&e.push(at(i.data.length)),e.push(i.data))})}),Di(e)}function hd(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function rn(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=ic(r,n),s=rt(r.slice(n[0],n[0]+i));n[0]+=i;var a={id:Pt(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=rt(o.data),l=Pt(c[3][0].data);a.messages.push({meta:c,data:r.slice(n[0],n[0]+l)}),n[0]+=l}),(e=s[3])!=null&&e[0]&&(a.merge=Pt(s[3][0].data)>>>0>0),t.push(a)}return t}function qs(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:at(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:at(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:at(a.data.length)}],n[2].push({data:sr(a.meta),type:2})});var s=sr(n);e.push(at(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Di(e)}function U6(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=ic(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(e[t[0]]>>2&7)+4,c=(e[t[0]++]&224)<<3,c|=e[t[0]++]):(l=(e[t[0]++]>>2)+1,s==2?(c=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(c=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Di(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var u=Di(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function nn(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(U6(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return Di(e)}function Xs(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=at(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=n}return Di(e)}function G6(r,e,t,n){var i=Ss(r),s=i.getUint32(4,!0),a=(n>1?12:8)+Og(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Og(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(l=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(r[2]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[c]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:t[o]};else if(c>-1)h={t:"s",v:e[c]};else if(!isNaN(l))h={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return h}function W6(r,e,t){var n=Ss(r),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,l=NaN,u=new Date(2001,0,1);i&1&&(c=V6(r,s),s+=16),i&2&&(l=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(r[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)))}return h}function Af(r,e){var t=new Uint8Array(32),n=Ss(t),i=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,B6(t,i,r.v),s|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,r.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,i)}function Sf(r,e){var t=new Uint8Array(32),n=Ss(t),i=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(i,r.v,!0),s|=32,i+=8;break;case"b":t[2]=6,n.setFloat64(i,r.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,i)}function H6(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return G6(r,e,t,r[0]);case 5:return W6(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function pr(r){var e=rt(r);return ic(e[1][0].data)}function Lg(r,e){var t=rt(e.data),n=Pt(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(a){var o=rt(a.data),c=Pt(o[1][0].data)>>>0;switch(n){case 1:s[c]=v0(o[3][0].data);break;case 8:{var l=r[pr(o[9][0].data)][0],u=rt(l.data),h=r[pr(u[1][0].data)][0],d=Pt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=rt(h.data);s[c]=m[3].map(function(g){return v0(g.data)}).join("")}break}}),s}function z6(r,e){var t,n,i,s,a,o,c,l,u,h,d,m,g,p,x=rt(r),T=Pt(x[1][0].data)>>>0,C=Pt(x[2][0].data)>>>0,w=((n=(t=x[8])==null?void 0:t[0])==null?void 0:n.data)&&Pt(x[8][0].data)>0||!1,F,L;if((s=(i=x[7])==null?void 0:i[0])!=null&&s.data&&e!=0)F=(o=(a=x[7])==null?void 0:a[0])==null?void 0:o.data,L=(l=(c=x[6])==null?void 0:c[0])==null?void 0:l.data;else if((h=(u=x[4])==null?void 0:u[0])!=null&&h.data&&e!=1)F=(m=(d=x[4])==null?void 0:d[0])==null?void 0:m.data,L=(p=(g=x[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var O=w?4:1,v=Ss(F),A=[],y=0;y<F.length/2;++y){var I=v.getUint16(y*2,!0);I<65535&&A.push([y,I])}if(A.length!=C)throw"Expected ".concat(C," cells, found ").concat(A.length);var k=[];for(y=0;y<A.length-1;++y)k[A[y][0]]=L.subarray(A[y][1]*O,A[y+1][1]*O);return A.length>=1&&(k[A[A.length-1][0]]=L.subarray(A[A.length-1][1]*O)),{R:T,cells:k}}function $6(r,e){var t,n=rt(e.data),i=(t=n==null?void 0:n[7])!=null&&t[0]?Pt(n[7][0].data)>>>0>0?1:0:-1,s=hd(n[5],function(a){return z6(a,i)});return{nrows:Pt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function j6(r,e,t){var n,i=rt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Pt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Pt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=Ve(s);var a=rt(i[4][0].data),o=Lg(r,r[pr(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?Lg(r,r[pr(a[17][0].data)][0]):[],l=rt(a[3][0].data),u=0;l[1].forEach(function(h){var d=rt(h.data),m=r[pr(d[2][0].data)][0],g=Pt(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=$6(r,m);p.data.forEach(function(x,T){x.forEach(function(C,w){var F=Pe({r:u+T,c:w}),L=H6(C,o,c);L&&(t[F]=L)})}),u+=p.nrows})}function K6(r,e){var t=rt(e.data),n={"!ref":"A1"},i=r[pr(t[2][0].data)],s=Pt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return j6(r,i[0],n),n}function q6(r,e){var t,n=rt(e.data),i={name:(t=n[1])!=null&&t[0]?v0(n[1][0].data):"",sheets:[]},s=hd(n[2],pr);return s.forEach(function(a){r[a].forEach(function(o){var c=Pt(o.meta[1][0].data);c==6e3&&i.sheets.push(K6(r,o))})}),i}function X6(r,e){var t=vd(),n=rt(e.data),i=hd(n[1],pr);if(i.forEach(function(s){r[s].forEach(function(a){var o=Pt(a.meta[1][0].data);if(o==2){var c=q6(r,a);c.sheets.forEach(function(l,u){yd(t,l,u==0?c.name:c.name+"_"+u,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function If(r){var e,t,n,i,s={},a=[];if(r.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=nn(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var u;try{u=rn(l)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Pt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(l){var u=Pt(l.meta[1][0].data)>>>0;if(u==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return X6(s,o)}function Q6(r,e,t){var n,i,s,a;if(!((n=r[6])!=null&&n[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&Pt(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Ss(r[7][0].data),u=0,h=[],d=Ss(r[4][0].data),m=0,g=[],p=0;p<e.length;++p){if(e[p]==null){l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}l.setUint16(p*2,u,!0),d.setUint16(p*2,m,!0);var x,T;switch(typeof e[p]){case"string":x=Af({t:"s",v:e[p]},t),T=Sf({t:"s",v:e[p]},t);break;case"number":x=Af({t:"n",v:e[p]},t),T=Sf({t:"n",v:e[p]},t);break;case"boolean":x=Af({t:"b",v:e[p]},t),T=Sf({t:"b",v:e[p]},t);break;default:throw new Error("Unsupported value "+e[p])}h.push(x),u+=x.length,g.push(T),m+=T.length,++c}for(r[2][0].data=at(c);p<r[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return r[6][0].data=Di(h),r[3][0].data=Di(g),c}function Y6(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=br(t["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ve(n)));var s=iu(t,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(z){return z.forEach(function(W){typeof W=="string"&&a.push(W)})});var o={},c=[],l=Re.read(e.numbers,{type:"base64"});l.FileIndex.map(function(z,W){return[z,l.FullPaths[W]]}).forEach(function(z){var W=z[0],H=z[1];if(W.type==2&&W.name.match(/\.iwa/)){var se=W.content,he=nn(se),me=rn(he);me.forEach(function(le){c.push(le.id),o[le.id]={deps:[],location:H,type:Pt(le.messages[0].meta[1][0].data)}})}}),c.sort(function(z,W){return z-W});var u=c.filter(function(z){return z>1}).map(function(z){return[z,at(z)]});l.FileIndex.map(function(z,W){return[z,l.FullPaths[W]]}).forEach(function(z){var W=z[0];if(z[1],!!W.name.match(/\.iwa/)){var H=rn(nn(W.content));H.forEach(function(se){se.messages.forEach(function(he){u.forEach(function(me){se.messages.some(function(le){return Pt(le.meta[1][0].data)!=11006&&M6(le.data,me[1])})&&o[me[0]].deps.push(se.id)})})})}});for(var h=Re.find(l,o[1].location),d=rn(nn(h.content)),m,g=0;g<d.length;++g){var p=d[g];p.id==1&&(m=p)}var x=pr(rt(m.messages[0].data)[1][0].data);for(h=Re.find(l,o[x].location),d=rn(nn(h.content)),g=0;g<d.length;++g)p=d[g],p.id==x&&(m=p);for(x=pr(rt(m.messages[0].data)[2][0].data),h=Re.find(l,o[x].location),d=rn(nn(h.content)),g=0;g<d.length;++g)p=d[g],p.id==x&&(m=p);for(x=pr(rt(m.messages[0].data)[2][0].data),h=Re.find(l,o[x].location),d=rn(nn(h.content)),g=0;g<d.length;++g)p=d[g],p.id==x&&(m=p);var T=rt(m.messages[0].data);{T[6][0].data=at(n.e.r+1),T[7][0].data=at(n.e.c+1);var C=pr(T[46][0].data),w=Re.find(l,o[C].location),F=rn(nn(w.content));{for(var L=0;L<F.length&&F[L].id!=C;++L);if(F[L].id!=C)throw"Bad ColumnRowUIDMapArchive";var O=rt(F[L].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var v=0;v<=n.e.c;++v){var A=[];A[1]=A[2]=[{type:0,data:at(v+420690)}],O[1].push({type:2,data:sr(A)}),O[2].push({type:0,data:at(v)}),O[3].push({type:0,data:at(v)})}O[4]=[],O[5]=[],O[6]=[];for(var y=0;y<=n.e.r;++y)A=[],A[1]=A[2]=[{type:0,data:at(y+726270)}],O[4].push({type:2,data:sr(A)}),O[5].push({type:0,data:at(y)}),O[6].push({type:0,data:at(y)});F[L].messages[0].data=sr(O)}w.content=Xs(qs(F)),w.size=w.content.length,delete T[46];var I=rt(T[4][0].data);{I[7][0].data=at(n.e.r+1);var k=rt(I[1][0].data),b=pr(k[2][0].data);w=Re.find(l,o[b].location),F=rn(nn(w.content));{if(F[0].id!=b)throw"Bad HeaderStorageBucket";var R=rt(F[0].messages[0].data);for(y=0;y<s.length;++y){var K=rt(R[2][0].data);K[1][0].data=at(y),K[4][0].data=at(s[y].length),R[2][y]={type:R[2][0].type,data:sr(K)}}F[0].messages[0].data=sr(R)}w.content=Xs(qs(F)),w.size=w.content.length;var Z=pr(I[2][0].data);w=Re.find(l,o[Z].location),F=rn(nn(w.content));{if(F[0].id!=Z)throw"Bad HeaderStorageBucket";for(R=rt(F[0].messages[0].data),v=0;v<=n.e.c;++v)K=rt(R[2][0].data),K[1][0].data=at(v),K[4][0].data=at(n.e.r+1),R[2][v]={type:R[2][0].type,data:sr(K)};F[0].messages[0].data=sr(R)}w.content=Xs(qs(F)),w.size=w.content.length;var ge=pr(I[4][0].data);(function(){for(var z=Re.find(l,o[ge].location),W=rn(nn(z.content)),H,se=0;se<W.length;++se){var he=W[se];he.id==ge&&(H=he)}var me=rt(H.messages[0].data);{me[3]=[];var le=[];a.forEach(function(G,it){le[1]=[{type:0,data:at(it)}],le[2]=[{type:0,data:at(1)}],le[3]=[{type:2,data:L6(G)}],me[3].push({type:2,data:sr(le)})})}H.messages[0].data=sr(me);var oe=qs(W),Oe=Xs(oe);z.content=Oe,z.size=z.content.length})();var de=rt(I[3][0].data);{var ze=de[1][0];delete de[2];var Y=rt(ze.data);{var Ce=pr(Y[2][0].data);(function(){for(var z=Re.find(l,o[Ce].location),W=rn(nn(z.content)),H,se=0;se<W.length;++se){var he=W[se];he.id==Ce&&(H=he)}var me=rt(H.messages[0].data);{delete me[6],delete de[7];var le=new Uint8Array(me[5][0].data);me[5]=[];for(var oe=0,Oe=0;Oe<=n.e.r;++Oe){var G=rt(le);oe+=Q6(G,s[Oe],a),G[1][0].data=at(Oe),me[5].push({data:sr(G),type:2})}me[1]=[{type:0,data:at(n.e.c+1)}],me[2]=[{type:0,data:at(n.e.r+1)}],me[3]=[{type:0,data:at(oe)}],me[4]=[{type:0,data:at(n.e.r+1)}]}H.messages[0].data=sr(me);var it=qs(W),$e=Xs(it);z.content=$e,z.size=z.content.length})()}ze.data=sr(Y)}I[3][0].data=sr(de)}T[4][0].data=sr(I)}m.messages[0].data=sr(T);var Fe=qs(d),B=Xs(Fe);return h.content=B,h.size=h.content.length,l}function Ny(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function dd(r){Ny([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function md(r){Ny([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function J6(r){return je.WS.indexOf(r)>-1?"sheet":r==je.CS?"chart":r==je.DS?"dialog":r==je.MS?"macro":r&&r.length?r:"sheet"}function Z6(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,J6(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function eO(r,e,t,n,i,s,a,o,c,l,u,h){try{s[n]=Ao(Hr(r,t,!0),e);var d=zt(r,e),m;switch(o){case"sheet":m=IN(d,e,i,c,s[n],l,u,h);break;case"chart":if(m=kN(d,e,i,c,s[n],l,u,h),!m||!m["!drawel"])break;var g=mo(m["!drawel"].Target,e),p=Jo(g),x=mF(Hr(r,g,!0),Ao(Hr(r,p,!0),g)),T=mo(x,g),C=Jo(T);m=tN(Hr(r,T,!0),T,c,Ao(Hr(r,C,!0),T),l,m);break;case"macro":m=CN(d,e,i,c,s[n],l,u,h);break;case"dialog":m=bN(d,e,i,c,s[n],l,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var w=[];s&&s[n]&&Nt(s[n]).forEach(function(F){var L="";if(s[n][F].Type==je.CMNT){L=mo(s[n][F].Target,e);var O=PN(zt(r,L,!0),L,c);if(!O||!O.length)return;wg(m,O,!1)}s[n][F].Type==je.TCMNT&&(L=mo(s[n][F].Target,e),w=w.concat(gF(zt(r,L,!0),c)))}),w&&w.length&&wg(m,w,!0,c.people||[])}catch(F){if(c.WTF)throw F}}function en(r){return r.charAt(0)=="/"?r.slice(1):r}function Oy(r,e){if(Ga(),e=e||{},dd(e),sn(r,"META-INF/manifest.xml")||sn(r,"objectdata.xml"))return Dg(r,e);if(sn(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof If<"u"){if(r.FileIndex)return If(r);var t=Re.utils.cfb_new();return Wp(r).forEach(function(K){Ue(t,K,_k(r,K))}),If(t)}throw new Error("Unsupported NUMBERS file")}if(!sn(r,"[Content_Types].xml"))throw sn(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):sn(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Wp(r),i=u4(Hr(r,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",zt(r,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!zt(r,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(So=[],i.sst)try{So=DN(zt(r,en(i.sst)),i.sst,e)}catch(K){if(e.WTF)throw K}e.cellStyles&&i.themes.length&&(c=FN(Hr(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(l=RN(zt(r,en(i.style)),i.style,c,e))}i.links.map(function(K){try{var Z=Ao(Hr(r,Jo(en(K))),K);return ON(zt(r,en(K)),Z,K,e)}catch{}});var u=SN(zt(r,en(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=zt(r,en(i.coreprops[0]),!0),d&&(h=xv(d)),i.extprops.length!==0&&(d=zt(r,en(i.extprops[0]),!0),d&&_4(d,h,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=Hr(r,en(i.custprops[0]),!0),d&&(m=v4(d,e)));var g={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(Z){return Z.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=m),e.bookSheets&&typeof a<"u"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var p={};e.bookDeps&&i.calcchain&&(p=NN(zt(r,en(i.calcchain)),i.calcchain));var x=0,T={},C,w;{var F=u.Sheets;h.Worksheets=F.length,h.SheetNames=[];for(var L=0;L!=F.length;++L)h.SheetNames[L]=F[L].name}var O=s?"bin":"xml",v=i.workbooks[0].lastIndexOf("/"),A=(i.workbooks[0].slice(0,v+1)+"_rels/"+i.workbooks[0].slice(v+1)+".rels").replace(/^\//,"");sn(r,A)||(A="xl/_rels/workbook."+O+".rels");var y=Ao(Hr(r,A,!0),A.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=LN(zt(r,en(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=xF(zt(r,en(i.people[0])),e)),y&&(y=Z6(y,u.Sheets));var I=zt(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=h.Worksheets;++x){var k="sheet";if(y&&y[x]?(C="xl/"+y[x][1].replace(/[\/]?xl\//,""),sn(r,C)||(C=y[x][1]),sn(r,C)||(C=A.replace(/_rels\/.*$/,"")+y[x][1]),k=y[x][2]):(C="xl/worksheets/sheet"+(x+1-I)+"."+O,C=C.replace(/sheet0\./,"sheet.")),w=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(h.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var b=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==x&&(b=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[x].toLowerCase()&&(b=1);if(!b)continue e}}eO(r,C,w,h.SheetNames[x],x,T,a,k,e,u,c,l)}return g={Directory:i,Workbook:u,Props:h,Custprops:m,Deps:p,Sheets:a,SheetNames:h.SheetNames,Strings:So,Styles:l,Themes:c,SSF:mt(De)},e&&e.bookFiles&&(r.files?(g.keys=n,g.files=r.files):(g.keys=[],g.files={},r.FullPaths.forEach(function(K,Z){K=K.replace(/^Root Entry[\/]/,""),g.keys.push(K),g.files[K]=r.FileIndex[Z]}))),e&&e.bookVBA&&(i.vba.length>0?g.vbaraw=zt(r,en(i.vba[0]),!0):i.defaults&&i.defaults.bin===IF&&(g.vbaraw=zt(r,"xl/vbaProject.bin",!0))),g}function tO(r,e){var t=e||{},n="Workbook",i=Re.find(r,n);try{if(n="/!DataSpaces/Version",i=Re.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Mb(i.content),n="/!DataSpaces/DataSpaceMap",i=Re.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Bb(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Re.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Ub(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Re.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Wb(i.content)}catch{}if(n="/EncryptionInfo",i=Re.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Hb(i.content);if(n="/EncryptedPackage",i=Re.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function rO(r,e){return e.bookType=="ods"?Py(r,e):e.bookType=="numbers"?Y6(r,e):e.bookType=="xlsb"?nO(r,e):Ly(r,e)}function nO(r,e){ia=1024,r&&!r.SSF&&(r.SSF=mt(De)),r&&r.SSF&&(Ga(),Ec(r.SSF),e.revssf=Du(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Io?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=ny.indexOf(e.bookType)>-1,i=Jh();md(e=e||{});var s=Nh(),a="",o=0;if(e.cellXfs=[],Gi(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Ue(s,a,vv(r.Props,e)),i.coreprops.push(a),ot(e.rels,2,a,je.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,Ue(s,a,Ev(r.Props)),i.extprops.push(a),ot(e.rels,3,a,je.EXT_PROPS),r.Custprops!==r.Props&&Nt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Ue(s,a,Tv(r.Custprops)),i.custprops.push(a),ot(e.rels,4,a,je.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var u={"!id":{}},h=r.Sheets[r.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,Ue(s,a,VN(o-1,a,e,r,u)),i.sheets.push(a),ot(e.wbrels,-1,"worksheets/sheet"+o+"."+t,je.WS[0])}if(h){var m=h["!comments"],g=!1,p="";m&&m.length>0&&(p="xl/comments"+o+"."+t,Ue(s,p,GN(m,p)),i.comments.push(p),ot(u,-1,"../comments"+o+"."+t,je.CMNT),g=!0),h["!legacy"]&&g&&Ue(s,"xl/drawings/vmlDrawing"+o+".vml",ty(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Ue(s,Jo(a),la(u))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,Ue(s,a,UN(e.Strings,a,e)),i.strs.push(a),ot(e.wbrels,-1,"sharedStrings."+t,je.SST)),a="xl/workbook."+t,Ue(s,a,MN(r,a)),i.workbooks.push(a),ot(e.rels,1,a,je.WB),a="xl/theme/theme1.xml",Ue(s,a,id(r.Themes,e)),i.themes.push(a),ot(e.wbrels,-1,"theme/theme1.xml",je.THEME),a="xl/styles."+t,Ue(s,a,BN(r,a,e)),i.styles.push(a),ot(e.wbrels,-1,"styles."+t,je.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",Ue(s,a,r.vbaraw),i.vba.push(a),ot(e.wbrels,-1,"vbaProject.bin",je.VBA)),a="xl/metadata."+t,Ue(s,a,WN(a)),i.metadata.push(a),ot(e.wbrels,-1,"metadata."+t,je.XLMETA),Ue(s,"[Content_Types].xml",gv(i,e)),Ue(s,"_rels/.rels",la(e.rels)),Ue(s,"xl/_rels/workbook."+t+".rels",la(e.wbrels)),delete e.revssf,delete e.ssf,s}function Ly(r,e){ia=1024,r&&!r.SSF&&(r.SSF=mt(De)),r&&r.SSF&&(Ga(),Ec(r.SSF),e.revssf=Du(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Io?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=ny.indexOf(e.bookType)>-1,i=Jh();md(e=e||{});var s=Nh(),a="",o=0;if(e.cellXfs=[],Gi(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Ue(s,a,vv(r.Props,e)),i.coreprops.push(a),ot(e.rels,2,a,je.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,Ue(s,a,Ev(r.Props)),i.extprops.push(a),ot(e.rels,3,a,je.EXT_PROPS),r.Custprops!==r.Props&&Nt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Ue(s,a,Tv(r.Custprops)),i.custprops.push(a),ot(e.rels,4,a,je.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},d=r.Sheets[r.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,Ue(s,a,my(o-1,e,r,h)),i.sheets.push(a),ot(e.wbrels,-1,"worksheets/sheet"+o+"."+t,je.WS[0])}if(d){var g=d["!comments"],p=!1,x="";if(g&&g.length>0){var T=!1;g.forEach(function(C){C[1].forEach(function(w){w.T==!0&&(T=!0)})}),T&&(x="xl/threadedComments/threadedComment"+o+"."+t,Ue(s,x,_F(g,u,e)),i.threadedcomments.push(x),ot(h,-1,"../threadedComments/threadedComment"+o+"."+t,je.TCMNT)),x="xl/comments"+o+"."+t,Ue(s,x,ry(g)),i.comments.push(x),ot(h,-1,"../comments"+o+"."+t,je.CMNT),p=!0}d["!legacy"]&&p&&Ue(s,"xl/drawings/vmlDrawing"+o+".vml",ty(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&Ue(s,Jo(a),la(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,Ue(s,a,Hv(e.Strings,e)),i.strs.push(a),ot(e.wbrels,-1,"sharedStrings."+t,je.SST)),a="xl/workbook."+t,Ue(s,a,yy(r)),i.workbooks.push(a),ot(e.rels,1,a,je.WB),a="xl/theme/theme1.xml",Ue(s,a,id(r.Themes,e)),i.themes.push(a),ot(e.wbrels,-1,"theme/theme1.xml",je.THEME),a="xl/styles."+t,Ue(s,a,Yv(r,e)),i.styles.push(a),ot(e.wbrels,-1,"styles."+t,je.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",Ue(s,a,r.vbaraw),i.vba.push(a),ot(e.wbrels,-1,"vbaProject.bin",je.VBA)),a="xl/metadata."+t,Ue(s,a,ey()),i.metadata.push(a),ot(e.wbrels,-1,"metadata."+t,je.XLMETA),u.length>1&&(a="xl/persons/person.xml",Ue(s,a,vF(u)),i.people.push(a),ot(e.wbrels,-1,"persons/person.xml",je.PEOPLE)),Ue(s,"[Content_Types].xml",gv(i,e)),Ue(s,"_rels/.rels",la(e.rels)),Ue(s,"xl/_rels/workbook."+t+".rels",la(e.wbrels)),delete e.revssf,delete e.ssf,s}function pd(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=qr(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function iO(r,e){return Re.find(r,"EncryptedPackage")?tO(r,e):fd(r,e)}function sO(r,e){var t,n=r,i=e||{};return i.type||(i.type=We&&Buffer.isBuffer(r)?"buffer":"base64"),t=Xx(n,i),Oy(t,i)}function My(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return _0(r.slice(t),e);default:break e}return Ra.to_workbook(r,e)}function aO(r,e){var t="",n=pd(r,e);switch(e.type){case"base64":t=qr(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=ws(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=ut(t)),e.type="binary",My(t,e)}function oO(r,e){var t=r;return e.type=="base64"&&(t=qr(t)),t=Ye.utils.decode(1200,t.slice(2),"str"),e.type="binary",My(t,e)}function cO(r){return r.match(/[^\x00-\x7F]/)?bn(r):r}function kf(r,e,t,n){return n?(t.type="string",Ra.to_workbook(r,t)):Ra.to_workbook(e,t)}function sc(r,e){Ru();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return sc(new Uint8Array(r),(t=mt(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),fa={},t.dateNF&&(fa.dateNF=t.dateNF),t.type||(t.type=We&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=We?"buffer":"binary",n=lk(r),typeof Uint8Array<"u"&&!We&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=cO(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return t=mt(t),t.type="array",sc(Rh(n),t)}switch((i=pd(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return iO(Re.read(n,t),t);break;case 9:if(i[1]<=8)return fd(n,t);break;case 60:return _0(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return yb(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Gv.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?sO(n,t):kf(r,n,t,s);case 239:return i[3]===60?_0(n,t):kf(r,n,t,s);case 255:if(i[1]===254)return oO(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return os.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return os.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return g0.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return qv.to_workbook(n,t);break;case 10:case 13:case 32:return aO(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vb.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?g0.to_workbook(n,t):kf(r,n,t,s)}function Mg(r,e){var t=e||{};return t.type="file",sc(r,t)}function Vy(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Tc(e.file,Re.write(r,{type:We?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Re.write(r,e)}function lO(r,e){var t=mt(e||{}),n=rO(r,t);return By(n,t)}function uO(r,e){var t=mt(e||{}),n=Ly(r,t);return By(n,t)}function By(r,e){var t={},n=We?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?Re.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(wc(i))}return e.password&&typeof encrypt_agile<"u"?Vy(encrypt_agile(i,e.password),e):e.type==="file"?Tc(e.file,i):e.type=="string"?ut(i):i}function fO(r,e){var t=e||{},n=m6(r,t);return Vy(n,t)}function In(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return Ko(bn(n));case"binary":return bn(n);case"string":return r;case"file":return Tc(e.file,n,"utf8");case"buffer":return We?ti(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):In(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function hO(r,e){switch(e.type){case"base64":return Ko(r);case"binary":return r;case"string":return r;case"file":return Tc(e.file,r,"binary");case"buffer":return We?ti(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ll(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?Ko(t):e.type=="string"?ut(t):t;case"file":return Tc(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function gd(r,e){Ru(),vy(r);var t=mt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=gd(r,t);return t.type="array",wc(n)}return uO(r,t)}function Da(r,e){Ru(),vy(r);var t=mt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Da(r,t);return t.type="array",wc(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return In(o6(r,t),t);case"slk":case"sylk":return In(Uv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return In(by(r.Sheets[r.SheetNames[i]],t),t);case"txt":return hO(Wy(r.Sheets[r.SheetNames[i]],t),t);case"csv":return In(xd(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return In(Gv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return ll(g0.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return In(Ra.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return In(qv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return In(Wv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return In(Py(r,t),t);case"wk1":return ll(os.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return ll(os.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),ll(Ay(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),fO(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return lO(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function _d(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function Vg(r,e,t){var n=t||{};return n.type="file",n.file=e,_d(n),Da(r,n)}function dO(r,e,t){var n=t||{};return n.type="file",n.file=e,_d(n),gd(r,n)}function mO(r,e,t,n){var i=t||{};i.type="file",i.file=r,_d(i),i.type="buffer";var s=n;return s instanceof Function||(s=t),xi.writeFile(r,Da(e,i),s)}function Uy(r,e,t,n,i,s,a,o){var c=Dt(t),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!a||r[t])for(var m=e.s.c;m<=e.e.c;++m){var g=a?r[t][m]:r[n[m]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[m]!=null&&(d[s[m]]=l);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[m]!=null){if(p==null)if(g.t=="e"&&p===null)d[s[m]]=null;else if(l!==void 0)d[s[m]]=l;else if(u&&p===null)d[s[m]]=null;else continue;else d[s[m]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:Pn(g,p,o);p!=null&&(h=!1)}}return{row:d,isempty:h}}function iu(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},u=l.range!=null?l.range:r["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof u){case"string":c=qe(u);break;case"number":c=qe(r["!ref"]),c.s.r=u;break;default:c=u}n>0&&(i=0);var h=Dt(c.s.r),d=[],m=[],g=0,p=0,x=Array.isArray(r),T=c.s.r,C=0,w={};x&&!r[T]&&(r[T]=[]);var F=l.skipHidden&&r["!cols"]||[],L=l.skipHidden&&r["!rows"]||[];for(C=c.s.c;C<=c.e.c;++C)if(!(F[C]||{}).hidden)switch(d[C]=vt(C),t=x?r[T][C]:r[d[C]+h],n){case 1:s[C]=C-c.s.c;break;case 2:s[C]=d[C];break;case 3:s[C]=l.header[C-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=Pn(t,null,l),p=w[a]||0,!p)w[a]=1;else{do o=a+"_"+p++;while(w[o]);w[a]=p,w[o]=1}s[C]=o}for(T=c.s.r+i;T<=c.e.r;++T)if(!(L[T]||{}).hidden){var O=Uy(r,c,T,d,n,s,x,l);(O.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(m[g++]=O.row)}return m.length=g,m}var Bg=/"/g;function Gy(r,e,t,n,i,s,a,o){for(var c=!0,l=[],u="",h=Dt(t),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(r[t]||[])[d]:r[n[d]+h];if(m==null)u="";else if(m.v!=null){c=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:Pn(m,null,o));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===i||p===s||p===34||o.forceQuotes){u='"'+u.replace(Bg,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Bg,'""')+'"')):u="";l.push(u)}return o.blankrows===!1&&c?null:l.join(a)}function xd(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=qe(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(r);for(var d=n.skipHidden&&r["!cols"]||[],m=n.skipHidden&&r["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(h[g]=vt(g));for(var p=0,x=i.s.r;x<=i.e.r;++x)(m[x]||{}).hidden||(u=Gy(r,i,x,h,a,c,s,n),u!=null&&(n.strip&&(u=u.replace(l,"")),(u||n.blankrows!==!1)&&t.push((p++?o:"")+u)));return delete n.dense,t.join("")}function Wy(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=xd(r,e);if(typeof Ye>"u"||e.type=="string")return t;var n=Ye.utils.encode(1200,t,"str");return""+n}function pO(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=qe(r["!ref"]),s="",a=[],o,c=[],l=Array.isArray(r);for(o=i.s.c;o<=i.e.c;++o)a[o]=vt(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Dt(u),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=l?(r[u]||[])[o]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=e+"="+n}return c}function Hy(r,e,t){var n=t||{},i=+!n.skipHeader,s=r||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?kt(n.origin):n.origin;a=c.r,o=c.c}var l,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=qe(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+e.length-1+i)}else a==-1&&(a=0,u.e.r=e.length-1+i);var d=n.header||[],m=0;e.forEach(function(p,x){Nt(p).forEach(function(T){(m=d.indexOf(T))==-1&&(d[m=d.length]=T);var C=p[T],w="z",F="",L=Pe({c:o+m,r:a+x+i});l=ac(s,L),C&&typeof C=="object"&&!(C instanceof Date)?s[L]=C:(typeof C=="number"?w="n":typeof C=="boolean"?w="b":typeof C=="string"?w="s":C instanceof Date?(w="d",n.cellDates||(w="n",C=Kt(C)),F=n.dateNF||De[14]):C===null&&n.nullError&&(w="e",C=0),l?(l.t=w,l.v=C,delete l.w,delete l.R,F&&(l.z=F)):s[L]=l={t:w,v:C},F&&(l.z=F))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var g=Dt(a);if(i)for(m=0;m<d.length;++m)s[vt(m+o)+g]={t:"s",v:d[m]};return s["!ref"]=Ve(u),s}function gO(r,e){return Hy(null,r,e)}function ac(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=kt(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?ac(r,Pe(e)):ac(r,Pe({r:e,c:t||0}))}function _O(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function vd(){return{SheetNames:[],Sheets:{}}}function yd(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=a+i)!=-1;++i);}if(xy(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function xO(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=_O(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function vO(r,e){return r.z=e,r}function zy(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function yO(r,e,t){return zy(r,"#"+e,t)}function wO(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function EO(r,e,t,n){for(var i=typeof e!="string"?e:qe(e),s=typeof e=="string"?e:Ve(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=ac(r,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=t,n&&(c.D=!0))}return r}var sa={encode_col:vt,encode_row:Dt,encode_cell:Pe,encode_range:Ve,decode_col:jh,decode_row:$h,split_cell:Gk,decode_cell:kt,decode_range:br,format_cell:Pn,sheet_add_aoa:lv,sheet_add_json:Hy,sheet_add_dom:Ry,aoa_to_sheet:Ha,json_to_sheet:gO,table_to_sheet:Fy,table_to_book:D6,sheet_to_csv:xd,sheet_to_txt:Wy,sheet_to_json:iu,sheet_to_html:by,sheet_to_formulae:pO,sheet_to_row_object_array:iu,sheet_get_cell:ac,book_new:vd,book_append_sheet:yd,book_set_sheet_visibility:xO,cell_set_number_format:vO,cell_set_hyperlink:zy,cell_set_internal_link:yO,cell_add_comment:wO,sheet_set_array_formula:EO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Bu;function TO(r){Bu=r}function AO(r,e){var t=Bu(),n=e??{};if(r==null||r["!ref"]==null)return t.push(null),t;var i=qe(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(r);for(var d=n.skipHidden&&r["!cols"]||[],m=n.skipHidden&&r["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(h[g]=vt(g));var p=i.s.r,x=!1,T=0;return t._read=function(){if(!x)return x=!0,t.push("\uFEFF");for(;p<=i.e.r;)if(++p,!(m[p-1]||{}).hidden&&(u=Gy(r,i,p-1,h,a,c,s,n),u!=null&&(n.strip&&(u=u.replace(l,"")),u||n.blankrows!==!1)))return t.push((T++?o:"")+u);return t.push(null)},t}function SO(r,e){var t=Bu(),n=e||{},i=n.header!=null?n.header:Iy,s=n.footer!=null?n.footer:ky;t.push(i);var a=br(r["!ref"]);n.dense=Array.isArray(r),t.push(Cy(r,a,n));var o=a.s.r,c=!1;return t._read=function(){if(o>a.e.r)return c||(c=!0,t.push("</table>"+s)),t.push(null);for(;o<=a.e.r;){t.push(Sy(r,a,o,n)),++o;break}},t}function IO(r,e){var t=Bu({objectMode:!0});if(r==null||r["!ref"]==null)return t.push(null),t;var n={t:"n",v:0},i=0,s=1,a=[],o=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:r["!ref"];switch(u.header===1?i=1:u.header==="A"?i=2:Array.isArray(u.header)&&(i=3),typeof h){case"string":l=qe(h);break;case"number":l=qe(r["!ref"]),l.s.r=h;break;default:l=h}i>0&&(s=0);var d=Dt(l.s.r),m=[],g=0,p=Array.isArray(r),x=l.s.r,T=0,C={};p&&!r[x]&&(r[x]=[]);var w=u.skipHidden&&r["!cols"]||[],F=u.skipHidden&&r["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(w[T]||{}).hidden)switch(m[T]=vt(T),n=p?r[x][T]:r[m[T]+d],i){case 1:a[T]=T-l.s.c;break;case 2:a[T]=m[T];break;case 3:a[T]=u.header[T-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=o=Pn(n,null,u),g=C[o]||0,!g)C[o]=1;else{do c=o+"_"+g++;while(C[c]);C[o]=g,C[c]=1}a[T]=c}return x=l.s.r+s,t._read=function(){for(;x<=l.e.r;)if(!(F[x-1]||{}).hidden){var L=Uy(r,l,x,m,i,a,p,u);if(++x,L.isempty===!1||(i===1?u.blankrows!==!1:u.blankrows)){t.push(L.row);return}}return t.push(null)},t}var kO={to_json:IO,to_html:SO,to_csv:AO,set_readable:TO};const CO=jo.version,bO=Object.freeze(Object.defineProperty({__proto__:null,CFB:Re,SSF:Hx,parse_xlscfb:fd,parse_zip:Oy,read:sc,readFile:Mg,readFileSync:Mg,set_cptable:DI,set_fs:ok,stream:kO,utils:sa,version:CO,write:Da,writeFile:Vg,writeFileAsync:mO,writeFileSync:Vg,writeFileXLSX:dO,writeXLSX:gd},Symbol.toStringTag,{value:"Module"}));(function(){function r(t,{tries:n=50,delay:i=200}={}){return new Promise(s=>{let a=0;const o=()=>{const c=t();if(c)return s(c);if(++a>=n)return s(null);setTimeout(o,i)};o()})}function e(t,n,i,s){const a=async()=>{var m;const o=document.getElementById("viewAdmin");if(!o)return;const c=await r(()=>o.querySelector("#"+t)),l=await r(()=>o.querySelector("#"+n));if(!c||!l)return;let u=document.getElementById(i);u||(u=document.createElement("button"),u.id=i,u.type="button",u.className=c.className||"btn",u.textContent="Export JPG",u.style.marginLeft="8px"),c.nextSibling!==u&&c.insertAdjacentElement("afterend",u);const h=g=>{const p=document.createElement("a"),x=URL.createObjectURL(g);p.href=x,p.download=s||n+".jpg",document.body.appendChild(p),p.click(),setTimeout(()=>{URL.revokeObjectURL(x),p.remove()},0)};u.onclick=()=>{try{if(l.toBlob)l.toBlob(g=>{if(g)h(g);else{const p=l.toDataURL("image/jpeg",.92);fetch(p).then(x=>x.blob()).then(h)}},"image/jpeg",.92);else{const g=l.toDataURL("image/jpeg",.92);fetch(g).then(p=>p.blob()).then(h)}}catch(g){console.error("JPG export failed:",g),alert("JPG export mislukt.")}};const d=()=>{try{c.nextSibling!==u&&c.insertAdjacentElement("afterend",u)}catch{}};c.addEventListener("click",()=>setTimeout(d,0)),window.addEventListener("resize",d),(m=document.getElementById("adminSubtabs"))==null||m.addEventListener("click",()=>setTimeout(d,0)),o&&window.MutationObserver&&new MutationObserver(()=>d()).observe(o,{childList:!0,subtree:!0}),d()};a(),document.readyState!=="complete"&&document.readyState!=="interactive"&&document.addEventListener("DOMContentLoaded",a,{once:!0})}window.attachChartExportJPGNextToReload=e})();let Qi=[];async function wd(){try{if(Array.isArray(Qi)&&Qi.length)return Qi;const r=Cr(et,"globals","ridePlan"),e=await Ua(r);return Qi=(e.exists()&&Array.isArray(e.data().plannedDates)?e.data().plannedDates.filter(Boolean):[]).map(n=>{if(typeof n=="string"){const s=n.match(/\d{4}-\d{2}-\d{2}/);if(s)return s[0]}const i=new Date(n);return isNaN(i)?"":i.toISOString().slice(0,10)}).filter(Boolean),Qi}catch(r){return console.error("ensureRideDatesLoaded()",r),Qi=[],Qi}}const Ug=["LidNr","Naam","Voor naam","Voor letters","Tussen voegsel","Regio Omschrijving"];let Gg=!1;function RO(){return new Promise((r,e)=>{if(window.Html5QrcodeScanner)return r(!0);if(Gg){const n=setInterval(()=>{window.Html5QrcodeScanner&&(clearInterval(n),r(!0))},100);setTimeout(()=>{clearInterval(n),window.Html5QrcodeScanner||e(new Error("Timeout bij laden QR-lib"))},1e4);return}Gg=!0;const t=document.createElement("script");t.src="https://unpkg.com/html5-qrcode",t.async=!0,t.onload=()=>r(!0),t.onerror=()=>e(new Error("Kon QR-bibliotheek niet laden")),document.head.appendChild(t)})}async function FO(r){const e=new Map(r.map(t=>[t,0]));try{let t=null;const n=400;for(;;){let i=ln(Or(et,"members"),un("__name__"),fn(n));t&&(i=ln(Or(et,"members"),un("__name__"),ku(t),fn(n)));const s=await Zn(i);if(s.empty||(s.forEach(a=>{const o=a.data()||{},c=Array.isArray(o.ScanDatums)?o.ScanDatums:[];for(const l of c){const u=typeof l=="string"?l.slice(0,10):"";u&&e.has(u)&&e.set(u,e.get(u)+1)}}),t=s.docs[s.docs.length-1],s.size<n))break}}catch(t){console.error("[rideStats] tellen mislukt",t)}return e}let ul=null;async function DO(){const r=document.getElementById("rideStatsChart"),e=document.getElementById("rideStatsStatus"),t=document.getElementById("reloadStatsBtn");if(!r)return;async function n(){try{e&&(e.textContent="Laden");const s=(await wd()||[]).map(u=>typeof u=="string"?u.slice(0,10):"").filter(Boolean).sort();if(!s.length){e&&(e.textContent="Geen geplande datums.");return}const a=await FO(s),o=s,c=s.map(u=>a.get(u)||0);try{ul&&(ul.destroy(),ul=null)}catch{}const l=r.getContext("2d");ul=new Chart(l,{type:"bar",data:{labels:o,datasets:[{label:"Inschrijvingen",data:c}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Ritdatum"}},y:{beginAtZero:!0,title:{display:!0,text:"Aantal leden"},ticks:{precision:0}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:u=>` ${u.parsed.y} inschrijvingen`}}}}}),e&&(e.textContent=` Gegevens geladen (${c.reduce((u,h)=>u+h,0)} totaal)`)}catch(i){console.error(i),e&&(e.textContent=" Laden mislukt")}}await n(),t&&t.addEventListener("click",()=>n(),{passive:!0})}async function PO(r){const e=r.length,t=new Array(e+1).fill(0),n=new Set(r);try{let i=null;const s=400;for(;;){let a=ln(Or(et,"members"),un("__name__"),fn(s));i&&(a=ln(Or(et,"members"),un("__name__"),ku(i),fn(s)));const o=await Zn(a);if(o.empty||(o.forEach(c=>{const l=c.data()||{};if((l.Jaarhanger||"").toString()!=="Ja")return;const u=Array.isArray(l.ScanDatums)?l.ScanDatums:[];let h=0;for(const d of u){const m=typeof d=="string"?d.slice(0,10):"";m&&n.has(m)&&h++}h<0&&(h=0),h>e&&(h=e),t[h]+=1}),i=o.docs[o.docs.length-1],o.size<s))break}}catch(i){console.error("[starDist] bouwen mislukt",i)}return t}let fl=null;async function NO(){const r=document.getElementById("starDistChart"),e=document.getElementById("starDistStatus"),t=document.getElementById("reloadStarDistBtn");if(!r)return;async function n(){try{e&&(e.textContent="Laden");const s=(await wd()||[]).map(d=>typeof d=="string"?d.slice(0,10):"").filter(Boolean).sort(),a=s.length;if(!a){e&&(e.textContent="Geen geplande datums.");return}const o=await PO(s),c=Array.from({length:a+1},(d,m)=>String(m)),l=o;try{fl&&(fl.destroy(),fl=null)}catch{}const u=r.getContext("2d");fl=new Chart(u,{type:"bar",data:{labels:c,datasets:[{label:"Aantal leden",data:l}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Aantal sterren (0.."+a+")"}},y:{beginAtZero:!0,title:{display:!0,text:"Aantal leden"},ticks:{precision:0}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:d=>` ${d.parsed.y} leden`}}}}});const h=l.reduce((d,m)=>d+m,0);e&&(e.textContent=` Gegevens geladen (leden met Jaarhanger=Ja: ${h})`)}catch(i){console.error(i),e&&(e.textContent=" Laden mislukt")}}await n(),t&&t.addEventListener("click",()=>n(),{passive:!0})}function OO(){var C;const r=w=>document.getElementById(w),e=r("fileInput"),t=r("fileName"),n=r("uploadBtn"),i=r("status"),s=r("log");function a(w,F=""){if(!s)return;const L=document.createElement("div");F&&(L.className=F),L.textContent=w,s.appendChild(L),s.scrollTop=s.scrollHeight}function o(w){n&&(n.disabled=w,n.textContent=w?"Bezig...":"Uploaden")}e==null||e.addEventListener("change",()=>{var F;const w=(F=e==null?void 0:e.files)==null?void 0:F[0];t&&(t.textContent=w?w.name:"Geen bestand gekozen")});async function c(w){const F=await w.arrayBuffer();return sc(F,{type:"array"})}function l(w){const F=w.SheetNames[0],L=w.Sheets[F];return sa.sheet_to_json(L,{defval:""})}function u(w){return w.map(F=>{const L={};for(const O of Ug)L[O]=(F[O]??"").toString().trim();return L})}async function h(w){let F=0,L=0,O=0,v=Wl(et);const A=async()=>{await v.commit(),v=Wl(et)};for(const y of w){F++;const I=String(y.LidNr||"").trim();if(!/^\d+$/.test(I)){O++;continue}const k={};for(const b of Ug)k[b]=y[b];k.ridesCount=kx(0),v.set(Cr(et,"members",I),k,{merge:!0}),L++,L%400===0&&await A()}return await A(),{total:F,updated:L,skipped:O}}let d=!1;async function m(){var F;if(d)return;const w=(F=e==null?void 0:e.files)==null?void 0:F[0];if(!w){i&&(i.textContent=" Kies eerst een bestand");return}d=!0,o(!0),i&&(i.textContent="Bezig met inlezen"),s&&(s.innerHTML="");try{const L=await c(w),O=u(l(L));a(`Gelezen rijen: ${O.length}`),i&&(i.textContent="Importeren naar Firestore");const v=await h(O);a(`Klaar. Totaal: ${v.total}, verwerkt: ${v.updated}, overgeslagen: ${v.skipped}`,"ok"),i&&(i.textContent=" Import voltooid (ridesCount behouden)")}catch(L){console.error(L),i&&(i.textContent=" Fout tijdens import"),a(String((L==null?void 0:L.message)||L),"err")}finally{o(!1),d=!1}}(C=r("uploadBtn"))==null||C.addEventListener("click",m);const g=document.getElementById("resetRidesBtn"),p=document.getElementById("resetStatus");g==null||g.addEventListener("click",async()=>{window.confirm("Weet je zeker dat je ALLE ridesCount waardes naar 0 wilt zetten? Dit kan niet ongedaan worden gemaakt.")&&await GO(p)});const x=document.getElementById("resetJaarhangerBtn"),T=document.getElementById("resetJaarhangerStatus");x==null||x.addEventListener("click",async()=>{window.confirm("Weet je zeker dat je de Jaarhanger keuze voor ALLE leden wilt resetten naar leeg? Dit kan niet ongedaan worden gemaakt.")&&await WO(T)}),BO(),LO();try{UO()}catch{}try{DO()}catch{}try{NO()}catch{}try{attachChartExportJPGNextToReload("reloadStarDistBtn","starDistChart","btnStarDistJPG","sterrenverdeling.jpg")}catch{}try{attachChartExportJPGNextToReload("reloadStatsBtn","rideStatsChart","btnRideStatsJPG","inschrijvingen-per-rit.jpg")}catch{}}function LO(){const r=T=>document.getElementById(T);if(!r("ridePlannerCard"))return;const t=r("rideDate1"),n=r("rideDate2"),i=r("rideDate3"),s=r("rideDate4"),a=r("rideDate5"),o=r("rideDate6"),c=r("saveRidePlanBtn"),l=r("reloadRidePlanBtn"),u=r("ridePlanStatus"),h=Cr(et,"globals","ridePlan");function d(T,C=!0){u&&(u.textContent=T,u.style.color=C?"#9ca3af":"#ef4444")}function m(T){const w=(Array.isArray(T)?T:[]).slice(0,6).concat(Array(6)).slice(0,6).map(F=>F||"");[t,n,i,s,a,o].forEach((F,L)=>{F&&(F.value=w[L]||"")})}async function g(){try{d("Laden");const T=await Ua(h);if(T.exists()){const C=T.data()||{},w=Array.isArray(C.plannedDates)?C.plannedDates:[];m(w),d(` ${w.length} datums geladen`)}else m([]),d("Nog geen planning opgeslagen.")}catch(T){console.error("[ridePlan] loadPlan error",T),d(" Laden mislukt (controleer regels/verbinding)",!1)}}function p(){const T=[t,n,i,s,a,o].map(w=>(w&&w.value||"").trim()).filter(Boolean),C=Array.from(new Set(T));return C.sort(),C}async function x(){try{const T=p();if(T.length<5){d(" Vul minimaal 5 datums in.",!1);return}d("Opslaan"),await yc(h,{plannedDates:T,updatedAt:qS()},{merge:!0}),d(" Planning opgeslagen")}catch(T){console.error("[ridePlan] savePlan error",T),d(" Opslaan mislukt (controleer regels/verbinding)",!1)}}c==null||c.addEventListener("click",x),l==null||l.addEventListener("click",g),g()}async function $y(r,e,t){const n=String(r||"").trim();if(!n)throw new Error("Geen LidNr meegegeven");const i=(t||"").toString().slice(0,10);if(!/^\d{4}-\d{2}-\d{2}$/.test(i))throw new Error("Geen geldige ritdatum gekozen");const s=Cr(et,"members",n),a=await KS(et,async o=>{const c=await o.get(s),l=c.exists()?c.data():{},u=Number.isFinite(Number(l==null?void 0:l.ridesCount))?Number(l.ridesCount):0,h=Array.isArray(l==null?void 0:l.ScanDatums)?l.ScanDatums.map(String):[];if(h.includes(i))return o.set(s,{ridesCount:u,ScanDatums:h.length?h:[]},{merge:!0}),{changed:!1,newTotal:u,ymd:i};{const m=u+1;return o.set(s,{ridesCount:kx(1),ScanDatums:XS(i)},{merge:!0}),{changed:!0,newTotal:m,ymd:i}}});return{id:n,...a}}function MO(r){if(!r)return null;try{const n=JSON.parse(r),i=(n==null?void 0:n.uid)||(n==null?void 0:n.id)||(n==null?void 0:n.member)||(n==null?void 0:n.lid)||(n==null?void 0:n.lidnr);if(i)return String(i).trim()}catch{}const e=r.match(/lidnr\s*[:=]\s*([\w-]+)/i);if(e)return e[1].trim();try{const n=new URL(r),i=n.searchParams.get("lid")||n.searchParams.get("lidnr")||n.searchParams.get("member")||n.searchParams.get("id")||n.searchParams.get("uid");if(i)return i.trim()}catch{}const t=r.match(/\b(\d{3,})\b/);return t?t[1]:null}function hl(r,e=!0){const t=document.getElementById("toast-root")||document.body,n=document.createElement("div");n.className="toast",n.textContent=r,e||(n.style.background="#ef4444"),t.appendChild(n),setTimeout(()=>n.remove(),1200)}function VO(r=new Date){return r.toTimeString().slice(0,8)}function BO(){const r=y=>document.getElementById(y),e=r("adminManualSearchInput"),t=r("adminManualClear"),n=r("adminManualSuggest"),i=r("adminManualResult"),s=r("adminManualError"),a=r("adminMName"),o=r("adminMMemberNo"),c=r("adminMRidesCount"),l=r("adminManualStatus"),u=r("adminRideButtons"),h=r("adminRideHint");let d=null;async function m(y){if(!g){l.textContent="Kies eerst een lid.",l.classList.add("error");return}l.classList.remove("error"),l.textContent="Bezig met registreren";try{const I=await $y(g.id,a.textContent||"",y);l.textContent=I.changed?` Rit geregistreerd op ${I.ymd} (totaal: ${I.newTotal})`:` Deze datum (${I.ymd}) was al geregistreerd  niets aangepast.`,h&&(h.textContent=`Geregistreerd op: ${I.ymd}`)}catch(I){console.error(I),l.textContent=" Fout bij registreren",l.classList.add("error")}}if(!e||!n||!i)return;let g=null,p=null;function x(y){const I=((y==null?void 0:y["Tussen voegsel"])||"").toString().trim();return[((y==null?void 0:y["Voor naam"])||"").toString().trim(),y!=null&&y["Voor letters"]?`(${(y["Voor letters"]+"").trim()})`:"",I,((y==null?void 0:y.Naam)||(y==null?void 0:y.name)||(y==null?void 0:y.naam)||"").toString().trim()].filter(Boolean).join(" ").replace(/\s+/g," ").trim()}function T(){n.innerHTML="",n.style.display="none"}function C(y){n.innerHTML="";for(const I of y){const k=document.createElement("li");k.textContent=`${x(I.data)}  ${I.id}`,k.addEventListener("click",()=>{A(I),T()},{passive:!0}),n.appendChild(k)}n.style.display=y.length?"block":"none"}async function w(y){if(!y)return[];const I=10;try{const k=ln(Or(et,"members"),un("Naam"),Ul(y),Gl(y+""),fn(I)),b=ln(Or(et,"members"),un("Voor naam"),Ul(y),Gl(y+""),fn(I)),[R,K]=await Promise.all([Zn(k),Zn(b)]),Z=new Map;return R.forEach(de=>{Z.has(de.id)||Z.set(de.id,{id:de.id,data:de.data()})}),K.forEach(de=>{Z.has(de.id)||Z.set(de.id,{id:de.id,data:de.data()})}),Array.from(Z.values()).slice(0,I)}catch(k){return console.error("queryByLastNamePrefix (admin) failed",k),[]}}function F(){g=null,i.style.display="none",s.style.display="none",l.textContent="";try{p&&p()}catch{}p=null}async function L(){F();const y=(e.value||"").trim();if(y.length>=1)try{const I=await w(y);I&&I.length?C(I):T()}catch{T()}else T()}async function O(){F();const y=(e.value||"").trim();if(y.length<2){T();return}try{const I=await w(y);C(I)}catch(I){console.error(I),T()}}async function v(){if(u){u.innerHTML="",d=null;try{const y=await wd(),I=new Date,k=new Date(Date.UTC(I.getFullYear(),I.getMonth(),I.getDate())).toISOString().slice(0,10),b=(y||[]).map(K=>typeof K=="string"?K.slice(0,10):"").filter(Boolean).filter(K=>K.localeCompare(k)<=0);if(!b.length){u.innerHTML='<span class="muted">Geen geplande ritdatums gevonden.</span>',h&&(h.textContent="Geen (verleden/heden) ritdatums.");return}const R=document.createDocumentFragment();b.forEach(K=>{const Z=document.createElement("button");Z.type="button",Z.className="chip",Z.textContent=K,Z.setAttribute("aria-pressed","false"),Z.addEventListener("click",async()=>{d=K,h&&(h.textContent=`Registreren voor: ${K}`),await m(K)},{passive:!0}),R.appendChild(Z)}),u.appendChild(R),h&&(h.textContent="Klik op een datum om direct te registreren.")}catch(y){console.error(y),u.innerHTML='<span class="error">Kon ritdatums niet laden.</span>'}}}function A(y){g=y,a.textContent=x(y.data),o.textContent=y.id,(async()=>{var k,b;try{const R=await Ca(),K=Array.isArray((k=y.data)==null?void 0:k.ScanDatums)?y.data.ScanDatums:[],{stars:Z,tooltip:ge,planned:de}=$l(R,K);c.textContent=Z||"",c.setAttribute("title",Z?ge:"Geen ingeplande datums")}catch{const K=typeof((b=y.data)==null?void 0:b.ridesCount)=="number"?y.data.ridesCount:0;c.textContent=String(K)}})(),i.style.display="grid",v();try{p&&p()}catch{}const I=Cr(Or(et,"members"),y.id);p=Ax(I,k=>{const b=k.exists()?k.data():null;(async()=>{try{const R=await Ca(),K=b&&Array.isArray(b.ScanDatums)?b.ScanDatums:[],{stars:Z,tooltip:ge}=$l(R,K);c.textContent=Z||"",Z?c.setAttribute("title",ge):c.removeAttribute("title")}catch{const K=b&&typeof b.ridesCount=="number"?b.ridesCount:0;c.textContent=String(K)}})()},k=>console.error(k))}e.addEventListener("focus",L,{passive:!0}),e.addEventListener("input",O,{passive:!0}),e.addEventListener("keydown",async y=>{if(y.key==="Escape"&&T(),y.key==="Enter"){y.preventDefault();const I=(e.value||"").trim();if(!I){T();return}try{const k=await w(I);k&&k.length?C(k):(s.textContent="Geen leden gevonden.",s.style.display="block",T())}catch{s.textContent="Zoeken mislukt.",s.style.display="block",T()}}}),t==null||t.addEventListener("click",()=>{e.value="",T(),F()})}function UO(){const r=T=>document.getElementById(T),e=r("adminScanStart"),t=r("adminScanStop"),n=r("adminQRStatus"),i=r("adminQRReader"),s=r("adminQRResult");function a(){var C;let T=document.getElementById("adminQRLog");return T||(T=document.createElement("div"),T.id="adminQRLog",T.style.marginTop="10px",T.innerHTML='<h4 style="margin:6px 0 6px;">Registraties</h4><div id="adminQRLogList" class="qr-log-list"></div>',(C=(s==null?void 0:s.parentElement)||(i==null?void 0:i.parentElement)||i)==null||C.appendChild(T)),document.getElementById("adminQRLogList")}const o=a();let c=null,l=new Map;const u=3e4;function h({naam:T,lid:C,ok:w,reason:F,ridesTotal:L}){if(!o)return;const O=document.createElement("div");O.style.display="flex",O.style.justifyContent="space-between",O.style.gap="8px",O.style.padding="10px 12px",O.style.border="1px solid #1f2937",O.style.borderRadius="12px",O.style.marginBottom="6px",O.style.background=w?"#0f1d12":"#1a0f0f";const v=document.createElement("div");v.textContent=`${VO()}  ${T?T+" ":""}${C?"(LidNr: "+C+")":"(onbekend)"}`;const A=document.createElement("div");A.textContent=w?` bijgewerkt${L??L===0?"  totaal: "+L:""}`:` ${F||"geweigerd"}`,O.appendChild(v),O.appendChild(A),o.prepend(O)}async function d(T){const C=Date.now(),w=l.get(T)||0;if(C-w<u)return;l.set(T,C);let F=MO(T||""),L="",O=null;if(!F){n&&(n.textContent=" Geen LidNr in QR"),hl(" Onbekende QR (geen LidNr)",!1),h({naam:"",lid:"",ok:!1,reason:"geen LidNr"});return}try{try{const I=await Ua(Cr(et,"members",String(F)));if(I.exists()){const k=I.data();L=`${(k["Voor naam"]||"").toString().trim()} ${(k["Tussen voegsel"]||"").toString().trim()} ${(k.Naam||k.name||k.naam||"").toString().trim()}`.replace(/\s+/g," ").trim()||k.Naam||k.name||k.naam||"";const R=Number(k==null?void 0:k.ridesCount);O=Number.isFinite(R)?R:0}else O=0}catch{O=O??0}const v=new Date(Date.UTC(new Date().getFullYear(),new Date().getMonth(),new Date().getDate())).toISOString().slice(0,10),A=await $y(F,L||"",v),y=A.newTotal;n&&(n.textContent=A.changed?` Rit +1 voor ${L||"(onbekend)"} (${F}) op ${A.ymd}`:` ${L||"(onbekend)"} (${F}) had ${A.ymd} al geregistreerd  niets aangepast.`),s&&(s.textContent=`Gescand: ${L?"Naam: "+L+" ":""}(LidNr: ${F})`),hl(A.changed?" QR-code gescand":" Reeds geregistreerd",!0),h({naam:L||"",lid:F,ok:!0,ridesTotal:y})}catch(v){console.error(v),n&&(n.textContent=` Fout bij updaten: ${(v==null?void 0:v.message)||v}`),hl(" Fout bij updaten",!1),h({naam:L||"",lid:F,ok:!1,reason:"update fout"})}}function m(T){d(T)}function g(T){}async function p(){n&&(n.textContent="Camera openen");try{await RO()}catch{n&&(n.textContent="Bibliotheek niet geladen."),hl("Bibliotheek niet geladen",!1);return}try{c&&c.clear&&await c.clear()}catch{}i&&(i.innerHTML=""),c=new Html5QrcodeScanner("adminQRReader",{fps:10,qrbox:250,aspectRatio:1.333},!1),c.render(m,g),n&&(n.textContent="Richt je camera op de QR-code")}async function x(){n&&(n.textContent="Stoppen");try{c&&c.clear&&await c.clear()}catch{}c=null,i&&(i.innerHTML=""),n&&(n.textContent=" Gestopt")}e==null||e.addEventListener("click",p),t==null||t.addEventListener("click",x)}async function GO(r){if(!r)return;r.textContent="Voorbereiden";let e=0;try{let t=null;const n=400;for(;;){let i=ln(Or(et,"members"),un("__name__"),fn(n));t&&(i=ln(Or(et,"members"),un("__name__"),ku(t),fn(n)));const s=await Zn(i);if(s.empty)break;let a=Wl(et);if(s.forEach(o=>{a.set(Cr(et,"members",o.id),{ridesCount:0,ScanDatums:[]},{merge:!0})}),await a.commit(),e+=s.size,r.textContent=`Gerest: ${e} leden`,t=s.docs[s.docs.length-1],s.size<n)break}r.textContent=` Klaar. Alle ridesCount naar 0 gezet voor ${e} leden.`}catch(t){console.error(t),r.textContent=` Fout bij resetten: ${(t==null?void 0:t.message)||t}`}}async function WO(r){if(!r)return;r.textContent="Voorbereiden";let e=0;try{let t=null;const n=400;for(;;){let i=ln(Or(et,"members"),un("__name__"),fn(n));t&&(i=ln(Or(et,"members"),un("__name__"),ku(t),fn(n)));const s=await Zn(i);if(s.empty)break;let a=Wl(et);if(s.forEach(o=>{a.set(Cr(et,"members",o.id),{Jaarhanger:""},{merge:!0})}),await a.commit(),e+=s.size,r.textContent=`Gerest Jaarhanger voor: ${e} leden`,t=s.docs[s.docs.length-1],s.size<n)break}r.textContent=` Klaar. Jaarhanger gereset voor ${e} leden.`}catch(t){console.error(t),r.textContent=` Fout bij resetten Jaarhanger: ${(t==null?void 0:t.message)||t}`}}async function HO(){const r=document.getElementById("exportExcelStatus");try{r&&(r.textContent="Bezig met ophalen...");const e=await Zn(Or(et,"members")),t=[];e.forEach(l=>{const u=l.data()||{},h=u.Naam??u.naam??u.lastName??u.achternaam??"",d=u["Tussen voegsel"]??u.tussenvoegsel??u.tussenVoegsel??u.tussen??u.infix??"",m=u["Voor letters"]??u.voorletters??u.initialen??u.initials??"",g=u["Voor naam"]??u.voornaam??u.firstName??u.naamVoor??"",p=typeof u.ridesCount=="number"?u.ridesCount:typeof u.rittenCount=="number"?u.rittenCount:typeof u.ritten=="number"?u.ritten:0;let x=u["Regio Omschrijving"]??u.regioOmschrijving??"";!x&&u.regio&&typeof u.regio=="object"&&(x=u.regio.omschrijving??u.regio.name??u.regio.title??""),t.push({Naam:String(h||""),"Tussen voegsel":String(d||""),"Voor letters":String(m||""),"Voor naam":String(g||""),ridesCount:p,"Regio Omschrijving":String(x||"")})});const n=["Naam","Tussen voegsel","Voor letters","Voor naam","ridesCount","Regio Omschrijving"];try{if(typeof bO<"u"&&sa&&Da){const l=sa.book_new(),u=sa.json_to_sheet(t,{header:n});sa.book_append_sheet(l,u,"Leden");const h=Da(l,{bookType:"xlsx",type:"array"}),d=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=document.createElement("a"),g=URL.createObjectURL(d);m.href=g;const p=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");m.download=`leden_export_${p}.xlsx`,document.body.appendChild(m),m.click(),setTimeout(()=>{URL.revokeObjectURL(g),m.remove()},0),r&&(r.textContent=`Gereed  ${t.length} leden`);return}}catch(l){console.warn("XLSX export faalde, fallback CSV:",l)}const i=[n.join(",")];for(const l of t){const u=n.map(h=>{const d=l[h]??"";return`"${String(d).replace(/"/g,'""')}"`});i.push(u.join(","))}const s=new Blob([i.join(`
`)],{type:"text/csv;charset=utf-8"}),a=document.createElement("a"),o=URL.createObjectURL(s);a.href=o;const c=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");a.download=`leden_export_${c}.csv`,document.body.appendChild(a),a.click(),setTimeout(()=>{URL.revokeObjectURL(o),a.remove()},0),r&&(r.textContent=`Gereed  ${t.length} leden`)}catch(e){console.error("Export mislukt:",e),r&&(r.textContent="Mislukt"),alert("Export mislukt. Controleer de console voor details.")}}function Ed(){const r=document.getElementById("exportExcelBtn");r&&(r.dataset._wired||(r.addEventListener("click",HO),r.dataset._wired="1"))}document.addEventListener("DOMContentLoaded",()=>{try{Ed()}catch{}});var $g;($g=document.getElementById("adminSubtabs"))==null||$g.addEventListener("click",()=>{setTimeout(()=>{try{Ed()}catch{}},0)});if(window.MutationObserver){const r=document.getElementById("viewAdmin");r&&new MutationObserver(()=>{try{Ed()}catch{}}).observe(r,{childList:!0,subtree:!0})}const Uu=r=>document.getElementById(r);let $n=null;async function Td(){if($n)return $n;const r=Cr(et,"globals","passwords"),e=await Ua(r);if(e.exists()){const t=e.data()||{};$n={inschrijftafel:String(t.inschrijftafel||"Shadow"),hoofdadmin:String(t.hoofdadmin||"1100")}}else{const t={inschrijftafel:"Shadow",hoofdadmin:"1100",updatedAt:Date.now()};await yc(r,t,{merge:!0}),$n=t}return $n}async function zO(r){const e=Cr(et,"globals","passwords");await yc(e,{inschrijftafel:String(r||""),updatedAt:Date.now()},{merge:!0}),$n={...$n||{},inschrijftafel:String(r||"")}}async function $O(){return(await Td()).inschrijftafel}async function jO(r){const e=Cr(et,"globals","passwords");await yc(e,{hoofdadmin:String(r||""),updatedAt:Date.now()},{merge:!0}),$n={...$n||{},hoofdadmin:String(r||"")}}async function KO(){return(await Td()).hoofdadmin}const Hn=Uu("tabMember"),zn=Uu("tabAdmin"),Cf=Uu("viewMember"),bf=Uu("viewAdmin");function jy(){try{const r=sessionStorage.getItem("admin_level")||"admin",e=document.getElementById("viewAdmin");if(!e)return;const t=Array.from(e.querySelectorAll(".card"));r==="root"?(t.forEach(n=>{n.style.display="",n.removeAttribute("hidden")}),document.body.dataset.role="rootadmin"):(document.body.dataset.role="admin",t.forEach(n=>{const i=n.id||"",s=i==="qrScanCard"||i==="manualRideCard";n.style.display=s?"":"none",s||n.setAttribute("hidden","hidden")}))}catch{}}function Wg(r){try{sessionStorage.setItem("admin_subtab",String(r));const e=document.getElementById("adminSubtabs");if(!e)return;Array.from(e.querySelectorAll(".subtab")).forEach(i=>{const s=String(i.dataset.adminTab)===String(r);i.setAttribute("aria-pressed",String(s))}),Array.from(document.querySelectorAll("#viewAdmin .card")).forEach(i=>{const s=i.getAttribute("data-admin-group");s&&(i.style.display=String(s)===String(r)?"":"none")});try{window.scrollTo({top:0,behavior:"smooth"})}catch{}}catch{}}function Ky(){try{const r=document.getElementById("adminSubtabs");if(!r)return;if((sessionStorage.getItem("admin_level")||"admin")!=="root"){r.setAttribute("hidden","");return}r.removeAttribute("hidden"),r.addEventListener("click",n=>{const i=n.target;i instanceof HTMLElement&&i.classList.contains("subtab")&&i.dataset.adminTab&&Wg(i.dataset.adminTab)},{passive:!0});const t=sessionStorage.getItem("admin_subtab")||"1";Wg(t)}catch{}}function qy(r){const e=r==="member";Hn==null||Hn.classList.toggle("active",e),zn==null||zn.classList.toggle("active",!e),Cf==null||Cf.classList.toggle("active",e),bf==null||bf.classList.toggle("active",!e),Hn==null||Hn.setAttribute("aria-pressed",String(e)),zn==null||zn.setAttribute("aria-pressed",String(!e)),window.innerWidth<560&&window.scrollTo({top:0,behavior:"smooth"})}async function qO(r="Wachtwoord",e="Wachtwoord"){return new Promise(t=>{const n=document.createElement("div");n.style.position="fixed",n.style.inset="0",n.style.background="rgba(0,0,0,0.4)",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.zIndex="9999";const i=document.createElement("div");i.style.background="var(--card-bg, #111)",i.style.color="var(--fg, #fff)",i.style.border="1px solid rgba(255,255,255,0.12)",i.style.borderRadius="16px",i.style.padding="18px 16px",i.style.minWidth="320px",i.style.maxWidth="92vw",i.style.boxShadow="0 10px 30px rgba(0,0,0,0.35)",i.setAttribute("role","dialog"),i.setAttribute("aria-modal","true"),i.setAttribute("aria-label",r);const s=document.createElement("h3");s.textContent=r,s.style.margin="0 0 10px 0",s.style.fontSize="18px";const a=document.createElement("input");a.type="password",a.placeholder=e,a.autocomplete="current-password",a.style.width="100%",a.style.padding="10px 12px",a.style.borderRadius="10px",a.style.border="1px solid rgba(255,255,255,0.2)",a.style.background="transparent",a.style.color="inherit";const o=document.createElement("div");o.style.display="flex",o.style.gap="10px",o.style.alignItems="center",o.style.justifyContent="flex-end",o.style.marginTop="12px";const c=document.createElement("button");c.className="btn",c.textContent="Doorgaan";const l=document.createElement("button");l.className="btn btn-ghost",l.textContent="Annuleren",o.appendChild(l),o.appendChild(c),i.appendChild(s),i.appendChild(a),i.appendChild(o),n.appendChild(i),document.body.appendChild(n);let u=!1;function h(d){if(!u){u=!0;try{document.body.removeChild(n)}catch{}t(d)}}c.addEventListener("click",()=>h(a.value||"")),l.addEventListener("click",()=>h(null)),n.addEventListener("click",d=>{d.target===n&&h(null)}),a.addEventListener("keydown",d=>{d.key==="Enter"&&(d.preventDefault(),c.click()),d.key==="Escape"&&(d.preventDefault(),h(null))}),setTimeout(()=>a.focus(),0)})}Hn==null||Hn.addEventListener("click",()=>qy("member"));zn==null||zn.addEventListener("click",async()=>{try{await Td();const r=await qO("Vul uw wachtwoord in","Wachtwoord");if(r==null)return;const e=await KO(),t=await $O();if(r===e)sessionStorage.setItem("admin_ok","1"),sessionStorage.setItem("admin_level","root");else if(r===t)sessionStorage.setItem("admin_ok","1"),sessionStorage.setItem("admin_level","admin");else{window.alert("Wachtwoord onjuist");return}const n=sessionStorage.getItem("admin_level")||"admin";document.body.dataset.role=n==="root"?"rootadmin":"admin",qy("admin"),jy();try{Ky()}catch{}}catch(r){console.error(r),window.alert("Wachtwoordcontrole mislukt")}});CI();OO();function XO(){try{const r=document.getElementById("saveAdminPwd"),e=document.getElementById("newAdminPwd"),t=document.getElementById("pwdStatus");if(!r||!e)return;e.value="",r.addEventListener("click",async()=>{const n=String(e.value||"").trim();if(n.length<3){t&&(t.textContent="Minimaal 3 tekens.",t.classList.add("error"));return}try{await zO(n),t&&(t.textContent=" Nieuw admin-wachtwoord opgeslagen in Firestore.",t.classList.remove("error")),e.value=""}catch(i){console.error(i),t&&(t.textContent=" Opslaan mislukt.",t.classList.add("error"))}})}catch{}}function QO(){try{const r=document.getElementById("saveRootPwd"),e=document.getElementById("newRootPwd"),t=document.getElementById("rootPwdStatus");if(!r||!e)return;e.value="",r.addEventListener("click",async()=>{const n=String(e.value||"").trim();if(n.length<4){t&&(t.textContent="Minimaal 4 tekens.",t.classList.add("error"));return}try{await jO(n),t&&(t.textContent=" Nieuw hoofdadmin-wachtwoord opgeslagen in Firestore.",t.classList.remove("error")),e.value=""}catch(i){console.error(i),t&&(t.textContent=" Opslaan mislukt.",t.classList.add("error"))}})}catch{}}document.addEventListener("DOMContentLoaded",()=>{try{sessionStorage.getItem("admin_ok")==="1"&&jy();try{Ky()}catch{}}catch{}XO(),QO();const r=document.getElementById("rideConsentGate");if(!r)return;const e=!!document.getElementById("viewAdmin")&&document.getElementById("viewAdmin").classList.contains("active");if(!!document.getElementById("ridePlanSection")||e||/(^|\/)(admin|beheer)(\/|$)/i.test(location.pathname)){r.remove();return}function n(){const a=document.querySelector('#landelijkeSignup, [data-ride-signup="true"]');if(a)return a.closest("section")||a;const c=Array.from(document.querySelectorAll("section h1, section h2, section h3")).find(l=>/inschrijven\s*voor\s*landelijke\s*rit/i.test(l.textContent||""));return c?c.closest("section"):null}const i=n();if(!i){r.remove();return}i.setAttribute("aria-hidden","true"),i.setAttribute("hidden",""),i.style.display="none";const s=document.getElementById("rideConsentBtn");s==null||s.addEventListener("click",()=>{i.removeAttribute("aria-hidden"),i.removeAttribute("hidden"),i.style.display="",r.remove();try{ZO()}catch{}const a=i.querySelector("h1, h2, h3, [tabindex]")||i;a&&(a.setAttribute("tabindex","-1"),a.focus({preventScroll:!1}))})});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(r=>{console.log("ServiceWorker registered:",r.scope)}).catch(r=>{console.warn("ServiceWorker registration failed:",r)})});function YO(r){try{const e=new Date(r);return isNaN(e)?String(r):e.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}catch{return String(r)}}function Rf(r,e){if(!r)return;if(r.innerHTML="",!e||e.length===0){const n=document.createElement("li");n.textContent="Geen geplande ritten.",r.appendChild(n);return}const t=(Array.isArray(e)?e.slice():[]).filter(n=>{const i=Hg(n);return i===null?!0:i>=0});if(t.sort((n,i)=>new Date(n)-new Date(i)),t.length===0){const n=document.createElement("li");n.textContent="Geen geplande ritten.",r.appendChild(n);return}t.forEach(n=>{const i=document.createElement("li"),s=document.createElement("span");s.className="date",s.textContent=YO(n);const a=document.createElement("span");a.className="days-left";const o=Hg(n);o===null?a.textContent="-":o===0?a.textContent="Vandaag":o===1?a.textContent="1 dag":o>1?a.textContent=`${o} dagen`:a.textContent=`${Math.abs(o)} dagen geleden`,a.classList.add(JO(o)),i.appendChild(s),i.appendChild(a),r.appendChild(i)})}function Hg(r){try{const e=new Date(r);if(isNaN(e))return null;const t=new Date,n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),i=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return Math.round((i-n)/(1e3*60*60*24))}catch{return null}}function JO(r){return r===null?"":r<0?"passed":r<=3?"soon":"upcoming"}function ZO(){const r=document.getElementById("plannedRidesSection");r&&(r.style.display="none")}function e8(){const r=document.getElementById("plannedRidesSection");r&&(r.style.display="")}const zg=["2025-10-25","2025-11-08","2025-12-06"];document.addEventListener("DOMContentLoaded",()=>{try{const r=document.getElementById("plannedRidesList");(async()=>{try{const e=typeof Ca=="function"?await Ca():null;e&&Array.isArray(e)&&e.length?Rf(r,e):Rf(r,zg)}catch{Rf(r,zg)}})(),e8()}catch(r){console.error("Planned rides init failed",r)}});
