(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var lc={},hw=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},$g={},nn={};let Eh;const dw=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];nn.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};nn.getSymbolTotalCodewords=function(e){return dw[e]};nn.getBCHDigit=function(r){let e=0;for(;r!==0;)e++,r>>>=1;return e};nn.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Eh=e};nn.isKanjiModeEnabled=function(){return typeof Eh<"u"};nn.toSJIS=function(e){return Eh(e)};var ou={};(function(r){r.L={bit:1},r.M={bit:0},r.Q={bit:3},r.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return r.L;case"m":case"medium":return r.M;case"q":case"quartile":return r.Q;case"h":case"high":return r.H;default:throw new Error("Unknown EC Level: "+t)}}r.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},r.from=function(n,i){if(r.isValid(n))return n;try{return e(n)}catch{return i}}})(ou);function Kg(){this.buffer=[],this.length=0}Kg.prototype={get:function(r){const e=Math.floor(r/8);return(this.buffer[e]>>>7-r%8&1)===1},put:function(r,e){for(let t=0;t<e;t++)this.putBit((r>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),r&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var mw=Kg;function uc(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}uc.prototype.set=function(r,e,t,n){const i=r*this.size+e;this.data[i]=t,n&&(this.reservedBit[i]=!0)};uc.prototype.get=function(r,e){return this.data[r*this.size+e]};uc.prototype.xor=function(r,e,t){this.data[r*this.size+e]^=t};uc.prototype.isReserved=function(r,e){return this.reservedBit[r*this.size+e]};var pw=uc,qg={};(function(r){const e=nn.getSymbolSize;r.getRowColCoords=function(n){if(n===1)return[];const i=Math.floor(n/7)+2,s=e(n),a=s===145?26:Math.ceil((s-13)/(2*i-2))*2,o=[s-7];for(let c=1;c<i-1;c++)o[c]=o[c-1]-a;return o.push(6),o.reverse()},r.getPositions=function(n){const i=[],s=r.getRowColCoords(n),a=s.length;for(let o=0;o<a;o++)for(let c=0;c<a;c++)o===0&&c===0||o===0&&c===a-1||o===a-1&&c===0||i.push([s[o],s[c]]);return i}})(qg);var Xg={};const gw=nn.getSymbolSize,rm=7;Xg.getPositions=function(e){const t=gw(e);return[[0,0],[t-rm,0],[0,t-rm]]};var Qg={};(function(r){r.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};r.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},r.from=function(i){return r.isValid(i)?parseInt(i,10):void 0},r.getPenaltyN1=function(i){const s=i.size;let a=0,o=0,c=0,l=null,u=null;for(let h=0;h<s;h++){o=c=0,l=u=null;for(let d=0;d<s;d++){let m=i.get(h,d);m===l?o++:(o>=5&&(a+=e.N1+(o-5)),l=m,o=1),m=i.get(d,h),m===u?c++:(c>=5&&(a+=e.N1+(c-5)),u=m,c=1)}o>=5&&(a+=e.N1+(o-5)),c>=5&&(a+=e.N1+(c-5))}return a},r.getPenaltyN2=function(i){const s=i.size;let a=0;for(let o=0;o<s-1;o++)for(let c=0;c<s-1;c++){const l=i.get(o,c)+i.get(o,c+1)+i.get(o+1,c)+i.get(o+1,c+1);(l===4||l===0)&&a++}return a*e.N2},r.getPenaltyN3=function(i){const s=i.size;let a=0,o=0,c=0;for(let l=0;l<s;l++){o=c=0;for(let u=0;u<s;u++)o=o<<1&2047|i.get(l,u),u>=10&&(o===1488||o===93)&&a++,c=c<<1&2047|i.get(u,l),u>=10&&(c===1488||c===93)&&a++}return a*e.N3},r.getPenaltyN4=function(i){let s=0;const a=i.data.length;for(let c=0;c<a;c++)s+=i.data[c];return Math.abs(Math.ceil(s*100/a/5)-10)*e.N4};function t(n,i,s){switch(n){case r.Patterns.PATTERN000:return(i+s)%2===0;case r.Patterns.PATTERN001:return i%2===0;case r.Patterns.PATTERN010:return s%3===0;case r.Patterns.PATTERN011:return(i+s)%3===0;case r.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(s/3))%2===0;case r.Patterns.PATTERN101:return i*s%2+i*s%3===0;case r.Patterns.PATTERN110:return(i*s%2+i*s%3)%2===0;case r.Patterns.PATTERN111:return(i*s%3+(i+s)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}r.applyMask=function(i,s){const a=s.size;for(let o=0;o<a;o++)for(let c=0;c<a;c++)s.isReserved(c,o)||s.xor(c,o,t(i,c,o))},r.getBestMask=function(i,s){const a=Object.keys(r.Patterns).length;let o=0,c=1/0;for(let l=0;l<a;l++){s(l),r.applyMask(l,i);const u=r.getPenaltyN1(i)+r.getPenaltyN2(i)+r.getPenaltyN3(i)+r.getPenaltyN4(i);r.applyMask(l,i),u<c&&(c=u,o=l)}return o}})(Qg);var cu={};const gi=ou,Kc=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],qc=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];cu.getBlocksCount=function(e,t){switch(t){case gi.L:return Kc[(e-1)*4+0];case gi.M:return Kc[(e-1)*4+1];case gi.Q:return Kc[(e-1)*4+2];case gi.H:return Kc[(e-1)*4+3];default:return}};cu.getTotalCodewordsCount=function(e,t){switch(t){case gi.L:return qc[(e-1)*4+0];case gi.M:return qc[(e-1)*4+1];case gi.Q:return qc[(e-1)*4+2];case gi.H:return qc[(e-1)*4+3];default:return}};var Yg={},lu={};const _o=new Uint8Array(512),Al=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)_o[t]=e,Al[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)_o[t]=_o[t-255]})();lu.log=function(e){if(e<1)throw new Error("log("+e+")");return Al[e]};lu.exp=function(e){return _o[e]};lu.mul=function(e,t){return e===0||t===0?0:_o[Al[e]+Al[t]]};(function(r){const e=lu;r.mul=function(n,i){const s=new Uint8Array(n.length+i.length-1);for(let a=0;a<n.length;a++)for(let o=0;o<i.length;o++)s[a+o]^=e.mul(n[a],i[o]);return s},r.mod=function(n,i){let s=new Uint8Array(n);for(;s.length-i.length>=0;){const a=s[0];for(let c=0;c<i.length;c++)s[c]^=e.mul(i[c],a);let o=0;for(;o<s.length&&s[o]===0;)o++;s=s.slice(o)}return s},r.generateECPolynomial=function(n){let i=new Uint8Array([1]);for(let s=0;s<n;s++)i=r.mul(i,new Uint8Array([1,e.exp(s)]));return i}})(Yg);const Jg=Yg;function Th(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}Th.prototype.initialize=function(e){this.degree=e,this.genPoly=Jg.generateECPolynomial(this.degree)};Th.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const n=Jg.mod(t,this.genPoly),i=this.degree-n.length;if(i>0){const s=new Uint8Array(this.degree);return s.set(n,i),s}return n};var _w=Th,Zg={},Mi={},Ah={};Ah.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var Ln={};const e1="[0-9]+",xw="[A-Z $%*+\\-./:]+";let Fo="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Fo=Fo.replace(/u/g,"\\u");const vw="(?:(?![A-Z0-9 $%*+\\-./:]|"+Fo+`)(?:.|[\r
]))+`;Ln.KANJI=new RegExp(Fo,"g");Ln.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Ln.BYTE=new RegExp(vw,"g");Ln.NUMERIC=new RegExp(e1,"g");Ln.ALPHANUMERIC=new RegExp(xw,"g");const yw=new RegExp("^"+Fo+"$"),ww=new RegExp("^"+e1+"$"),Ew=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Ln.testKanji=function(e){return yw.test(e)};Ln.testNumeric=function(e){return ww.test(e)};Ln.testAlphanumeric=function(e){return Ew.test(e)};(function(r){const e=Ah,t=Ln;r.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},r.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},r.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},r.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},r.MIXED={bit:-1},r.getCharCountIndicator=function(s,a){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(a))throw new Error("Invalid version: "+a);return a>=1&&a<10?s.ccBits[0]:a<27?s.ccBits[1]:s.ccBits[2]},r.getBestModeForData=function(s){return t.testNumeric(s)?r.NUMERIC:t.testAlphanumeric(s)?r.ALPHANUMERIC:t.testKanji(s)?r.KANJI:r.BYTE},r.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},r.isValid=function(s){return s&&s.bit&&s.ccBits};function n(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return r.NUMERIC;case"alphanumeric":return r.ALPHANUMERIC;case"kanji":return r.KANJI;case"byte":return r.BYTE;default:throw new Error("Unknown mode: "+i)}}r.from=function(s,a){if(r.isValid(s))return s;try{return n(s)}catch{return a}}})(Mi);(function(r){const e=nn,t=cu,n=ou,i=Mi,s=Ah,a=7973,o=e.getBCHDigit(a);function c(d,m,g){for(let p=1;p<=40;p++)if(m<=r.getCapacity(p,g,d))return p}function l(d,m){return i.getCharCountIndicator(d,m)+4}function u(d,m){let g=0;return d.forEach(function(p){const x=l(p.mode,m);g+=x+p.getBitsLength()}),g}function h(d,m){for(let g=1;g<=40;g++)if(u(d,g)<=r.getCapacity(g,m,i.MIXED))return g}r.from=function(m,g){return s.isValid(m)?parseInt(m,10):g},r.getCapacity=function(m,g,p){if(!s.isValid(m))throw new Error("Invalid QR Code version");typeof p>"u"&&(p=i.BYTE);const x=e.getSymbolTotalCodewords(m),T=t.getTotalCodewordsCount(m,g),b=(x-T)*8;if(p===i.MIXED)return b;const E=b-l(p,m);switch(p){case i.NUMERIC:return Math.floor(E/10*3);case i.ALPHANUMERIC:return Math.floor(E/11*2);case i.KANJI:return Math.floor(E/13);case i.BYTE:default:return Math.floor(E/8)}},r.getBestVersionForData=function(m,g){let p;const x=n.from(g,n.M);if(Array.isArray(m)){if(m.length>1)return h(m,x);if(m.length===0)return 1;p=m[0]}else p=m;return c(p.mode,p.getLength(),x)},r.getEncodedBits=function(m){if(!s.isValid(m)||m<7)throw new Error("Invalid QR Code version");let g=m<<12;for(;e.getBCHDigit(g)-o>=0;)g^=a<<e.getBCHDigit(g)-o;return m<<12|g}})(Zg);var t1={};const Pf=nn,r1=1335,Tw=21522,nm=Pf.getBCHDigit(r1);t1.getEncodedBits=function(e,t){const n=e.bit<<3|t;let i=n<<10;for(;Pf.getBCHDigit(i)-nm>=0;)i^=r1<<Pf.getBCHDigit(i)-nm;return(n<<10|i)^Tw};var n1={};const Aw=Mi;function pa(r){this.mode=Aw.NUMERIC,this.data=r.toString()}pa.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};pa.prototype.getLength=function(){return this.data.length};pa.prototype.getBitsLength=function(){return pa.getBitsLength(this.data.length)};pa.prototype.write=function(e){let t,n,i;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),i=parseInt(n,10),e.put(i,10);const s=this.data.length-t;s>0&&(n=this.data.substr(t),i=parseInt(n,10),e.put(i,s*3+1))};var Sw=pa;const Iw=Mi,Zu=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function ga(r){this.mode=Iw.ALPHANUMERIC,this.data=r}ga.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};ga.prototype.getLength=function(){return this.data.length};ga.prototype.getBitsLength=function(){return ga.getBitsLength(this.data.length)};ga.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=Zu.indexOf(this.data[t])*45;n+=Zu.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(Zu.indexOf(this.data[t]),6)};var kw=ga;const Cw=Mi;function _a(r){this.mode=Cw.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}_a.getBitsLength=function(e){return e*8};_a.prototype.getLength=function(){return this.data.length};_a.prototype.getBitsLength=function(){return _a.getBitsLength(this.data.length)};_a.prototype.write=function(r){for(let e=0,t=this.data.length;e<t;e++)r.put(this.data[e],8)};var bw=_a;const Rw=Mi,Fw=nn;function xa(r){this.mode=Rw.KANJI,this.data=r}xa.getBitsLength=function(e){return e*13};xa.prototype.getLength=function(){return this.data.length};xa.prototype.getBitsLength=function(){return xa.getBitsLength(this.data.length)};xa.prototype.write=function(r){let e;for(e=0;e<this.data.length;e++){let t=Fw.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),r.put(t,13)}};var Dw=xa,i1={exports:{}};(function(r){var e={single_source_shortest_paths:function(t,n,i){var s={},a={};a[n]=0;var o=e.PriorityQueue.make();o.push(n,0);for(var c,l,u,h,d,m,g,p,x;!o.empty();){c=o.pop(),l=c.value,h=c.cost,d=t[l]||{};for(u in d)d.hasOwnProperty(u)&&(m=d[u],g=h+m,p=a[u],x=typeof a[u]>"u",(x||p>g)&&(a[u]=g,o.push(u,g),s[u]=l))}if(typeof i<"u"&&typeof a[i]>"u"){var T=["Could not find a path from ",n," to ",i,"."].join("");throw new Error(T)}return s},extract_shortest_path_from_predecessor_list:function(t,n){for(var i=[],s=n;s;)i.push(s),t[s],s=t[s];return i.reverse(),i},find_path:function(t,n,i){var s=e.single_source_shortest_paths(t,n,i);return e.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(t){var n=e.PriorityQueue,i={},s;t=t||{};for(s in n)n.hasOwnProperty(s)&&(i[s]=n[s]);return i.queue=[],i.sorter=t.sorter||n.default_sorter,i},default_sorter:function(t,n){return t.cost-n.cost},push:function(t,n){var i={value:t,cost:n};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};r.exports=e})(i1);var Pw=i1.exports;(function(r){const e=Mi,t=Sw,n=kw,i=bw,s=Dw,a=Ln,o=nn,c=Pw;function l(T){return unescape(encodeURIComponent(T)).length}function u(T,b,E){const F=[];let M;for(;(M=T.exec(E))!==null;)F.push({data:M[0],index:M.index,mode:b,length:M[0].length});return F}function h(T){const b=u(a.NUMERIC,e.NUMERIC,T),E=u(a.ALPHANUMERIC,e.ALPHANUMERIC,T);let F,M;return o.isKanjiModeEnabled()?(F=u(a.BYTE,e.BYTE,T),M=u(a.KANJI,e.KANJI,T)):(F=u(a.BYTE_KANJI,e.BYTE,T),M=[]),b.concat(E,F,M).sort(function(y,A){return y.index-A.index}).map(function(y){return{data:y.data,mode:y.mode,length:y.length}})}function d(T,b){switch(b){case e.NUMERIC:return t.getBitsLength(T);case e.ALPHANUMERIC:return n.getBitsLength(T);case e.KANJI:return s.getBitsLength(T);case e.BYTE:return i.getBitsLength(T)}}function m(T){return T.reduce(function(b,E){const F=b.length-1>=0?b[b.length-1]:null;return F&&F.mode===E.mode?(b[b.length-1].data+=E.data,b):(b.push(E),b)},[])}function g(T){const b=[];for(let E=0;E<T.length;E++){const F=T[E];switch(F.mode){case e.NUMERIC:b.push([F,{data:F.data,mode:e.ALPHANUMERIC,length:F.length},{data:F.data,mode:e.BYTE,length:F.length}]);break;case e.ALPHANUMERIC:b.push([F,{data:F.data,mode:e.BYTE,length:F.length}]);break;case e.KANJI:b.push([F,{data:F.data,mode:e.BYTE,length:l(F.data)}]);break;case e.BYTE:b.push([{data:F.data,mode:e.BYTE,length:l(F.data)}])}}return b}function p(T,b){const E={},F={start:{}};let M=["start"];for(let O=0;O<T.length;O++){const y=T[O],A=[];for(let v=0;v<y.length;v++){const S=y[v],I=""+O+v;A.push(I),E[I]={node:S,lastCount:0},F[I]={};for(let k=0;k<M.length;k++){const R=M[k];E[R]&&E[R].node.mode===S.mode?(F[R][I]=d(E[R].lastCount+S.length,S.mode)-d(E[R].lastCount,S.mode),E[R].lastCount+=S.length):(E[R]&&(E[R].lastCount=S.length),F[R][I]=d(S.length,S.mode)+4+e.getCharCountIndicator(S.mode,b))}}M=A}for(let O=0;O<M.length;O++)F[M[O]].end=0;return{map:F,table:E}}function x(T,b){let E;const F=e.getBestModeForData(T);if(E=e.from(b,F),E!==e.BYTE&&E.bit<F.bit)throw new Error('"'+T+'" cannot be encoded with mode '+e.toString(E)+`.
 Suggested mode is: `+e.toString(F));switch(E===e.KANJI&&!o.isKanjiModeEnabled()&&(E=e.BYTE),E){case e.NUMERIC:return new t(T);case e.ALPHANUMERIC:return new n(T);case e.KANJI:return new s(T);case e.BYTE:return new i(T)}}r.fromArray=function(b){return b.reduce(function(E,F){return typeof F=="string"?E.push(x(F,null)):F.data&&E.push(x(F.data,F.mode)),E},[])},r.fromString=function(b,E){const F=h(b,o.isKanjiModeEnabled()),M=g(F),O=p(M,E),y=c.find_path(O.map,"start","end"),A=[];for(let v=1;v<y.length-1;v++)A.push(O.table[y[v]].node);return r.fromArray(m(A))},r.rawSplit=function(b){return r.fromArray(h(b,o.isKanjiModeEnabled()))}})(n1);const uu=nn,ef=ou,Nw=mw,Ow=pw,Lw=qg,Mw=Xg,Nf=Qg,Of=cu,Vw=_w,Sl=Zg,Bw=t1,Uw=Mi,tf=n1;function Gw(r,e){const t=r.size,n=Mw.getPositions(e);for(let i=0;i<n.length;i++){const s=n[i][0],a=n[i][1];for(let o=-1;o<=7;o++)if(!(s+o<=-1||t<=s+o))for(let c=-1;c<=7;c++)a+c<=-1||t<=a+c||(o>=0&&o<=6&&(c===0||c===6)||c>=0&&c<=6&&(o===0||o===6)||o>=2&&o<=4&&c>=2&&c<=4?r.set(s+o,a+c,!0,!0):r.set(s+o,a+c,!1,!0))}}function Ww(r){const e=r.size;for(let t=8;t<e-8;t++){const n=t%2===0;r.set(t,6,n,!0),r.set(6,t,n,!0)}}function zw(r,e){const t=Lw.getPositions(e);for(let n=0;n<t.length;n++){const i=t[n][0],s=t[n][1];for(let a=-2;a<=2;a++)for(let o=-2;o<=2;o++)a===-2||a===2||o===-2||o===2||a===0&&o===0?r.set(i+a,s+o,!0,!0):r.set(i+a,s+o,!1,!0)}}function Hw(r,e){const t=r.size,n=Sl.getEncodedBits(e);let i,s,a;for(let o=0;o<18;o++)i=Math.floor(o/3),s=o%3+t-8-3,a=(n>>o&1)===1,r.set(i,s,a,!0),r.set(s,i,a,!0)}function rf(r,e,t){const n=r.size,i=Bw.getEncodedBits(e,t);let s,a;for(s=0;s<15;s++)a=(i>>s&1)===1,s<6?r.set(s,8,a,!0):s<8?r.set(s+1,8,a,!0):r.set(n-15+s,8,a,!0),s<8?r.set(8,n-s-1,a,!0):s<9?r.set(8,15-s-1+1,a,!0):r.set(8,15-s-1,a,!0);r.set(n-8,8,1,!0)}function jw(r,e){const t=r.size;let n=-1,i=t-1,s=7,a=0;for(let o=t-1;o>0;o-=2)for(o===6&&o--;;){for(let c=0;c<2;c++)if(!r.isReserved(i,o-c)){let l=!1;a<e.length&&(l=(e[a]>>>s&1)===1),r.set(i,o-c,l),s--,s===-1&&(a++,s=7)}if(i+=n,i<0||t<=i){i-=n,n=-n;break}}}function $w(r,e,t){const n=new Nw;t.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),Uw.getCharCountIndicator(c.mode,r)),c.write(n)});const i=uu.getSymbolTotalCodewords(r),s=Of.getTotalCodewordsCount(r,e),a=(i-s)*8;for(n.getLengthInBits()+4<=a&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const o=(a-n.getLengthInBits())/8;for(let c=0;c<o;c++)n.put(c%2?17:236,8);return Kw(n,r,e)}function Kw(r,e,t){const n=uu.getSymbolTotalCodewords(e),i=Of.getTotalCodewordsCount(e,t),s=n-i,a=Of.getBlocksCount(e,t),o=n%a,c=a-o,l=Math.floor(n/a),u=Math.floor(s/a),h=u+1,d=l-u,m=new Vw(d);let g=0;const p=new Array(a),x=new Array(a);let T=0;const b=new Uint8Array(r.buffer);for(let y=0;y<a;y++){const A=y<c?u:h;p[y]=b.slice(g,g+A),x[y]=m.encode(p[y]),g+=A,T=Math.max(T,A)}const E=new Uint8Array(n);let F=0,M,O;for(M=0;M<T;M++)for(O=0;O<a;O++)M<p[O].length&&(E[F++]=p[O][M]);for(M=0;M<d;M++)for(O=0;O<a;O++)E[F++]=x[O][M];return E}function qw(r,e,t,n){let i;if(Array.isArray(r))i=tf.fromArray(r);else if(typeof r=="string"){let l=e;if(!l){const u=tf.rawSplit(r);l=Sl.getBestVersionForData(u,t)}i=tf.fromString(r,l||40)}else throw new Error("Invalid data");const s=Sl.getBestVersionForData(i,t);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=s;else if(e<s)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+s+`.
`);const a=$w(e,t,i),o=uu.getSymbolSize(e),c=new Ow(o);return Gw(c,e),Ww(c),zw(c,e),rf(c,t,0),e>=7&&Hw(c,e),jw(c,a),isNaN(n)&&(n=Nf.getBestMask(c,rf.bind(null,c,t))),Nf.applyMask(n,c),rf(c,t,n),{modules:c,version:e,errorCorrectionLevel:t,maskPattern:n,segments:i}}$g.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let n=ef.M,i,s;return typeof t<"u"&&(n=ef.from(t.errorCorrectionLevel,ef.M),i=Sl.from(t.version),s=Nf.from(t.maskPattern),t.toSJISFunc&&uu.setToSJISFunction(t.toSJISFunc)),qw(e,i,n,s)};var s1={},Sh={};(function(r){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let n=t.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+t);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(s){return[s,s]}))),n.length===6&&n.push("F","F");const i=parseInt(n.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+n.slice(0,6).join("")}}r.getOptions=function(n){n||(n={}),n.color||(n.color={});const i=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,s=n.width&&n.width>=21?n.width:void 0,a=n.scale||4;return{width:s,scale:s?4:a,margin:i,color:{dark:e(n.color.dark||"#000000ff"),light:e(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},r.getScale=function(n,i){return i.width&&i.width>=n+i.margin*2?i.width/(n+i.margin*2):i.scale},r.getImageWidth=function(n,i){const s=r.getScale(n,i);return Math.floor((n+i.margin*2)*s)},r.qrToImageData=function(n,i,s){const a=i.modules.size,o=i.modules.data,c=r.getScale(a,s),l=Math.floor((a+s.margin*2)*c),u=s.margin*c,h=[s.color.light,s.color.dark];for(let d=0;d<l;d++)for(let m=0;m<l;m++){let g=(d*l+m)*4,p=s.color.light;if(d>=u&&m>=u&&d<l-u&&m<l-u){const x=Math.floor((d-u)/c),T=Math.floor((m-u)/c);p=h[o[x*a+T]?1:0]}n[g++]=p.r,n[g++]=p.g,n[g++]=p.b,n[g]=p.a}}})(Sh);(function(r){const e=Sh;function t(i,s,a){i.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=a,s.width=a,s.style.height=a+"px",s.style.width=a+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}r.render=function(s,a,o){let c=o,l=a;typeof c>"u"&&(!a||!a.getContext)&&(c=a,a=void 0),a||(l=n()),c=e.getOptions(c);const u=e.getImageWidth(s.modules.size,c),h=l.getContext("2d"),d=h.createImageData(u,u);return e.qrToImageData(d.data,s,c),t(h,l,u),h.putImageData(d,0,0),l},r.renderToDataURL=function(s,a,o){let c=o;typeof c>"u"&&(!a||!a.getContext)&&(c=a,a=void 0),c||(c={});const l=r.render(s,a,c),u=c.type||"image/png",h=c.rendererOpts||{};return l.toDataURL(u,h.quality)}})(s1);var a1={};const Xw=Sh;function im(r,e){const t=r.a/255,n=e+'="'+r.hex+'"';return t<1?n+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':n}function nf(r,e,t){let n=r+e;return typeof t<"u"&&(n+=" "+t),n}function Qw(r,e,t){let n="",i=0,s=!1,a=0;for(let o=0;o<r.length;o++){const c=Math.floor(o%e),l=Math.floor(o/e);!c&&!s&&(s=!0),r[o]?(a++,o>0&&c>0&&r[o-1]||(n+=s?nf("M",c+t,.5+l+t):nf("m",i,0),i=0,s=!1),c+1<e&&r[o+1]||(n+=nf("h",a),a=0)):i++}return n}a1.render=function(e,t,n){const i=Xw.getOptions(t),s=e.modules.size,a=e.modules.data,o=s+i.margin*2,c=i.color.light.a?"<path "+im(i.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",l="<path "+im(i.color.dark,"stroke")+' d="'+Qw(a,s,i.margin)+'"/>',u='viewBox="0 0 '+o+" "+o+'"',d='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+u+' shape-rendering="crispEdges">'+c+l+`</svg>
`;return typeof n=="function"&&n(null,d),d};const Yw=hw,Lf=$g,o1=s1,Jw=a1;function Ih(r,e,t,n,i){const s=[].slice.call(arguments,1),a=s.length,o=typeof s[a-1]=="function";if(!o&&!Yw())throw new Error("Callback required as last argument");if(o){if(a<2)throw new Error("Too few arguments provided");a===2?(i=t,t=e,e=n=void 0):a===3&&(e.getContext&&typeof i>"u"?(i=n,n=void 0):(i=n,n=t,t=e,e=void 0))}else{if(a<1)throw new Error("Too few arguments provided");return a===1?(t=e,e=n=void 0):a===2&&!e.getContext&&(n=t,t=e,e=void 0),new Promise(function(c,l){try{const u=Lf.create(t,n);c(r(u,e,n))}catch(u){l(u)}})}try{const c=Lf.create(t,n);i(null,r(c,e,n))}catch(c){i(c)}}lc.create=Lf.create;lc.toCanvas=Ih.bind(null,o1.render);lc.toDataURL=Ih.bind(null,o1.renderToDataURL);lc.toString=Ih.bind(null,function(r,e,t){return Jw.render(r,t)});var sm={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Zw=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],a=r[t++],o=r[t++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=r[t++],a=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},l1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],a=i+1<r.length,o=a?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0,u=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|l>>6,m=l&63;c||(m=64,a||(d=64)),n.push(t[u],t[h],t[d],t[m])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(c1(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):Zw(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],o=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const h=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||o==null||l==null||h==null)throw new eE;const d=s<<2|o>>4;if(n.push(d),l!==64){const m=o<<4&240|l>>2;if(n.push(m),h!==64){const g=l<<6&192|h;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class eE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tE=function(r){const e=c1(r);return l1.encodeByteArray(e,!0)},Il=function(r){return tE(r).replace(/\./g,"")},rE=function(r){try{return l1.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=()=>nE().__FIREBASE_DEFAULTS__,sE=()=>{if(typeof process>"u"||typeof sm>"u")return;const r=sm.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},aE=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&rE(r[1]);return e&&JSON.parse(e)},kh=()=>{try{return iE()||sE()||aE()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},oE=r=>{var e,t;return(t=(e=kh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},cE=r=>{const e=oE(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},u1=()=>{var r;return(r=kh())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Il(JSON.stringify(t)),Il(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fE(){var r;const e=(r=kh())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function f1(){return!fE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function h1(){try{return typeof indexedDB=="object"}catch{return!1}}function hE(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE="FirebaseError";class bs extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=dE,Object.setPrototypeOf(this,bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,d1.prototype.create)}}class d1{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?mE(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new bs(i,o,n)}}function mE(r,e){return r.replace(pE,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const pE=/\{\$([^}]+)}/g;function Do(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],a=e[i];if(am(s)&&am(a)){if(!Do(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function am(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(r){return r&&r._delegate?r._delegate:r}class va{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new lE;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xE(e))try{this.getOrInitializeService({instanceIdentifier:Zi})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Zi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zi){return this.instances.has(e)}getOptions(e=Zi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:_E(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Zi){return this.component?this.component.multipleInstances?e:Zi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _E(r){return r===Zi?void 0:r}function xE(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new gE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(tt||(tt={}));const yE={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},wE=tt.INFO,EE={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},TE=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=EE[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class m1{constructor(e){this.name=e,this._logLevel=wE,this._logHandler=TE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}}const AE=(r,e)=>e.some(t=>r instanceof t);let om,cm;function SE(){return om||(om=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IE(){return cm||(cm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const p1=new WeakMap,Mf=new WeakMap,g1=new WeakMap,sf=new WeakMap,Ch=new WeakMap;function kE(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",a)},s=()=>{t(Ei(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&p1.set(t,r)}).catch(()=>{}),Ch.set(e,r),e}function CE(r){if(Mf.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",a),r.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",a),r.addEventListener("abort",a)});Mf.set(r,e)}let Vf={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Mf.get(r);if(e==="objectStoreNames")return r.objectStoreNames||g1.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ei(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function bE(r){Vf=r(Vf)}function RE(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(af(this),e,...t);return g1.set(n,e.sort?e.sort():[e]),Ei(n)}:IE().includes(r)?function(...e){return r.apply(af(this),e),Ei(p1.get(this))}:function(...e){return Ei(r.apply(af(this),e))}}function FE(r){return typeof r=="function"?RE(r):(r instanceof IDBTransaction&&CE(r),AE(r,SE())?new Proxy(r,Vf):r)}function Ei(r){if(r instanceof IDBRequest)return kE(r);if(sf.has(r))return sf.get(r);const e=FE(r);return e!==r&&(sf.set(r,e),Ch.set(e,r)),e}const af=r=>Ch.get(r);function DE(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(r,e),o=Ei(a);return n&&a.addEventListener("upgradeneeded",c=>{n(Ei(a.result),c.oldVersion,c.newVersion,Ei(a.transaction),c)}),t&&a.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const PE=["get","getKey","getAll","getAllKeys","count"],NE=["put","add","delete","clear"],of=new Map;function lm(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(of.get(e))return of.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=NE.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||PE.includes(t)))return;const s=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[t](...o),i&&c.done]))[0]};return of.set(e,s),s}bE(r=>({...r,get:(e,t,n)=>lm(e,t)||r.get(e,t,n),has:(e,t)=>!!lm(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(LE(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function LE(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bf="@firebase/app",um="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=new m1("@firebase/app"),ME="@firebase/app-compat",VE="@firebase/analytics-compat",BE="@firebase/analytics",UE="@firebase/app-check-compat",GE="@firebase/app-check",WE="@firebase/auth",zE="@firebase/auth-compat",HE="@firebase/database",jE="@firebase/data-connect",$E="@firebase/database-compat",KE="@firebase/functions",qE="@firebase/functions-compat",XE="@firebase/installations",QE="@firebase/installations-compat",YE="@firebase/messaging",JE="@firebase/messaging-compat",ZE="@firebase/performance",e2="@firebase/performance-compat",t2="@firebase/remote-config",r2="@firebase/remote-config-compat",n2="@firebase/storage",i2="@firebase/storage-compat",s2="@firebase/firestore",a2="@firebase/vertexai-preview",o2="@firebase/firestore-compat",c2="firebase",l2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uf="[DEFAULT]",u2={[Bf]:"fire-core",[ME]:"fire-core-compat",[BE]:"fire-analytics",[VE]:"fire-analytics-compat",[GE]:"fire-app-check",[UE]:"fire-app-check-compat",[WE]:"fire-auth",[zE]:"fire-auth-compat",[HE]:"fire-rtdb",[jE]:"fire-data-connect",[$E]:"fire-rtdb-compat",[KE]:"fire-fn",[qE]:"fire-fn-compat",[XE]:"fire-iid",[QE]:"fire-iid-compat",[YE]:"fire-fcm",[JE]:"fire-fcm-compat",[ZE]:"fire-perf",[e2]:"fire-perf-compat",[t2]:"fire-rc",[r2]:"fire-rc-compat",[n2]:"fire-gcs",[i2]:"fire-gcs-compat",[s2]:"fire-fst",[o2]:"fire-fst-compat",[a2]:"fire-vertex","fire-js":"fire-js",[c2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl=new Map,f2=new Map,Gf=new Map;function fm(r,e){try{r.container.addComponent(e)}catch(t){ti.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Po(r){const e=r.name;if(Gf.has(e))return ti.debug(`There were multiple attempts to register component ${e}.`),!1;Gf.set(e,r);for(const t of Cl.values())fm(t,r);for(const t of f2.values())fm(t,r);return!0}function _1(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ti=new d1("app","Firebase",h2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ti.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1=l2;function v1(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Uf,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Ti.create("bad-app-name",{appName:String(i)});if(t||(t=u1()),!t)throw Ti.create("no-options");const s=Cl.get(i);if(s){if(Do(t,s.options)&&Do(n,s.config))return s;throw Ti.create("duplicate-app",{appName:i})}const a=new vE(i);for(const c of Gf.values())a.addComponent(c);const o=new d2(t,n,a);return Cl.set(i,o),o}function m2(r=Uf){const e=Cl.get(r);if(!e&&r===Uf&&u1())return v1();if(!e)throw Ti.create("no-app",{appName:r});return e}function Ai(r,e,t){var n;let i=(n=u2[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ti.warn(o.join(" "));return}Po(new va(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2="firebase-heartbeat-database",g2=1,No="firebase-heartbeat-store";let cf=null;function y1(){return cf||(cf=DE(p2,g2,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(No)}catch(t){console.warn(t)}}}}).catch(r=>{throw Ti.create("idb-open",{originalErrorMessage:r.message})})),cf}async function _2(r){try{const t=(await y1()).transaction(No),n=await t.objectStore(No).get(w1(r));return await t.done,n}catch(e){if(e instanceof bs)ti.warn(e.message);else{const t=Ti.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ti.warn(t.message)}}}async function hm(r,e){try{const n=(await y1()).transaction(No,"readwrite");await n.objectStore(No).put(e,w1(r)),await n.done}catch(t){if(t instanceof bs)ti.warn(t.message);else{const n=Ti.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ti.warn(n.message)}}}function w1(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=1024,v2=30*24*60*60*1e3;class y2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new E2(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=dm();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=v2}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ti.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=dm(),{heartbeatsToSend:n,unsentEntries:i}=w2(this._heartbeatsCache.heartbeats),s=Il(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ti.warn(t),""}}}function dm(){return new Date().toISOString().substring(0,10)}function w2(r,e=x2){const t=[];let n=r.slice();for(const i of r){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),mm(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),mm(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class E2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return h1()?hE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _2(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return hm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return hm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function mm(r){return Il(JSON.stringify({version:2,heartbeats:r})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T2(r){Po(new va("platform-logger",e=>new OE(e),"PRIVATE")),Po(new va("heartbeat",e=>new y2(e),"PRIVATE")),Ai(Bf,um,r),Ai(Bf,um,"esm2017"),Ai("fire-js","")}T2("");var A2="firebase",S2="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ai(A2,S2,"app");var pm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var as,E1;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,A){function v(){}v.prototype=A.prototype,y.D=A.prototype,y.prototype=new v,y.prototype.constructor=y,y.C=function(S,I,k){for(var R=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)R[ae-2]=arguments[ae];return A.prototype[I].apply(S,R)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(y,A,v){v||(v=0);var S=Array(16);if(typeof A=="string")for(var I=0;16>I;++I)S[I]=A.charCodeAt(v++)|A.charCodeAt(v++)<<8|A.charCodeAt(v++)<<16|A.charCodeAt(v++)<<24;else for(I=0;16>I;++I)S[I]=A[v++]|A[v++]<<8|A[v++]<<16|A[v++]<<24;A=y.g[0],v=y.g[1],I=y.g[2];var k=y.g[3],R=A+(k^v&(I^k))+S[0]+3614090360&4294967295;A=v+(R<<7&4294967295|R>>>25),R=k+(I^A&(v^I))+S[1]+3905402710&4294967295,k=A+(R<<12&4294967295|R>>>20),R=I+(v^k&(A^v))+S[2]+606105819&4294967295,I=k+(R<<17&4294967295|R>>>15),R=v+(A^I&(k^A))+S[3]+3250441966&4294967295,v=I+(R<<22&4294967295|R>>>10),R=A+(k^v&(I^k))+S[4]+4118548399&4294967295,A=v+(R<<7&4294967295|R>>>25),R=k+(I^A&(v^I))+S[5]+1200080426&4294967295,k=A+(R<<12&4294967295|R>>>20),R=I+(v^k&(A^v))+S[6]+2821735955&4294967295,I=k+(R<<17&4294967295|R>>>15),R=v+(A^I&(k^A))+S[7]+4249261313&4294967295,v=I+(R<<22&4294967295|R>>>10),R=A+(k^v&(I^k))+S[8]+1770035416&4294967295,A=v+(R<<7&4294967295|R>>>25),R=k+(I^A&(v^I))+S[9]+2336552879&4294967295,k=A+(R<<12&4294967295|R>>>20),R=I+(v^k&(A^v))+S[10]+4294925233&4294967295,I=k+(R<<17&4294967295|R>>>15),R=v+(A^I&(k^A))+S[11]+2304563134&4294967295,v=I+(R<<22&4294967295|R>>>10),R=A+(k^v&(I^k))+S[12]+1804603682&4294967295,A=v+(R<<7&4294967295|R>>>25),R=k+(I^A&(v^I))+S[13]+4254626195&4294967295,k=A+(R<<12&4294967295|R>>>20),R=I+(v^k&(A^v))+S[14]+2792965006&4294967295,I=k+(R<<17&4294967295|R>>>15),R=v+(A^I&(k^A))+S[15]+1236535329&4294967295,v=I+(R<<22&4294967295|R>>>10),R=A+(I^k&(v^I))+S[1]+4129170786&4294967295,A=v+(R<<5&4294967295|R>>>27),R=k+(v^I&(A^v))+S[6]+3225465664&4294967295,k=A+(R<<9&4294967295|R>>>23),R=I+(A^v&(k^A))+S[11]+643717713&4294967295,I=k+(R<<14&4294967295|R>>>18),R=v+(k^A&(I^k))+S[0]+3921069994&4294967295,v=I+(R<<20&4294967295|R>>>12),R=A+(I^k&(v^I))+S[5]+3593408605&4294967295,A=v+(R<<5&4294967295|R>>>27),R=k+(v^I&(A^v))+S[10]+38016083&4294967295,k=A+(R<<9&4294967295|R>>>23),R=I+(A^v&(k^A))+S[15]+3634488961&4294967295,I=k+(R<<14&4294967295|R>>>18),R=v+(k^A&(I^k))+S[4]+3889429448&4294967295,v=I+(R<<20&4294967295|R>>>12),R=A+(I^k&(v^I))+S[9]+568446438&4294967295,A=v+(R<<5&4294967295|R>>>27),R=k+(v^I&(A^v))+S[14]+3275163606&4294967295,k=A+(R<<9&4294967295|R>>>23),R=I+(A^v&(k^A))+S[3]+4107603335&4294967295,I=k+(R<<14&4294967295|R>>>18),R=v+(k^A&(I^k))+S[8]+1163531501&4294967295,v=I+(R<<20&4294967295|R>>>12),R=A+(I^k&(v^I))+S[13]+2850285829&4294967295,A=v+(R<<5&4294967295|R>>>27),R=k+(v^I&(A^v))+S[2]+4243563512&4294967295,k=A+(R<<9&4294967295|R>>>23),R=I+(A^v&(k^A))+S[7]+1735328473&4294967295,I=k+(R<<14&4294967295|R>>>18),R=v+(k^A&(I^k))+S[12]+2368359562&4294967295,v=I+(R<<20&4294967295|R>>>12),R=A+(v^I^k)+S[5]+4294588738&4294967295,A=v+(R<<4&4294967295|R>>>28),R=k+(A^v^I)+S[8]+2272392833&4294967295,k=A+(R<<11&4294967295|R>>>21),R=I+(k^A^v)+S[11]+1839030562&4294967295,I=k+(R<<16&4294967295|R>>>16),R=v+(I^k^A)+S[14]+4259657740&4294967295,v=I+(R<<23&4294967295|R>>>9),R=A+(v^I^k)+S[1]+2763975236&4294967295,A=v+(R<<4&4294967295|R>>>28),R=k+(A^v^I)+S[4]+1272893353&4294967295,k=A+(R<<11&4294967295|R>>>21),R=I+(k^A^v)+S[7]+4139469664&4294967295,I=k+(R<<16&4294967295|R>>>16),R=v+(I^k^A)+S[10]+3200236656&4294967295,v=I+(R<<23&4294967295|R>>>9),R=A+(v^I^k)+S[13]+681279174&4294967295,A=v+(R<<4&4294967295|R>>>28),R=k+(A^v^I)+S[0]+3936430074&4294967295,k=A+(R<<11&4294967295|R>>>21),R=I+(k^A^v)+S[3]+3572445317&4294967295,I=k+(R<<16&4294967295|R>>>16),R=v+(I^k^A)+S[6]+76029189&4294967295,v=I+(R<<23&4294967295|R>>>9),R=A+(v^I^k)+S[9]+3654602809&4294967295,A=v+(R<<4&4294967295|R>>>28),R=k+(A^v^I)+S[12]+3873151461&4294967295,k=A+(R<<11&4294967295|R>>>21),R=I+(k^A^v)+S[15]+530742520&4294967295,I=k+(R<<16&4294967295|R>>>16),R=v+(I^k^A)+S[2]+3299628645&4294967295,v=I+(R<<23&4294967295|R>>>9),R=A+(I^(v|~k))+S[0]+4096336452&4294967295,A=v+(R<<6&4294967295|R>>>26),R=k+(v^(A|~I))+S[7]+1126891415&4294967295,k=A+(R<<10&4294967295|R>>>22),R=I+(A^(k|~v))+S[14]+2878612391&4294967295,I=k+(R<<15&4294967295|R>>>17),R=v+(k^(I|~A))+S[5]+4237533241&4294967295,v=I+(R<<21&4294967295|R>>>11),R=A+(I^(v|~k))+S[12]+1700485571&4294967295,A=v+(R<<6&4294967295|R>>>26),R=k+(v^(A|~I))+S[3]+2399980690&4294967295,k=A+(R<<10&4294967295|R>>>22),R=I+(A^(k|~v))+S[10]+4293915773&4294967295,I=k+(R<<15&4294967295|R>>>17),R=v+(k^(I|~A))+S[1]+2240044497&4294967295,v=I+(R<<21&4294967295|R>>>11),R=A+(I^(v|~k))+S[8]+1873313359&4294967295,A=v+(R<<6&4294967295|R>>>26),R=k+(v^(A|~I))+S[15]+4264355552&4294967295,k=A+(R<<10&4294967295|R>>>22),R=I+(A^(k|~v))+S[6]+2734768916&4294967295,I=k+(R<<15&4294967295|R>>>17),R=v+(k^(I|~A))+S[13]+1309151649&4294967295,v=I+(R<<21&4294967295|R>>>11),R=A+(I^(v|~k))+S[4]+4149444226&4294967295,A=v+(R<<6&4294967295|R>>>26),R=k+(v^(A|~I))+S[11]+3174756917&4294967295,k=A+(R<<10&4294967295|R>>>22),R=I+(A^(k|~v))+S[2]+718787259&4294967295,I=k+(R<<15&4294967295|R>>>17),R=v+(k^(I|~A))+S[9]+3951481745&4294967295,y.g[0]=y.g[0]+A&4294967295,y.g[1]=y.g[1]+(I+(R<<21&4294967295|R>>>11))&4294967295,y.g[2]=y.g[2]+I&4294967295,y.g[3]=y.g[3]+k&4294967295}n.prototype.u=function(y,A){A===void 0&&(A=y.length);for(var v=A-this.blockSize,S=this.B,I=this.h,k=0;k<A;){if(I==0)for(;k<=v;)i(this,y,k),k+=this.blockSize;if(typeof y=="string"){for(;k<A;)if(S[I++]=y.charCodeAt(k++),I==this.blockSize){i(this,S),I=0;break}}else for(;k<A;)if(S[I++]=y[k++],I==this.blockSize){i(this,S),I=0;break}}this.h=I,this.o+=A},n.prototype.v=function(){var y=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);y[0]=128;for(var A=1;A<y.length-8;++A)y[A]=0;var v=8*this.o;for(A=y.length-8;A<y.length;++A)y[A]=v&255,v/=256;for(this.u(y),y=Array(16),A=v=0;4>A;++A)for(var S=0;32>S;S+=8)y[v++]=this.g[A]>>>S&255;return y};function s(y,A){var v=o;return Object.prototype.hasOwnProperty.call(v,y)?v[y]:v[y]=A(y)}function a(y,A){this.h=A;for(var v=[],S=!0,I=y.length-1;0<=I;I--){var k=y[I]|0;S&&k==A||(v[I]=k,S=!1)}this.g=v}var o={};function c(y){return-128<=y&&128>y?s(y,function(A){return new a([A|0],0>A?-1:0)}):new a([y|0],0>y?-1:0)}function l(y){if(isNaN(y)||!isFinite(y))return h;if(0>y)return x(l(-y));for(var A=[],v=1,S=0;y>=v;S++)A[S]=y/v|0,v*=4294967296;return new a(A,0)}function u(y,A){if(y.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(y.charAt(0)=="-")return x(u(y.substring(1),A));if(0<=y.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=l(Math.pow(A,8)),S=h,I=0;I<y.length;I+=8){var k=Math.min(8,y.length-I),R=parseInt(y.substring(I,I+k),A);8>k?(k=l(Math.pow(A,k)),S=S.j(k).add(l(R))):(S=S.j(v),S=S.add(l(R)))}return S}var h=c(0),d=c(1),m=c(16777216);r=a.prototype,r.m=function(){if(p(this))return-x(this).m();for(var y=0,A=1,v=0;v<this.g.length;v++){var S=this.i(v);y+=(0<=S?S:4294967296+S)*A,A*=4294967296}return y},r.toString=function(y){if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(g(this))return"0";if(p(this))return"-"+x(this).toString(y);for(var A=l(Math.pow(y,6)),v=this,S="";;){var I=F(v,A).g;v=T(v,I.j(A));var k=((0<v.g.length?v.g[0]:v.h)>>>0).toString(y);if(v=I,g(v))return k+S;for(;6>k.length;)k="0"+k;S=k+S}},r.i=function(y){return 0>y?0:y<this.g.length?this.g[y]:this.h};function g(y){if(y.h!=0)return!1;for(var A=0;A<y.g.length;A++)if(y.g[A]!=0)return!1;return!0}function p(y){return y.h==-1}r.l=function(y){return y=T(this,y),p(y)?-1:g(y)?0:1};function x(y){for(var A=y.g.length,v=[],S=0;S<A;S++)v[S]=~y.g[S];return new a(v,~y.h).add(d)}r.abs=function(){return p(this)?x(this):this},r.add=function(y){for(var A=Math.max(this.g.length,y.g.length),v=[],S=0,I=0;I<=A;I++){var k=S+(this.i(I)&65535)+(y.i(I)&65535),R=(k>>>16)+(this.i(I)>>>16)+(y.i(I)>>>16);S=R>>>16,k&=65535,R&=65535,v[I]=R<<16|k}return new a(v,v[v.length-1]&-2147483648?-1:0)};function T(y,A){return y.add(x(A))}r.j=function(y){if(g(this)||g(y))return h;if(p(this))return p(y)?x(this).j(x(y)):x(x(this).j(y));if(p(y))return x(this.j(x(y)));if(0>this.l(m)&&0>y.l(m))return l(this.m()*y.m());for(var A=this.g.length+y.g.length,v=[],S=0;S<2*A;S++)v[S]=0;for(S=0;S<this.g.length;S++)for(var I=0;I<y.g.length;I++){var k=this.i(S)>>>16,R=this.i(S)&65535,ae=y.i(I)>>>16,oe=y.i(I)&65535;v[2*S+2*I]+=R*oe,b(v,2*S+2*I),v[2*S+2*I+1]+=k*oe,b(v,2*S+2*I+1),v[2*S+2*I+1]+=R*ae,b(v,2*S+2*I+1),v[2*S+2*I+2]+=k*ae,b(v,2*S+2*I+2)}for(S=0;S<A;S++)v[S]=v[2*S+1]<<16|v[2*S];for(S=A;S<2*A;S++)v[S]=0;return new a(v,0)};function b(y,A){for(;(y[A]&65535)!=y[A];)y[A+1]+=y[A]>>>16,y[A]&=65535,A++}function E(y,A){this.g=y,this.h=A}function F(y,A){if(g(A))throw Error("division by zero");if(g(y))return new E(h,h);if(p(y))return A=F(x(y),A),new E(x(A.g),x(A.h));if(p(A))return A=F(y,x(A)),new E(x(A.g),A.h);if(30<y.g.length){if(p(y)||p(A))throw Error("slowDivide_ only works with positive integers.");for(var v=d,S=A;0>=S.l(y);)v=M(v),S=M(S);var I=O(v,1),k=O(S,1);for(S=O(S,2),v=O(v,2);!g(S);){var R=k.add(S);0>=R.l(y)&&(I=I.add(v),k=R),S=O(S,1),v=O(v,1)}return A=T(y,I.j(A)),new E(I,A)}for(I=h;0<=y.l(A);){for(v=Math.max(1,Math.floor(y.m()/A.m())),S=Math.ceil(Math.log(v)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),k=l(v),R=k.j(A);p(R)||0<R.l(y);)v-=S,k=l(v),R=k.j(A);g(k)&&(k=d),I=I.add(k),y=T(y,R)}return new E(I,y)}r.A=function(y){return F(this,y).h},r.and=function(y){for(var A=Math.max(this.g.length,y.g.length),v=[],S=0;S<A;S++)v[S]=this.i(S)&y.i(S);return new a(v,this.h&y.h)},r.or=function(y){for(var A=Math.max(this.g.length,y.g.length),v=[],S=0;S<A;S++)v[S]=this.i(S)|y.i(S);return new a(v,this.h|y.h)},r.xor=function(y){for(var A=Math.max(this.g.length,y.g.length),v=[],S=0;S<A;S++)v[S]=this.i(S)^y.i(S);return new a(v,this.h^y.h)};function M(y){for(var A=y.g.length+1,v=[],S=0;S<A;S++)v[S]=y.i(S)<<1|y.i(S-1)>>>31;return new a(v,y.h)}function O(y,A){var v=A>>5;A%=32;for(var S=y.g.length-v,I=[],k=0;k<S;k++)I[k]=0<A?y.i(k+v)>>>A|y.i(k+v+1)<<32-A:y.i(k+v);return new a(I,y.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,E1=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=u,as=a}).apply(typeof pm<"u"?pm:typeof self<"u"?self:typeof window<"u"?window:{});var Xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var T1,lo,A1,pl,Wf,S1,I1,k1;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,_,w){return f==Array.prototype||f==Object.prototype||(f[_]=w.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xc=="object"&&Xc];for(var _=0;_<f.length;++_){var w=f[_];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var n=t(this);function i(f,_){if(_)e:{var w=n;f=f.split(".");for(var D=0;D<f.length-1;D++){var j=f[D];if(!(j in w))break e;w=w[j]}f=f[f.length-1],D=w[f],_=_(D),_!=D&&_!=null&&e(w,f,{configurable:!0,writable:!0,value:_})}}function s(f,_){f instanceof String&&(f+="");var w=0,D=!1,j={next:function(){if(!D&&w<f.length){var te=w++;return{value:_(te,f[te]),done:!1}}return D=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}i("Array.prototype.values",function(f){return f||function(){return s(this,function(_,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(f){var _=typeof f;return _=_!="object"?_:f?Array.isArray(f)?"array":_:"null",_=="array"||_=="object"&&typeof f.length=="number"}function l(f){var _=typeof f;return _=="object"&&f!=null||_=="function"}function u(f,_,w){return f.call.apply(f.bind,arguments)}function h(f,_,w){if(!f)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,D),f.apply(_,j)}}return function(){return f.apply(_,arguments)}}function d(f,_,w){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,d.apply(null,arguments)}function m(f,_){var w=Array.prototype.slice.call(arguments,1);return function(){var D=w.slice();return D.push.apply(D,arguments),f.apply(this,D)}}function g(f,_){function w(){}w.prototype=_.prototype,f.aa=_.prototype,f.prototype=new w,f.prototype.constructor=f,f.Qb=function(D,j,te){for(var Te=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)Te[xt-2]=arguments[xt];return _.prototype[j].apply(D,Te)}}function p(f){const _=f.length;if(0<_){const w=Array(_);for(let D=0;D<_;D++)w[D]=f[D];return w}return[]}function x(f,_){for(let w=1;w<arguments.length;w++){const D=arguments[w];if(c(D)){const j=f.length||0,te=D.length||0;f.length=j+te;for(let Te=0;Te<te;Te++)f[j+Te]=D[Te]}else f.push(D)}}class T{constructor(_,w){this.i=_,this.j=w,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function b(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function F(f){return F[" "](f),f}F[" "]=function(){};var M=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function O(f,_,w){for(const D in f)_.call(w,f[D],D,f)}function y(f,_){for(const w in f)_.call(void 0,f[w],w,f)}function A(f){const _={};for(const w in f)_[w]=f[w];return _}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(f,_){let w,D;for(let j=1;j<arguments.length;j++){D=arguments[j];for(w in D)f[w]=D[w];for(let te=0;te<v.length;te++)w=v[te],Object.prototype.hasOwnProperty.call(D,w)&&(f[w]=D[w])}}function I(f){var _=1;f=f.split(":");const w=[];for(;0<_&&f.length;)w.push(f.shift()),_--;return f.length&&w.push(f.join(":")),w}function k(f){o.setTimeout(()=>{throw f},0)}function R(){var f=K;let _=null;return f.g&&(_=f.g,f.g=f.g.next,f.g||(f.h=null),_.next=null),_}class ae{constructor(){this.h=this.g=null}add(_,w){const D=oe.get();D.set(_,w),this.h?this.h.next=D:this.g=D,this.h=D}}var oe=new T(()=>new Ae,f=>f.reset());class Ae{constructor(){this.next=this.g=this.h=null}set(_,w){this.h=_,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let le,We=!1,K=new ae,Fe=()=>{const f=o.Promise.resolve(void 0);le=()=>{f.then(Ne)}};var Ne=()=>{for(var f;f=R();){try{f.h.call(f.g)}catch(w){k(w)}var _=oe;_.j(f),100>_.h&&(_.h++,f.next=_.g,_.g=f)}We=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(f,_){this.type=f,this.g=this.target=_,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var W=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,_=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const w=()=>{};o.addEventListener("test",w,_),o.removeEventListener("test",w,_)}catch{}return f}();function z(f,_){if(H.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var w=this.type=f.type,D=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=_,_=f.relatedTarget){if(M){e:{try{F(_.nodeName);var j=!0;break e}catch{}j=!1}j||(_=null)}}else w=="mouseover"?_=f.fromElement:w=="mouseout"&&(_=f.toElement);this.relatedTarget=_,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ie[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&z.aa.h.call(this)}}g(z,H);var ie={2:"touch",3:"pen",4:"mouse"};z.prototype.h=function(){z.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),_e=0;function pe(f,_,w,D,j){this.listener=f,this.proxy=null,this.src=_,this.type=w,this.capture=!!D,this.ha=j,this.key=++_e,this.da=this.fa=!1}function fe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Ve(f){this.src=f,this.g={},this.h=0}Ve.prototype.add=function(f,_,w,D,j){var te=f.toString();f=this.g[te],f||(f=this.g[te]=[],this.h++);var Te=ot(f,_,D,j);return-1<Te?(_=f[Te],w||(_.fa=!1)):(_=new pe(_,this.src,te,!!D,j),_.fa=w,f.push(_)),_};function G(f,_){var w=_.type;if(w in f.g){var D=f.g[w],j=Array.prototype.indexOf.call(D,_,void 0),te;(te=0<=j)&&Array.prototype.splice.call(D,j,1),te&&(fe(_),f.g[w].length==0&&(delete f.g[w],f.h--))}}function ot(f,_,w,D){for(var j=0;j<f.length;++j){var te=f[j];if(!te.da&&te.listener==_&&te.capture==!!w&&te.ha==D)return j}return-1}var Z="closure_lm_"+(1e6*Math.random()|0),ue={};function xe(f,_,w,D,j){if(Array.isArray(_)){for(var te=0;te<_.length;te++)xe(f,_[te],w,D,j);return null}return w=ct(w),f&&f[de]?f.K(_,w,l(D)?!!D.capture:!1,j):se(f,_,w,!1,D,j)}function se(f,_,w,D,j,te){if(!_)throw Error("Invalid event type");var Te=l(j)?!!j.capture:!!j,xt=jr(f);if(xt||(f[Z]=xt=new Ve(f)),w=xt.add(_,w,D,Te,te),w.proxy)return w;if(D=$e(),w.proxy=D,D.src=f,D.listener=w,f.addEventListener)W||(j=Te),j===void 0&&(j=!1),f.addEventListener(_.toString(),D,j);else if(f.attachEvent)f.attachEvent(Yt(_.toString()),D);else if(f.addListener&&f.removeListener)f.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return w}function $e(){function f(w){return _.call(f.src,f.listener,w)}const _=Jt;return f}function Qe(f,_,w,D,j){if(Array.isArray(_))for(var te=0;te<_.length;te++)Qe(f,_[te],w,D,j);else D=l(D)?!!D.capture:!!D,w=ct(w),f&&f[de]?(f=f.i,_=String(_).toString(),_ in f.g&&(te=f.g[_],w=ot(te,w,D,j),-1<w&&(fe(te[w]),Array.prototype.splice.call(te,w,1),te.length==0&&(delete f.g[_],f.h--)))):f&&(f=jr(f))&&(_=f.g[_.toString()],f=-1,_&&(f=ot(_,w,D,j)),(w=-1<f?_[f]:null)&&mt(w))}function mt(f){if(typeof f!="number"&&f&&!f.da){var _=f.src;if(_&&_[de])G(_.i,f);else{var w=f.type,D=f.proxy;_.removeEventListener?_.removeEventListener(w,D,f.capture):_.detachEvent?_.detachEvent(Yt(w),D):_.addListener&&_.removeListener&&_.removeListener(D),(w=jr(_))?(G(w,f),w.h==0&&(w.src=null,_[Z]=null)):fe(f)}}}function Yt(f){return f in ue?ue[f]:ue[f]="on"+f}function Jt(f,_){if(f.da)f=!0;else{_=new z(_,this);var w=f.listener,D=f.ha||f.src;f.fa&&mt(f),f=w.call(D,_)}return f}function jr(f){return f=f[Z],f instanceof Ve?f:null}var rr="__closure_events_fn_"+(1e9*Math.random()>>>0);function ct(f){return typeof f=="function"?f:(f[rr]||(f[rr]=function(_){return f.handleEvent(_)}),f[rr])}function Ze(){B.call(this),this.i=new Ve(this),this.M=this,this.F=null}g(Ze,B),Ze.prototype[de]=!0,Ze.prototype.removeEventListener=function(f,_,w,D){Qe(this,f,_,w,D)};function It(f,_){var w,D=f.F;if(D)for(w=[];D;D=D.F)w.push(D);if(f=f.M,D=_.type||_,typeof _=="string")_=new H(_,f);else if(_ instanceof H)_.target=_.target||f;else{var j=_;_=new H(D,f),S(_,j)}if(j=!0,w)for(var te=w.length-1;0<=te;te--){var Te=_.g=w[te];j=kt(Te,D,!0,_)&&j}if(Te=_.g=f,j=kt(Te,D,!0,_)&&j,j=kt(Te,D,!1,_)&&j,w)for(te=0;te<w.length;te++)Te=_.g=w[te],j=kt(Te,D,!1,_)&&j}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var f=this.i,_;for(_ in f.g){for(var w=f.g[_],D=0;D<w.length;D++)fe(w[D]);delete f.g[_],f.h--}}this.F=null},Ze.prototype.K=function(f,_,w,D){return this.i.add(String(f),_,!1,w,D)},Ze.prototype.L=function(f,_,w,D){return this.i.add(String(f),_,!0,w,D)};function kt(f,_,w,D){if(_=f.i.g[String(_)],!_)return!0;_=_.concat();for(var j=!0,te=0;te<_.length;++te){var Te=_[te];if(Te&&!Te.da&&Te.capture==w){var xt=Te.listener,ur=Te.ha||Te.src;Te.fa&&G(f.i,Te),j=xt.call(ur,D)!==!1&&j}}return j&&!D.defaultPrevented}function Fr(f,_,w){if(typeof f=="function")w&&(f=d(f,w));else if(f&&typeof f.handleEvent=="function")f=d(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(f,_||0)}function Ue(f){f.g=Fr(()=>{f.g=null,f.i&&(f.i=!1,Ue(f))},f.l);const _=f.h;f.h=null,f.m.apply(null,_)}class yt extends B{constructor(_,w){super(),this.m=_,this.l=w,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Ue(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $t(f){B.call(this),this.h=f,this.g={}}g($t,B);var Ct=[];function sn(f){O(f.g,function(_,w){this.g.hasOwnProperty(w)&&mt(_)},f),f.g={}}$t.prototype.N=function(){$t.aa.N.call(this),sn(this)},$t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bs=o.JSON.stringify,zu=o.JSON.parse,Hu=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Us(){}Us.prototype.h=null;function $a(f){return f.h||(f.h=f.i())}function Ka(){}var $i={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qa(){H.call(this,"d")}g(qa,H);function oi(){H.call(this,"c")}g(oi,H);var Un={},Dc=null;function Gs(){return Dc=Dc||new Ze}Un.La="serverreachability";function Pc(f){H.call(this,Un.La,f)}g(Pc,H);function Ki(f){const _=Gs();It(_,new Pc(_))}Un.STAT_EVENT="statevent";function Nc(f,_){H.call(this,Un.STAT_EVENT,f),this.stat=_}g(Nc,H);function lr(f){const _=Gs();It(_,new Nc(_,f))}Un.Ma="timingevent";function Oc(f,_){H.call(this,Un.Ma,f),this.size=_}g(Oc,H);function Gn(f,_){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},_)}function qi(){this.g=!0}qi.prototype.xa=function(){this.g=!1};function ju(f,_,w,D,j,te){f.info(function(){if(f.g)if(te)for(var Te="",xt=te.split("&"),ur=0;ur<xt.length;ur++){var st=xt[ur].split("=");if(1<st.length){var gr=st[0];st=st[1];var _r=gr.split("_");Te=2<=_r.length&&_r[1]=="type"?Te+(gr+"="+st+"&"):Te+(gr+"=redacted&")}}else Te=null;else Te=te;return"XMLHTTP REQ ("+D+") [attempt "+j+"]: "+_+`
`+w+`
`+Te})}function $u(f,_,w,D,j,te,Te){f.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+j+"]: "+_+`
`+w+`
`+te+" "+Te})}function C(f,_,w,D){f.info(function(){return"XMLHTTP TEXT ("+_+"): "+P(f,w)+(D?" "+D:"")})}function L(f,_){f.info(function(){return"TIMEOUT: "+_})}qi.prototype.info=function(){};function P(f,_){if(!f.g)return _;if(!_)return null;try{var w=JSON.parse(_);if(w){for(f=0;f<w.length;f++)if(Array.isArray(w[f])){var D=w[f];if(!(2>D.length)){var j=D[1];if(Array.isArray(j)&&!(1>j.length)){var te=j[0];if(te!="noop"&&te!="stop"&&te!="close")for(var Te=1;Te<j.length;Te++)j[Te]=""}}}}return Bs(w)}catch{return _}}var N={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},U;function X(){}g(X,Us),X.prototype.g=function(){return new XMLHttpRequest},X.prototype.i=function(){return{}},U=new X;function re(f,_,w,D){this.j=f,this.i=_,this.l=w,this.R=D||1,this.U=new $t(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Q}function Q(){this.i=null,this.g="",this.h=!1}var Y={},J={};function me(f,_,w){f.L=1,f.v=Vc(zn(_)),f.m=w,f.P=!0,Ee(f,null)}function Ee(f,_){f.F=Date.now(),Ie(f),f.A=zn(f.v);var w=f.A,D=f.R;Array.isArray(D)||(D=[String(D)]),Nd(w.i,"t",D),f.C=0,w=f.j.J,f.h=new Q,f.g=Jd(f.j,w?_:null,!f.m),0<f.O&&(f.M=new yt(d(f.Y,f,f.g),f.O)),_=f.U,w=f.g,D=f.ca;var j="readystatechange";Array.isArray(j)||(j&&(Ct[0]=j.toString()),j=Ct);for(var te=0;te<j.length;te++){var Te=xe(w,j[te],D||_.handleEvent,!1,_.h||_);if(!Te)break;_.g[Te.key]=Te}_=f.H?A(f.H):{},f.m?(f.u||(f.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,_)):(f.u="GET",f.g.ea(f.A,f.u,null,_)),Ki(),ju(f.i,f.u,f.A,f.l,f.R,f.m)}re.prototype.ca=function(f){f=f.target;const _=this.M;_&&Hn(f)==3?_.j():this.Y(f)},re.prototype.Y=function(f){try{if(f==this.g)e:{const _r=Hn(this.g);var _=this.g.Ba();const js=this.g.Z();if(!(3>_r)&&(_r!=3||this.g&&(this.h.h||this.g.oa()||Gd(this.g)))){this.J||_r!=4||_==7||(_==8||0>=js?Ki(3):Ki(2)),_t(this);var w=this.g.Z();this.X=w;t:if(ke(this)){var D=Gd(this.g);f="";var j=D.length,te=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){bt(this),lt(this);var Te="";break t}this.h.i=new o.TextDecoder}for(_=0;_<j;_++)this.h.h=!0,f+=this.h.i.decode(D[_],{stream:!(te&&_==j-1)});D.length=0,this.h.g+=f,this.C=0,Te=this.h.g}else Te=this.g.oa();if(this.o=w==200,$u(this.i,this.u,this.A,this.l,this.R,_r,w),this.o){if(this.T&&!this.K){t:{if(this.g){var xt,ur=this.g;if((xt=ur.g?ur.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(xt)){var st=xt;break t}}st=null}if(w=st)C(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wn(this,w);else{this.o=!1,this.s=3,lr(12),bt(this),lt(this);break e}}if(this.P){w=!0;let pn;for(;!this.J&&this.C<Te.length;)if(pn=ve(this,Te),pn==J){_r==4&&(this.s=4,lr(14),w=!1),C(this.i,this.l,null,"[Incomplete Response]");break}else if(pn==Y){this.s=4,lr(15),C(this.i,this.l,Te,"[Invalid Chunk]"),w=!1;break}else C(this.i,this.l,pn,null),Wn(this,pn);if(ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_r!=4||Te.length!=0||this.h.h||(this.s=1,lr(16),w=!1),this.o=this.o&&w,!w)C(this.i,this.l,Te,"[Invalid Chunked Response]"),bt(this),lt(this);else if(0<Te.length&&!this.W){this.W=!0;var gr=this.j;gr.g==this&&gr.ba&&!gr.M&&(gr.j.info("Great, no buffering proxy detected. Bytes received: "+Te.length),Yu(gr),gr.M=!0,lr(11))}}else C(this.i,this.l,Te,null),Wn(this,Te);_r==4&&bt(this),this.o&&!this.J&&(_r==4?qd(this.j,this):(this.o=!1,Ie(this)))}else uw(this.g),w==400&&0<Te.indexOf("Unknown SID")?(this.s=3,lr(12)):(this.s=0,lr(13)),bt(this),lt(this)}}}catch{}finally{}};function ke(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function ve(f,_){var w=f.C,D=_.indexOf(`
`,w);return D==-1?J:(w=Number(_.substring(w,D)),isNaN(w)?Y:(D+=1,D+w>_.length?J:(_=_.slice(D,D+w),f.C=D+w,_)))}re.prototype.cancel=function(){this.J=!0,bt(this)};function Ie(f){f.S=Date.now()+f.I,Be(f,f.I)}function Be(f,_){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Gn(d(f.ba,f),_)}function _t(f){f.B&&(o.clearTimeout(f.B),f.B=null)}re.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(L(this.i,this.A),this.L!=2&&(Ki(),lr(17)),bt(this),this.s=2,lt(this)):Be(this,this.S-f)};function lt(f){f.j.G==0||f.J||qd(f.j,f)}function bt(f){_t(f);var _=f.M;_&&typeof _.ma=="function"&&_.ma(),f.M=null,sn(f.U),f.g&&(_=f.g,f.g=null,_.abort(),_.ma())}function Wn(f,_){try{var w=f.j;if(w.G!=0&&(w.g==f||$r(w.h,f))){if(!f.K&&$r(w.h,f)&&w.G==3){try{var D=w.Da.g.parse(_)}catch{D=null}if(Array.isArray(D)&&D.length==3){var j=D;if(j[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<f.F)Hc(w),Wc(w);else break e;Qu(w),lr(18)}}else w.za=j[1],0<w.za-w.T&&37500>j[2]&&w.F&&w.v==0&&!w.C&&(w.C=Gn(d(w.Za,w),6e3));if(1>=Ws(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else Yi(w,11)}else if((f.K||w.g==f)&&Hc(w),!b(_))for(j=w.Da.g.parse(_),_=0;_<j.length;_++){let st=j[_];if(w.T=st[0],st=st[1],w.G==2)if(st[0]=="c"){w.K=st[1],w.ia=st[2];const gr=st[3];gr!=null&&(w.la=gr,w.j.info("VER="+w.la));const _r=st[4];_r!=null&&(w.Aa=_r,w.j.info("SVER="+w.Aa));const js=st[5];js!=null&&typeof js=="number"&&0<js&&(D=1.5*js,w.L=D,w.j.info("backChannelRequestTimeoutMs_="+D)),D=w;const pn=f.g;if(pn){const $c=pn.g?pn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($c){var te=D.h;te.g||$c.indexOf("spdy")==-1&&$c.indexOf("quic")==-1&&$c.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Ku(te,te.h),te.h=null))}if(D.D){const Ju=pn.g?pn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ju&&(D.ya=Ju,Et(D.I,D.D,Ju))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-f.F,w.j.info("Handshake RTT: "+w.R+"ms")),D=w;var Te=f;if(D.qa=Yd(D,D.J?D.ia:null,D.W),Te.K){Id(D.h,Te);var xt=Te,ur=D.L;ur&&(xt.I=ur),xt.B&&(_t(xt),Ie(xt)),D.g=Te}else $d(D);0<w.i.length&&zc(w)}else st[0]!="stop"&&st[0]!="close"||Yi(w,7);else w.G==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?Yi(w,7):Xu(w):st[0]!="noop"&&w.l&&w.l.ta(st),w.v=0)}}Ki(4)}catch{}}var Xi=class{constructor(f,_){this.g=f,this.map=_}};function ci(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function An(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Ws(f){return f.h?1:f.g?f.g.size:0}function $r(f,_){return f.h?f.h==_:f.g?f.g.has(_):!1}function Ku(f,_){f.g?f.g.add(_):f.h=_}function Id(f,_){f.h&&f.h==_?f.h=null:f.g&&f.g.has(_)&&f.g.delete(_)}ci.prototype.cancel=function(){if(this.i=kd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function kd(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let _=f.i;for(const w of f.g.values())_=_.concat(w.D);return _}return p(f.i)}function Xy(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var _=[],w=f.length,D=0;D<w;D++)_.push(f[D]);return _}_=[],w=0;for(D in f)_[w++]=f[D];return _}function Qy(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var _=[];f=f.length;for(var w=0;w<f;w++)_.push(w);return _}_=[],w=0;for(const D in f)_[w++]=D;return _}}}function Cd(f,_){if(f.forEach&&typeof f.forEach=="function")f.forEach(_,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,_,void 0);else for(var w=Qy(f),D=Xy(f),j=D.length,te=0;te<j;te++)_.call(void 0,D[te],w&&w[te],f)}var bd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yy(f,_){if(f){f=f.split("&");for(var w=0;w<f.length;w++){var D=f[w].indexOf("="),j=null;if(0<=D){var te=f[w].substring(0,D);j=f[w].substring(D+1)}else te=f[w];_(te,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Qi(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Qi){this.h=f.h,Lc(this,f.j),this.o=f.o,this.g=f.g,Mc(this,f.s),this.l=f.l;var _=f.i,w=new Ya;w.i=_.i,_.g&&(w.g=new Map(_.g),w.h=_.h),Rd(this,w),this.m=f.m}else f&&(_=String(f).match(bd))?(this.h=!1,Lc(this,_[1]||"",!0),this.o=Xa(_[2]||""),this.g=Xa(_[3]||"",!0),Mc(this,_[4]),this.l=Xa(_[5]||"",!0),Rd(this,_[6]||"",!0),this.m=Xa(_[7]||"")):(this.h=!1,this.i=new Ya(null,this.h))}Qi.prototype.toString=function(){var f=[],_=this.j;_&&f.push(Qa(_,Fd,!0),":");var w=this.g;return(w||_=="file")&&(f.push("//"),(_=this.o)&&f.push(Qa(_,Fd,!0),"@"),f.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&f.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&f.push("/"),f.push(Qa(w,w.charAt(0)=="/"?ew:Zy,!0))),(w=this.i.toString())&&f.push("?",w),(w=this.m)&&f.push("#",Qa(w,rw)),f.join("")};function zn(f){return new Qi(f)}function Lc(f,_,w){f.j=w?Xa(_,!0):_,f.j&&(f.j=f.j.replace(/:$/,""))}function Mc(f,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);f.s=_}else f.s=null}function Rd(f,_,w){_ instanceof Ya?(f.i=_,nw(f.i,f.h)):(w||(_=Qa(_,tw)),f.i=new Ya(_,f.h))}function Et(f,_,w){f.i.set(_,w)}function Vc(f){return Et(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Xa(f,_){return f?_?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Qa(f,_,w){return typeof f=="string"?(f=encodeURI(f).replace(_,Jy),w&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Jy(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Fd=/[#\/\?@]/g,Zy=/[#\?:]/g,ew=/[#\?]/g,tw=/[#\?@]/g,rw=/#/g;function Ya(f,_){this.h=this.g=null,this.i=f||null,this.j=!!_}function li(f){f.g||(f.g=new Map,f.h=0,f.i&&Yy(f.i,function(_,w){f.add(decodeURIComponent(_.replace(/\+/g," ")),w)}))}r=Ya.prototype,r.add=function(f,_){li(this),this.i=null,f=zs(this,f);var w=this.g.get(f);return w||this.g.set(f,w=[]),w.push(_),this.h+=1,this};function Dd(f,_){li(f),_=zs(f,_),f.g.has(_)&&(f.i=null,f.h-=f.g.get(_).length,f.g.delete(_))}function Pd(f,_){return li(f),_=zs(f,_),f.g.has(_)}r.forEach=function(f,_){li(this),this.g.forEach(function(w,D){w.forEach(function(j){f.call(_,j,D,this)},this)},this)},r.na=function(){li(this);const f=Array.from(this.g.values()),_=Array.from(this.g.keys()),w=[];for(let D=0;D<_.length;D++){const j=f[D];for(let te=0;te<j.length;te++)w.push(_[D])}return w},r.V=function(f){li(this);let _=[];if(typeof f=="string")Pd(this,f)&&(_=_.concat(this.g.get(zs(this,f))));else{f=Array.from(this.g.values());for(let w=0;w<f.length;w++)_=_.concat(f[w])}return _},r.set=function(f,_){return li(this),this.i=null,f=zs(this,f),Pd(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[_]),this.h+=1,this},r.get=function(f,_){return f?(f=this.V(f),0<f.length?String(f[0]):_):_};function Nd(f,_,w){Dd(f,_),0<w.length&&(f.i=null,f.g.set(zs(f,_),p(w)),f.h+=w.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],_=Array.from(this.g.keys());for(var w=0;w<_.length;w++){var D=_[w];const te=encodeURIComponent(String(D)),Te=this.V(D);for(D=0;D<Te.length;D++){var j=te;Te[D]!==""&&(j+="="+encodeURIComponent(String(Te[D]))),f.push(j)}}return this.i=f.join("&")};function zs(f,_){return _=String(_),f.j&&(_=_.toLowerCase()),_}function nw(f,_){_&&!f.j&&(li(f),f.i=null,f.g.forEach(function(w,D){var j=D.toLowerCase();D!=j&&(Dd(this,D),Nd(this,j,w))},f)),f.j=_}function iw(f,_){const w=new qi;if(o.Image){const D=new Image;D.onload=m(ui,w,"TestLoadImage: loaded",!0,_,D),D.onerror=m(ui,w,"TestLoadImage: error",!1,_,D),D.onabort=m(ui,w,"TestLoadImage: abort",!1,_,D),D.ontimeout=m(ui,w,"TestLoadImage: timeout",!1,_,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=f}else _(!1)}function sw(f,_){const w=new qi,D=new AbortController,j=setTimeout(()=>{D.abort(),ui(w,"TestPingServer: timeout",!1,_)},1e4);fetch(f,{signal:D.signal}).then(te=>{clearTimeout(j),te.ok?ui(w,"TestPingServer: ok",!0,_):ui(w,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(j),ui(w,"TestPingServer: error",!1,_)})}function ui(f,_,w,D,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),D(w)}catch{}}function aw(){this.g=new Hu}function ow(f,_,w){const D=w||"";try{Cd(f,function(j,te){let Te=j;l(j)&&(Te=Bs(j)),_.push(D+te+"="+encodeURIComponent(Te))})}catch(j){throw _.push(D+"type="+encodeURIComponent("_badmap")),j}}function Bc(f){this.l=f.Ub||null,this.j=f.eb||!1}g(Bc,Us),Bc.prototype.g=function(){return new Uc(this.l,this.j)},Bc.prototype.i=function(f){return function(){return f}}({});function Uc(f,_){Ze.call(this),this.D=f,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Uc,Ze),r=Uc.prototype,r.open=function(f,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=_,this.readyState=1,Za(this)},r.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(_.body=f),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ja(this)),this.readyState=0},r.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Za(this)),this.g&&(this.readyState=3,Za(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Od(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Od(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}r.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var _=f.value?f.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!f.done}))&&(this.response=this.responseText+=_)}f.done?Ja(this):Za(this),this.readyState==3&&Od(this)}},r.Ra=function(f){this.g&&(this.response=this.responseText=f,Ja(this))},r.Qa=function(f){this.g&&(this.response=f,Ja(this))},r.ga=function(){this.g&&Ja(this)};function Ja(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Za(f)}r.setRequestHeader=function(f,_){this.u.append(f,_)},r.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],_=this.h.entries();for(var w=_.next();!w.done;)w=w.value,f.push(w[0]+": "+w[1]),w=_.next();return f.join(`\r
`)};function Za(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Uc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Ld(f){let _="";return O(f,function(w,D){_+=D,_+=":",_+=w,_+=`\r
`}),_}function qu(f,_,w){e:{for(D in w){var D=!1;break e}D=!0}D||(w=Ld(w),typeof f=="string"?w!=null&&encodeURIComponent(String(w)):Et(f,_,w))}function Ot(f){Ze.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Ot,Ze);var cw=/^https?$/i,lw=["POST","PUT"];r=Ot.prototype,r.Ha=function(f){this.J=f},r.ea=function(f,_,w,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);_=_?_.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():U.g(),this.v=this.o?$a(this.o):$a(U),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(_,String(f),!0),this.B=!1}catch(te){Md(this,te);return}if(f=w||"",w=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var j in D)w.set(j,D[j]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const te of D.keys())w.set(te,D.get(te));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(w.keys()).find(te=>te.toLowerCase()=="content-type"),j=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(lw,_,void 0))||D||j||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,Te]of w)this.g.setRequestHeader(te,Te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ud(this),this.u=!0,this.g.send(f),this.u=!1}catch(te){Md(this,te)}};function Md(f,_){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=_,f.m=5,Vd(f),Gc(f)}function Vd(f){f.A||(f.A=!0,It(f,"complete"),It(f,"error"))}r.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,It(this,"complete"),It(this,"abort"),Gc(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gc(this,!0)),Ot.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Bd(this):this.bb())},r.bb=function(){Bd(this)};function Bd(f){if(f.h&&typeof a<"u"&&(!f.v[1]||Hn(f)!=4||f.Z()!=2)){if(f.u&&Hn(f)==4)Fr(f.Ea,0,f);else if(It(f,"readystatechange"),Hn(f)==4){f.h=!1;try{const Te=f.Z();e:switch(Te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var w;if(!(w=_)){var D;if(D=Te===0){var j=String(f.D).match(bd)[1]||null;!j&&o.self&&o.self.location&&(j=o.self.location.protocol.slice(0,-1)),D=!cw.test(j?j.toLowerCase():"")}w=D}if(w)It(f,"complete"),It(f,"success");else{f.m=6;try{var te=2<Hn(f)?f.g.statusText:""}catch{te=""}f.l=te+" ["+f.Z()+"]",Vd(f)}}finally{Gc(f)}}}}function Gc(f,_){if(f.g){Ud(f);const w=f.g,D=f.v[0]?()=>{}:null;f.g=null,f.v=null,_||It(f,"ready");try{w.onreadystatechange=D}catch{}}}function Ud(f){f.I&&(o.clearTimeout(f.I),f.I=null)}r.isActive=function(){return!!this.g};function Hn(f){return f.g?f.g.readyState:0}r.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(f){if(this.g){var _=this.g.responseText;return f&&_.indexOf(f)==0&&(_=_.substring(f.length)),zu(_)}};function Gd(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function uw(f){const _={};f=(f.g&&2<=Hn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<f.length;D++){if(b(f[D]))continue;var w=I(f[D]);const j=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const te=_[j]||[];_[j]=te,te.push(w)}y(_,function(D){return D.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function eo(f,_,w){return w&&w.internalChannelParams&&w.internalChannelParams[f]||_}function Wd(f){this.Aa=0,this.i=[],this.j=new qi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=eo("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=eo("baseRetryDelayMs",5e3,f),this.cb=eo("retryDelaySeedMs",1e4,f),this.Wa=eo("forwardChannelMaxRetries",2,f),this.wa=eo("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new ci(f&&f.concurrentRequestLimit),this.Da=new aw,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Wd.prototype,r.la=8,r.G=1,r.connect=function(f,_,w,D){lr(0),this.W=f,this.H=_||{},w&&D!==void 0&&(this.H.OSID=w,this.H.OAID=D),this.F=this.X,this.I=Yd(this,null,this.W),zc(this)};function Xu(f){if(zd(f),f.G==3){var _=f.U++,w=zn(f.I);if(Et(w,"SID",f.K),Et(w,"RID",_),Et(w,"TYPE","terminate"),to(f,w),_=new re(f,f.j,_),_.L=2,_.v=Vc(zn(w)),w=!1,o.navigator&&o.navigator.sendBeacon)try{w=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!w&&o.Image&&(new Image().src=_.v,w=!0),w||(_.g=Jd(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Ie(_)}Qd(f)}function Wc(f){f.g&&(Yu(f),f.g.cancel(),f.g=null)}function zd(f){Wc(f),f.u&&(o.clearTimeout(f.u),f.u=null),Hc(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function zc(f){if(!An(f.h)&&!f.s){f.s=!0;var _=f.Ga;le||Fe(),We||(le(),We=!0),K.add(_,f),f.B=0}}function fw(f,_){return Ws(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=_.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Gn(d(f.Ga,f,_),Xd(f,f.B)),f.B++,!0)}r.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const j=new re(this,this.j,f);let te=this.o;if(this.S&&(te?(te=A(te),S(te,this.S)):te=this.S),this.m!==null||this.O||(j.H=te,te=null),this.P)e:{for(var _=0,w=0;w<this.i.length;w++){t:{var D=this.i[w];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(_+=D,4096<_){_=w;break e}if(_===4096||w===this.i.length-1){_=w+1;break e}}_=1e3}else _=1e3;_=jd(this,j,_),w=zn(this.I),Et(w,"RID",f),Et(w,"CVER",22),this.D&&Et(w,"X-HTTP-Session-Id",this.D),to(this,w),te&&(this.O?_="headers="+encodeURIComponent(String(Ld(te)))+"&"+_:this.m&&qu(w,this.m,te)),Ku(this.h,j),this.Ua&&Et(w,"TYPE","init"),this.P?(Et(w,"$req",_),Et(w,"SID","null"),j.T=!0,me(j,w,null)):me(j,w,_),this.G=2}}else this.G==3&&(f?Hd(this,f):this.i.length==0||An(this.h)||Hd(this))};function Hd(f,_){var w;_?w=_.l:w=f.U++;const D=zn(f.I);Et(D,"SID",f.K),Et(D,"RID",w),Et(D,"AID",f.T),to(f,D),f.m&&f.o&&qu(D,f.m,f.o),w=new re(f,f.j,w,f.B+1),f.m===null&&(w.H=f.o),_&&(f.i=_.D.concat(f.i)),_=jd(f,w,1e3),w.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Ku(f.h,w),me(w,D,_)}function to(f,_){f.H&&O(f.H,function(w,D){Et(_,D,w)}),f.l&&Cd({},function(w,D){Et(_,D,w)})}function jd(f,_,w){w=Math.min(f.i.length,w);var D=f.l?d(f.l.Na,f.l,f):null;e:{var j=f.i;let te=-1;for(;;){const Te=["count="+w];te==-1?0<w?(te=j[0].g,Te.push("ofs="+te)):te=0:Te.push("ofs="+te);let xt=!0;for(let ur=0;ur<w;ur++){let st=j[ur].g;const gr=j[ur].map;if(st-=te,0>st)te=Math.max(0,j[ur].g-100),xt=!1;else try{ow(gr,Te,"req"+st+"_")}catch{D&&D(gr)}}if(xt){D=Te.join("&");break e}}}return f=f.i.splice(0,w),_.D=f,D}function $d(f){if(!f.g&&!f.u){f.Y=1;var _=f.Fa;le||Fe(),We||(le(),We=!0),K.add(_,f),f.v=0}}function Qu(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Gn(d(f.Fa,f),Xd(f,f.v)),f.v++,!0)}r.Fa=function(){if(this.u=null,Kd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Gn(d(this.ab,this),f)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,lr(10),Wc(this),Kd(this))};function Yu(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function Kd(f){f.g=new re(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var _=zn(f.qa);Et(_,"RID","rpc"),Et(_,"SID",f.K),Et(_,"AID",f.T),Et(_,"CI",f.F?"0":"1"),!f.F&&f.ja&&Et(_,"TO",f.ja),Et(_,"TYPE","xmlhttp"),to(f,_),f.m&&f.o&&qu(_,f.m,f.o),f.L&&(f.g.I=f.L);var w=f.g;f=f.ia,w.L=1,w.v=Vc(zn(_)),w.m=null,w.P=!0,Ee(w,f)}r.Za=function(){this.C!=null&&(this.C=null,Wc(this),Qu(this),lr(19))};function Hc(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function qd(f,_){var w=null;if(f.g==_){Hc(f),Yu(f),f.g=null;var D=2}else if($r(f.h,_))w=_.D,Id(f.h,_),D=1;else return;if(f.G!=0){if(_.o)if(D==1){w=_.m?_.m.length:0,_=Date.now()-_.F;var j=f.B;D=Gs(),It(D,new Oc(D,w)),zc(f)}else $d(f);else if(j=_.s,j==3||j==0&&0<_.X||!(D==1&&fw(f,_)||D==2&&Qu(f)))switch(w&&0<w.length&&(_=f.h,_.i=_.i.concat(w)),j){case 1:Yi(f,5);break;case 4:Yi(f,10);break;case 3:Yi(f,6);break;default:Yi(f,2)}}}function Xd(f,_){let w=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(w*=2),w*_}function Yi(f,_){if(f.j.info("Error code "+_),_==2){var w=d(f.fb,f),D=f.Xa;const j=!D;D=new Qi(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Lc(D,"https"),Vc(D),j?iw(D.toString(),w):sw(D.toString(),w)}else lr(2);f.G=0,f.l&&f.l.sa(_),Qd(f),zd(f)}r.fb=function(f){f?(this.j.info("Successfully pinged google.com"),lr(2)):(this.j.info("Failed to ping google.com"),lr(1))};function Qd(f){if(f.G=0,f.ka=[],f.l){const _=kd(f.h);(_.length!=0||f.i.length!=0)&&(x(f.ka,_),x(f.ka,f.i),f.h.i.length=0,p(f.i),f.i.length=0),f.l.ra()}}function Yd(f,_,w){var D=w instanceof Qi?zn(w):new Qi(w);if(D.g!="")_&&(D.g=_+"."+D.g),Mc(D,D.s);else{var j=o.location;D=j.protocol,_=_?_+"."+j.hostname:j.hostname,j=+j.port;var te=new Qi(null);D&&Lc(te,D),_&&(te.g=_),j&&Mc(te,j),w&&(te.l=w),D=te}return w=f.D,_=f.ya,w&&_&&Et(D,w,_),Et(D,"VER",f.la),to(f,D),D}function Jd(f,_,w){if(_&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=f.Ca&&!f.pa?new Ot(new Bc({eb:w})):new Ot(f.pa),_.Ha(f.J),_}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zd(){}r=Zd.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function jc(){}jc.prototype.g=function(f,_){return new Kr(f,_)};function Kr(f,_){Ze.call(this),this.g=new Wd(_),this.l=f,this.h=_&&_.messageUrlParams||null,f=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(f?f["X-WebChannel-Content-Type"]=_.messageContentType:f={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(f?f["X-WebChannel-Client-Profile"]=_.va:f={"X-WebChannel-Client-Profile":_.va}),this.g.S=f,(f=_&&_.Sb)&&!b(f)&&(this.g.m=f),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!b(_)&&(this.g.D=_,f=this.h,f!==null&&_ in f&&(f=this.h,_ in f&&delete f[_])),this.j=new Hs(this)}g(Kr,Ze),Kr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Kr.prototype.close=function(){Xu(this.g)},Kr.prototype.o=function(f){var _=this.g;if(typeof f=="string"){var w={};w.__data__=f,f=w}else this.u&&(w={},w.__data__=Bs(f),f=w);_.i.push(new Xi(_.Ya++,f)),_.G==3&&zc(_)},Kr.prototype.N=function(){this.g.l=null,delete this.j,Xu(this.g),delete this.g,Kr.aa.N.call(this)};function em(f){qa.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var _=f.__sm__;if(_){e:{for(const w in _){f=w;break e}f=void 0}(this.i=f)&&(f=this.i,_=_!==null&&f in _?_[f]:void 0),this.data=_}else this.data=f}g(em,qa);function tm(){oi.call(this),this.status=1}g(tm,oi);function Hs(f){this.g=f}g(Hs,Zd),Hs.prototype.ua=function(){It(this.g,"a")},Hs.prototype.ta=function(f){It(this.g,new em(f))},Hs.prototype.sa=function(f){It(this.g,new tm)},Hs.prototype.ra=function(){It(this.g,"b")},jc.prototype.createWebChannel=jc.prototype.g,Kr.prototype.send=Kr.prototype.o,Kr.prototype.open=Kr.prototype.m,Kr.prototype.close=Kr.prototype.close,k1=function(){return new jc},I1=function(){return Gs()},S1=Un,Wf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},N.NO_ERROR=0,N.TIMEOUT=8,N.HTTP_ERROR=6,pl=N,V.COMPLETE="complete",A1=V,Ka.EventType=$i,$i.OPEN="a",$i.CLOSE="b",$i.ERROR="c",$i.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,lo=Ka,Ot.prototype.listenOnce=Ot.prototype.L,Ot.prototype.getLastError=Ot.prototype.Ka,Ot.prototype.getLastErrorCode=Ot.prototype.Ba,Ot.prototype.getStatus=Ot.prototype.Z,Ot.prototype.getResponseJson=Ot.prototype.Oa,Ot.prototype.getResponseText=Ot.prototype.oa,Ot.prototype.send=Ot.prototype.ea,Ot.prototype.setWithCredentials=Ot.prototype.Ha,T1=Ot}).apply(typeof Xc<"u"?Xc:typeof self<"u"?self:typeof window<"u"?window:{});const gm="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yr.UNAUTHENTICATED=new yr(null),yr.GOOGLE_CREDENTIALS=new yr("google-credentials-uid"),yr.FIRST_PARTY=new yr("first-party-uid"),yr.MOCK_USER=new yr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oa="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs=new m1("@firebase/firestore");function Zs(){return hs.logLevel}function he(r,...e){if(hs.logLevel<=tt.DEBUG){const t=e.map(bh);hs.debug(`Firestore (${Oa}): ${r}`,...t)}}function Wt(r,...e){if(hs.logLevel<=tt.ERROR){const t=e.map(bh);hs.error(`Firestore (${Oa}): ${r}`,...t)}}function Oo(r,...e){if(hs.logLevel<=tt.WARN){const t=e.map(bh);hs.warn(`Firestore (${Oa}): ${r}`,...t)}}function bh(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(r="Unexpected state"){const e=`FIRESTORE (${Oa}) INTERNAL ASSERTION FAILED: `+r;throw Wt(e),new Error(e)}function Re(r,e){r||Ce()}function be(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends bs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(yr.UNAUTHENTICATED))}shutdown(){}}class C2{constructor(e){this.t=e,this.currentUser=yr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Re(this.o===void 0);let n=this.i;const i=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve();let s=new vn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new vn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vn)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Re(typeof n.accessToken=="string"),new I2(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Re(e===null||typeof e=="string"),new yr(e)}}class b2{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=yr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class R2{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new b2(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(yr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class F2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Re(this.o===void 0);const n=s=>{s.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,he("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Re(typeof t.token=="string"),this.R=t.token,new F2(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=P2(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%e.length))}return n}}function Ge(r,e){return r<e?-1:r>e?1:0}function ya(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function b1(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ge(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ge(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ge(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Nt.fromMillis(Date.now())}static fromDate(e){return Nt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Nt(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.timestamp=e}static fromTimestamp(e){return new De(e)}static min(){return new De(new Nt(0,0))}static max(){return new De(new Nt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ce(),n===void 0?n=e.length-t:n>e.length-t&&Ce(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Lo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Lo?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class nt extends Lo{construct(e,t,n){return new nt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ge(ee.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new nt(t)}static emptyPath(){return new nt([])}}const N2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dt extends Lo{construct(e,t,n){return new Dt(e,t,n)}static isValidIdentifier(e){return N2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Dt(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new ge(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ge(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ge(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new ge(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Dt(t)}static emptyPath(){return new Dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.path=e}static fromPath(e){return new Se(nt.fromString(e))}static fromName(e){return new Se(nt.fromString(e).popFirst(5))}static empty(){return new Se(nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return nt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new nt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function zf(r){return r.fields.find(e=>e.kind===2)}function es(r){return r.fields.filter(e=>e.kind!==2)}bl.UNKNOWN_ID=-1;class gl{constructor(e,t){this.fieldPath=e,this.kind=t}}class Mo{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Mo(0,en.min())}}function R1(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=De.fromTimestamp(n===1e9?new Nt(t+1,0):new Nt(t,n));return new en(i,Se.empty(),e)}function F1(r){return new en(r.readTime,r.key,-1)}class en{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new en(De.min(),Se.empty(),-1)}static max(){return new en(De.max(),Se.empty(),-1)}}function Rh(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=Se.comparator(r.documentKey,e.documentKey),t!==0?t:Ge(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class P1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vi(r){if(r.code!==ee.FAILED_PRECONDITION||r.message!==D1)throw r;he("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ce(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):q.reject(t)}static resolve(e){return new q((t,n)=>{t(e)})}static reject(e){return new q((t,n)=>{n(e)})}static waitFor(e){return new q((t,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&t()},c=>n(c))}),a=!0,s===i&&t()})}static or(e){let t=q.resolve(!1);for(const n of e)t=t.next(i=>i?q.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new q((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let c=0;c<s;c++){const l=c;t(e[l]).next(u=>{a[l]=u,++o,o===s&&n(a)},u=>i(u))}})}static doWhile(e,t){return new q((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new vn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new xo(e,t.error)):this.V.resolve()},this.transaction.onerror=n=>{const i=Fh(n.target.error);this.V.reject(new xo(e,i))}}static open(e,t,n,i){try{return new fu(t,e.transaction(i,n))}catch(s){throw new xo(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(he("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new L2(t)}}class Si{constructor(e,t,n){this.name=e,this.version=t,this.p=n,Si.S(kl())===12.2&&Wt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return he("SimpleDb","Removing database:",e),ts(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!h1())return!1;if(Si.v())return!0;const e=kl(),t=Si.S(e),n=0<t&&t<10,i=N1(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(he("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{n(new xo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?n(new ge(ee.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?n(new ge(ee.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):n(new xo(e,a))},i.onupgradeneeded=s=>{he("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.O(a,i.transaction,s.oldVersion,this.version).next(()=>{he("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.M(e);const o=fu.open(this.db,e,s?"readonly":"readwrite",n),c=i(o).next(l=>(o.g(),l)).catch(l=>(o.abort(l),q.reject(l))).toPromise();return c.catch(()=>{}),await o.m,c}catch(o){const c=o,l=c.name!=="FirebaseError"&&a<3;if(he("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function N1(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class O2{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ts(this.B.delete())}}class xo extends ge{constructor(e,t){super(ee.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Bi(r){return r.name==="IndexedDbTransactionError"}class L2{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(he("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(he("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),ts(n)}add(e){return he("SimpleDb","ADD",this.store.name,e,e),ts(this.store.add(e))}get(e){return ts(this.store.get(e)).next(t=>(t===void 0&&(t=null),he("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return he("SimpleDb","DELETE",this.store.name,e),ts(this.store.delete(e))}count(){return he("SimpleDb","COUNT",this.store.name),ts(this.store.count())}U(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(n.range);return new q((a,o)=>{s.onerror=c=>{o(c.target.error)},s.onsuccess=c=>{a(c.target.result)}})}{const s=this.cursor(n),a=[];return this.W(s,(o,c)=>{a.push(c)}).next(()=>a)}}G(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new q((i,s)=>{n.onerror=a=>{s(a.target.error)},n.onsuccess=a=>{i(a.target.result)}})}j(e,t){he("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const i=this.cursor(n);return this.W(i,(s,a,o)=>o.delete())}J(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.W(i,t)}Y(e){const t=this.cursor({});return new q((n,i)=>{t.onerror=s=>{const a=Fh(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(o=>{o?a.continue():n()}):n()}})}W(e,t){const n=[];return new q((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const o=a.target.result;if(!o)return void i();const c=new O2(o),l=t(o.primaryKey,o.value,c);if(l instanceof q){const u=l.catch(h=>(c.done(),q.reject(h)));n.push(u)}c.isDone?i():c.K===null?o.continue():o.continue(c.K)}}).next(()=>q.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ts(r){return new q((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=Fh(n.target.error);t(i)}})}let _m=!1;function Fh(r){const e=Si.S(kl());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new ge("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _m||(_m=!0,setTimeout(()=>{throw n},0)),n}}return r}class M2{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){he("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{he("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Bi(t)?he("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Vi(t)}await this.X(6e4)})}}class V2{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const n=new Set;let i=t,s=!0;return q.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!n.has(a))return he("IndexBackfiller",`Processing collection: ${a}`),this.ne(e,a,i).next(o=>{i-=o,n.add(a)});s=!1})).next(()=>t-i)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.re(i,s)).next(o=>(he("IndexBackfiller",`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o))).next(()=>a.size)}))}re(e,t){let n=e;return t.changes.forEach((i,s)=>{const a=F1(s);Rh(a,n)>0&&(n=a)}),new en(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ie(n),this.se=n=>t.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Vr.oe=-1;function fc(r){return r==null}function Vo(r){return r===0&&1/r==-1/0}function O1(r){return typeof r=="number"&&Number.isInteger(r)&&!Vo(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=xm(e)),e=B2(r.get(t),e);return xm(e)}function B2(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function xm(r){return r+""}function Cn(r){const e=r.length;if(Re(e>=2),e===2)return Re(r.charAt(0)===""&&r.charAt(1)===""),nt.emptyPath();const t=e-2,n=[];let i="";for(let s=0;s<e;){const a=r.indexOf("",s);switch((a<0||a>t)&&Ce(),r.charAt(a+1)){case"":const o=r.substring(s,a);let c;i.length===0?c=o:(i+=o,c=i,i=""),n.push(c);break;case"":i+=r.substring(s,a),i+="\0";break;case"":i+=r.substring(s,a+1);break;default:Ce()}s=a+2}return new nt(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _l(r,e){return[r,Nr(e)]}function L1(r,e,t){return[r,Nr(e),t]}const U2={},G2=["prefixPath","collectionGroup","readTime","documentId"],W2=["prefixPath","collectionGroup","documentId"],z2=["collectionGroup","readTime","prefixPath","documentId"],H2=["canonicalId","targetId"],j2=["targetId","path"],$2=["path","targetId"],K2=["collectionId","parent"],q2=["indexId","uid"],X2=["uid","sequenceNumber"],Q2=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Y2=["indexId","uid","orderedDocumentKey"],J2=["userId","collectionPath","documentId"],Z2=["userId","collectionPath","largestBatchId"],eT=["userId","collectionGroup","largestBatchId"],M1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],tT=[...M1,"documentOverlays"],V1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],B1=V1,Dh=[...B1,"indexConfiguration","indexState","indexEntries"],rT=Dh,nT=[...Dh,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf extends P1{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function tr(r,e){const t=be(r);return Si.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ym(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Rs(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function U1(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,t){this.comparator=e,this.root=t||hr.EMPTY}insert(e,t){return new wt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,hr.BLACK,null,null))}remove(e){return new wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,hr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qc(this.root,e,this.comparator,!0)}}class Qc{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class hr{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??hr.RED,this.left=i??hr.EMPTY,this.right=s??hr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new hr(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return hr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return hr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,hr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,hr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ce();const e=this.left.check();if(e!==this.right.check())throw Ce();return e+(this.isRed()?0:1)}}hr.EMPTY=null,hr.RED=!0,hr.BLACK=!1;hr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce()}get value(){throw Ce()}get color(){throw Ce()}get left(){throw Ce()}get right(){throw Ce()}copy(e,t,n,i,s){return this}insert(e,t,n){return new hr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.comparator=e,this.data=new wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wm(this.data.getIterator())}getIteratorFrom(e){return new wm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof gt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new gt(this.comparator);return t.data=e,t}}class wm{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $s(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.fields=e,e.sort(Dt.comparator)}static empty(){return new Br([])}unionWith(e){let t=new gt(Dt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Br(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ya(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new G1("Invalid base64 string: "+s):s}}(e);return new Ht(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Ht(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ht.EMPTY_BYTE_STRING=new Ht("");const iT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ri(r){if(Re(!!r),typeof r=="string"){let e=0;const t=iT.exec(r);if(Re(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Rt(r.seconds),nanos:Rt(r.nanos)}}function Rt(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function ki(r){return typeof r=="string"?Ht.fromBase64String(r):Ht.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hu(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ph(r){const e=r.mapValue.fields.__previous_value__;return hu(e)?Ph(e):e}function Bo(r){const e=ri(r.mapValue.fields.__local_write_time__.timestampValue);return new Nt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e,t,n,i,s,a,o,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l}}class ds{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ds("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ds&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},xl={nullValue:"NULL_VALUE"};function ms(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?hu(r)?4:W1(r)?9007199254740991:du(r)?10:11:Ce()}function Dn(r,e){if(r===e)return!0;const t=ms(r);if(t!==ms(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Bo(r).isEqual(Bo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=ri(i.timestampValue),o=ri(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return ki(i.bytesValue).isEqual(ki(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Rt(i.geoPointValue.latitude)===Rt(s.geoPointValue.latitude)&&Rt(i.geoPointValue.longitude)===Rt(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Rt(i.integerValue)===Rt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Rt(i.doubleValue),o=Rt(s.doubleValue);return a===o?Vo(a)===Vo(o):isNaN(a)&&isNaN(o)}return!1}(r,e);case 9:return ya(r.arrayValue.values||[],e.arrayValue.values||[],Dn);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(ym(a)!==ym(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!Dn(a[c],o[c])))return!1;return!0}(r,e);default:return Ce()}}function Uo(r,e){return(r.values||[]).find(t=>Dn(t,e))!==void 0}function Ci(r,e){if(r===e)return 0;const t=ms(r),n=ms(e);if(t!==n)return Ge(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ge(r.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Rt(s.integerValue||s.doubleValue),c=Rt(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(r,e);case 3:return Em(r.timestampValue,e.timestampValue);case 4:return Em(Bo(r),Bo(e));case 5:return Ge(r.stringValue,e.stringValue);case 6:return function(s,a){const o=ki(s),c=ki(a);return o.compareTo(c)}(r.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){const u=Ge(o[l],c[l]);if(u!==0)return u}return Ge(o.length,c.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,a){const o=Ge(Rt(s.latitude),Rt(a.latitude));return o!==0?o:Ge(Rt(s.longitude),Rt(a.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Tm(r.arrayValue,e.arrayValue);case 10:return function(s,a){var o,c,l,u;const h=s.fields||{},d=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,g=(c=d.value)===null||c===void 0?void 0:c.arrayValue,p=Ge(((l=m==null?void 0:m.values)===null||l===void 0?void 0:l.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return p!==0?p:Tm(m,g)}(r.mapValue,e.mapValue);case 11:return function(s,a){if(s===_i.mapValue&&a===_i.mapValue)return 0;if(s===_i.mapValue)return 1;if(a===_i.mapValue)return-1;const o=s.fields||{},c=Object.keys(o),l=a.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const d=Ge(c[h],u[h]);if(d!==0)return d;const m=Ci(o[c[h]],l[u[h]]);if(m!==0)return m}return Ge(c.length,u.length)}(r.mapValue,e.mapValue);default:throw Ce()}}function Em(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Ge(r,e);const t=ri(r),n=ri(e),i=Ge(t.seconds,n.seconds);return i!==0?i:Ge(t.nanos,n.nanos)}function Tm(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=Ci(t[i],n[i]);if(s)return s}return Ge(t.length,n.length)}function wa(r){return jf(r)}function jf(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=ri(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return ki(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return Se.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=jf(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${jf(t.fields[a])}`;return i+"}"}(r.mapValue):Ce()}function ps(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function $f(r){return!!r&&"integerValue"in r}function Go(r){return!!r&&"arrayValue"in r}function Am(r){return!!r&&"nullValue"in r}function Sm(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function vl(r){return!!r&&"mapValue"in r}function du(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function vo(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return Rs(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=vo(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vo(r.arrayValue.values[t]);return e}return Object.assign({},r)}function W1(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const z1={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function aT(r){return"nullValue"in r?xl:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?ps(ds.empty(),Se.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?du(r)?z1:{mapValue:{}}:Ce()}function oT(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?ps(ds.empty(),Se.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?z1:"mapValue"in r?du(r)?{mapValue:{}}:_i:Ce()}function Im(r,e){const t=Ci(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function km(r,e){const t=Ci(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e){this.value=e}static empty(){return new mr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!vl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vo(t)}setAll(e){let t=Dt.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=o.popLast()}a?n[o.lastSegment()]=vo(a):i.push(o.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());vl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];vl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Rs(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new mr(vo(this.value))}}function H1(r){const e=[];return Rs(r.fields,(t,n)=>{const i=new Dt([t]);if(vl(n)){const s=H1(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Br(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e,t,n,i,s,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Ft(e,0,De.min(),De.min(),De.min(),mr.empty(),0)}static newFoundDocument(e,t,n,i){return new Ft(e,1,t,De.min(),n,i,0)}static newNoDocument(e,t){return new Ft(e,2,t,De.min(),De.min(),mr.empty(),0)}static newUnknownDocument(e,t){return new Ft(e,3,t,De.min(),De.min(),mr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=mr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=mr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ft&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ft(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,t){this.position=e,this.inclusive=t}}function Cm(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],a=r.position[i];if(s.field.isKeyField()?n=Se.comparator(Se.fromName(a.referenceValue),t.key):n=Ci(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function bm(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Dn(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e,t="asc"){this.field=e,this.dir=t}}function cT(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{}class Ye extends j1{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new lT(e,t,n):t==="array-contains"?new hT(e,n):t==="in"?new Y1(e,n):t==="not-in"?new dT(e,n):t==="array-contains-any"?new mT(e,n):new Ye(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new uT(e,n):new fT(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ci(t,this.value)):t!==null&&ms(this.value)===ms(t)&&this.matchesComparison(Ci(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ht extends j1{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new ht(e,t)}matches(e){return Ea(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ea(r){return r.op==="and"}function Kf(r){return r.op==="or"}function Nh(r){return $1(r)&&Ea(r)}function $1(r){for(const e of r.filters)if(e instanceof ht)return!1;return!0}function qf(r){if(r instanceof Ye)return r.field.canonicalString()+r.op.toString()+wa(r.value);if(Nh(r))return r.filters.map(e=>qf(e)).join(",");{const e=r.filters.map(t=>qf(t)).join(",");return`${r.op}(${e})`}}function K1(r,e){return r instanceof Ye?function(n,i){return i instanceof Ye&&n.op===i.op&&n.field.isEqual(i.field)&&Dn(n.value,i.value)}(r,e):r instanceof ht?function(n,i){return i instanceof ht&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&K1(a,i.filters[o]),!0):!1}(r,e):void Ce()}function q1(r,e){const t=r.filters.concat(e);return ht.create(t,r.op)}function X1(r){return r instanceof Ye?function(t){return`${t.field.canonicalString()} ${t.op} ${wa(t.value)}`}(r):r instanceof ht?function(t){return t.op.toString()+" {"+t.getFilters().map(X1).join(" ,")+"}"}(r):"Filter"}class lT extends Ye{constructor(e,t,n){super(e,t,n),this.key=Se.fromName(n.referenceValue)}matches(e){const t=Se.comparator(e.key,this.key);return this.matchesComparison(t)}}class uT extends Ye{constructor(e,t){super(e,"in",t),this.keys=Q1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class fT extends Ye{constructor(e,t){super(e,"not-in",t),this.keys=Q1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Q1(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>Se.fromName(n.referenceValue))}class hT extends Ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Go(t)&&Uo(t.arrayValue,this.value)}}class Y1 extends Ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Uo(this.value.arrayValue,t)}}class dT extends Ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Uo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Uo(this.value.arrayValue,t)}}class mT extends Ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Go(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Uo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(e,t=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function Xf(r,e=null,t=[],n=[],i=null,s=null,a=null){return new pT(r,e,t,n,i,s,a)}function gs(r){const e=be(r);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>qf(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),fc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>wa(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>wa(n)).join(",")),e.ue=t}return e.ue}function hc(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!cT(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!K1(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!bm(r.startAt,e.startAt)&&bm(r.endAt,e.endAt)}function Rl(r){return Se.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Fl(r,e){return r.filters.filter(t=>t instanceof Ye&&t.field.isEqual(e))}function Rm(r,e,t){let n=xl,i=!0;for(const s of Fl(r,e)){let a=xl,o=!0;switch(s.op){case"<":case"<=":a=aT(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,o=!1;break;case"!=":case"not-in":a=xl}Im({value:n,inclusive:i},{value:a,inclusive:o})<0&&(n=a,i=o)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const a=t.position[s];Im({value:n,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(n=a,i=t.inclusive);break}}return{value:n,inclusive:i}}function Fm(r,e,t){let n=_i,i=!0;for(const s of Fl(r,e)){let a=_i,o=!0;switch(s.op){case">=":case">":a=oT(s.value),o=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,o=!1;break;case"!=":case"not-in":a=_i}km({value:n,inclusive:i},{value:a,inclusive:o})>0&&(n=a,i=o)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const a=t.position[s];km({value:n,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(n=a,i=t.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,t=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function J1(r,e,t,n,i,s,a,o){return new Ui(r,e,t,n,i,s,a,o)}function dc(r){return new Ui(r)}function Dm(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Oh(r){return r.collectionGroup!==null}function la(r){const e=be(r);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new gt(Dt.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Wo(s,n))}),t.has(Dt.keyField().canonicalString())||e.ce.push(new Wo(Dt.keyField(),n))}return e.ce}function Jr(r){const e=be(r);return e.le||(e.le=gT(e,la(r))),e.le}function gT(r,e){if(r.limitType==="F")return Xf(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Wo(i.field,s)});const t=r.endAt?new bi(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new bi(r.startAt.position,r.startAt.inclusive):null;return Xf(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Qf(r,e){const t=r.filters.concat([e]);return new Ui(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Dl(r,e,t){return new Ui(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function mu(r,e){return hc(Jr(r),Jr(e))&&r.limitType===e.limitType}function Z1(r){return`${gs(Jr(r))}|lt:${r.limitType}`}function ea(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>X1(i)).join(", ")}]`),fc(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>wa(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>wa(i)).join(",")),`Target(${n})`}(Jr(r))}; limitType=${r.limitType})`}function mc(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Se.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of la(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){const l=Cm(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,la(n),i)||n.endAt&&!function(a,o,c){const l=Cm(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,la(n),i))}(r,e)}function e_(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function t_(r){return(e,t)=>{let n=!1;for(const i of la(r)){const s=_T(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function _T(r,e,t){const n=r.field.isKeyField()?Se.comparator(e.key,t.key):function(s,a,o){const c=a.data.field(s),l=o.data.field(s);return c!==null&&l!==null?Ci(c,l):Ce()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ce()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Rs(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return U1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT=new wt(Se.comparator);function Yr(){return xT}const r_=new wt(Se.comparator);function uo(...r){let e=r_;for(const t of r)e=e.insert(t.key,t);return e}function n_(r){let e=r_;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function bn(){return yo()}function i_(){return yo()}function yo(){return new Gi(r=>r.toString(),(r,e)=>r.isEqual(e))}const vT=new wt(Se.comparator),yT=new gt(Se.comparator);function qe(...r){let e=yT;for(const t of r)e=e.add(t);return e}const wT=new gt(Ge);function Lh(){return wT}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vo(e)?"-0":e}}function s_(r){return{integerValue:""+r}}function a_(r,e){return O1(e)?s_(e):Mh(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(){this._=void 0}}function ET(r,e,t){return r instanceof Ta?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&hu(s)&&(s=Ph(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):r instanceof _s?c_(r,e):r instanceof Aa?l_(r,e):function(i,s){const a=o_(i,s),o=Pm(a)+Pm(i.Pe);return $f(a)&&$f(i.Pe)?s_(o):Mh(i.serializer,o)}(r,e)}function TT(r,e,t){return r instanceof _s?c_(r,e):r instanceof Aa?l_(r,e):t}function o_(r,e){return r instanceof Sa?function(n){return $f(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Ta extends pu{}class _s extends pu{constructor(e){super(),this.elements=e}}function c_(r,e){const t=u_(e);for(const n of r.elements)t.some(i=>Dn(i,n))||t.push(n);return{arrayValue:{values:t}}}class Aa extends pu{constructor(e){super(),this.elements=e}}function l_(r,e){let t=u_(e);for(const n of r.elements)t=t.filter(i=>!Dn(i,n));return{arrayValue:{values:t}}}class Sa extends pu{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Pm(r){return Rt(r.integerValue||r.doubleValue)}function u_(r){return Go(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,t){this.field=e,this.transform=t}}function AT(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof _s&&i instanceof _s||n instanceof Aa&&i instanceof Aa?ya(n.elements,i.elements,Dn):n instanceof Sa&&i instanceof Sa?Dn(n.Pe,i.Pe):n instanceof Ta&&i instanceof Ta}(r.transform,e.transform)}class ST{constructor(e,t){this.version=e,this.transformResults=t}}class zt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new zt}static exists(e){return new zt(void 0,e)}static updateTime(e){return new zt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yl(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class _u{}function f_(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new pc(r.key,zt.none()):new La(r.key,r.data,zt.none());{const t=r.data,n=mr.empty();let i=new gt(Dt.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ni(r.key,n,new Br(i.toArray()),zt.none())}}function IT(r,e,t){r instanceof La?function(i,s,a){const o=i.value.clone(),c=Om(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(r,e,t):r instanceof ni?function(i,s,a){if(!yl(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=Om(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(h_(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(r,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function wo(r,e,t,n){return r instanceof La?function(s,a,o,c){if(!yl(s.precondition,a))return o;const l=s.value.clone(),u=Lm(s.fieldTransforms,c,a);return l.setAll(u),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(r,e,t,n):r instanceof ni?function(s,a,o,c){if(!yl(s.precondition,a))return o;const l=Lm(s.fieldTransforms,c,a),u=a.data;return u.setAll(h_(s)),u.setAll(l),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(r,e,t,n):function(s,a,o){return yl(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(r,e,t)}function kT(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=o_(n.transform,i||null);s!=null&&(t===null&&(t=mr.empty()),t.set(n.field,s))}return t||null}function Nm(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&ya(n,i,(s,a)=>AT(s,a))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class La extends _u{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ni extends _u{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function h_(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function Om(r,e,t){const n=new Map;Re(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,TT(a,o,t[i]))}return n}function Lm(r,e,t){const n=new Map;for(const i of r){const s=i.transform,a=t.data.field(i.field);n.set(i.field,ET(s,a,e))}return n}class pc extends _u{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Vh extends _u{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&IT(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=wo(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=wo(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=i_();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const c=f_(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(De.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),qe())}isEqual(e){return this.batchId===e.batchId&&ya(this.mutations,e.mutations,(t,n)=>Nm(t,n))&&ya(this.baseMutations,e.baseMutations,(t,n)=>Nm(t,n))}}class Uh{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Re(e.mutations.length===n.length);let i=function(){return vT}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Uh(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt,et;function d_(r){switch(r){default:return Ce();case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0}}function m_(r){if(r===void 0)return Wt("GRPC error has no .code"),ee.UNKNOWN;switch(r){case qt.OK:return ee.OK;case qt.CANCELLED:return ee.CANCELLED;case qt.UNKNOWN:return ee.UNKNOWN;case qt.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case qt.INTERNAL:return ee.INTERNAL;case qt.UNAVAILABLE:return ee.UNAVAILABLE;case qt.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case qt.NOT_FOUND:return ee.NOT_FOUND;case qt.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case qt.ABORTED:return ee.ABORTED;case qt.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case qt.DATA_LOSS:return ee.DATA_LOSS;default:return Ce()}}(et=qt||(qt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=new as([4294967295,4294967295],0);function Mm(r){const e=bT().encode(r),t=new E1;return t.update(e),new Uint8Array(t.digest())}function Vm(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new as([t,n],0),new as([i,s],0)]}class Wh{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new fo(`Invalid padding: ${t}`);if(n<0)throw new fo(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new fo(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new fo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=as.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(as.fromNumber(n)));return i.compare(RT)===1&&(i=new as([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Mm(e),[n,i]=Vm(t);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Wh(s,i,t);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const t=Mm(e),[n,i]=Vm(t);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class fo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,_c.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new gc(De.min(),i,new wt(Ge),Yr(),qe())}}class _c{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new _c(n,t,qe(),qe(),qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}}class p_{constructor(e,t){this.targetId=e,this.me=t}}class g_{constructor(e,t,n=Ht.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Bm{constructor(){this.fe=0,this.ge=Gm(),this.pe=Ht.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=qe(),t=qe(),n=qe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Ce()}}),new _c(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Gm()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Re(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class FT{constructor(e){this.Le=e,this.Be=new Map,this.ke=Yr(),this.qe=Um(),this.Qe=new wt(Ge)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Ce()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,n=e.me.count,i=this.Je(t);if(i){const s=i.target;if(Rl(s))if(n===0){const a=new Se(s.path);this.Ue(t,a,Ft.newNoDocument(a,De.min()))}else Re(n===1);else{const a=this.Ye(t);if(a!==n){const o=this.Ze(e),c=o?this.Xe(o,e,a):1;if(c!==0){this.je(t);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=ki(n).toUint8Array()}catch(c){if(c instanceof G1)return Oo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new Wh(a,i,s)}catch(c){return Oo(c instanceof fo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.Ie===0?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&Rl(o.target)){const c=new Se(o.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,Ft.newNoDocument(c,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let n=qe();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(c=>{const l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new gc(e,t,this.Qe,this.ke,n);return this.ke=Yr(),this.qe=Um(),this.Qe=new wt(Ge),i}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Bm,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new gt(Ge),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||he("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Bm),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Um(){return new wt(Se.comparator)}function Gm(){return new wt(Se.comparator)}const DT={asc:"ASCENDING",desc:"DESCENDING"},PT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NT={and:"AND",or:"OR"};class OT{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Yf(r,e){return r.useProto3Json||fc(e)?e:{value:e}}function Ia(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function LT(r,e){return Ia(r,e.toTimestamp())}function cr(r){return Re(!!r),De.fromTimestamp(function(t){const n=ri(t);return new Nt(n.seconds,n.nanos)}(r))}function zh(r,e){return Jf(r,e).canonicalString()}function Jf(r,e){const t=function(i){return new nt(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function x_(r){const e=nt.fromString(r);return Re(k_(e)),e}function zo(r,e){return zh(r.databaseId,e.path)}function Jn(r,e){const t=x_(e);if(t.get(1)!==r.databaseId.projectId)throw new ge(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new ge(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Se(w_(t))}function v_(r,e){return zh(r.databaseId,e)}function y_(r){const e=x_(r);return e.length===4?nt.emptyPath():w_(e)}function Zf(r){return new nt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function w_(r){return Re(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Wm(r,e,t){return{name:zo(r,e),fields:t.value.mapValue.fields}}function MT(r,e,t){const n=Jn(r,e.name),i=cr(e.updateTime),s=e.createTime?cr(e.createTime):De.min(),a=new mr({mapValue:{fields:e.fields}}),o=Ft.newFoundDocument(n,i,s,a);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function VT(r,e){return"found"in e?function(n,i){Re(!!i.found),i.found.name,i.found.updateTime;const s=Jn(n,i.found.name),a=cr(i.found.updateTime),o=i.found.createTime?cr(i.found.createTime):De.min(),c=new mr({mapValue:{fields:i.found.fields}});return Ft.newFoundDocument(s,a,o,c)}(r,e):"missing"in e?function(n,i){Re(!!i.missing),Re(!!i.readTime);const s=Jn(n,i.missing),a=cr(i.readTime);return Ft.newNoDocument(s,a)}(r,e):Ce()}function BT(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Ce()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(Re(u===void 0||typeof u=="string"),Ht.fromBase64String(u||"")):(Re(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Ht.fromUint8Array(u||new Uint8Array))}(r,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(l){const u=l.code===void 0?ee.UNKNOWN:m_(l.code);return new ge(u,l.message||"")}(a);t=new g_(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Jn(r,n.document.name),s=cr(n.document.updateTime),a=n.document.createTime?cr(n.document.createTime):De.min(),o=new mr({mapValue:{fields:n.document.fields}}),c=Ft.newFoundDocument(i,s,a,o),l=n.targetIds||[],u=n.removedTargetIds||[];t=new wl(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Jn(r,n.document),s=n.readTime?cr(n.readTime):De.min(),a=Ft.newNoDocument(i,s),o=n.removedTargetIds||[];t=new wl([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Jn(r,n.document),s=n.removedTargetIds||[];t=new wl([],s,i,null)}else{if(!("filter"in e))return Ce();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new CT(i,s),o=n.targetId;t=new p_(o,a)}}return t}function Ho(r,e){let t;if(e instanceof La)t={update:Wm(r,e.key,e.value)};else if(e instanceof pc)t={delete:zo(r,e.key)};else if(e instanceof ni)t={update:Wm(r,e.key,e.data),updateMask:jT(e.fieldMask)};else{if(!(e instanceof Vh))return Ce();t={verify:zo(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Ta)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof _s)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Aa)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Sa)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Ce()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:LT(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ce()}(r,e.precondition)),t}function eh(r,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?zt.updateTime(cr(s.updateTime)):s.exists!==void 0?zt.exists(s.exists):zt.none()}(e.currentDocument):zt.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(a,o){let c=null;if("setToServerValue"in o)Re(o.setToServerValue==="REQUEST_TIME"),c=new Ta;else if("appendMissingElements"in o){const u=o.appendMissingElements.values||[];c=new _s(u)}else if("removeAllFromArray"in o){const u=o.removeAllFromArray.values||[];c=new Aa(u)}else"increment"in o?c=new Sa(a,o.increment):Ce();const l=Dt.fromServerFormat(o.fieldPath);return new gu(l,c)}(r,i)):[];if(e.update){e.update.name;const i=Jn(r,e.update.name),s=new mr({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(c){const l=c.fieldPaths||[];return new Br(l.map(u=>Dt.fromServerFormat(u)))}(e.updateMask);return new ni(i,s,a,t,n)}return new La(i,s,t,n)}if(e.delete){const i=Jn(r,e.delete);return new pc(i,t)}if(e.verify){const i=Jn(r,e.verify);return new Vh(i,t)}return Ce()}function UT(r,e){return r&&r.length>0?(Re(e!==void 0),r.map(t=>function(i,s){let a=i.updateTime?cr(i.updateTime):cr(s);return a.isEqual(De.min())&&(a=cr(s)),new ST(a,i.transformResults||[])}(t,e))):[]}function E_(r,e){return{documents:[v_(r,e.path)]}}function T_(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=v_(r,i);const s=function(l){if(l.length!==0)return I_(ht.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const a=function(l){if(l.length!==0)return l.map(u=>function(d){return{field:ta(d.field),direction:WT(d.dir)}}(u))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=Yf(r,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function A_(r){let e=y_(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){Re(n===1);const u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=function(h){const d=S_(h);return d instanceof ht&&Nh(d)?d.getFilters():[d]}(t.where));let a=[];t.orderBy&&(a=function(h){return h.map(d=>function(g){return new Wo(ra(g.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(t.orderBy));let o=null;t.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,fc(d)?null:d}(t.limit));let c=null;t.startAt&&(c=function(h){const d=!!h.before,m=h.values||[];return new bi(m,d)}(t.startAt));let l=null;return t.endAt&&(l=function(h){const d=!h.before,m=h.values||[];return new bi(m,d)}(t.endAt)),J1(e,i,a,s,o,"F",c,l)}function GT(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function S_(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=ra(t.unaryFilter.field);return Ye.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ra(t.unaryFilter.field);return Ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ra(t.unaryFilter.field);return Ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ra(t.unaryFilter.field);return Ye.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Ce()}}(r):r.fieldFilter!==void 0?function(t){return Ye.create(ra(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ce()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return ht.create(t.compositeFilter.filters.map(n=>S_(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ce()}}(t.compositeFilter.op))}(r):Ce()}function WT(r){return DT[r]}function zT(r){return PT[r]}function HT(r){return NT[r]}function ta(r){return{fieldPath:r.canonicalString()}}function ra(r){return Dt.fromServerFormat(r.fieldPath)}function I_(r){return r instanceof Ye?function(t){if(t.op==="=="){if(Sm(t.value))return{unaryFilter:{field:ta(t.field),op:"IS_NAN"}};if(Am(t.value))return{unaryFilter:{field:ta(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Sm(t.value))return{unaryFilter:{field:ta(t.field),op:"IS_NOT_NAN"}};if(Am(t.value))return{unaryFilter:{field:ta(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ta(t.field),op:zT(t.op),value:t.value}}}(r):r instanceof ht?function(t){const n=t.getFilters().map(i=>I_(i));return n.length===1?n[0]:{compositeFilter:{op:HT(t.op),filters:n}}}(r):Ce()}function jT(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function k_(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,t,n,i,s=De.min(),a=De.min(),o=Ht.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Qn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e){this.ct=e}}function $T(r,e){let t;if(e.document)t=MT(r.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Se.fromSegments(e.noDocument.path),i=vs(e.noDocument.readTime);t=Ft.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ce();{const n=Se.fromSegments(e.unknownDocument.path),i=vs(e.unknownDocument.version);t=Ft.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Nt(i[0],i[1]);return De.fromTimestamp(s)}(e.readTime)),t}function zm(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Pl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,a){return{name:zo(s,a.key),fields:a.data.value.mapValue.fields,updateTime:Ia(s,a.version.toTimestamp()),createTime:Ia(s,a.createTime.toTimestamp())}}(r.ct,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:xs(e.version)};else{if(!e.isUnknownDocument())return Ce();n.unknownDocument={path:t.path.toArray(),version:xs(e.version)}}return n}function Pl(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function xs(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function vs(r){const e=new Nt(r.seconds,r.nanoseconds);return De.fromTimestamp(e)}function rs(r,e){const t=(e.baseMutations||[]).map(s=>eh(r.ct,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];a.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>eh(r.ct,s)),i=Nt.fromMillis(e.localWriteTimeMs);return new Bh(e.batchId,i,t,n)}function ho(r){const e=vs(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?vs(r.lastLimboFreeSnapshotVersion):De.min();let n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){return Re(s.documents.length===1),Jr(dc(y_(s.documents[0])))}(r.query):function(s){return Jr(A_(s))}(r.query),new Qn(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Ht.fromBase64String(r.resumeToken))}function b_(r,e){const t=xs(e.snapshotVersion),n=xs(e.lastLimboFreeSnapshotVersion);let i;i=Rl(e.target)?E_(r.ct,e.target):T_(r.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:gs(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function R_(r){const e=A_({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Dl(e,e.limit,"L"):e}function lf(r,e){return new Gh(e.largestBatchId,eh(r.ct,e.overlayMutation))}function Hm(r,e){const t=e.path.lastSegment();return[r,Nr(e.path.popLast()),t]}function jm(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:xs(n.readTime),documentKey:Nr(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{getBundleMetadata(e,t){return $m(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:vs(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return $m(e).put(function(i){return{bundleId:i.id,createTime:xs(cr(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return Km(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:R_(s.bundledQuery),readTime:vs(s.readTime)}}(n)})}saveNamedQuery(e,t){return Km(e).put(function(i){return{name:i.name,readTime:xs(cr(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function $m(r){return tr(r,"bundles")}function Km(r){return tr(r,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new xu(e,n)}getOverlay(e,t){return ro(e).get(Hm(this.userId,t)).next(n=>n?lf(this.serializer,n):null)}getOverlays(e,t){const n=bn();return q.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((s,a)=>{const o=new Gh(t,a);i.push(this.ht(e,o))}),q.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(a=>i.add(Nr(a.getCollectionPath())));const s=[];return i.forEach(a=>{const o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,n+1],!1,!0);s.push(ro(e).j("collectionPathOverlayIndex",o))}),q.waitFor(s)}getOverlaysForCollection(e,t,n){const i=bn(),s=Nr(t),a=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ro(e).U("collectionPathOverlayIndex",a).next(o=>{for(const c of o){const l=lf(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const s=bn();let a;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ro(e).J({index:"collectionGroupOverlayIndex",range:o},(c,l,u)=>{const h=lf(this.serializer,l);s.size()<i||h.largestBatchId===a?(s.set(h.getKey(),h),a=h.largestBatchId):u.done()}).next(()=>s)}ht(e,t){return ro(e).put(function(i,s,a){const[o,c,l]=Hm(s,a.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Ho(i.ct,a.mutation)}}(this.serializer,this.userId,t))}}function ro(r){return tr(r,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{Pt(e){return tr(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?Ht.fromUint8Array(n):Ht.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Rt(e.integerValue));else if("doubleValue"in e){const n=Rt(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Vo(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),typeof n=="string"&&(n=ri(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(ki(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?W1(e)?this.dt(t,Number.MAX_SAFE_INTEGER):du(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Ce()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const i of Object.keys(n))this.Vt(i,t),this.Tt(n[i],t)}wt(e,t){var n,i;const s=e.fields||{};this.dt(t,53);const a="value",o=((i=(n=s[a].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Rt(o)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const i of n)this.Tt(i,t)}yt(e,t){this.dt(t,37),Se.fromName(e).path.forEach(n=>{this.dt(t,60),this.Dt(n,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}ns.vt=new ns;function XT(r){if(r===0)return 8;let e=0;return!(r>>4)&&(e+=4,r<<=4),!(r>>6)&&(e+=2,r<<=2),!(r>>7)&&(e+=1),e}function qm(r){const e=64-function(n){let i=0;for(let s=0;s<8;++s){const a=XT(255&n[s]);if(i+=a,a!==8)break}return i}(r);return Math.ceil(e/8)}class QT{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const t=this.qt(e),n=qm(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),n=qm(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),n=(128&t[0])!=0;t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class YT{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class JT{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class no{constructor(){this.jt=new QT,this.Ht=new YT(this.jt),this.Jt=new JT(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new is(this.indexId,this.documentKey,this.arrayValue,n)}}function fi(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=Xm(r.arrayValue,e.arrayValue),t!==0?t:(t=Xm(r.directionalValue,e.directionalValue),t!==0?t:Se.comparator(r.documentKey,e.documentKey)))}function Xm(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e){this.Xt=new gt((t,n)=>Dt.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const n=t;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(Re(e.collectionGroup===this.collectionId),this.nn)return!1;const t=zf(e);if(t!==void 0&&!this.sn(t))return!1;const n=es(e);let i=new Set,s=0,a=0;for(;s<n.length&&this.sn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const o=this.Xt.getIterator().getNext();if(!i.has(o.field.canonicalString())){const c=n[s];if(!this.on(o,c)||!this._n(this.en[a++],c))return!1}++s}for(;s<n.length;++s){const o=n[s];if(a>=this.en.length||!this._n(this.en[a++],o))return!1}return!0}an(){if(this.nn)return null;let e=new gt(Dt.comparator);const t=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new gl(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new gl(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new gl(n.field,n.dir==="asc"?0:1)));return new bl(bl.UNKNOWN_ID,this.collectionId,t,Mo.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F_(r){var e,t;if(Re(r instanceof Ye||r instanceof ht),r instanceof Ye){if(r instanceof Y1){const i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Ye.create(r.field,"==",s)))||[];return ht.create(i,"or")}return r}const n=r.filters.map(i=>F_(i));return ht.create(n,r.op)}function ZT(r){if(r.getFilters().length===0)return[];const e=nh(F_(r));return Re(D_(e)),th(e)||rh(e)?[e]:e.getFilters()}function th(r){return r instanceof Ye}function rh(r){return r instanceof ht&&Nh(r)}function D_(r){return th(r)||rh(r)||function(t){if(t instanceof ht&&Kf(t)){for(const n of t.getFilters())if(!th(n)&&!rh(n))return!1;return!0}return!1}(r)}function nh(r){if(Re(r instanceof Ye||r instanceof ht),r instanceof Ye)return r;if(r.filters.length===1)return nh(r.filters[0]);const e=r.filters.map(n=>nh(n));let t=ht.create(e,r.op);return t=Nl(t),D_(t)?t:(Re(t instanceof ht),Re(Ea(t)),Re(t.filters.length>1),t.filters.reduce((n,i)=>Hh(n,i)))}function Hh(r,e){let t;return Re(r instanceof Ye||r instanceof ht),Re(e instanceof Ye||e instanceof ht),t=r instanceof Ye?e instanceof Ye?function(i,s){return ht.create([i,s],"and")}(r,e):Ym(r,e):e instanceof Ye?Ym(e,r):function(i,s){if(Re(i.filters.length>0&&s.filters.length>0),Ea(i)&&Ea(s))return q1(i,s.getFilters());const a=Kf(i)?i:s,o=Kf(i)?s:i,c=a.filters.map(l=>Hh(l,o));return ht.create(c,"or")}(r,e),Nl(t)}function Ym(r,e){if(Ea(e))return q1(e,r.getFilters());{const t=e.filters.map(n=>Hh(r,n));return ht.create(t,"or")}}function Nl(r){if(Re(r instanceof Ye||r instanceof ht),r instanceof Ye)return r;const e=r.getFilters();if(e.length===1)return Nl(e[0]);if($1(r))return r;const t=e.map(i=>Nl(i)),n=[];return t.forEach(i=>{i instanceof Ye?n.push(i):i instanceof ht&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:ht.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(){this.un=new jh}addToCollectionParentIndex(e,t){return this.un.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(en.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(en.min())}updateCollectionGroup(e,t,n){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class jh{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new gt(nt.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new gt(nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc=new Uint8Array(0);class tA{constructor(e,t){this.databaseId=t,this.cn=new jh,this.ln=new Gi(n=>gs(n),(n,i)=>hc(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const s={collectionId:n,parent:Nr(i)};return Jm(e).put(s)}return q.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[b1(t),""],!1,!0);return Jm(e).U(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;n.push(Cn(a.parent))}return n})}addFieldIndex(e,t){const n=io(e),i=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;const s=n.add(i);if(t.indexState){const a=qs(e);return s.next(o=>{a.put(jm(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=io(e),i=qs(e),s=Ks(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=io(e),n=Ks(e),i=qs(e);return t.j().next(()=>n.j()).next(()=>i.j())}createTargetIndexes(e,t){return q.forEach(this.hn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){const s=new Qm(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const n=Ks(e);let i=!0;const s=new Map;return q.forEach(this.hn(t),a=>this.Pn(e,a).next(o=>{i&&(i=!!o),s.set(a,o)})).next(()=>{if(i){let a=qe();const o=[];return q.forEach(s,(c,l)=>{he("IndexedDbIndexManager",`Using index ${function(E){return`id=${E.indexId}|cg=${E.collectionGroup}|f=${E.fields.map(F=>`${F.fieldPath}:${F.kind}`).join(",")}`}(c)} to execute ${gs(t)}`);const u=function(E,F){const M=zf(F);if(M===void 0)return null;for(const O of Fl(E,M.fieldPath))switch(O.op){case"array-contains-any":return O.value.arrayValue.values||[];case"array-contains":return[O.value]}return null}(l,c),h=function(E,F){const M=new Map;for(const O of es(F))for(const y of Fl(E,O.fieldPath))switch(y.op){case"==":case"in":M.set(O.fieldPath.canonicalString(),y.value);break;case"not-in":case"!=":return M.set(O.fieldPath.canonicalString(),y.value),Array.from(M.values())}return null}(l,c),d=function(E,F){const M=[];let O=!0;for(const y of es(F)){const A=y.kind===0?Rm(E,y.fieldPath,E.startAt):Fm(E,y.fieldPath,E.startAt);M.push(A.value),O&&(O=A.inclusive)}return new bi(M,O)}(l,c),m=function(E,F){const M=[];let O=!0;for(const y of es(F)){const A=y.kind===0?Fm(E,y.fieldPath,E.endAt):Rm(E,y.fieldPath,E.endAt);M.push(A.value),O&&(O=A.inclusive)}return new bi(M,O)}(l,c),g=this.In(c,l,d),p=this.In(c,l,m),x=this.Tn(c,l,h),T=this.En(c.indexId,u,g,d.inclusive,p,m.inclusive,x);return q.forEach(T,b=>n.G(b,t.limit).next(E=>{E.forEach(F=>{const M=Se.fromSegments(F.documentKey);a.has(M)||(a=a.add(M),o.push(M))})}))}).next(()=>o)}return q.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=ZT(ht.create(e.filters,"and")).map(n=>Xf(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,n,i,s,a,o){const c=(t!=null?t.length:1)*Math.max(n.length,s.length),l=c/(t!=null?t.length:1),u=[];for(let h=0;h<c;++h){const d=t?this.dn(t[h/l]):Yc,m=this.An(e,d,n[h%l],i),g=this.Rn(e,d,s[h%l],a),p=o.map(x=>this.An(e,d,x,!0));u.push(...this.createRange(m,g,p))}return u}An(e,t,n,i){const s=new is(e,Se.empty(),t,n);return i?s:s.Zt()}Rn(e,t,n,i){const s=new is(e,Se.empty(),t,n);return i?s.Zt():s}Pn(e,t){const n=new Qm(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const o of s)n.rn(o)&&(!a||o.fields.length>a.fields.length)&&(a=o);return a})}getIndexType(e,t){let n=2;const i=this.hn(t);return q.forEach(i,s=>this.Pn(e,s).next(a=>{a?n!==0&&a.fields.length<function(c){let l=new gt(Dt.comparator),u=!1;for(const h of c.filters)for(const d of h.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?u=!0:l=l.add(d.field));for(const h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(u?1:0)}(s)&&(n=1):n=0})).next(()=>function(a){return a.limit!==null}(t)&&i.length>1&&n===2?1:n)}Vn(e,t){const n=new no;for(const i of es(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=n.Yt(i.kind);ns.vt.It(s,a)}return n.zt()}dn(e){const t=new no;return ns.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const n=new no;return ns.vt.It(ps(this.databaseId,t),n.Yt(function(s){const a=es(s);return a.length===0?0:a[a.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(n===null)return[];let i=[];i.push(new no);let s=0;for(const a of es(e)){const o=n[s++];for(const c of i)if(this.fn(t,a.fieldPath)&&Go(o))i=this.gn(i,a,o);else{const l=c.Yt(a.kind);ns.vt.It(o,l)}}return this.pn(i)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){const i=[...e],s=[];for(const a of n.arrayValue.values||[])for(const o of i){const c=new no;c.seed(o.zt()),ns.vt.It(a,c.Yt(t.kind)),s.push(c)}return s}fn(e,t){return!!e.filters.find(n=>n instanceof Ye&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=io(e),i=qs(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(s=>{const a=[];return q.forEach(s,o=>i.get([o.indexId,this.uid]).next(c=>{a.push(function(u,h){const d=h?new Mo(h.sequenceNumber,new en(vs(h.readTime),new Se(Cn(h.documentKey)),h.largestBatchId)):Mo.empty(),m=u.fields.map(([g,p])=>new gl(Dt.fromServerFormat(g),p));return new bl(u.indexId,u.collectionGroup,m,d)}(o,c))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{const s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Ge(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=io(e),s=qs(e);return this.yn(e).next(a=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(o=>q.forEach(o,c=>s.put(jm(c.indexId,this.uid,a,n)))))}updateIndexEntries(e,t){const n=new Map;return q.forEach(t,(i,s)=>{const a=n.get(i.collectionGroup);return(a?q.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(o=>(n.set(i.collectionGroup,o),q.forEach(o,c=>this.wn(e,i,c).next(l=>{const u=this.Sn(s,c);return l.isEqual(u)?q.resolve():this.bn(e,s,c,l,u)}))))})}Dn(e,t,n,i){return Ks(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,i){return Ks(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){const i=Ks(e);let s=new gt(fi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},(a,o)=>{s=s.add(new is(n.indexId,t,o.arrayValue,o.directionalValue))}).next(()=>s)}Sn(e,t){let n=new gt(fi);const i=this.Vn(t,e);if(i==null)return n;const s=zf(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Go(a))for(const o of a.arrayValue.values||[])n=n.add(new is(t.indexId,e.key,this.dn(o),i))}else n=n.add(new is(t.indexId,e.key,Yc,i));return n}bn(e,t,n,i,s){he("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(c,l,u,h,d){const m=c.getIterator(),g=l.getIterator();let p=$s(m),x=$s(g);for(;p||x;){let T=!1,b=!1;if(p&&x){const E=u(p,x);E<0?b=!0:E>0&&(T=!0)}else p!=null?b=!0:T=!0;T?(h(x),x=$s(g)):b?(d(p),p=$s(m)):(p=$s(m),x=$s(g))}}(i,s,fi,o=>{a.push(this.Dn(e,t,n,o))},o=>{a.push(this.vn(e,t,n,o))}),q.waitFor(a)}yn(e){let t=1;return qs(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((a,o)=>fi(a,o)).filter((a,o,c)=>!o||fi(a,c[o-1])!==0);const i=[];i.push(e);for(const a of n){const o=fi(a,e),c=fi(a,t);if(o===0)i[0]=e.Zt();else if(o>0&&c<0)i.push(a),i.push(a.Zt());else if(c>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.Cn(i[a],i[a+1]))return[];const o=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Yc,[]],c=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Yc,[]];s.push(IDBKeyRange.bound(o,c))}return s}Cn(e,t){return fi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Zm)}getMinOffset(e,t){return q.mapArray(this.hn(t),n=>this.Pn(e,n).next(i=>i||Ce())).next(Zm)}}function Jm(r){return tr(r,"collectionParents")}function Ks(r){return tr(r,"indexEntries")}function io(r){return tr(r,"indexConfiguration")}function qs(r){return tr(r,"indexState")}function Zm(r){Re(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;Rh(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new en(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Mr{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Mr(e,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(r,e,t){const n=r.store("mutations"),i=r.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let o=0;const c=n.J({range:a},(u,h,d)=>(o++,d.delete()));s.push(c.next(()=>{Re(o===1)}));const l=[];for(const u of t.mutations){const h=L1(e,u.key.path,t.batchId);s.push(i.delete(h)),l.push(u.key)}return q.waitFor(s).next(()=>l)}function Ol(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ce();e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mr.DEFAULT_COLLECTION_PERCENTILE=10,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mr.DEFAULT=new Mr(41943040,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mr.DISABLED=new Mr(-1,0,0);class vu{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Fn={}}static lt(e,t,n,i){Re(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new vu(s,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return hi(e).J({index:"userMutationsIndex",range:n},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const s=na(e),a=hi(e);return a.add({}).next(o=>{Re(typeof o=="number");const c=new Bh(o,t,n,i),l=function(m,g,p){const x=p.baseMutations.map(b=>Ho(m.ct,b)),T=p.mutations.map(b=>Ho(m.ct,b));return{userId:g,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:T}}(this.serializer,this.userId,c),u=[];let h=new gt((d,m)=>Ge(d.canonicalString(),m.canonicalString()));for(const d of i){const m=L1(this.userId,d.key.path,o);h=h.add(d.key.path.popLast()),u.push(a.put(l)),u.push(s.put(m,U2))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Fn[o]=c.keys()}),q.waitFor(u).next(()=>c)})}lookupMutationBatch(e,t){return hi(e).get(t).next(n=>n?(Re(n.userId===this.userId),rs(this.serializer,n)):null)}Mn(e,t){return this.Fn[t]?q.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const i=n.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return hi(e).J({index:"userMutationsIndex",range:i},(a,o,c)=>{o.userId===this.userId&&(Re(o.batchId>=n),s=rs(this.serializer,o)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return hi(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{n=s.batchId,a.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return hi(e).U("userMutationsIndex",t).next(n=>n.map(i=>rs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=_l(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return na(e).J({range:i},(a,o,c)=>{const[l,u,h]=a,d=Cn(u);if(l===this.userId&&t.path.isEqual(d))return hi(e).get(h).next(m=>{if(!m)throw Ce();Re(m.userId===this.userId),s.push(rs(this.serializer,m))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new gt(Ge);const i=[];return t.forEach(s=>{const a=_l(this.userId,s.path),o=IDBKeyRange.lowerBound(a),c=na(e).J({range:o},(l,u,h)=>{const[d,m,g]=l,p=Cn(m);d===this.userId&&s.path.isEqual(p)?n=n.add(g):h.done()});i.push(c)}),q.waitFor(i).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,s=_l(this.userId,n),a=IDBKeyRange.lowerBound(s);let o=new gt(Ge);return na(e).J({range:a},(c,l,u)=>{const[h,d,m]=c,g=Cn(d);h===this.userId&&n.isPrefixOf(g)?g.length===i&&(o=o.add(m)):u.done()}).next(()=>this.xn(e,o))}xn(e,t){const n=[],i=[];return t.forEach(s=>{i.push(hi(e).get(s).next(a=>{if(a===null)throw Ce();Re(a.userId===this.userId),n.push(rs(this.serializer,a))}))}),q.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return P_(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),q.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return q.resolve();const n=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return na(e).J({range:n},(s,a,o)=>{if(s[0]===this.userId){const c=Cn(s[1]);i.push(c)}else o.done()}).next(()=>{Re(i.length===0)})})}containsKey(e,t){return N_(e,this.userId,t)}Nn(e){return O_(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function N_(r,e,t){const n=_l(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n);let a=!1;return na(r).J({range:s,H:!0},(o,c,l)=>{const[u,h,d]=o;u===e&&h===i&&(a=!0),l.done()}).next(()=>a)}function hi(r){return tr(r,"mutations")}function na(r){return tr(r,"documentMutations")}function O_(r){return tr(r,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ys(0)}static kn(){return new ys(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const n=new ys(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>De.fromTimestamp(new Nt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Xs(e).delete(t.targetId)).next(()=>this.qn(e)).next(n=>(Re(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,t,n){let i=0;const s=[];return Xs(e).J((a,o)=>{const c=ho(o);c.sequenceNumber<=t&&n.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>q.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Xs(e).J((n,i)=>{const s=ho(i);t(s)})}qn(e){return tp(e).get("targetGlobalKey").next(t=>(Re(t!==null),t))}Qn(e,t){return tp(e).put("targetGlobalKey",t)}Kn(e,t){return Xs(e).put(b_(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=gs(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return Xs(e).J({range:i,index:"queryTargetsIndex"},(a,o,c)=>{const l=ho(o);hc(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,n){const i=[],s=mi(e);return t.forEach(a=>{const o=Nr(a.path);i.push(s.put({targetId:n,path:o})),i.push(this.referenceDelegate.addReference(e,n,a))}),q.waitFor(i)}removeMatchingKeys(e,t,n){const i=mi(e);return q.forEach(t,s=>{const a=Nr(s.path);return q.waitFor([i.delete([n,a]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=mi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=mi(e);let s=qe();return i.J({range:n,H:!0},(a,o,c)=>{const l=Cn(a[1]),u=new Se(l);s=s.add(u)}).next(()=>s)}containsKey(e,t){const n=Nr(t.path),i=IDBKeyRange.bound([n],[b1(n)],!1,!0);let s=0;return mi(e).J({index:"documentTargetsIndex",H:!0,range:i},([a,o],c,l)=>{a!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return Xs(e).get(t).next(n=>n?ho(n):null)}}function Xs(r){return tr(r,"targets")}function tp(r){return tr(r,"targetGlobal")}function mi(r){return tr(r,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp([r,e],[t,n]){const i=Ge(r,t);return i===0?Ge(e,n):i}class nA{constructor(e){this.Un=e,this.buffer=new gt(rp),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();rp(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class iA{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){he("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Bi(t)?he("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Vi(t)}await this.Hn(3e5)})}}class sA{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return q.resolve(Vr.oe);const n=new nA(t);return this.Jn.forEachTarget(e,i=>n.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>n.zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(ep)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ep):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,i,s,a,o,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,a=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(l=Date.now(),Zs()<=tt.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-u}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(c-o)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function aA(r,e){return new sA(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,t){this.db=e,this.garbageCollector=aA(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}er(e){let t=0;return this.Zn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(n,i)=>t(i))}addReference(e,t,n){return Jc(e,n)}removeReference(e,t,n){return Jc(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Jc(e,t)}nr(e,t){return function(i,s){let a=!1;return O_(i).Y(o=>N_(i,o,s).next(c=>(c&&(a=!0),q.resolve(!c)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(a,o)=>{if(o<=t){const c=this.nr(e,a).next(l=>{if(!l)return s++,n.getEntry(e,a).next(()=>(n.removeEntry(a,De.min()),mi(e).delete(function(h){return[0,Nr(h.path)]}(a))))});i.push(c)}}).next(()=>q.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Jc(e,t)}tr(e,t){const n=mi(e);let i,s=Vr.oe;return n.J({index:"documentTargetsIndex"},([a,o],{path:c,sequenceNumber:l})=>{a===0?(s!==Vr.oe&&t(new Se(Cn(i)),s),s=l,i=c):s=Vr.oe}).next(()=>{s!==Vr.oe&&t(new Se(Cn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Jc(r,e){return mi(r).put(function(n,i){return{targetId:0,path:Nr(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(){this.changes=new Gi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ft.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?q.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Ji(e).put(n)}removeEntry(e,t,n){return Ji(e).delete(function(s,a){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Pl(a),o[o.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.rr(e,n)))}getEntry(e,t){let n=Ft.newInvalidDocument(t);return Ji(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(so(t))},(i,s)=>{n=this.ir(t,s)}).next(()=>n)}sr(e,t){let n={size:0,document:Ft.newInvalidDocument(t)};return Ji(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(so(t))},(i,s)=>{n={document:this.ir(t,s),size:Ol(s)}}).next(()=>n)}getEntries(e,t){let n=Yr();return this._r(e,t,(i,s)=>{const a=this.ir(i,s);n=n.insert(i,a)}).next(()=>n)}ar(e,t){let n=Yr(),i=new wt(Se.comparator);return this._r(e,t,(s,a)=>{const o=this.ir(s,a);n=n.insert(s,o),i=i.insert(s,Ol(a))}).next(()=>({documents:n,ur:i}))}_r(e,t,n){if(t.isEmpty())return q.resolve();let i=new gt(sp);t.forEach(c=>i=i.add(c));const s=IDBKeyRange.bound(so(i.first()),so(i.last())),a=i.getIterator();let o=a.getNext();return Ji(e).J({index:"documentKeyIndex",range:s},(c,l,u)=>{const h=Se.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;o&&sp(o,h)<0;)n(o,null),o=a.getNext();o&&o.isEqual(h)&&(n(o,l),o=a.hasNext()?a.getNext():null),o?u.$(so(o)):u.done()}).next(()=>{for(;o;)n(o,null),o=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),Pl(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ji(e).U(IDBKeyRange.bound(o,c,!0)).next(l=>{s==null||s.incrementDocumentReadCount(l.length);let u=Yr();for(const h of l){const d=this.ir(Se.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);d.isFoundDocument()&&(mc(t,d)||i.has(d.key))&&(u=u.insert(d.key,d))}return u})}getAllFromCollectionGroup(e,t,n,i){let s=Yr();const a=ip(t,n),o=ip(t,en.max());return Ji(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,o,!0)},(c,l,u)=>{const h=this.ir(Se.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new lA(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return np(e).get("remoteDocumentGlobalKey").next(t=>(Re(!!t),t))}rr(e,t){return np(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const n=$T(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(De.min())))return n}return Ft.newInvalidDocument(e)}}function M_(r){return new cA(r)}class lA extends L_{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Gi(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const t=[];let n=0,i=new gt((s,a)=>Ge(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const o=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,o.readTime)),a.isValidDocument()){const c=zm(this.cr.serializer,a);i=i.add(s.path.popLast());const l=Ol(c);n+=l-o.size,t.push(this.cr.addEntry(e,s,c))}else if(n-=o.size,this.trackRemovals){const c=zm(this.cr.serializer,a.convertToNoDocument(De.min()));t.push(this.cr.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,n)),q.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(n=>(this.lr.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:n,ur:i})=>(i.forEach((s,a)=>{this.lr.set(s,{size:a,readTime:n.get(s).readTime})}),n))}}function np(r){return tr(r,"remoteDocumentGlobal")}function Ji(r){return tr(r,"remoteDocumentsV14")}function so(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ip(r,e){const t=e.documentKey.path.toArray();return[r,Pl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function sp(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=Ge(t[s],n[s]),i)return i;return i=Ge(t.length,n.length),i||(i=Ge(t[t.length-2],n[n.length-2]),i||Ge(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&wo(n.mutation,i,Br.empty(),Nt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,qe()).next(()=>n))}getLocalViewOfDocuments(e,t,n=qe()){const i=bn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let a=uo();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const n=bn();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,qe()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,n,i){let s=Yr();const a=yo(),o=function(){return yo()}();return t.forEach((c,l)=>{const u=n.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof ni)?s=s.insert(l.key,l):u!==void 0?(a.set(l.key,u.mutation.getFieldMask()),wo(u.mutation,l,u.mutation.getFieldMask(),Nt.now())):a.set(l.key,Br.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>a.set(l,u)),t.forEach((l,u)=>{var h;return o.set(l,new uA(u,(h=a.get(l))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,t){const n=yo();let i=new wt((a,o)=>a-o),s=qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(c=>{const l=t.get(c);if(l===null)return;let u=n.get(c)||Br.empty();u=o.applyToLocalView(l,u),n.set(c,u);const h=(i.get(o.batchId)||qe()).add(c);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,u=c.value,h=i_();u.forEach(d=>{if(!s.has(d)){const m=f_(t.get(d),n.get(d));m!==null&&h.set(d,m),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,h))}return q.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(a){return Se.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Oh(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):q.resolve(bn());let o=-1,c=s;return a.next(l=>q.forEach(l,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(u)?q.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,qe())).next(u=>({batchId:o,changes:n_(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Se(t)).next(n=>{let i=uo();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let a=uo();return this.indexManager.getCollectionParents(e,s).next(o=>q.forEach(o,c=>{const l=function(h,d){return new Ui(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(u=>{u.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(a=>{s.forEach((c,l)=>{const u=l.getKey();a.get(u)===null&&(a=a.insert(u,Ft.newInvalidDocument(u)))});let o=uo();return a.forEach((c,l)=>{const u=s.get(c);u!==void 0&&wo(u.mutation,l,Br.empty(),Nt.now()),mc(t,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return q.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:cr(i.createTime)}}(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:R_(i.bundledQuery),readTime:cr(i.readTime)}}(t)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(){this.overlays=new wt(Se.comparator),this.Ir=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const n=bn();return q.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.ht(e,t,s)}),q.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),q.resolve()}getOverlaysForCollection(e,t,n){const i=bn(),s=t.length+1,a=new Se(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return q.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new wt((l,u)=>l-u);const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let u=s.get(l.largestBatchId);u===null&&(u=bn(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const o=bn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>o.set(l,u)),!(o.size()>=i)););return q.resolve(o)}ht(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new Gh(t,n));let s=this.Ir.get(t);s===void 0&&(s=qe(),this.Ir.set(t,s)),this.Ir.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(){this.sessionToken=Ht.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(){this.Tr=new gt(nr.Er),this.dr=new gt(nr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new nr(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Vr(new nr(e,t))}mr(e,t){e.forEach(n=>this.removeReference(n,t))}gr(e){const t=new Se(new nt([])),n=new nr(t,e),i=new nr(t,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Se(new nt([])),n=new nr(t,e),i=new nr(t,e+1);let s=qe();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new nr(e,0),n=this.Tr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class nr{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Se.comparator(e.key,t.key)||Ge(e.wr,t.wr)}static Ar(e,t){return Ge(e.wr,t.wr)||Se.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new gt(nr.Er)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Bh(s,t,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new nr(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return q.resolve(a)}lookupMutationBatch(e,t){return q.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.vr(n),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new nr(t,0),i=new nr(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new gt(Ge);return t.forEach(i=>{const s=new nr(i,0),a=new nr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),q.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;Se.isDocumentKey(s)||(s=s.child(""));const a=new nr(new Se(s),0);let o=new gt(Ge);return this.br.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.wr)),!0)},a),q.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Re(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return q.forEach(t.mutations,i=>{const s=new nr(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new nr(t,0),i=this.br.firstAfterOrEqual(n);return q.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(e){this.Mr=e,this.docs=function(){return new wt(Se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return q.resolve(n?n.document.mutableCopy():Ft.newInvalidDocument(t))}getEntries(e,t){let n=Yr();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Ft.newInvalidDocument(i))}),q.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=Yr();const a=t.path,o=new Se(a.child("")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||Rh(F1(u),n)<=0||(i.has(u.key)||mc(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,t,n,i){Ce()}Or(e,t){return q.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new gA(this)}getSize(e){return q.resolve(this.size)}}class gA extends L_{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),q.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e){this.persistence=e,this.Nr=new Gi(t=>gs(t),hc),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.Lr=0,this.Br=new $h,this.targetCount=0,this.kr=ys.Bn()}forEachTarget(e,t){return this.Nr.forEach((n,i)=>t(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),q.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new ys(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.Kn(t),q.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return q.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),q.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return q.resolve(n)}containsKey(e,t){return q.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Vr(0),this.Kr=!1,this.Kr=!0,this.$r=new dA,this.referenceDelegate=e(this),this.Ur=new _A(this),this.indexManager=new eA,this.remoteDocumentCache=function(i){return new pA(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new C_(t),this.Gr=new fA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new hA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new mA(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){he("MemoryPersistence","Starting transaction:",e);const i=new xA(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return q.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class xA extends P1{constructor(e){super(),this.currentSequenceNumber=e}}class yu{constructor(e){this.persistence=e,this.Jr=new $h,this.Yr=null}static Zr(e){return new yu(e)}get Xr(){if(this.Yr)return this.Yr;throw Ce()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),q.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),q.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.Xr,n=>{const i=Se.fromPath(n);return this.ei(e,i).next(s=>{s||t.removeEntry(i,De.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(n=>{n?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return q.or([()=>q.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e){this.serializer=e}O(e,t,n,i){const s=new fu("createOrUpgrade",t);n<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",vm,{unique:!0}),c.createObjectStore("documentMutations")}(e),ap(e),function(c){c.createObjectStore("remoteDocuments")}(e));let a=q.resolve();return n<3&&i>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),ap(e)),a=a.next(()=>function(c){const l=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(s))),n<4&&i>=4&&(n!==0&&(a=a.next(()=>function(c,l){return l.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",vm,{unique:!0});const h=l.store("mutations"),d=u.map(m=>h.put(m));return q.waitFor(d)})}(e,s))),a=a.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&i>=5&&(a=a.next(()=>this.ni(s))),n<6&&i>=6&&(a=a.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&i>=7&&(a=a.next(()=>this.ii(s))),n<8&&i>=8&&(a=a.next(()=>this.si(e,s))),n<9&&i>=9&&(a=a.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(a=a.next(()=>this.oi(s))),n<11&&i>=11&&(a=a.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&i>=12&&(a=a.next(()=>{(function(c){const l=c.createObjectStore("documentOverlays",{keyPath:J2});l.createIndex("collectionPathOverlayIndex",Z2,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",eT,{unique:!1})})(e)})),n<13&&i>=13&&(a=a.next(()=>function(c){const l=c.createObjectStore("remoteDocumentsV14",{keyPath:G2});l.createIndex("documentKeyIndex",W2),l.createIndex("collectionGroupIndex",z2)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&i>=14&&(a=a.next(()=>this.ai(e,s))),n<15&&i>=15&&(a=a.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:q2}).createIndex("sequenceNumberIndex",X2,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:Q2}).createIndex("documentKeyIndex",Y2,{unique:!1})}(e))),n<16&&i>=16&&(a=a.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),n<17&&i>=17&&(a=a.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),a}ri(e){let t=0;return e.store("remoteDocuments").J((n,i)=>{t+=Ol(i)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(i=>q.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",a).next(o=>q.forEach(o,c=>{Re(c.userId===s.userId);const l=rs(this.serializer,c);return P_(e,s.userId,l).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return n.J((a,o)=>{const c=new nt(a),l=function(h){return[0,Nr(h)]}(c);s.push(t.get(l).next(u=>u?q.resolve():(h=>t.put({targetId:0,path:Nr(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>q.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:K2});const n=t.store("collectionParents"),i=new jh,s=a=>{if(i.add(a)){const o=a.lastSegment(),c=a.popLast();return n.put({collectionId:o,parent:Nr(c)})}};return t.store("remoteDocuments").J({H:!0},(a,o)=>{const c=new nt(a);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([a,o,c],l)=>{const u=Cn(o);return s(u.popLast())}))}oi(e){const t=e.store("targets");return t.J((n,i)=>{const s=ho(i),a=b_(this.serializer,s);return t.put(a)})}_i(e,t){const n=t.store("remoteDocuments"),i=[];return n.J((s,a)=>{const o=t.store("remoteDocumentsV14"),c=function(h){return h.document?new Se(nt.fromString(h.document.name).popFirst(5)):h.noDocument?Se.fromSegments(h.noDocument.path):h.unknownDocument?Se.fromSegments(h.unknownDocument.path):Ce()}(a).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(o.put(l))}).next(()=>q.waitFor(i))}ai(e,t){const n=t.store("mutations"),i=M_(this.serializer),s=new B_(yu.Zr,this.serializer.ct);return n.U().next(a=>{const o=new Map;return a.forEach(c=>{var l;let u=(l=o.get(c.userId))!==null&&l!==void 0?l:qe();rs(this.serializer,c).keys().forEach(h=>u=u.add(h)),o.set(c.userId,u)}),q.forEach(o,(c,l)=>{const u=new yr(l),h=xu.lt(this.serializer,u),d=s.getIndexManager(u),m=vu.lt(u,this.serializer,d,s.referenceDelegate);return new V_(i,m,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Hf(t,Vr.oe),c).next()})})}}function ap(r){r.createObjectStore("targetDocuments",{keyPath:j2}).createIndex("documentTargetsIndex",$2,{unique:!0}),r.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",H2,{unique:!0}),r.createObjectStore("targetGlobal")}const uf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Kh{constructor(e,t,n,i,s,a,o,c,l,u,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=s,this.window=a,this.document=o,this.ci=l,this.li=u,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=d=>Promise.resolve(),!Kh.D())throw new ge(ee.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oA(this,i),this.Ai=t+"main",this.serializer=new C_(c),this.Ri=new Si(this.Ai,this.hi,new vA(this.serializer)),this.$r=new qT,this.Ur=new rA(this.referenceDelegate,this.serializer),this.remoteDocumentCache=M_(this.serializer),this.Gr=new KT,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&Wt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ge(ee.FAILED_PRECONDITION,uf);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Vr(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Zc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Bi(e))return he("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return he("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ao(e).get("owner").next(t=>q.resolve(this.vi(t)))}Ci(e){return Zc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=tr(t,"clientMetadata");return n.U().next(i=>{const s=this.xi(i,18e5),a=i.filter(o=>s.indexOf(o)===-1);return q.forEach(a,o=>n.delete(o.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?q.resolve(!0):ao(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new ge(ee.FAILED_PRECONDITION,uf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Zc(e).U().next(n=>this.xi(n,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,o=this.networkEnabled===i.networkEnabled;if(s||a&&o)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&he("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Hf(e,Vr.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(n=>this.Mi(n.updateTimeMs,t)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Zc(e).U().next(t=>this.xi(t,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return vu.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new tA(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return xu.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){he("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?nT:c===16?rT:c===15?Dh:c===14?B1:c===13?V1:c===12?tT:c===11?M1:void Ce()}(this.hi);let a;return this.Ri.runTransaction(e,i,s,o=>(a=new Hf(o,this.Qr?this.Qr.next():Vr.oe),t==="readwrite-primary"?this.wi(a).next(c=>!!c||this.Si(a)).next(c=>{if(!c)throw Wt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ge(ee.FAILED_PRECONDITION,D1);return n(a)}).next(c=>this.Di(a).next(()=>c)):this.Ki(a).next(()=>n(a)))).then(o=>(a.raiseOnCommittedEvent(),o))}Ki(e){return ao(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ge(ee.FAILED_PRECONDITION,uf)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ao(e).put("owner",t)}static D(){return Si.D()}bi(e){const t=ao(e);return t.get("owner").next(n=>this.vi(n)?(he("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):q.resolve())}Mi(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Wt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;f1()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const n=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return he("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Wt("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Wt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ao(r){return tr(r,"owner")}function Zc(r){return tr(r,"clientMetadata")}function U_(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=qe(),i=qe();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new qh(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return f1()?8:N1(kl())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new yA;return this.Xi(e,t,a).next(o=>{if(s.result=o,this.zi)return this.es(e,t,a,o.size)})}).next(()=>s.result)}es(e,t,n,i){return n.documentReadCount<this.ji?(Zs()<=tt.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",ea(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),q.resolve()):(Zs()<=tt.DEBUG&&he("QueryEngine","Query:",ea(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Zs()<=tt.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",ea(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jr(t))):q.resolve())}Yi(e,t){if(Dm(t))return q.resolve(null);let n=Jr(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Dl(t,null,"F"),n=Jr(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=qe(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ts(t,o);return this.ns(t,l,a,c.readTime)?this.Yi(e,Dl(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,n,i){return Dm(t)||i.isEqual(De.min())?q.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(t,s);return this.ns(t,a,n,i)?q.resolve(null):(Zs()<=tt.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ea(t)),this.rs(e,a,t,R1(i,-1)).next(o=>o))})}ts(e,t){let n=new gt(t_(e));return t.forEach((i,s)=>{mc(e,s)&&(n=n.add(s))}),n}ns(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,n){return Zs()<=tt.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",ea(t)),this.Ji.getDocumentsMatchingQuery(e,t,en.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new wt(Ge),this._s=new Gi(s=>gs(s),hc),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new V_(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function W_(r,e,t,n){return new wA(r,e,t,n)}async function z_(r,e){const t=be(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let c=qe();for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(n,c).next(l=>({hs:l,removedBatchIds:a,addedBatchIds:o}))})})}function EA(r,e){const t=be(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(o,c,l,u){const h=l.batch,d=h.keys();let m=q.resolve();return d.forEach(g=>{m=m.next(()=>u.getEntry(c,g)).next(p=>{const x=l.docVersions.get(g);Re(x!==null),p.version.compareTo(x)<0&&(h.applyToRemoteDocument(p,l),p.isValidDocument()&&(p.setReadTime(l.commitVersion),u.addEntry(p)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=qe();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function H_(r){const e=be(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function TA(r,e){const t=be(r),n=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const o=[];e.targetChanges.forEach((u,h)=>{const d=i.get(h);if(!d)return;o.push(t.Ur.removeMatchingKeys(s,u.removedDocuments,h).next(()=>t.Ur.addMatchingKeys(s,u.addedDocuments,h)));let m=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Ht.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,n)),i=i.insert(h,m),function(p,x,T){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,m,u)&&o.push(t.Ur.updateTargetData(s,m))});let c=Yr(),l=qe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(AA(s,a,e.documentUpdates).next(u=>{c=u.Ps,l=u.Is})),!n.isEqual(De.min())){const u=t.Ur.getLastRemoteSnapshotVersion(s).next(h=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(u)}return q.waitFor(o).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.os=i,s))}function AA(r,e,t){let n=qe(),i=qe();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let a=Yr();return t.forEach((o,c)=>{const l=s.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(De.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):he("LocalStore","Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{Ps:a,Is:i}})}function SA(r,e){const t=be(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Ll(r,e){const t=be(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Ur.getTargetData(n,e).next(s=>s?(i=s,q.resolve(i)):t.Ur.allocateTargetId(n).next(a=>(i=new Qn(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(n.targetId,n),t._s.set(e,n.targetId)),n})}async function ka(r,e,t){const n=be(r),i=n.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Bi(a))throw a;he("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function ih(r,e,t){const n=be(r);let i=De.min(),s=qe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,l,u){const h=be(c),d=h._s.get(u);return d!==void 0?q.resolve(h.os.get(d)):h.Ur.getTargetData(l,u)}(n,a,Jr(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,t?i:De.min(),t?s:qe())).next(o=>(K_(n,e_(e),o),{documents:o,Ts:s})))}function j_(r,e){const t=be(r),n=be(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.ot(s,e).next(a=>a?a.target:null))}function $_(r,e){const t=be(r),n=t.us.get(e)||De.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,R1(n,-1),Number.MAX_SAFE_INTEGER)).then(i=>(K_(t,e,i),i))}function K_(r,e,t){let n=r.us.get(e)||De.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.us.set(e,n)}function op(r,e){return`firestore_clients_${r}_${e}`}function cp(r,e,t){let n=`firestore_mutations_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function ff(r,e){return`firestore_targets_${r}_${e}`}class Ml{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Rs(e,t,n){const i=JSON.parse(n);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new ge(i.error.code,i.error.message))),a?new Ml(e,t,i.state,s):(Wt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Eo{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Rs(e,t){const n=JSON.parse(t);let i,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(i=new ge(n.error.code,n.error.message))),s?new Eo(e,n.state,i):(Wt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Vl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,s=Lh();for(let a=0;i&&a<n.activeTargetIds.length;++a)i=O1(n.activeTargetIds[a]),s=s.add(n.activeTargetIds[a]);return i?new Vl(e,s):(Wt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Xh{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Xh(t.clientId,t.onlineState):(Wt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class sh{constructor(){this.activeTargetIds=Lh()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hf{constructor(e,t,n,i,s){this.window=e,this.ui=t,this.persistenceKey=n,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new wt(Ge),this.started=!1,this.bs=[];const a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=op(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new sh),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const n of e){if(n===this.ps)continue;const i=this.getItem(op(this.persistenceKey,n));if(i){const s=Vl.Rs(n,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const n=this.Ls(t);n&&this.Bs(n)}for(const n of this.bs)this.ws(n);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,n){this.qs(e,t,n),this.Qs(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(ff(this.persistenceKey,e));if(i){const s=Eo.Rs(e,i);s&&(n=s.state)}}return t&&this.Ks.fs(e),this.Ns(),n}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ff(this.persistenceKey,e))}updateQueryState(e,t,n){this.$s(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return he("SharedClientState","READ",e,t),t}setItem(e,t){he("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){he("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(he("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Wt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const n=this.Gs(t.key);return this.zs(n,null)}{const n=this.js(t.key,t.newValue);if(n)return this.zs(n.clientId,n)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const n=this.Hs(t.key,t.newValue);if(n)return this.Js(n)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const n=this.Ys(t.key,t.newValue);if(n)return this.Zs(n)}}else if(t.key===this.xs){if(t.newValue!==null){const n=this.Ls(t.newValue);if(n)return this.Bs(n)}}else if(t.key===this.vs){const n=function(s){let a=Vr.oe;if(s!=null)try{const o=JSON.parse(s);Re(typeof o=="number"),a=o}catch(o){Wt("SharedClientState","Failed to read sequence number from WebStorage",o)}return a}(t.newValue);n!==Vr.oe&&this.sequenceNumberHandler(n)}else if(t.key===this.Os){const n=this.Xs(t.newValue);await Promise.all(n.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,n){const i=new Ml(this.currentUser,e,t,n),s=cp(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const t=cp(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,n){const i=ff(this.persistenceKey,e),s=new Eo(e,t,n);this.setItem(i,s.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const n=this.Gs(e);return Vl.Rs(n,t)}Hs(e,t){const n=this.Fs.exec(e),i=Number(n[1]),s=n[2]!==void 0?n[2]:null;return Ml.Rs(new yr(s),i,t)}Ys(e,t){const n=this.Ms.exec(e),i=Number(n[1]);return Eo.Rs(i,t)}Ls(e){return Xh.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);he("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const n=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(n),a=[],o=[];return s.forEach(c=>{i.has(c)||a.push(c)}),i.forEach(c=>{s.has(c)||o.push(c)}),this.syncEngine.io(a,o).then(()=>{this.Ss=n})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Lh();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class q_{constructor(){this.so=new sh,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new sh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){he("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){he("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let el=null;function df(){return el===null?el=function(){return 268435456+Math.round(2147483648*Math.random())}():el++,"0x"+el.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr="WebChannelConnection";class bA extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,n,i,s,a){const o=df(),c=this.xo(t,n.toUriEncodedString());he("RestConnection",`Sending RPC '${t}' ${o}:`,c,i);const l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,a),this.No(t,c,l,i).then(u=>(he("RestConnection",`Received RPC '${t}' ${o}: `,u),u),u=>{throw Oo("RestConnection",`RPC '${t}' ${o} failed with error: `,u,"url: ",c,"request:",i),u})}Lo(t,n,i,s,a,o){return this.Mo(t,n,i,s,a)}Oo(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Oa}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,n){const i=kA[t];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){const s=df();return new Promise((a,o)=>{const c=new T1;c.setWithCredentials(!0),c.listenOnce(A1.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case pl.NO_ERROR:const u=c.getResponseJson();he(xr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),a(u);break;case pl.TIMEOUT:he(xr,`RPC '${e}' ${s} timed out`),o(new ge(ee.DEADLINE_EXCEEDED,"Request time out"));break;case pl.HTTP_ERROR:const h=c.getStatus();if(he(xr,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);const m=d==null?void 0:d.error;if(m&&m.status&&m.message){const g=function(x){const T=x.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(T)>=0?T:ee.UNKNOWN}(m.status);o(new ge(g,m.message))}else o(new ge(ee.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new ge(ee.UNAVAILABLE,"Connection failed."));break;default:Ce()}}finally{he(xr,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);he(xr,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,n,15)})}Bo(e,t,n){const i=df(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=k1(),o=I1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const u=s.join("");he(xr,`Creating RPC '${e}' stream ${i}: ${u}`,c);const h=a.createWebChannel(u,c);let d=!1,m=!1;const g=new CA({Io:x=>{m?he(xr,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(d||(he(xr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),he(xr,`RPC '${e}' stream ${i} sending:`,x),h.send(x))},To:()=>h.close()}),p=(x,T,b)=>{x.listen(T,E=>{try{b(E)}catch(F){setTimeout(()=>{throw F},0)}})};return p(h,lo.EventType.OPEN,()=>{m||(he(xr,`RPC '${e}' stream ${i} transport opened.`),g.yo())}),p(h,lo.EventType.CLOSE,()=>{m||(m=!0,he(xr,`RPC '${e}' stream ${i} transport closed`),g.So())}),p(h,lo.EventType.ERROR,x=>{m||(m=!0,Oo(xr,`RPC '${e}' stream ${i} transport errored:`,x),g.So(new ge(ee.UNAVAILABLE,"The operation could not be completed")))}),p(h,lo.EventType.MESSAGE,x=>{var T;if(!m){const b=x.data[0];Re(!!b);const E=b,F=E.error||((T=E[0])===null||T===void 0?void 0:T.error);if(F){he(xr,`RPC '${e}' stream ${i} received error:`,F);const M=F.status;let O=function(v){const S=qt[v];if(S!==void 0)return m_(S)}(M),y=F.message;O===void 0&&(O=ee.INTERNAL,y="Unknown error status: "+M+" with message "+F.message),m=!0,g.So(new ge(O,y)),h.close()}else he(xr,`RPC '${e}' stream ${i} received:`,b),g.bo(b)}}),p(o,S1.STAT_EVENT,x=>{x.stat===Wf.PROXY?he(xr,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Wf.NOPROXY&&he(xr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(){return typeof window<"u"?window:null}function El(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(r){return new OT(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&he("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e,t,n,i,s,a,o,c){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Qh(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(Wt(t.toString()),Wt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===t&&this.P_(n,i)},n=>{e(()=>{const i=new ge(ee.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return he("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(he("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RA extends Q_{constructor(e,t,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=BT(this.serializer,e),n=function(s){if(!("targetChange"in s))return De.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?De.min():a.readTime?cr(a.readTime):De.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Zf(this.serializer),t.addTarget=function(s,a){let o;const c=a.target;if(o=Rl(c)?{documents:E_(s,c)}:{query:T_(s,c)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=__(s,a.resumeToken);const l=Yf(s,a.expectedCount);l!==null&&(o.expectedCount=l)}else if(a.snapshotVersion.compareTo(De.min())>0){o.readTime=Ia(s,a.snapshotVersion.toTimestamp());const l=Yf(s,a.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=GT(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Zf(this.serializer),t.removeTarget=e,this.a_(t)}}class FA extends Q_{constructor(e,t,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Re(!!e.streamToken),this.lastStreamToken=e.streamToken,Re(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Re(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=UT(e.writeResults,e.commitTime),n=cr(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Zf(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Ho(this.serializer,n))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ge(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Jf(t,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ge(ee.UNKNOWN,s.toString())})}Lo(e,t,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Jf(t,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ge(ee.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class PA{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Wt(t),this.D_=!1):he("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Fs(this)&&(he("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=be(c);l.L_.add(4),await xc(l),l.q_.set("Unknown"),l.L_.delete(4),await Eu(l)}(this))})}),this.q_=new PA(n,i)}}async function Eu(r){if(Fs(r))for(const e of r.B_)await e(!0)}async function xc(r){for(const e of r.B_)await e(!1)}function Tu(r,e){const t=be(r);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Zh(t)?Jh(t):Va(t).r_()&&Yh(t,e))}function Ca(r,e){const t=be(r),n=Va(t);t.N_.delete(e),n.r_()&&Y_(t,e),t.N_.size===0&&(n.r_()?n.o_():Fs(t)&&t.q_.set("Unknown"))}function Yh(r,e){if(r.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Va(r).A_(e)}function Y_(r,e){r.Q_.xe(e),Va(r).R_(e)}function Jh(r){r.Q_=new FT({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>r.N_.get(e)||null,tt:()=>r.datastore.serializer.databaseId}),Va(r).start(),r.q_.v_()}function Zh(r){return Fs(r)&&!Va(r).n_()&&r.N_.size>0}function Fs(r){return be(r).L_.size===0}function J_(r){r.Q_=void 0}async function OA(r){r.q_.set("Online")}async function LA(r){r.N_.forEach((e,t)=>{Yh(r,e)})}async function MA(r,e){J_(r),Zh(r)?(r.q_.M_(e),Jh(r)):r.q_.set("Unknown")}async function VA(r,e,t){if(r.q_.set("Online"),e instanceof g_&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(r,e)}catch(n){he("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Bl(r,n)}else if(e instanceof wl?r.Q_.Ke(e):e instanceof p_?r.Q_.He(e):r.Q_.We(e),!t.isEqual(De.min()))try{const n=await H_(r.localStore);t.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.N_.get(l);u&&s.N_.set(l,u.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,l)=>{const u=s.N_.get(c);if(!u)return;s.N_.set(c,u.withResumeToken(Ht.EMPTY_BYTE_STRING,u.snapshotVersion)),Y_(s,c);const h=new Qn(u.target,c,l,u.sequenceNumber);Yh(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(r,t)}catch(n){he("RemoteStore","Failed to raise snapshot:",n),await Bl(r,n)}}async function Bl(r,e,t){if(!Bi(e))throw e;r.L_.add(1),await xc(r),r.q_.set("Offline"),t||(t=()=>H_(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{he("RemoteStore","Retrying IndexedDB access"),await t(),r.L_.delete(1),await Eu(r)})}function Z_(r,e){return e().catch(t=>Bl(r,t,e))}async function Ma(r){const e=be(r),t=Ri(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;BA(e);)try{const i=await SA(e.localStore,n);if(i===null){e.O_.length===0&&t.o_();break}n=i.batchId,UA(e,i)}catch(i){await Bl(e,i)}ex(e)&&tx(e)}function BA(r){return Fs(r)&&r.O_.length<10}function UA(r,e){r.O_.push(e);const t=Ri(r);t.r_()&&t.V_&&t.m_(e.mutations)}function ex(r){return Fs(r)&&!Ri(r).n_()&&r.O_.length>0}function tx(r){Ri(r).start()}async function GA(r){Ri(r).p_()}async function WA(r){const e=Ri(r);for(const t of r.O_)e.m_(t.mutations)}async function zA(r,e,t){const n=r.O_.shift(),i=Uh.from(n,e,t);await Z_(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await Ma(r)}async function HA(r,e){e&&Ri(r).V_&&await async function(n,i){if(function(a){return d_(a)&&a!==ee.ABORTED}(i.code)){const s=n.O_.shift();Ri(n).s_(),await Z_(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ma(n)}}(r,e),ex(r)&&tx(r)}async function up(r,e){const t=be(r);t.asyncQueue.verifyOperationInProgress(),he("RemoteStore","RemoteStore received new credentials");const n=Fs(t);t.L_.add(3),await xc(t),n&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Eu(t)}async function ah(r,e){const t=be(r);e?(t.L_.delete(2),await Eu(t)):e||(t.L_.add(2),await xc(t),t.q_.set("Unknown"))}function Va(r){return r.K_||(r.K_=function(t,n,i){const s=be(t);return s.w_(),new RA(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Eo:OA.bind(null,r),Ro:LA.bind(null,r),mo:MA.bind(null,r),d_:VA.bind(null,r)}),r.B_.push(async e=>{e?(r.K_.s_(),Zh(r)?Jh(r):r.q_.set("Unknown")):(await r.K_.stop(),J_(r))})),r.K_}function Ri(r){return r.U_||(r.U_=function(t,n,i){const s=be(t);return s.w_(),new FA(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Eo:()=>Promise.resolve(),Ro:GA.bind(null,r),mo:HA.bind(null,r),f_:WA.bind(null,r),g_:zA.bind(null,r)}),r.B_.push(async e=>{e?(r.U_.s_(),await Ma(r)):(await r.U_.stop(),r.O_.length>0&&(he("RemoteStore",`Stopping write stream with ${r.O_.length} pending writes`),r.O_=[]))})),r.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new vn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const a=Date.now()+n,o=new e0(e,t,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function t0(r,e){if(Wt("AsyncQueue",`${e}: ${r}`),Bi(r))return new ge(ee.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Se.comparator(t.key,n.key):(t,n)=>Se.comparator(t.key,n.key),this.keyedMap=uo(),this.sortedSet=new wt(this.comparator)}static emptySet(e){return new ua(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ua)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new ua;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(){this.W_=new wt(Se.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(t,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(t):e.type===1&&n.type===2?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ce():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class ba{constructor(e,t,n,i,s,a,o,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,s){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new ba(e,t,ua.emptySet(t),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class $A{constructor(){this.queries=hp(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,n){const i=be(t),s=i.queries;i.queries=hp(),s.forEach((a,o)=>{for(const c of o.j_)c.onError(n)})})(this,new ge(ee.ABORTED,"Firestore shutting down"))}}function hp(){return new Gi(r=>Z1(r),mu)}async function r0(r,e){const t=be(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new jA,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=t0(a,`Initialization of query '${ea(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&i0(t)}async function n0(r,e){const t=be(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function KA(r,e){const t=be(r);let n=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&i0(t)}function qA(r,e,t){const n=be(r),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(t);n.queries.delete(e)}function i0(r){r.Y_.forEach(e=>{e.next()})}var oh,dp;(dp=oh||(oh={})).ea="default",dp.Cache="cache";class s0{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ba(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const n=t!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ba.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==oh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e){this.key=e}}class nx{constructor(e){this.key=e}}class XA{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=qe(),this.mutatedKeys=qe(),this.Aa=t_(e),this.Ra=new ua(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new fp,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const d=i.get(u),m=mc(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),p=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;d&&m?d.data.isEqual(m.data)?g!==p&&(n.track({type:3,doc:m}),x=!0):this.ga(d,m)||(n.track({type:2,doc:m}),x=!0,(c&&this.Aa(m,c)>0||l&&this.Aa(m,l)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),x=!0):d&&!m&&(n.track({type:1,doc:d}),x=!0,(c||l)&&(o=!0)),x&&(m?(a=a.add(m),s=p?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,h)=>function(m,g){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce()}};return p(m)-p(g)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,a.length!==0||l?{snapshot:new ba(this.query,e.Ra,s,a,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new fp,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=qe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const t=[];return e.forEach(n=>{this.da.has(n)||t.push(new nx(n))}),this.da.forEach(n=>{e.has(n)||t.push(new rx(n))}),t}ba(e){this.Ta=e.Ts,this.da=qe();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ba.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class QA{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class YA{constructor(e){this.key=e,this.va=!1}}class JA{constructor(e,t,n,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Gi(o=>Z1(o),mu),this.Ma=new Map,this.xa=new Set,this.Oa=new wt(Se.comparator),this.Na=new Map,this.La=new $h,this.Ba={},this.ka=new Map,this.qa=ys.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function ZA(r,e,t=!0){const n=Au(r);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await ix(n,e,t,!0),i}async function eS(r,e){const t=Au(r);await ix(t,e,!0,!1)}async function ix(r,e,t,n){const i=await Ll(r.localStore,Jr(e)),s=i.targetId,a=r.sharedClientState.addLocalQueryTarget(s,t);let o;return n&&(o=await a0(r,e,s,a==="current",i.resumeToken)),r.isPrimaryClient&&t&&Tu(r.remoteStore,i),o}async function a0(r,e,t,n,i){r.Ka=(h,d,m)=>async function(p,x,T,b){let E=x.view.ma(T);E.ns&&(E=await ih(p.localStore,x.query,!1).then(({documents:y})=>x.view.ma(y,E)));const F=b&&b.targetChanges.get(x.targetId),M=b&&b.targetMismatches.get(x.targetId)!=null,O=x.view.applyChanges(E,p.isPrimaryClient,F,M);return ch(p,x.targetId,O.wa),O.snapshot}(r,h,d,m);const s=await ih(r.localStore,e,!0),a=new XA(e,s.Ts),o=a.ma(s.documents),c=_c.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),l=a.applyChanges(o,r.isPrimaryClient,c);ch(r,t,l.wa);const u=new QA(e,t,a);return r.Fa.set(e,u),r.Ma.has(t)?r.Ma.get(t).push(e):r.Ma.set(t,[e]),l.snapshot}async function tS(r,e,t){const n=be(r),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!mu(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await ka(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Ca(n.remoteStore,i.targetId),Ra(n,i.targetId)}).catch(Vi)):(Ra(n,i.targetId),await ka(n.localStore,i.targetId,!0))}async function rS(r,e){const t=be(r),n=t.Fa.get(e),i=t.Ma.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Ca(t.remoteStore,n.targetId))}async function nS(r,e,t){const n=u0(r);try{const i=await function(a,o){const c=be(a),l=Nt.now(),u=o.reduce((m,g)=>m.add(g.key),qe());let h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Yr(),p=qe();return c.cs.getEntries(m,u).next(x=>{g=x,g.forEach((T,b)=>{b.isValidDocument()||(p=p.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(x=>{h=x;const T=[];for(const b of o){const E=kT(b,h.get(b.key).overlayedDocument);E!=null&&T.push(new ni(b.key,E,H1(E.value.mapValue),zt.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,T,o)}).next(x=>{d=x;const T=x.applyToLocalDocumentSet(h,p);return c.documentOverlayCache.saveOverlays(m,x.batchId,T)})}).then(()=>({batchId:d.batchId,changes:n_(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let l=a.Ba[a.currentUser.toKey()];l||(l=new wt(Ge)),l=l.insert(o,c),a.Ba[a.currentUser.toKey()]=l}(n,i.batchId,t),await Wi(n,i.changes),await Ma(n.remoteStore)}catch(i){const s=t0(i,"Failed to persist write");t.reject(s)}}async function sx(r,e){const t=be(r);try{const n=await TA(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.Na.get(s);a&&(Re(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Re(a.va):i.removedDocuments.size>0&&(Re(a.va),a.va=!1))}),await Wi(t,n,e)}catch(n){await Vi(n)}}function mp(r,e,t){const n=be(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const c=be(a);c.onlineState=o;let l=!1;c.queries.forEach((u,h)=>{for(const d of h.j_)d.Z_(o)&&(l=!0)}),l&&i0(c)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function iS(r,e,t){const n=be(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new wt(Se.comparator);a=a.insert(s,Ft.newNoDocument(s,De.min()));const o=qe().add(s),c=new gc(De.min(),new Map,new wt(Ge),a,o);await sx(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),l0(n)}else await ka(n.localStore,e,!1).then(()=>Ra(n,e,t)).catch(Vi)}async function sS(r,e){const t=be(r),n=e.batch.batchId;try{const i=await EA(t.localStore,e);c0(t,n,null),o0(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Wi(t,i)}catch(i){await Vi(i)}}async function aS(r,e,t){const n=be(r);try{const i=await function(a,o){const c=be(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,o).next(h=>(Re(h!==null),u=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(n.localStore,e);c0(n,e,t),o0(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Wi(n,i)}catch(i){await Vi(i)}}function o0(r,e){(r.ka.get(e)||[]).forEach(t=>{t.resolve()}),r.ka.delete(e)}function c0(r,e,t){const n=be(r);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Ra(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Ma.get(e))r.Fa.delete(n),t&&r.Ca.$a(n,t);r.Ma.delete(e),r.isPrimaryClient&&r.La.gr(e).forEach(n=>{r.La.containsKey(n)||ax(r,n)})}function ax(r,e){r.xa.delete(e.path.canonicalString());const t=r.Oa.get(e);t!==null&&(Ca(r.remoteStore,t),r.Oa=r.Oa.remove(e),r.Na.delete(t),l0(r))}function ch(r,e,t){for(const n of t)n instanceof rx?(r.La.addReference(n.key,e),oS(r,n)):n instanceof nx?(he("SyncEngine","Document no longer in limbo: "+n.key),r.La.removeReference(n.key,e),r.La.containsKey(n.key)||ax(r,n.key)):Ce()}function oS(r,e){const t=e.key,n=t.path.canonicalString();r.Oa.get(t)||r.xa.has(n)||(he("SyncEngine","New document in limbo: "+t),r.xa.add(n),l0(r))}function l0(r){for(;r.xa.size>0&&r.Oa.size<r.maxConcurrentLimboResolutions;){const e=r.xa.values().next().value;r.xa.delete(e);const t=new Se(nt.fromString(e)),n=r.qa.next();r.Na.set(n,new YA(t)),r.Oa=r.Oa.insert(t,n),Tu(r.remoteStore,new Qn(Jr(dc(t.path)),n,"TargetPurposeLimboResolution",Vr.oe))}}async function Wi(r,e,t){const n=be(r),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,c)=>{a.push(n.Ka(c,e,t).then(l=>{var u;if((l||t)&&n.isPrimaryClient){const h=l?!l.fromCache:(u=t==null?void 0:t.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){i.push(l);const h=qh.Wi(c.targetId,l);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(c,l){const u=be(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>q.forEach(l,d=>q.forEach(d.$i,m=>u.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>q.forEach(d.Ui,m=>u.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!Bi(h))throw h;he("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const d=h.targetId;if(!h.fromCache){const m=u.os.get(d),g=m.snapshotVersion,p=m.withLastLimboFreeSnapshotVersion(g);u.os=u.os.insert(d,p)}}}(n.localStore,s))}async function cS(r,e){const t=be(r);if(!t.currentUser.isEqual(e)){he("SyncEngine","User change. New user:",e.toKey());const n=await z_(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(c=>{c.reject(new ge(ee.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Wi(t,n.hs)}}function lS(r,e){const t=be(r),n=t.Na.get(e);if(n&&n.va)return qe().add(n.key);{let i=qe();const s=t.Ma.get(e);if(!s)return i;for(const a of s){const o=t.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}async function uS(r,e){const t=be(r),n=await ih(t.localStore,e.query,!0),i=e.view.ba(n);return t.isPrimaryClient&&ch(t,e.targetId,i.wa),i}async function fS(r,e){const t=be(r);return $_(t.localStore,e).then(n=>Wi(t,n))}async function hS(r,e,t,n){const i=be(r),s=await function(o,c){const l=be(o),u=be(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.Mn(h,c).next(d=>d?l.localDocuments.getDocuments(h,d):q.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await Ma(i.remoteStore):t==="acknowledged"||t==="rejected"?(c0(i,e,n||null),o0(i,e),function(o,c){be(be(o).mutationQueue).On(c)}(i.localStore,e)):Ce(),await Wi(i,s)):he("SyncEngine","Cannot apply mutation batch with id: "+e)}async function dS(r,e){const t=be(r);if(Au(t),u0(t),e===!0&&t.Qa!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await pp(t,n.toArray());t.Qa=!0,await ah(t.remoteStore,!0);for(const s of i)Tu(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){const n=[];let i=Promise.resolve();t.Ma.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?n.push(a):i=i.then(()=>(Ra(t,a),ka(t.localStore,a,!0))),Ca(t.remoteStore,a)}),await i,await pp(t,n),function(a){const o=be(a);o.Na.forEach((c,l)=>{Ca(o.remoteStore,l)}),o.La.pr(),o.Na=new Map,o.Oa=new wt(Se.comparator)}(t),t.Qa=!1,await ah(t.remoteStore,!1)}}async function pp(r,e,t){const n=be(r),i=[],s=[];for(const a of e){let o;const c=n.Ma.get(a);if(c&&c.length!==0){o=await Ll(n.localStore,Jr(c[0]));for(const l of c){const u=n.Fa.get(l),h=await uS(n,u);h.snapshot&&s.push(h.snapshot)}}else{const l=await j_(n.localStore,a);o=await Ll(n.localStore,l),await a0(n,ox(l),a,!1,o.resumeToken)}i.push(o)}return n.Ca.d_(s),i}function ox(r){return J1(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function mS(r){return function(t){return be(be(t).persistence).Qi()}(be(r).localStore)}async function pS(r,e,t,n){const i=be(r);if(i.Qa)return void he("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=await $_(i.localStore,e_(s[0])),o=gc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ht.EMPTY_BYTE_STRING);await Wi(i,a,o);break}case"rejected":await ka(i.localStore,e,!0),Ra(i,e,n);break;default:Ce()}}async function gS(r,e,t){const n=Au(r);if(n.Qa){for(const i of e){if(n.Ma.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){he("SyncEngine","Adding an already active target "+i);continue}const s=await j_(n.localStore,i),a=await Ll(n.localStore,s);await a0(n,ox(s),a.targetId,!1,a.resumeToken),Tu(n.remoteStore,a)}for(const i of t)n.Ma.has(i)&&await ka(n.localStore,i,!1).then(()=>{Ca(n.remoteStore,i),Ra(n,i)}).catch(Vi)}}function Au(r){const e=be(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=sx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lS.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=iS.bind(null,e),e.Ca.d_=KA.bind(null,e.eventManager),e.Ca.$a=qA.bind(null,e.eventManager),e}function u0(r){const e=be(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sS.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aS.bind(null,e),e}class jo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return W_(this.persistence,new G_,e.initialUser,this.serializer)}Ga(e){return new B_(yu.Zr,this.serializer)}Wa(e){return new q_}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jo.provider={build:()=>new jo};class cx extends jo{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await u0(this.Ja.syncEngine),await Ma(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return W_(this.persistence,new G_,e.initialUser,this.serializer)}ja(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new iA(n,e.asyncQueue,t)}Ha(e,t){const n=new V2(t,this.persistence);return new M2(e.asyncQueue,n)}Ga(e){const t=U_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new Kh(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,X_(),El(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new q_}}class _S extends cx{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof hf&&(this.sharedClientState.syncEngine={no:hS.bind(null,t),ro:pS.bind(null,t),io:gS.bind(null,t),Qi:mS.bind(null,t),eo:fS.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async n=>{await dS(this.Ja.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}Wa(e){const t=X_();if(!hf.D(t))throw new ge(ee.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=U_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new hf(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class $o{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>mp(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=cS.bind(null,this.syncEngine),await ah(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $A}()}createDatastore(e){const t=wu(e.databaseInfo.databaseId),n=function(s){return new bA(s)}(e.databaseInfo);return function(s,a,o,c){return new DA(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,a,o){return new NA(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>mp(this.syncEngine,t,0),function(){return lp.D()?new lp:new IA}())}createSyncEngine(e,t){return function(i,s,a,o,c,l,u){const h=new JA(i,s,a,o,c,l);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=be(i);he("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await xc(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}$o.provider={build:()=>new $o};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Wt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ge(ee.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const a=be(i),o={documents:s.map(h=>zo(a.serializer,h))},c=await a.Lo("BatchGetDocuments",a.serializer.databaseId,nt.emptyPath(),o,s.length),l=new Map;c.forEach(h=>{const d=VT(a.serializer,h);l.set(d.key.toString(),d)});const u=[];return s.forEach(h=>{const d=l.get(h.toString());Re(!!d),u.push(d)}),u}(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new pc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{const i=Se.fromPath(n);this.mutations.push(new Vh(i,this.precondition(i)))}),await async function(n,i){const s=be(n),a={writes:i.map(o=>Ho(s.serializer,o))};await s.Mo("Commit",s.serializer.databaseId,nt.emptyPath(),a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ce();t=De.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new ge(ee.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(De.min())?zt.exists(!1):zt.updateTime(t):zt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(De.min()))throw new ge(ee.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return zt.updateTime(t)}return zt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(e,t,n,i,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=s,this._u=n.maxAttempts,this.t_=new Qh(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new xS(this.datastore),t=this.cu(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(i=>{this.lu(i)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const t=this.updateFunction(e);return!fc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!d_(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=yr.UNAUTHENTICATED,this.clientId=C1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{he("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(he("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=t0(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function mf(r,e){r.asyncQueue.verifyOperationInProgress(),he("FirestoreClient","Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await z_(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function gp(r,e){r.asyncQueue.verifyOperationInProgress();const t=await wS(r);he("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>up(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>up(e.remoteStore,i)),r._onlineComponents=e}async function wS(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){he("FirestoreClient","Using user provided OfflineComponentProvider");try{await mf(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===ee.FAILED_PRECONDITION||i.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Oo("Error using user provided cache. Falling back to memory cache: "+t),await mf(r,new jo)}}else he("FirestoreClient","Using default OfflineComponentProvider"),await mf(r,new jo);return r._offlineComponents}async function h0(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(he("FirestoreClient","Using user provided OnlineComponentProvider"),await gp(r,r._uninitializedComponentsProvider._online)):(he("FirestoreClient","Using default OnlineComponentProvider"),await gp(r,new $o))),r._onlineComponents}function ES(r){return h0(r).then(e=>e.syncEngine)}function TS(r){return h0(r).then(e=>e.datastore)}async function Ul(r){const e=await h0(r),t=e.eventManager;return t.onListen=ZA.bind(null,e.syncEngine),t.onUnlisten=tS.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=eS.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=rS.bind(null,e.syncEngine),t}function AS(r,e,t={}){const n=new vn;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,l){const u=new f0({next:d=>{u.Za(),a.enqueueAndForget(()=>n0(s,h));const m=d.docs.has(o);!m&&d.fromCache?l.reject(new ge(ee.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&c&&c.source==="server"?l.reject(new ge(ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new s0(dc(o.path),u,{includeMetadataChanges:!0,_a:!0});return r0(s,h)}(await Ul(r),r.asyncQueue,e,t,n)),n.promise}function SS(r,e,t={}){const n=new vn;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,l){const u=new f0({next:d=>{u.Za(),a.enqueueAndForget(()=>n0(s,h)),d.fromCache&&c.source==="server"?l.reject(new ge(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new s0(o,u,{includeMetadataChanges:!0,_a:!0});return r0(s,h)}(await Ul(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lx(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(r,e,t){if(!t)throw new ge(ee.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function IS(r,e,t,n){if(e===!0&&n===!0)throw new ge(ee.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function xp(r){if(!Se.isDocumentKey(r))throw new ge(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function vp(r){if(Se.isDocumentKey(r))throw new ge(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Su(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ce()}function yn(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new ge(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Su(r);throw new ge(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function kS(r,e){if(e<=0)throw new ge(ee.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lx((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ge(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ge(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ge(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class d0{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yp({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yp(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new k2;switch(n.type){case"firstParty":return new R2(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ge(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=_p.get(t);n&&(he("ComponentProvider","Removing Datastore"),_p.delete(t),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Tn(this.firestore,e,this._query)}}class Sr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ii(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sr(this.firestore,e,this._key)}}class Ii extends Tn{constructor(e,t,n){super(e,t,dc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Sr(this.firestore,null,new Se(e))}withConverter(e){return new Ii(this.firestore,e,this._path)}}function Ir(r,e,...t){if(r=Gr(r),ux("collection","path",e),r instanceof d0){const n=nt.fromString(e,...t);return vp(n),new Ii(r,null,n)}{if(!(r instanceof Sr||r instanceof Ii))throw new ge(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(nt.fromString(e,...t));return vp(n),new Ii(r.firestore,null,n)}}function Gt(r,e,...t){if(r=Gr(r),arguments.length===1&&(e=C1.newId()),ux("doc","path",e),r instanceof d0){const n=nt.fromString(e,...t);return xp(n),new Sr(r,null,new Se(n))}{if(!(r instanceof Sr||r instanceof Ii))throw new ge(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(nt.fromString(e,...t));return xp(n),new Sr(r.firestore,r instanceof Ii?r.converter:null,new Se(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Qh(this,"async_queue_retry"),this.Vu=()=>{const n=El();n&&he("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const t=El();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=El();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new vn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Bi(e))throw e;he("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Wt("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=e0.createAndSchedule(this,e,t,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Ce()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Ep(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class Fi extends d0{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new wp,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new wp(e),this._firestoreClient=void 0,await e}}}function CS(r,e,t){t||(t="(default)");const n=_1(r,"firestore");if(n.isInitialized(t)){const i=n.getImmediate({identifier:t}),s=n.getOptions(t);if(Do(s,e))return i;throw new ge(ee.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ge(ee.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return n.initialize({options:e,instanceIdentifier:t})}function Ba(r){if(r._terminated)throw new ge(ee.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||bS(r),r._firestoreClient}function bS(r){var e,t,n;const i=r._freezeSettings(),s=function(o,c,l,u){return new sT(o,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,lx(u.experimentalLongPollingOptions),u.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new yS(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ws(Ht.fromBase64String(e))}catch(t){throw new ge(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ws(Ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ge(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ge(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ge(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=/^__.*__$/;class FS{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new ni(e,this.data,this.fieldMask,t,this.fieldTransforms):new La(e,this.data,t,this.fieldTransforms)}}class fx{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ni(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hx(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce()}}class Iu{constructor(e,t,n,i,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Iu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Gl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(hx(this.Cu)&&RS.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class DS{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||wu(e)}Qu(e,t,n,i=!1){return new Iu({Cu:e,methodName:t,qu:n,path:Dt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yc(r){const e=r._freezeSettings(),t=wu(r._databaseId);return new DS(r._databaseId,!!e.ignoreUndefinedProperties,t)}function g0(r,e,t,n,i,s={}){const a=r.Qu(s.merge||s.mergeFields?2:0,e,t,i);y0("Data must be an object, but it was:",a,n);const o=gx(n,a);let c,l;if(s.merge)c=new Br(a.fieldMask),l=a.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=lh(e,h,t);if(!a.contains(d))throw new ge(ee.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);xx(u,d)||u.push(d)}c=new Br(u),l=a.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=a.fieldTransforms;return new FS(new mr(o),c,l)}class ku extends Ua{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ku}}function PS(r,e,t){return new Iu({Cu:3,qu:e.settings.qu,methodName:r._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class _0 extends Ua{_toFieldTransform(e){return new gu(e.path,new Ta)}isEqual(e){return e instanceof _0}}class x0 extends Ua{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=PS(this,e,!0),n=this.Ku.map(s=>Ga(s,t)),i=new _s(n);return new gu(e.path,i)}isEqual(e){return e instanceof x0&&Do(this.Ku,e.Ku)}}class v0 extends Ua{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Sa(e.serializer,a_(e.serializer,this.$u));return new gu(e.path,t)}isEqual(e){return e instanceof v0&&this.$u===e.$u}}function dx(r,e,t,n){const i=r.Qu(1,e,t);y0("Data must be an object, but it was:",i,n);const s=[],a=mr.empty();Rs(n,(c,l)=>{const u=w0(e,c,t);l=Gr(l);const h=i.Nu(u);if(l instanceof ku)s.push(u);else{const d=Ga(l,h);d!=null&&(s.push(u),a.set(u,d))}});const o=new Br(s);return new fx(a,o,i.fieldTransforms)}function mx(r,e,t,n,i,s){const a=r.Qu(1,e,t),o=[lh(e,n,t)],c=[i];if(s.length%2!=0)throw new ge(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(lh(e,s[d])),c.push(s[d+1]);const l=[],u=mr.empty();for(let d=o.length-1;d>=0;--d)if(!xx(l,o[d])){const m=o[d];let g=c[d];g=Gr(g);const p=a.Nu(m);if(g instanceof ku)l.push(m);else{const x=Ga(g,p);x!=null&&(l.push(m),u.set(m,x))}}const h=new Br(l);return new fx(u,h,a.fieldTransforms)}function px(r,e,t,n=!1){return Ga(t,r.Qu(n?4:3,e))}function Ga(r,e){if(_x(r=Gr(r)))return y0("Unsupported field value:",e,r),gx(r,e);if(r instanceof Ua)return function(n,i){if(!hx(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let c=Ga(o,i.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=Gr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return a_(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Nt.fromDate(n);return{timestampValue:Ia(i.serializer,s)}}if(n instanceof Nt){const s=new Nt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ia(i.serializer,s)}}if(n instanceof m0)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ws)return{bytesValue:__(i.serializer,n._byteString)};if(n instanceof Sr){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:zh(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof p0)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw o.Bu("VectorValues must only contain numeric values.");return Mh(o.serializer,c)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Su(n)}`)}(r,e)}function gx(r,e){const t={};return U1(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rs(r,(n,i)=>{const s=Ga(i,e.Mu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function _x(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Nt||r instanceof m0||r instanceof ws||r instanceof Sr||r instanceof Ua||r instanceof p0)}function y0(r,e,t){if(!_x(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=Su(t);throw n==="an object"?e.Bu(r+" a custom object"):e.Bu(r+" "+n)}}function lh(r,e,t){if((e=Gr(e))instanceof vc)return e._internalPath;if(typeof e=="string")return w0(r,e);throw Gl("Field path arguments must be of type string or ",r,!1,void 0,t)}const NS=new RegExp("[~\\*/\\[\\]]");function w0(r,e,t){if(e.search(NS)>=0)throw Gl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new vc(...e.split("."))._internalPath}catch{throw Gl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Gl(r,e,t,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new ge(ee.INVALID_ARGUMENT,o+r+c)}function xx(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Sr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new OS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(E0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class OS extends Ko{data(){return super.data()}}function E0(r,e){return typeof e=="string"?w0(r,e):e instanceof vc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new ge(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class T0{}class wc extends T0{}function Wr(r,e,...t){let n=[];e instanceof T0&&n.push(e),n=n.concat(t),function(s){const a=s.filter(c=>c instanceof S0).length,o=s.filter(c=>c instanceof A0).length;if(a>1||a>0&&o>0)throw new ge(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class A0 extends wc{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new A0(e,t,n)}_apply(e){const t=this._parse(e);return wx(e._query,t),new Tn(e.firestore,e.converter,Qf(e._query,t))}_parse(e){const t=yc(e.firestore);return function(s,a,o,c,l,u,h){let d;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ge(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Ap(h,u);const m=[];for(const g of h)m.push(Tp(c,s,g));d={arrayValue:{values:m}}}else d=Tp(c,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Ap(h,u),d=px(o,a,h,u==="in"||u==="not-in");return Ye.create(l,u,d)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class S0 extends T0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new S0(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const c of o)wx(a,c),a=Qf(a,c)}(e._query,t),new Tn(e.firestore,e.converter,Qf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class I0 extends wc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new I0(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new ge(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ge(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Wo(s,a)}(e._query,this._field,this._direction);return new Tn(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new Ui(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function zr(r,e="asc"){const t=e,n=E0("orderBy",r);return I0._create(n,t)}class k0 extends wc{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new k0(e,t,n)}_apply(e){return new Tn(e.firestore,e.converter,Dl(e._query,this._limit,this._limitType))}}function Hr(r){return kS("limit",r),k0._create("limit",r,"F")}class Cu extends wc{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Cu(e,t,n)}_apply(e){const t=yx(e,this.type,this._docOrFields,this._inclusive);return new Tn(e.firestore,e.converter,function(i,s){return new Ui(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function Wl(...r){return Cu._create("startAt",r,!0)}function Ec(...r){return Cu._create("startAfter",r,!1)}class C0 extends wc{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new C0(e,t,n)}_apply(e){const t=yx(e,this.type,this._docOrFields,this._inclusive);return new Tn(e.firestore,e.converter,function(i,s){return new Ui(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function zl(...r){return C0._create("endAt",r,!0)}function yx(r,e,t,n){if(t[0]=Gr(t[0]),t[0]instanceof Ko)return function(s,a,o,c,l){if(!c)throw new ge(ee.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const h of la(s))if(h.field.isKeyField())u.push(ps(a,c.key));else{const d=c.data.field(h.field);if(hu(d))throw new ge(ee.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){const m=h.field.canonicalString();throw new ge(ee.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}u.push(d)}return new bi(u,l)}(r._query,r.firestore._databaseId,e,t[0]._document,n);{const i=yc(r.firestore);return function(a,o,c,l,u,h){const d=a.explicitOrderBy;if(u.length>d.length)throw new ge(ee.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let g=0;g<u.length;g++){const p=u[g];if(d[g].field.isKeyField()){if(typeof p!="string")throw new ge(ee.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof p}`);if(!Oh(a)&&p.indexOf("/")!==-1)throw new ge(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${p}' contains a slash.`);const x=a.path.child(nt.fromString(p));if(!Se.isDocumentKey(x))throw new ge(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);const T=new Se(x);m.push(ps(o,T))}else{const x=px(c,l,p);m.push(x)}}return new bi(m,h)}(r._query,r.firestore._databaseId,i,e,t,n)}}function Tp(r,e,t){if(typeof(t=Gr(t))=="string"){if(t==="")throw new ge(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Oh(e)&&t.indexOf("/")!==-1)throw new ge(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(nt.fromString(t));if(!Se.isDocumentKey(n))throw new ge(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ps(r,new Se(n))}if(t instanceof Sr)return ps(r,t._key);throw new ge(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Su(t)}.`)}function Ap(r,e){if(!Array.isArray(r)||r.length===0)throw new ge(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wx(r,e){const t=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ge(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Ex{convertValue(e,t="none"){switch(ms(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ki(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Rs(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Rt(a.doubleValue));return new p0(s)}convertGeoPoint(e){return new m0(Rt(e.latitude),Rt(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ph(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Bo(e));default:return null}}convertTimestamp(e){const t=ri(e);return new Nt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=nt.fromString(e);Re(k_(n));const i=new ds(n.get(1),n.get(3)),s=new Se(n.popFirst(5));return i.isEqual(t)||Wt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class LS extends Ex{constructor(e){super(),this.firestore=e}convertBytes(e){return new ws(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Sr(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class R0 extends Ko{constructor(e,t,n,i,s,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Tl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(E0("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Tl extends R0{data(e={}){return super.data(e)}}class Tx{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new sa(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Tl(this._firestore,this._userDataWriter,n.key,n,new sa(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ge(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const c=new Tl(i._firestore,i._userDataWriter,o.doc.key,o.doc,new sa(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const c=new Tl(i._firestore,i._userDataWriter,o.doc.key,o.doc,new sa(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return o.type!==0&&(l=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:MS(o.type),doc:c,oldIndex:l,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function MS(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Di(r){r=yn(r,Sr);const e=yn(r.firestore,Fi);return AS(Ba(e),r._key).then(t=>Ix(e,r,t))}class bu extends Ex{constructor(e){super(),this.firestore=e}convertBytes(e){return new ws(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Sr(this.firestore,null,t)}}function Pn(r){r=yn(r,Tn);const e=yn(r.firestore,Fi),t=Ba(e),n=new bu(e);return vx(r._query),SS(t,r._query).then(i=>new Tx(e,n,r,i))}function qn(r,e,t){r=yn(r,Sr);const n=yn(r.firestore,Fi),i=b0(r.converter,e,t);return Sx(n,[g0(yc(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,zt.none())])}function Ax(r,...e){var t,n,i;r=Gr(r);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Ep(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Ep(e[a])){const h=e[a];e[a]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,u;if(r instanceof Sr)l=yn(r.firestore,Fi),u=dc(r._key.path),c={next:h=>{e[a]&&e[a](Ix(l,r,h))},error:e[a+1],complete:e[a+2]};else{const h=yn(r,Tn);l=yn(h.firestore,Fi),u=h._query;const d=new bu(l);c={next:m=>{e[a]&&e[a](new Tx(l,d,h,m))},error:e[a+1],complete:e[a+2]},vx(r._query)}return function(d,m,g,p){const x=new f0(p),T=new s0(m,x,g);return d.asyncQueue.enqueueAndForget(async()=>r0(await Ul(d),T)),()=>{x.Za(),d.asyncQueue.enqueueAndForget(async()=>n0(await Ul(d),T))}}(Ba(l),u,o,c)}function Sx(r,e){return function(n,i){const s=new vn;return n.asyncQueue.enqueueAndForget(async()=>nS(await ES(n),i,s)),s.promise}(Ba(r),e)}function Ix(r,e,t){const n=t.docs.get(e._key),i=new bu(r);return new R0(r,i,e._key,n,new sa(t.hasPendingWrites,t.fromCache),e.converter)}class VS{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=WS(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function BS(r){return new VS(r)}class US{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=$o.provider,this._offlineComponentProvider={build:t=>new cx(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class GS{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=$o.provider,this._offlineComponentProvider={build:t=>new _S(t,e==null?void 0:e.cacheSizeBytes)}}}function WS(r){return new US(void 0)}function zS(){return new GS}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=yc(e)}set(e,t,n){this._verifyNotCommitted();const i=pi(e,this._firestore),s=b0(i.converter,t,n),a=g0(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(a.toMutation(i._key,zt.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=pi(e,this._firestore);let a;return a=typeof(t=Gr(t))=="string"||t instanceof vc?mx(this._dataReader,"WriteBatch.update",s._key,t,n,i):dx(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,zt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=pi(e,this._firestore);return this._mutations=this._mutations.concat(new pc(t._key,zt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ge(ee.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function pi(r,e){if((r=Gr(r)).firestore!==e)throw new ge(ee.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S extends class{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=yc(t)}get(t){const n=pi(t,this._firestore),i=new LS(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return Ce();const a=s[0];if(a.isFoundDocument())return new Ko(this._firestore,i,a.key,a,n.converter);if(a.isNoDocument())return new Ko(this._firestore,i,n._key,null,n.converter);throw Ce()})}set(t,n,i){const s=pi(t,this._firestore),a=b0(s.converter,n,i),o=g0(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,o),this}update(t,n,i,...s){const a=pi(t,this._firestore);let o;return o=typeof(n=Gr(n))=="string"||n instanceof vc?mx(this._dataReader,"Transaction.update",a._key,n,i,s):dx(this._dataReader,"Transaction.update",a._key,n),this._transaction.update(a._key,o),this}delete(t){const n=pi(t,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=pi(e,this._firestore),n=new bu(this._firestore);return super.get(e).then(i=>new R0(this._firestore,n,t._key,i._document,new sa(!1,!1),t.converter))}}function KS(r,e,t){r=yn(r,Fi);const n=Object.assign(Object.assign({},HS),t);return function(s){if(s.maxAttempts<1)throw new ge(ee.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,a,o){const c=new vn;return s.asyncQueue.enqueueAndForget(async()=>{const l=await TS(s);new vS(s.asyncQueue,l,o,a,c).au()}),c.promise}(Ba(r),i=>e(new $S(r,i)),n)}function kx(){return new _0("serverTimestamp")}function qS(...r){return new x0("arrayUnion",r)}function Cx(r){return new v0("increment",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hl(r){return Ba(r=yn(r,Fi)),new jS(r,e=>Sx(r,e))}(function(e,t=!0){(function(i){Oa=i})(x1),Po(new va("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Fi(new C2(n.getProvider("auth-internal")),new D2(n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new ge(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ds(l.options.projectId,u)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Ai(gm,"4.7.3",e),Ai(gm,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx="firebasestorage.googleapis.com",XS="storageBucket",QS=2*60*1e3,YS=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn extends bs{constructor(e,t,n=0){super(pf(e),`Firebase Storage: ${t} (${pf(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Mn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return pf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Nn;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Nn||(Nn={}));function pf(r){return"storage/"+r}function JS(){const r="An unknown error occurred, please check the error payload for server response.";return new Mn(Nn.UNKNOWN,r)}function ZS(){return new Mn(Nn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function eI(){return new Mn(Nn.CANCELED,"User canceled the upload/download.")}function tI(r){return new Mn(Nn.INVALID_URL,"Invalid URL '"+r+"'.")}function rI(r){return new Mn(Nn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function Sp(r){return new Mn(Nn.INVALID_ARGUMENT,r)}function Rx(){return new Mn(Nn.APP_DELETED,"The Firebase app was deleted.")}function nI(r){return new Mn(Nn.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=_n.makeFromUrl(e,t)}catch{return new _n(e,"")}if(n.path==="")return n;throw rI(e)}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),c={bucket:1,path:3};function l(F){F.path_=decodeURIComponent(F.path)}const u="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${u}/b/${i}/o${d}`,"i"),g={bucket:1,path:3},p=t===bx?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",T=new RegExp(`^https?://${p}/${i}/${x}`,"i"),E=[{regex:o,indices:c,postModify:s},{regex:m,indices:g,postModify:l},{regex:T,indices:{bucket:1,path:2},postModify:l}];for(let F=0;F<E.length;F++){const M=E[F],O=M.regex.exec(e);if(O){const y=O[M.indices.bucket];let A=O[M.indices.path];A||(A=""),n=new _n(y,A),M.postModify(n);break}}if(n==null)throw tI(e);return n}}class iI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(r,e,t){let n=1,i=null,s=null,a=!1,o=0;function c(){return o===2}let l=!1;function u(...x){l||(l=!0,e.apply(null,x))}function h(x){i=setTimeout(()=>{i=null,r(m,c())},x)}function d(){s&&clearTimeout(s)}function m(x,...T){if(l){d();return}if(x){d(),u.call(null,x,...T);return}if(c()||a){d(),u.call(null,x,...T);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,h(E)}let g=!1;function p(x){g||(g=!0,d(),!l&&(i!==null?(x||(o=2),clearTimeout(i),h(0)):x||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,p(!0)},t),p}function aI(r){r(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(r){return r!==void 0}function Ip(r,e,t,n){if(n<e)throw Sp(`Invalid value for '${r}'. Expected ${e} or greater.`);if(n>t)throw Sp(`Invalid value for '${r}'. Expected ${t} or less.`)}function cI(r){const e=encodeURIComponent;let t="?";for(const n in r)if(r.hasOwnProperty(n)){const i=e(n)+"="+e(r[n]);t=t+i+"&"}return t=t.slice(0,-1),t}var jl;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(jl||(jl={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(r,e){const t=r>=500&&r<600,i=[408,429].indexOf(r)!==-1,s=e.indexOf(r)!==-1;return t||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e,t,n,i,s,a,o,c,l,u,h,d=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,g)=>{this.resolve_=m,this.reject_=g,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new tl(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const c=o.loaded,l=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===jl.NO_ERROR,c=s.getStatus();if(!o||lI(c,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===jl.ABORT;n(!1,new tl(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;n(!0,new tl(l,s))})},t=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(o,o.getResponse());oI(c)?s(c):s()}catch(c){a(c)}else if(o!==null){const c=JS();c.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,c)):a(c)}else if(i.canceled){const c=this.appDelete_?Rx():eI();a(c)}else{const c=ZS();a(c)}};this.canceled_?t(!1,new tl(!1,null,!0)):this.backoffId_=sI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&aI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class tl{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function fI(r,e){e!==null&&e.length>0&&(r.Authorization="Firebase "+e)}function hI(r,e){r["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function dI(r,e){e&&(r["X-Firebase-GMPID"]=e)}function mI(r,e){e!==null&&(r["X-Firebase-AppCheck"]=e)}function pI(r,e,t,n,i,s,a=!0){const o=cI(r.urlParams),c=r.url+o,l=Object.assign({},r.headers);return dI(l,e),fI(l,t),hI(l,s),mI(l,n),new uI(c,r.method,l,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(r){if(r.length===0)return null;const e=r.lastIndexOf("/");return e===-1?"":r.slice(0,e)}function _I(r){const e=r.lastIndexOf("/",r.length-2);return e===-1?r:r.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,t){this._service=e,t instanceof _n?this._location=t:this._location=_n.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new $l(e,t)}get root(){const e=new _n(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return _I(this._location.path)}get storage(){return this._service}get parent(){const e=gI(this._location.path);if(e===null)return null;const t=new _n(this._location.bucket,e);return new $l(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw nI(e)}}function kp(r,e){const t=e==null?void 0:e[XS];return t==null?null:_n.makeFromBucketSpec(t,r)}function xI(r,e,t,n={}){r.host=`${e}:${t}`,r._protocol="http";const{mockUserToken:i}=n;i&&(r._overrideAuthToken=typeof i=="string"?i:uE(i,r.app.options.projectId))}class vI{constructor(e,t,n,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=bx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=QS,this._maxUploadRetryTime=YS,this._requests=new Set,i!=null?this._bucket=_n.makeFromBucketSpec(i,this._host):this._bucket=kp(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=_n.makeFromBucketSpec(this._url,e):this._bucket=kp(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ip("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ip("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $l(this,e)}_makeRequest(e,t,n,i,s=!0){if(this._deleted)return new iI(Rx());{const a=pI(e,this._appId,n,i,t,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const Cp="@firebase/storage",bp="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="storage";function yI(r=m2(),e){r=Gr(r);const n=_1(r,Fx).getImmediate({identifier:e}),i=cE("storage");return i&&wI(n,...i),n}function wI(r,e,t,n={}){xI(r,e,t,n)}function EI(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),i=r.getProvider("app-check-internal");return new vI(t,n,i,e,x1)}function TI(){Po(new va(Fx,EI,"PUBLIC").setMultipleInstances(!0)),Ai(Cp,bp,""),Ai(Cp,bp,"esm2017")}TI();const AI={apiKey:"AIzaSyCwHJ1VIqM9s4tfh2hn8KZxqunuYySzuwQ",authDomain:"shadow-app-b3fb3.firebaseapp.com",projectId:"shadow-app-b3fb3",storageBucket:"shadow-app-b3fb3.appspot.com",messagingSenderId:"725156533083",appId:"1:725156533083:web:e372fd32d1d0abff4f3f92"},Dx=v1(AI),je=CS(Dx,{localCache:BS({tabManager:zS()}),experimentalAutoDetectLongPolling:!0});yI(Dx);async function os(){try{const r=Gt(je,"globals","ridePlan"),e=await Di(r),t=e.exists()?e.data():{};return(Array.isArray(t.plannedDates)?t.plannedDates:[]).filter(Boolean)}catch(r){return console.error("Kon plannedDates niet laden:",r),[]}}function Rp(r){try{if(!r)return"";if(typeof r=="object"&&r.seconds)return new Date(r.seconds*1e3).toISOString().slice(0,10);if(typeof r=="string"){const t=r.match(/\d{4}-\d{2}-\d{2}/);if(t)return t[0]}const e=new Date(r);return isNaN(e.getTime())?"":e.toISOString().slice(0,10)}catch{return""}}function Kl(r,e){const t=r.map(Rp).filter(Boolean),n=new Set((Array.isArray(e)?e:[]).map(Rp).filter(Boolean)),i=t.map(o=>n.has(o)?"":"").join(""),s=t.map(o=>n.has(o)?'<span class="star filled"></span>':'<span class="star empty"></span>').join(""),a=t.map((o,c)=>`${c+1}: ${o}  ${n.has(o)?"Geregistreerd":"Niet geregistreerd"}`).join("\\n");return{stars:i,starsHtml:s,tooltip:a,planned:t}}let Fp=5;async function SI(){try{const r=Gt(je,"globals","starConfig"),e=await Di(r),t=e.exists()&&typeof e.data().max=="number"?e.data().max:5;Fp=Math.max(1,Math.floor(t))}catch{Fp=5}}function II(r){try{let s=function(){try{document.removeEventListener("keydown",a)}catch{}t.remove()},a=function(o){o.key==="Escape"&&s()};const e=r.toDataURL("image/png"),t=document.createElement("div");t.id="qrFullscreenOverlay",t.style.position="fixed",t.style.inset="0",t.style.background="rgba(0,0,0,0.95)",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.zIndex="9999",t.style.cursor="zoom-out",t.setAttribute("role","dialog"),t.setAttribute("aria-label","QR-code fullscreen");const n=document.createElement("img");n.src=e,n.alt="QR-code",n.style.width="100vmin",n.style.height="100vmin",n.style.imageRendering="pixelated";const i=document.createElement("div");i.textContent="Klik of druk op Esc om te sluiten",i.style.position="fixed",i.style.bottom="24px",i.style.left="50%",i.style.transform="translateX(-50%)",i.style.color="#e5e7eb",i.style.fontSize="14px",i.style.opacity="0.8",t.addEventListener("click",s,{passive:!0}),document.addEventListener("keydown",a),t.appendChild(n),t.appendChild(i),document.body.appendChild(t)}catch(e){console.error("QR fullscreen overlay faalde:",e)}}async function kI(){try{try{window!=null&&window.appSplash&&window.appSplash.setProgress(5,"Initialiseren leden...")}catch{}await SI();try{window!=null&&window.appSplash&&window.appSplash.setProgress(30,"Ster-config laden...")}catch{}}catch{}const r=Z=>document.getElementById(Z),e=r("nameInput");let t=null;const n=r("suggestions"),i=r("result"),s=r("error"),a=r("rName"),o=r("rMemberNo"),c=r("rRidesCount"),l=r("qrCanvas"),u=r("rRegion"),h=r("loadingIndicator"),d=r("lunchChoiceSection");r("lunchToggle");const m=r("lunchYes"),g=r("lunchNo"),p=r("lunchDetailsSection"),x=r("vastEtenDisplay"),T=r("keuzeEtenButtons");let b=null,E=[];function F(Z){if(!navigator.onLine)return"Geen internetverbinding. Check je wifi of mobiele data.";const ue=(Z==null?void 0:Z.code)||"",xe=(Z==null?void 0:Z.message)||"";return ue==="permission-denied"||xe.includes("permission")?"Toegang geweigerd. Neem contact op met de beheerder.":ue==="unavailable"||xe.includes("unavailable")?"Database tijdelijk niet bereikbaar. Probeer het over een paar seconden opnieuw.":ue==="not-found"||xe.includes("not-found")?"Gegevens niet gevonden. Neem contact op met de inschrijfbalie.":ue==="deadline-exceeded"||xe.includes("timeout")?"Verzoek duurt te lang. Check je internetverbinding en probeer opnieuw.":ue==="resource-exhausted"?"Te veel verzoeken. Wacht even en probeer opnieuw.":xe.includes("network")||xe.includes("fetch")?"Netwerkfout. Check je internetverbinding.":"Er ging iets mis. Probeer het opnieuw of ga naar de inschrijfbalie."}function M(Z,ue=!1){s&&(s.textContent=Z,s.style.display="block",s.style.color=ue?"#fbbf24":"#fca5a5")}function O(){s&&(s.style.display="none")}async function y(){try{const Z=Gt(je,"globals","lunch"),ue=await Di(Z);if(ue.exists()){const xe=ue.data();return{vastEten:Array.isArray(xe.vastEten)?xe.vastEten:[],keuzeEten:Array.isArray(xe.keuzeEten)?xe.keuzeEten:[]}}return{vastEten:[],keuzeEten:[]}}catch(Z){return console.error("Fout bij laden lunch opties:",Z),{vastEten:[],keuzeEten:[]}}}function A(){d&&(d.style.display="block",d.style.opacity="0",d.style.transform="translateY(-10px)",setTimeout(()=>{d.style.transition="all 0.4s ease",d.style.opacity="1",d.style.transform="translateY(0)"},10))}function v(){d&&(d.style.display="none"),p&&(p.style.display="none"),b=null,E=[]}async function S(Z){if(b=Z,m&&g&&(m.classList.toggle("active",Z==="ja"),g.classList.toggle("active",Z==="nee"),m.setAttribute("aria-checked",String(Z==="ja")),g.setAttribute("aria-checked",String(Z==="nee"))),Z==="nee")p&&(p.style.display="none");else if(Z==="ja"){p&&(p.style.display="block"),k&&(k.style.display="none");const ue=document.getElementById("jaarhangerInfo");ue&&(ue.style.display="none");const{vastEten:xe,keuzeEten:se}=await y();x&&(x.textContent=xe.length>0?xe.join(", "):"Geen vast eten beschikbaar"),T&&(T.innerHTML="",se.forEach($e=>{const Qe=document.createElement("button");Qe.type="button",Qe.className="seg-btn",Qe.textContent=$e,Qe.style.cssText=`
          flex: 1 1 auto;
          min-width: 140px;
          padding: 14px 20px;
          font-size: 15px;
          font-weight: 600;
          border-radius: 8px;
          transition: all 0.3s ease;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        `,E.includes($e)&&Qe.classList.add("active","yes"),Qe.addEventListener("click",async()=>{T.querySelectorAll("button").forEach(Yt=>Yt.classList.remove("active","yes")),Qe.classList.add("active","yes"),E=[$e],await I(),le(oe||null)}),T.appendChild(Qe)}))}}async function I(){try{if(!K||!K.id)return;const Z=E.length>0?E[0]:null;if(await qn(Gt(je,"members",String(K.id)),{lunchDeelname:b,lunchKeuze:Z,lunchTimestamp:kx()},{merge:!0}),b==="nee"||b==="ja"&&E.length>0){const ue=await Di(Gt(je,"members",String(K.id)));if(ue.exists()){const xe=ue.data(),se=xe==null?void 0:xe.Jaarhanger;if(se==="Ja"||se==="Nee"){oe=se,le(se);try{await rl(K)}catch($e){console.error("QR genereren mislukt:",$e)}}else le(null)}else le(null)}}catch(Z){console.error("Lunch keuze opslaan mislukt",Z)}}m&&m.addEventListener("click",async function(){await S("ja"),await I()}),g&&g.addEventListener("click",async function(){await S("nee"),await I()});let k=document.getElementById("yearhangerRow"),R=document.getElementById("yearhangerYes"),ae=document.getElementById("yearhangerNo"),oe="Ja";function Ae(){k=document.getElementById("yearhangerRow"),R=document.getElementById("yearhangerYes"),ae=document.getElementById("yearhangerNo")}Ae();function le(Z){if(Ae(),b===null){k&&(k.style.display="none");const se=document.getElementById("jaarhangerInfo");se&&(se.style.display="none");return}if(b==="ja"&&E.length===0){k&&(k.style.display="none");const se=document.getElementById("jaarhangerInfo");se&&(se.style.display="none");return}const ue=Z==="Ja"||Z===!0?"Ja":Z==="Nee"||Z===!1?"Nee":null;oe=ue,k&&(k.style.display="block");const xe=document.getElementById("jaarhangerInfo");xe&&(xe.style.display="block"),R&&ae&&(R.classList.toggle("active",ue==="Ja"),ae.classList.toggle("active",ue==="Nee"),R.classList.toggle("yes",ue==="Ja"),ae.classList.toggle("no",ue==="Nee"),R.setAttribute("aria-checked",String(ue==="Ja")),ae.setAttribute("aria-checked",String(ue==="Nee")),ue!=="Ja"&&R.classList.remove("yes"),ue!=="Nee"&&ae.classList.remove("no"))}async function We(Z){try{if(!K||!K.id)return;const ue=Z==="Ja"||Z===!0?"Ja":Z==="Nee"||Z===!1?"Nee":null;if(oe=ue,!navigator.onLine){const se=document.getElementById("error");se&&(se.textContent="Geen internetverbinding. Check je wifi of mobiele data.",se.style.display="block",se.style.color="#fca5a5");return}const xe=document.getElementById("loadingIndicator");xe&&(xe.style.display="flex"),await qn(Gt(je,"members",String(K.id)),{Jaarhanger:ue},{merge:!0});try{K&&await rl(K)}catch{}xe&&(xe.style.display="none")}catch(ue){console.error("Jaarhanger opslaan mislukt",ue);const xe=document.getElementById("loadingIndicator");xe&&(xe.style.display="none");const se=document.getElementById("error");if(se){const $e=F(ue);se.textContent=`Opslaan mislukt: ${$e}`,se.style.display="block",se.style.color="#fca5a5"}}}R&&R.addEventListener("click",function(){le("Ja"),We("Ja")}),ae&&ae.addEventListener("click",function(){le("Nee"),We("Nee")});let K=null,Fe=null;k&&(k.style.display="none");function Ne(Z){const ue=(Z["Tussen voegsel"]||"").trim();return[Z["Voor naam"]||"",Z["Voor letters"]?`(${Z["Voor letters"]})`:"",ue||"",Z.Naam||""].filter(Boolean).join(" ").replace(/\\s+/g," ").trim()}function B(){n&&(n.innerHTML="",n.style.display="none")}function H(Z){if(n){if(n.innerHTML="",!Z||Z.length===0){const ue=document.createElement("li");ue.style.textAlign="center",ue.style.padding="24px 12px",ue.style.color="var(--muted)",ue.innerHTML=`
        <div style="font-size: 32px; margin-bottom: 8px; opacity: 0.3;"></div>
        <div style="font-weight: 600; margin-bottom: 4px;">Geen leden gevonden</div>
        <div style="font-size: 13px;">Probeer een andere zoekterm</div>
      `,n.appendChild(ue),n.style.display="block";return}for(const ue of Z){const xe=document.createElement("li");xe.textContent=Ne(ue.data)+`  ${ue.id}`,xe.addEventListener("click",async()=>{K=ue,await ot(ue),B()}),n.appendChild(xe)}n.style.display=Z.length?"block":"none"}}async function W(Z){if(!Z)return[];const ue=8;try{if(!navigator.onLine)throw new Error("No internet connection");const xe=Wr(Ir(je,"members"),zr("Naam"),Wl(Z),zl(Z+""),Hr(ue)),se=Wr(Ir(je,"members"),zr("Voor naam"),Wl(Z),zl(Z+""),Hr(ue)),[$e,Qe]=await Promise.all([Pn(xe),Pn(se)]),mt=new Map;return $e.forEach(Jt=>{mt.has(Jt.id)||mt.set(Jt.id,{id:Jt.id,data:Jt.data()})}),Qe.forEach(Jt=>{mt.has(Jt.id)||mt.set(Jt.id,{id:Jt.id,data:Jt.data()})}),Array.from(mt.values()).slice(0,ue)}catch(xe){throw console.error("queryByLastNamePrefix failed",xe),xe}}function z(){i&&(i.style.display="none");const Z=document.getElementById("qrPrivacy");Z&&(Z.style.display="none")}function ie(){h&&(h.style.display="flex"),z()}function de(){h&&(h.style.display="none")}function _e(){K=null,z(),de(),O(),v();try{Fe&&Fe()}catch{}Fe=null,k&&(k.style.display="none");const Z=document.getElementById("jaarhangerInfo");Z&&(Z.style.display="none"),c&&(c.textContent="",c.removeAttribute("title"),c.removeAttribute("aria-label"),c.style.letterSpacing="",c.style.fontSize=""),u&&(u.textContent="")}async function pe(){_e();const Z=(e&&e.value?e.value:"").trim();if(Z.length>=1)try{const ue=await W(Z);ue&&ue.length?H(ue):B()}catch(ue){B(),M(F(ue))}else B()}async function fe(){t&&clearTimeout(t),t=setTimeout(async()=>{try{_e();const Z=(e&&e.value?e.value:"").trim();if(Z.length<2){B();return}M("Zoeken...",!0);const ue=await W(Z);if(!ue||!ue.length){M("Geen lid met uw achternaam gevonden  ga naar de inschrijfbalie voor meer informatie."),B();return}O(),H(ue)}catch(Z){B(),M(F(Z))}},250)}async function Ve(){O();try{const Z=(e&&e.value?e.value:"").trim();if(!Z){B();return}const ue=await W(Z);if(!ue.length){M("Geen lid met uw achternaam gevonden  ga naar de inschrijfbalie voor meer informatie."),B();return}H(ue)}catch(Z){M(F(Z))}}async function G(Z,ue){try{const xe=ue.lunchTimestamp;if(!xe){(ue.lunchDeelname||ue.lunchKeuze)&&(await qn(Gt(je,"members",String(Z)),{lunchDeelname:null,lunchKeuze:null,lunchTimestamp:null},{merge:!0}),console.log(`Oude lunch data verwijderd voor lid ${Z} (geen timestamp)`));return}let se;if(xe.toMillis)se=xe.toMillis();else if(typeof xe=="number")se=xe;else{await qn(Gt(je,"members",String(Z)),{lunchDeelname:null,lunchKeuze:null,lunchTimestamp:null},{merge:!0}),console.log(`Lunch data verwijderd voor lid ${Z} (ongeldig timestamp formaat)`);return}const $e=Date.now(),Qe=24*60*60*1e3;$e-se>Qe&&(await qn(Gt(je,"members",String(Z)),{lunchDeelname:null,lunchKeuze:null,lunchTimestamp:null},{merge:!0}),console.log(`Lunch data verwijderd voor lid ${Z} (ouder dan 1 dag)`))}catch(xe){console.error("Fout bij cleanup lunch data:",xe)}}async function ot(Z){var ue,xe;ie(),O();try{const se=Z.data||{};await G(Z.id,se),u&&(u.textContent=se["Regio Omschrijving"]||""),a&&(a.textContent=Ne(se)),o&&(o.textContent=Z.id);const $e=((ue=Z==null?void 0:Z.data)==null?void 0:ue.Jaarhanger)==="Nee"?"Nee":((xe=Z==null?void 0:Z.data)==null?void 0:xe.Jaarhanger)==="Ja"?"Ja":"";A();const Qe=se.lunchDeelname||null,mt=se.lunchKeuze;if(typeof mt=="string"&&mt?E=[mt]:Array.isArray(mt)&&mt.length>0?E=[mt[0]]:E=[],Qe){if(await S(Qe),(Qe==="nee"||Qe==="ja"&&E.length>0)&&(le($e||null),$e))try{await rl(Z)}catch(ct){console.error("QR genereren mislukt:",ct)}}else{k&&(k.style.display="none");const ct=document.getElementById("jaarhangerInfo");ct&&(ct.style.display="none")}const Yt=await os(),Jt=Array.isArray(se.ScanDatums)?se.ScanDatums:[];if(!Yt||Yt.length===0)c&&(c.innerHTML='<span style="color: var(--muted); font-size: 14px;">Geen ritten gepland</span>',c.setAttribute("title","Er zijn nog geen landelijke ritten ingepland voor dit jaar"),c.removeAttribute("aria-label"),c.style.letterSpacing="",c.style.fontSize="");else{const{stars:ct,starsHtml:Ze,tooltip:It,planned:kt}=Kl(Yt,Jt);c&&(c.innerHTML=Ze||"",c.setAttribute("title",ct?It:"Geen ingeplande datums"),c.setAttribute("aria-label",ct?`Sterren per datum (gepland: ${kt.length})`:"Geen ingeplande datums"),c.style.letterSpacing="3px",c.style.fontSize="20px")}try{Fe&&Fe()}catch{}if(Fe=Ax(Gt(je,"members",Z.id),ct=>{const Ze=ct.exists()?ct.data():{},It=typeof Ze.ridesCount=="number"?Ze.ridesCount:0,kt=Array.isArray(Ze.ScanDatums)?Ze.ScanDatums:[];os().then(Ue=>{if(!Ue||Ue.length===0)c&&(c.innerHTML='<span style="color: var(--muted); font-size: 14px;">Geen ritten gepland</span>',c.setAttribute("title","Er zijn nog geen landelijke ritten ingepland voor dit jaar"),c.removeAttribute("aria-label"),c.style.letterSpacing="",c.style.fontSize="");else{const{stars:yt,starsHtml:$t,tooltip:Ct,planned:sn}=Kl(Ue,kt);c&&(c.innerHTML=$t||"",c.setAttribute("title",yt?Ct:"Geen ingeplande datums"),c.setAttribute("aria-label",yt?`Sterren per datum (gepland: ${sn.length})`:"Geen ingeplande datums"),c.style.letterSpacing="3px",c.style.fontSize="20px")}}).catch(()=>{});const Fr=Ze&&typeof Ze.Jaarhanger=="string"?Ze.Jaarhanger:"";le(Fr||oe||null)}),$e&&Qe!==null&&(Qe==="nee"||Qe==="ja"&&E.length>0))try{await rl(Z),de()}catch(ct){console.error("QR creation failed",ct),M(F(ct)),de()}else{de(),i&&(i.style.display="none");const ct=document.getElementById("qrPrivacy");ct&&(ct.style.display="none")}}catch(se){console.error("renderSelected failed",se),M(F(se)),de()}}e==null||e.addEventListener("focus",pe),e==null||e.addEventListener("input",fe),e==null||e.addEventListener("keydown",Z=>{Z.key==="Escape"&&B(),Z.key==="Enter"&&(Z.preventDefault(),Ve())}),l&&(l.style.cursor="zoom-in",l.addEventListener("click",()=>II(l),{passive:!0}),l.setAttribute("title","Klik om fullscreen te openen"));try{try{window!=null&&window.appSplash&&window.appSplash.setProgress(50,"Ritdatums ophalen...")}catch{}await os();try{window!=null&&window.appSplash&&window.appSplash.setProgress(80,"Initialisatie bijna klaar...")}catch{}}catch{}try{window!=null&&window.appSplash&&(window.appSplash.setProgress(100,"Klaar"),window.appSplash.hide())}catch{}}async function rl(r){try{if(!r)return;const e=JSON.stringify({t:"member",uid:r.id}),t=document.getElementById("qrCanvas"),n=document.getElementById("result"),i=document.getElementById("error");return new Promise((s,a)=>{if(!t)return s();lc.toCanvas(t,e,{width:220,margin:1},o=>{if(o){const l="QR-code genereren mislukt. Probeer het opnieuw.";i&&(i.textContent=l,i.style.display="block",i.style.color="#fca5a5"),a(new Error(l));return}n&&(n.style.display="grid");const c=document.getElementById("qrPrivacy");c&&(c.style.display="block"),s()})})}catch(e){throw console.error("generateQrForEntry failed",e),e}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var qo={};qo.version="0.18.5";var Zr=1200,Es=1252,CI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],F0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ru=function(r){CI.indexOf(r)!=-1&&(Es=F0[0]=r)};function bI(){Ru(1252)}var hn=function(r){Zr=r,Ru(r)};function Fu(){hn(1200),bI()}function ql(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function RI(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function Px(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var aa=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?RI(r.slice(2)):e==254&&t==255?Px(r.slice(2)):e==65279?r.slice(1):r},mo=function(e){return String.fromCharCode(e)},uh=function(e){return String.fromCharCode(e)},rt;function FI(r){rt=r,hn=function(e){Zr=e,Ru(e)},aa=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?rt.utils.decode(1200,ql(e.slice(2))):e},mo=function(t){return Zr===1200?String.fromCharCode(t):rt.utils.decode(Zr,[t&255,t>>8])[0]},uh=function(t){return rt.utils.decode(Es,[t])[0]},cv()}var xi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xo(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0,c=0,l=0;l<r.length;)t=r.charCodeAt(l++),s=t>>2,n=r.charCodeAt(l++),a=(t&3)<<4|n>>4,i=r.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=xi.charAt(s)+xi.charAt(a)+xi.charAt(o)+xi.charAt(c);return e}function tn(r){var e="",t=0,n=0,i=0,s=0,a=0,o=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<r.length;)s=xi.indexOf(r.charAt(l++)),a=xi.indexOf(r.charAt(l++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=xi.indexOf(r.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=xi.indexOf(r.charAt(l++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var Ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ii=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Pi(r){return Ke?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Dp(r){return Ke?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Xr=function(e){return Ke?ii(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Tc(r){if(typeof ArrayBuffer>"u")return Xr(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function zi(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function DI(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function D0(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return D0(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var ar=Ke?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:ii(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function PI(r){for(var e=[],t=0,n=r.length+250,i=Pi(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>n&&(e.push(i.slice(0,t)),t=0,i=Pi(65535),n=65530)}return e.push(i.slice(0,t)),ar(e)}var kr=/\u0000/g,po=/[\u0001-\u0006]/g;function fa(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function xn(r,e){var t=""+r;return t.length>=e?t:Lt("0",e-t.length)+t}function P0(r,e){var t=""+r;return t.length>=e?t:Lt(" ",e-t.length)+t}function Xl(r,e){var t=""+r;return t.length>=e?t:t+Lt(" ",e-t.length)}function NI(r,e){var t=""+Math.round(r);return t.length>=e?t:Lt("0",e-t.length)+t}function OI(r,e){var t=""+r;return t.length>=e?t:Lt("0",e-t.length)+t}var Pp=Math.pow(2,32);function Qs(r,e){if(r>Pp||r<-Pp)return NI(r,e);var t=Math.round(r);return OI(t,e)}function Ql(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Np=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function LI(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var Oe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Op={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},MI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Yl(r,e,t){for(var n=r<0?-1:1,i=r*n,s=0,a=1,o=0,c=1,l=0,u=0,h=Math.floor(i);l<e&&(h=Math.floor(i),o=h*a+s,u=h*l+c,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,c=l,l=u;if(u>e&&(l>e?(u=c,o=s):(u=l,o=a)),!t)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function vi(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),s=0,a=[],o={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),t&&(s=zI(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Nx=new Date(1899,11,31,0,0,0),VI=Nx.getTime(),BI=new Date(1900,2,1,0,0,0);function Ox(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=BI&&(t+=24*60*60*1e3),(t-(VI+(r.getTimezoneOffset()-Nx.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function N0(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function UI(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function GI(r){var e=r<0?12:11,t=N0(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function WI(r){var e=N0(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function Qo(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=GI(r):e===10?t=r.toFixed(10).substr(0,12):t=WI(r),N0(UI(t.toUpperCase()))}function Ts(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Qo(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return rn(14,Ox(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function zI(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function HI(r,e,t,n){var i="",s=0,a=0,o=t.y,c,l=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=t.m,l=e.length;break;case 3:return gf[t.m-1][1];case 5:return gf[t.m-1][0];default:return gf[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=t.d,l=e.length;break;case 3:return Np[t.q][0];default:return Np[t.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(t.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=t.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=t.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?xn(t.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=xn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var u=l>0?xn(c,l):"";return u}function yi(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var Lx=/%/g;function jI(r,e,t){var n=e.replace(Lx,""),i=e.length-n.length;return Zn(r,n,t*Math.pow(10,2*i))+Lt("%",i)}function $I(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Zn(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function Mx(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Mx(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Vx=/# (\?+)( ?)\/( ?)(\d+)/;function KI(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return t+(s===0?"":""+s)+" "+(a===0?Lt(" ",r[1].length+1+r[4].length):P0(a,r[1].length)+r[2]+"/"+r[3]+xn(o,r[4].length))}function qI(r,e,t){return t+(e===0?"":""+e)+Lt(" ",r[1].length+2+r[4].length)}var Bx=/^#*0*\.([0#]+)/,Ux=/\).*[0#]/,Gx=/\(###\) ###\\?-####/;function Dr(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Lp(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Mp(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function XI(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function QI(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function on(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Ux)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?on("n",n,t):"("+on("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return $I(r,e,t);if(e.indexOf("%")!==-1)return jI(r,e,t);if(e.indexOf("E")!==-1)return Mx(e,t);if(e.charCodeAt(0)===36)return"$"+on(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,c=Math.abs(t),l=t<0?"-":"";if(e.match(/^00+$/))return l+Qs(c,e.length);if(e.match(/^[#?]+$/))return i=Qs(t,0),i==="0"&&(i=""),i.length>e.length?i:Dr(e.substr(0,e.length-i.length))+i;if(s=e.match(Vx))return KI(s,c,l);if(e.match(/^#+0+$/))return l+Qs(c,e.length-e.indexOf("0"));if(s=e.match(Bx))return i=Lp(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Dr(s[1])).replace(/\.$/,"."+Dr(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+Lt("0",Dr(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+Lp(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+yi(Qs(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+on(r,e,-t):yi(""+(Math.floor(t)+XI(t,s[1].length)))+"."+xn(Mp(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return on(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=fa(on(r,e.replace(/[\\-]/g,""),t)),a=0,fa(fa(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(Gx))return i=on(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Yl(c,Math.pow(10,a)-1,!1),i=""+l,u=Zn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Xl(o[2],a),u.length<s[4].length&&(u=Dr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Yl(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?P0(o[1],a)+s[2]+"/"+s[3]+Xl(o[2],a):Lt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Qs(t,0),e.length<=i.length?i:Dr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Dr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Mp(t,s[1].length),t<0?"-"+on(r,e,-t):yi(QI(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?xn(0,3-g.length):"")+g})+"."+xn(a,s[1].length);switch(e){case"###,##0.00":return on(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var m=yi(Qs(c,0));return m!=="0"?l+m:"";case"###,###.00":return on(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return on(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function YI(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Zn(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function JI(r,e,t){var n=e.replace(Lx,""),i=e.length-n.length;return Zn(r,n,t*Math.pow(10,2*i))+Lt("%",i)}function Wx(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Wx(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function In(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Ux)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?In("n",n,t):"("+In("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return YI(r,e,t);if(e.indexOf("%")!==-1)return JI(r,e,t);if(e.indexOf("E")!==-1)return Wx(e,t);if(e.charCodeAt(0)===36)return"$"+In(r,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,c=Math.abs(t),l=t<0?"-":"";if(e.match(/^00+$/))return l+xn(c,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:Dr(e.substr(0,e.length-i.length))+i;if(s=e.match(Vx))return qI(s,c,l);if(e.match(/^#+0+$/))return l+xn(c,e.length-e.indexOf("0"));if(s=e.match(Bx))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Dr(s[1])).replace(/\.$/,"."+Dr(s[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+Lt("0",Dr(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+yi(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+In(r,e,-t):yi(""+t)+"."+Lt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return In(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=fa(In(r,e.replace(/[\\-]/g,""),t)),a=0,fa(fa(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(Gx))return i=In(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Yl(c,Math.pow(10,a)-1,!1),i=""+l,u=Zn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Xl(o[2],a),u.length<s[4].length&&(u=Dr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Yl(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?P0(o[1],a)+s[2]+"/"+s[3]+Xl(o[2],a):Lt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:Dr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Dr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+In(r,e,-t):yi(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?xn(0,3-g.length):"")+g})+"."+xn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=yi(""+c);return m!=="0"?l+m:"";default:if(e.match(/\.[0#?]*$/))return In(r,e.slice(0,e.lastIndexOf(".")),t)+Dr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Zn(r,e,t){return(t|0)===t?In(r,e,t):on(r,e,t)}function ZI(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var zx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ds(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":Ql(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(zx))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function ek(r,e,t,n){for(var i=[],s="",a=0,o="",c="t",l,u,h,d="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!Ql(r,a))throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=r.charAt(++a),g=m==="("||m===")"?m:"t";i[i.length]={t:g,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(l==null&&(l=vi(e,t,r.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:r.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=vi(e,t),l==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var p={t:o,v:o};if(l==null&&(l=vi(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",a+=5,d="h"):r.substr(a,5).toUpperCase()==="/"?(l!=null&&(p.v=l.H>=12?"":""),p.t="T",a+=5,d="h"):(p.t="t",++a),l==null&&p.t==="T")return"";i[i.length]=p,c=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(zx)){if(l==null&&(l=vi(e,t),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ds(r)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);i[i.length]={t:"t",v:o},++a;break}var x=0,T=0,b;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,c="h",x<1&&(x=1);break;case"s":(b=i[a].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&i[a].v.match(/[Hh]/)&&(x=1),x<2&&i[a].v.match(/[Mm]/)&&(x=2),x<3&&i[a].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var E="",F;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=HI(i[a].t.charCodeAt(0),i[a].v,l,T),i[a].t="t";break;case"n":case"?":for(F=a+1;i[F]!=null&&((o=i[F].t)==="?"||o==="D"||(o===" "||o==="t")&&i[F+1]!=null&&(i[F+1].t==="?"||i[F+1].t==="t"&&i[F+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[F].v==="/"||i[F].v===" "&&i[F+1]!=null&&i[F+1].t=="?"));)i[a].v+=i[F].v,i[F]={v:"",t:";"},++F;E+=i[a].v,a=F-1;break;case"G":i[a].t="t",i[a].v=Ts(e,t);break}var M="",O,y;if(E.length>0){E.charCodeAt(0)==40?(O=e<0&&E.charCodeAt(0)===45?-e:e,y=Zn("n",E,O)):(O=e<0&&n>1?-e:e,y=Zn("n",E,O),O<0&&i[0]&&i[0].t=="t"&&(y=y.substr(1),i[0].v="-"+i[0].v)),F=y.length-1;var A=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){A=a;break}var v=i.length;if(A===i.length&&y.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(F>=i[a].v.length-1?(F-=i[a].v.length,i[a].v=y.substr(F+1,i[a].v.length)):F<0?i[a].v="":(i[a].v=y.substr(0,F+1),F=-1),i[a].t="t",v=a);F>=0&&v<i.length&&(i[v].v=y.substr(0,F+1)+i[v].v)}else if(A!==i.length&&y.indexOf("E")===-1){for(F=y.indexOf(".")-1,a=A;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")-1:i[a].v.length-1,M=i[a].v.substr(u+1);u>=0;--u)F>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(M=y.charAt(F--)+M);i[a].v=M,i[a].t="t",v=a}for(F>=0&&v<i.length&&(i[v].v=y.substr(0,F+1)+i[v].v),F=y.indexOf(".")+1,a=A;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==A)){for(u=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")+1:0,M=i[a].v.substr(0,u);u<i[a].v.length;++u)F<y.length&&(M+=y.charAt(F++));i[a].v=M,i[a].t="t",v=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(O=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Zn(i[a].t,i[a].v,O),i[a].t="t");var S="";for(a=0;a!==i.length;++a)i[a]!=null&&(S+=i[a].v);return S}var Vp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Bp(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function tk(r,e){var t=ZI(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(Vp),o=t[1].match(Vp);return Bp(e,a)?[n,t[0]]:Bp(e,o)?[n,t[1]]:[n,t[a!=null&&o!=null?2:1]]}return[n,s]}function rn(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Oe)[r],n==null&&(n=t.table&&t.table[Op[r]]||Oe[Op[r]]),n==null&&(n=MI[r]||"General");break}if(Ql(n,0))return Ts(e,t);e instanceof Date&&(e=Ox(e,t.date1904));var i=tk(n,e);if(Ql(i[1]))return Ts(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return ek(i[1],e,t,i[0])}function Fn(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Oe[t]==null){e<0&&(e=t);continue}if(Oe[t]==r){e=t;break}}e<0&&(e=391)}return Oe[e]=r,e}function Ac(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Fn(r[e],e)}function Wa(){Oe=LI()}var Hx={format:rn,load:Fn,_table:Oe,load_table:Ac,parse_date_code:vi,is_date:Ds,get_table:function(){return Hx._table=Oe}},rk={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},jx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function nk(r){var e=typeof r=="number"?Oe[r]:r;return e=e.replace(jx,"(\\d+)"),new RegExp("^"+e+"$")}function ik(r,e,t){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(jx)||[]).forEach(function(h,d){var m=parseInt(t[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":c=m;break;case"m":a>=0?o=m:i=m;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&s==-1?u:l+"T"+u}var sk=function(){var r={};r.version="1.2.0";function e(){for(var y=0,A=new Array(256),v=0;v!=256;++v)y=v,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,A[v]=y;return typeof Int32Array<"u"?new Int32Array(A):A}var t=e();function n(y){var A=0,v=0,S=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(S=0;S!=256;++S)I[S]=y[S];for(S=0;S!=256;++S)for(v=y[S],A=256+S;A<4096;A+=256)v=I[A]=v>>>8^y[v&255];var k=[];for(S=1;S!=16;++S)k[S-1]=typeof Int32Array<"u"?I.subarray(S*256,S*256+256):I.slice(S*256,S*256+256);return k}var i=n(t),s=i[0],a=i[1],o=i[2],c=i[3],l=i[4],u=i[5],h=i[6],d=i[7],m=i[8],g=i[9],p=i[10],x=i[11],T=i[12],b=i[13],E=i[14];function F(y,A){for(var v=A^-1,S=0,I=y.length;S<I;)v=v>>>8^t[(v^y.charCodeAt(S++))&255];return~v}function M(y,A){for(var v=A^-1,S=y.length-15,I=0;I<S;)v=E[y[I++]^v&255]^b[y[I++]^v>>8&255]^T[y[I++]^v>>16&255]^x[y[I++]^v>>>24]^p[y[I++]]^g[y[I++]]^m[y[I++]]^d[y[I++]]^h[y[I++]]^u[y[I++]]^l[y[I++]]^c[y[I++]]^o[y[I++]]^a[y[I++]]^s[y[I++]]^t[y[I++]];for(S+=15;I<S;)v=v>>>8^t[(v^y[I++])&255];return~v}function O(y,A){for(var v=A^-1,S=0,I=y.length,k=0,R=0;S<I;)k=y.charCodeAt(S++),k<128?v=v>>>8^t[(v^k)&255]:k<2048?(v=v>>>8^t[(v^(192|k>>6&31))&255],v=v>>>8^t[(v^(128|k&63))&255]):k>=55296&&k<57344?(k=(k&1023)+64,R=y.charCodeAt(S++)&1023,v=v>>>8^t[(v^(240|k>>8&7))&255],v=v>>>8^t[(v^(128|k>>2&63))&255],v=v>>>8^t[(v^(128|R>>6&15|(k&3)<<4))&255],v=v>>>8^t[(v^(128|R&63))&255]):(v=v>>>8^t[(v^(224|k>>12&15))&255],v=v>>>8^t[(v^(128|k>>6&63))&255],v=v>>>8^t[(v^(128|k&63))&255]);return~v}return r.table=t,r.bstr=F,r.buf=M,r.str=O,r}(),Pe=function(){var e={};e.version="1.2.1";function t(C,L){for(var P=C.split("/"),N=L.split("/"),V=0,U=0,X=Math.min(P.length,N.length);V<X;++V){if(U=P[V].length-N[V].length)return U;if(P[V]!=N[V])return P[V]<N[V]?-1:1}return P.length-N.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var L=C.lastIndexOf("/");return L===-1?C:C.slice(0,L+1)}function i(C){if(C.charAt(C.length-1)=="/")return i(C.slice(0,-1));var L=C.lastIndexOf("/");return L===-1?C:C.slice(L+1)}function s(C,L){typeof L=="string"&&(L=new Date(L));var P=L.getHours();P=P<<6|L.getMinutes(),P=P<<5|L.getSeconds()>>>1,C.write_shift(2,P);var N=L.getFullYear()-1980;N=N<<4|L.getMonth()+1,N=N<<5|L.getDate(),C.write_shift(2,N)}function a(C){var L=C.read_shift(2)&65535,P=C.read_shift(2)&65535,N=new Date,V=P&31;P>>>=5;var U=P&15;P>>>=4,N.setMilliseconds(0),N.setFullYear(P+1980),N.setMonth(U-1),N.setDate(V);var X=L&31;L>>>=5;var re=L&63;return L>>>=6,N.setHours(L),N.setMinutes(re),N.setSeconds(X<<1),N}function o(C){dr(C,0);for(var L={},P=0;C.l<=C.length-4;){var N=C.read_shift(2),V=C.read_shift(2),U=C.l+V,X={};switch(N){case 21589:P=C.read_shift(1),P&1&&(X.mtime=C.read_shift(4)),V>5&&(P&2&&(X.atime=C.read_shift(4)),P&4&&(X.ctime=C.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}C.l=U,L[N]=X}return L}var c;function l(){return c||(c={})}function u(C,L){if(C[0]==80&&C[1]==75)return Ka(C,L);if((C[0]|32)==109&&(C[1]|32)==105)return Nc(C,L);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var P=3,N=512,V=0,U=0,X=0,re=0,Q=0,Y=[],J=C.slice(0,512);dr(J,0);var me=h(J);switch(P=me[0],P){case 3:N=512;break;case 4:N=4096;break;case 0:if(me[1]==0)return Ka(C,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}N!==512&&(J=C.slice(0,N),dr(J,28));var Ee=C.slice(0,N);d(J,P);var ke=J.read_shift(4,"i");if(P===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);J.l+=4,X=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),re=J.read_shift(4,"i"),V=J.read_shift(4,"i"),Q=J.read_shift(4,"i"),U=J.read_shift(4,"i");for(var ve=-1,Ie=0;Ie<109&&(ve=J.read_shift(4,"i"),!(ve<0));++Ie)Y[Ie]=ve;var Be=m(C,N);x(Q,U,Be,N,Y);var _t=b(Be,X,Y,N);_t[X].name="!Directory",V>0&&re!==R&&(_t[re].name="!MiniFAT"),_t[Y[0]].name="!FAT",_t.fat_addrs=Y,_t.ssz=N;var lt={},bt=[],Wn=[],Xi=[];E(X,_t,Be,bt,V,lt,Wn,re),g(Wn,Xi,bt),bt.shift();var ci={FileIndex:Wn,FullPaths:Xi};return L&&L.raw&&(ci.raw={header:Ee,sectors:Be}),ci}function h(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(ae,"Header Signature: "),C.l+=16;var L=C.read_shift(2,"u");return[C.read_shift(2,"u"),L]}function d(C,L){var P=9;switch(C.l+=2,P=C.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function m(C,L){for(var P=Math.ceil(C.length/L)-1,N=[],V=1;V<P;++V)N[V-1]=C.slice(V*L,(V+1)*L);return N[P-1]=C.slice(P*L),N}function g(C,L,P){for(var N=0,V=0,U=0,X=0,re=0,Q=P.length,Y=[],J=[];N<Q;++N)Y[N]=J[N]=N,L[N]=P[N];for(;re<J.length;++re)N=J[re],V=C[N].L,U=C[N].R,X=C[N].C,Y[N]===N&&(V!==-1&&Y[V]!==V&&(Y[N]=Y[V]),U!==-1&&Y[U]!==U&&(Y[N]=Y[U])),X!==-1&&(Y[X]=N),V!==-1&&N!=Y[N]&&(Y[V]=Y[N],J.lastIndexOf(V)<re&&J.push(V)),U!==-1&&N!=Y[N]&&(Y[U]=Y[N],J.lastIndexOf(U)<re&&J.push(U));for(N=1;N<Q;++N)Y[N]===N&&(U!==-1&&Y[U]!==U?Y[N]=Y[U]:V!==-1&&Y[V]!==V&&(Y[N]=Y[V]));for(N=1;N<Q;++N)if(C[N].type!==0){if(re=N,re!=Y[re])do re=Y[re],L[N]=L[re]+"/"+L[N];while(re!==0&&Y[re]!==-1&&re!=Y[re]);Y[N]=-1}for(L[0]+="/",N=1;N<Q;++N)C[N].type!==2&&(L[N]+="/")}function p(C,L,P){for(var N=C.start,V=C.size,U=[],X=N;P&&V>0&&X>=0;)U.push(L.slice(X*k,X*k+k)),V-=k,X=ss(P,X*4);return U.length===0?ne(0):ar(U).slice(0,C.size)}function x(C,L,P,N,V){var U=R;if(C===R){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var X=P[C],re=(N>>>2)-1;if(!X)return;for(var Q=0;Q<re&&(U=ss(X,Q*4))!==R;++Q)V.push(U);x(ss(X,N-4),L-1,P,N,V)}}function T(C,L,P,N,V){var U=[],X=[];V||(V=[]);var re=N-1,Q=0,Y=0;for(Q=L;Q>=0;){V[Q]=!0,U[U.length]=Q,X.push(C[Q]);var J=P[Math.floor(Q*4/N)];if(Y=Q*4&re,N<4+Y)throw new Error("FAT boundary crossed: "+Q+" 4 "+N);if(!C[J])break;Q=ss(C[J],Y)}return{nodes:U,data:Yp([X])}}function b(C,L,P,N){var V=C.length,U=[],X=[],re=[],Q=[],Y=N-1,J=0,me=0,Ee=0,ke=0;for(J=0;J<V;++J)if(re=[],Ee=J+L,Ee>=V&&(Ee-=V),!X[Ee]){Q=[];var ve=[];for(me=Ee;me>=0;){ve[me]=!0,X[me]=!0,re[re.length]=me,Q.push(C[me]);var Ie=P[Math.floor(me*4/N)];if(ke=me*4&Y,N<4+ke)throw new Error("FAT boundary crossed: "+me+" 4 "+N);if(!C[Ie]||(me=ss(C[Ie],ke),ve[me]))break}U[Ee]={nodes:re,data:Yp([Q])}}return U}function E(C,L,P,N,V,U,X,re){for(var Q=0,Y=N.length?2:0,J=L[C].data,me=0,Ee=0,ke;me<J.length;me+=128){var ve=J.slice(me,me+128);dr(ve,64),Ee=ve.read_shift(2),ke=Ou(ve,0,Ee-Y),N.push(ke);var Ie={name:ke,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},Be=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);Be!==0&&(Ie.ct=F(ve,ve.l-8));var _t=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);_t!==0&&(Ie.mt=F(ve,ve.l-8)),Ie.start=ve.read_shift(4,"i"),Ie.size=ve.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=R,Ie.name=""),Ie.type===5?(Q=Ie.start,V>0&&Q!==R&&(L[Q].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",L[Ie.start]===void 0&&(L[Ie.start]=T(P,Ie.start,L.fat_addrs,L.ssz)),L[Ie.start].name=Ie.name,Ie.content=L[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:Q!==R&&Ie.start!==R&&L[Q]&&(Ie.content=p(Ie,L[Q].data,(L[re]||{}).data))),Ie.content&&dr(Ie.content,0),U[ke]=Ie,X.push(Ie)}}function F(C,L){return new Date((sr(C,L+4)/1e7*Math.pow(2,32)+sr(C,L)/1e7-11644473600)*1e3)}function M(C,L){return l(),u(c.readFileSync(C),L)}function O(C,L){var P=L&&L.type;switch(P||Ke&&Buffer.isBuffer(C)&&(P="buffer"),P||"base64"){case"file":return M(C,L);case"base64":return u(Xr(tn(C)),L);case"binary":return u(Xr(C),L)}return u(C,L)}function y(C,L){var P=L||{},N=P.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=N+"/",C.FileIndex[0]={name:N,type:5}),P.CLSID&&(C.FileIndex[0].clsid=P.CLSID),A(C)}function A(C){var L="Sh33tJ5";if(!Pe.find(C,"/"+L)){var P=ne(4);P[0]=55,P[1]=P[3]=50,P[2]=54,C.FileIndex.push({name:L,type:2,content:P,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+L),v(C)}}function v(C,L){y(C);for(var P=!1,N=!1,V=C.FullPaths.length-1;V>=0;--V){var U=C.FileIndex[V];switch(U.type){case 0:N?P=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(U.R*U.L*U.C)&&(P=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!L)){var X=new Date(1987,1,19),re=0,Q=Object.create?Object.create(null):{},Y=[];for(V=0;V<C.FullPaths.length;++V)Q[C.FullPaths[V]]=!0,C.FileIndex[V].type!==0&&Y.push([C.FullPaths[V],C.FileIndex[V]]);for(V=0;V<Y.length;++V){var J=n(Y[V][0]);N=Q[J],N||(Y.push([J,{name:i(J).replace("/",""),type:1,clsid:Ae,ct:X,mt:X,content:null}]),Q[J]=!0)}for(Y.sort(function(ke,ve){return t(ke[0],ve[0])}),C.FullPaths=[],C.FileIndex=[],V=0;V<Y.length;++V)C.FullPaths[V]=Y[V][0],C.FileIndex[V]=Y[V][1];for(V=0;V<Y.length;++V){var me=C.FileIndex[V],Ee=C.FullPaths[V];if(me.name=i(Ee).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||Ae,V===0)me.C=Y.length>1?1:-1,me.size=0,me.type=5;else if(Ee.slice(-1)=="/"){for(re=V+1;re<Y.length&&n(C.FullPaths[re])!=Ee;++re);for(me.C=re>=Y.length?-1:re,re=V+1;re<Y.length&&n(C.FullPaths[re])!=n(Ee);++re);me.R=re>=Y.length?-1:re,me.type=1}else n(C.FullPaths[V+1]||"")==n(Ee)&&(me.R=V+1),me.type=2}}}function S(C,L){var P=L||{};if(P.fileType=="mad")return lr(C,P);switch(v(C),P.fileType){case"zip":return qa(C,P)}var N=function(ke){for(var ve=0,Ie=0,Be=0;Be<ke.FileIndex.length;++Be){var _t=ke.FileIndex[Be];if(_t.content){var lt=_t.content.length;lt>0&&(lt<4096?ve+=lt+63>>6:Ie+=lt+511>>9)}}for(var bt=ke.FullPaths.length+3>>2,Wn=ve+7>>3,Xi=ve+127>>7,ci=Wn+Ie+bt+Xi,An=ci+127>>7,Ws=An<=109?0:Math.ceil((An-109)/127);ci+An+Ws+127>>7>An;)Ws=++An<=109?0:Math.ceil((An-109)/127);var $r=[1,Ws,An,Xi,bt,Ie,ve,0];return ke.FileIndex[0].size=ve<<6,$r[7]=(ke.FileIndex[0].start=$r[0]+$r[1]+$r[2]+$r[3]+$r[4]+$r[5])+($r[6]+7>>3),$r}(C),V=ne(N[7]<<9),U=0,X=0;{for(U=0;U<8;++U)V.write_shift(1,oe[U]);for(U=0;U<8;++U)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),U=0;U<3;++U)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,N[2]),V.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:R),V.write_shift(4,N[3]),V.write_shift(-4,N[1]?N[0]-1:R),V.write_shift(4,N[1]),U=0;U<109;++U)V.write_shift(-4,U<N[2]?N[1]+U:-1)}if(N[1])for(X=0;X<N[1];++X){for(;U<236+X*127;++U)V.write_shift(-4,U<N[2]?N[1]+U:-1);V.write_shift(-4,X===N[1]-1?R:X+1)}var re=function(ke){for(X+=ke;U<X-1;++U)V.write_shift(-4,U+1);ke&&(++U,V.write_shift(-4,R))};for(X=U=0,X+=N[1];U<X;++U)V.write_shift(-4,le.DIFSECT);for(X+=N[2];U<X;++U)V.write_shift(-4,le.FATSECT);re(N[3]),re(N[4]);for(var Q=0,Y=0,J=C.FileIndex[0];Q<C.FileIndex.length;++Q)J=C.FileIndex[Q],J.content&&(Y=J.content.length,!(Y<4096)&&(J.start=X,re(Y+511>>9)));for(re(N[6]+7>>3);V.l&511;)V.write_shift(-4,le.ENDOFCHAIN);for(X=U=0,Q=0;Q<C.FileIndex.length;++Q)J=C.FileIndex[Q],J.content&&(Y=J.content.length,!(!Y||Y>=4096)&&(J.start=X,re(Y+63>>6)));for(;V.l&511;)V.write_shift(-4,le.ENDOFCHAIN);for(U=0;U<N[4]<<2;++U){var me=C.FullPaths[U];if(!me||me.length===0){for(Q=0;Q<17;++Q)V.write_shift(4,0);for(Q=0;Q<3;++Q)V.write_shift(4,-1);for(Q=0;Q<12;++Q)V.write_shift(4,0);continue}J=C.FileIndex[U],U===0&&(J.start=J.size?J.start-1:R);var Ee=U===0&&P.root||J.name;if(Y=2*(Ee.length+1),V.write_shift(64,Ee,"utf16le"),V.write_shift(2,Y),V.write_shift(1,J.type),V.write_shift(1,J.color),V.write_shift(-4,J.L),V.write_shift(-4,J.R),V.write_shift(-4,J.C),J.clsid)V.write_shift(16,J.clsid,"hex");else for(Q=0;Q<4;++Q)V.write_shift(4,0);V.write_shift(4,J.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,J.start),V.write_shift(4,J.size),V.write_shift(4,0)}for(U=1;U<C.FileIndex.length;++U)if(J=C.FileIndex[U],J.size>=4096)if(V.l=J.start+1<<9,Ke&&Buffer.isBuffer(J.content))J.content.copy(V,V.l,0,J.size),V.l+=J.size+511&-512;else{for(Q=0;Q<J.size;++Q)V.write_shift(1,J.content[Q]);for(;Q&511;++Q)V.write_shift(1,0)}for(U=1;U<C.FileIndex.length;++U)if(J=C.FileIndex[U],J.size>0&&J.size<4096)if(Ke&&Buffer.isBuffer(J.content))J.content.copy(V,V.l,0,J.size),V.l+=J.size+63&-64;else{for(Q=0;Q<J.size;++Q)V.write_shift(1,J.content[Q]);for(;Q&63;++Q)V.write_shift(1,0)}if(Ke)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function I(C,L){var P=C.FullPaths.map(function(Q){return Q.toUpperCase()}),N=P.map(function(Q){var Y=Q.split("/");return Y[Y.length-(Q.slice(-1)=="/"?2:1)]}),V=!1;L.charCodeAt(0)===47?(V=!0,L=P[0].slice(0,-1)+L):V=L.indexOf("/")!==-1;var U=L.toUpperCase(),X=V===!0?P.indexOf(U):N.indexOf(U);if(X!==-1)return C.FileIndex[X];var re=!U.match(po);for(U=U.replace(kr,""),re&&(U=U.replace(po,"!")),X=0;X<P.length;++X)if((re?P[X].replace(po,"!"):P[X]).replace(kr,"")==U||(re?N[X].replace(po,"!"):N[X]).replace(kr,"")==U)return C.FileIndex[X];return null}var k=64,R=-2,ae="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function We(C,L,P){l();var N=S(C,P);c.writeFileSync(L,N)}function K(C){for(var L=new Array(C.length),P=0;P<C.length;++P)L[P]=String.fromCharCode(C[P]);return L.join("")}function Fe(C,L){var P=S(C,L);switch(L&&L.type||"buffer"){case"file":return l(),c.writeFileSync(L.filename,P),P;case"binary":return typeof P=="string"?P:K(P);case"base64":return Xo(typeof P=="string"?P:K(P));case"buffer":if(Ke)return Buffer.isBuffer(P)?P:ii(P);case"array":return typeof P=="string"?Xr(P):P}return P}var Ne;function B(C){try{var L=C.InflateRaw,P=new L;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)Ne=C;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function H(C,L){if(!Ne)return Us(C,L);var P=Ne.InflateRaw,N=new P,V=N._processChunk(C.slice(C.l),N._finishFlushFlag);return C.l+=N.bytesRead,V}function W(C){return Ne?Ne.deflateRawSync(C):Ue(C)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _e(C){var L=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(L>>16|L>>8|L)&255}for(var pe=typeof Uint8Array<"u",fe=pe?new Uint8Array(256):[],Ve=0;Ve<256;++Ve)fe[Ve]=_e(Ve);function G(C,L){var P=fe[C&255];return L<=8?P>>>8-L:(P=P<<8|fe[C>>8&255],L<=16?P>>>16-L:(P=P<<8|fe[C>>16&255],P>>>24-L))}function ot(C,L){var P=L&7,N=L>>>3;return(C[N]|(P<=6?0:C[N+1]<<8))>>>P&3}function Z(C,L){var P=L&7,N=L>>>3;return(C[N]|(P<=5?0:C[N+1]<<8))>>>P&7}function ue(C,L){var P=L&7,N=L>>>3;return(C[N]|(P<=4?0:C[N+1]<<8))>>>P&15}function xe(C,L){var P=L&7,N=L>>>3;return(C[N]|(P<=3?0:C[N+1]<<8))>>>P&31}function se(C,L){var P=L&7,N=L>>>3;return(C[N]|(P<=1?0:C[N+1]<<8))>>>P&127}function $e(C,L,P){var N=L&7,V=L>>>3,U=(1<<P)-1,X=C[V]>>>N;return P<8-N||(X|=C[V+1]<<8-N,P<16-N)||(X|=C[V+2]<<16-N,P<24-N)||(X|=C[V+3]<<24-N),X&U}function Qe(C,L,P){var N=L&7,V=L>>>3;return N<=5?C[V]|=(P&7)<<N:(C[V]|=P<<N&255,C[V+1]=(P&7)>>8-N),L+3}function mt(C,L,P){var N=L&7,V=L>>>3;return P=(P&1)<<N,C[V]|=P,L+1}function Yt(C,L,P){var N=L&7,V=L>>>3;return P<<=N,C[V]|=P&255,P>>>=8,C[V+1]=P,L+8}function Jt(C,L,P){var N=L&7,V=L>>>3;return P<<=N,C[V]|=P&255,P>>>=8,C[V+1]=P&255,C[V+2]=P>>>8,L+16}function jr(C,L){var P=C.length,N=2*P>L?2*P:L+5,V=0;if(P>=L)return C;if(Ke){var U=Dp(N);if(C.copy)C.copy(U);else for(;V<C.length;++V)U[V]=C[V];return U}else if(pe){var X=new Uint8Array(N);if(X.set)X.set(C);else for(;V<P;++V)X[V]=C[V];return X}return C.length=N,C}function rr(C){for(var L=new Array(C),P=0;P<C;++P)L[P]=0;return L}function ct(C,L,P){var N=1,V=0,U=0,X=0,re=0,Q=C.length,Y=pe?new Uint16Array(32):rr(32);for(U=0;U<32;++U)Y[U]=0;for(U=Q;U<P;++U)C[U]=0;Q=C.length;var J=pe?new Uint16Array(Q):rr(Q);for(U=0;U<Q;++U)Y[V=C[U]]++,N<V&&(N=V),J[U]=0;for(Y[0]=0,U=1;U<=N;++U)Y[U+16]=re=re+Y[U-1]<<1;for(U=0;U<Q;++U)re=C[U],re!=0&&(J[U]=Y[re+16]++);var me=0;for(U=0;U<Q;++U)if(me=C[U],me!=0)for(re=G(J[U],N)>>N-me,X=(1<<N+4-me)-1;X>=0;--X)L[re|X<<me]=me&15|U<<4;return N}var Ze=pe?new Uint16Array(512):rr(512),It=pe?new Uint16Array(32):rr(32);if(!pe){for(var kt=0;kt<512;++kt)Ze[kt]=0;for(kt=0;kt<32;++kt)It[kt]=0}(function(){for(var C=[],L=0;L<32;L++)C.push(5);ct(C,It,32);var P=[];for(L=0;L<=143;L++)P.push(8);for(;L<=255;L++)P.push(9);for(;L<=279;L++)P.push(7);for(;L<=287;L++)P.push(8);ct(P,Ze,288)})();var Fr=function(){for(var L=pe?new Uint8Array(32768):[],P=0,N=0;P<de.length-1;++P)for(;N<de[P+1];++N)L[N]=P;for(;N<32768;++N)L[N]=29;var V=pe?new Uint8Array(259):[];for(P=0,N=0;P<ie.length-1;++P)for(;N<ie[P+1];++N)V[N]=P;function U(re,Q){for(var Y=0;Y<re.length;){var J=Math.min(65535,re.length-Y),me=Y+J==re.length;for(Q.write_shift(1,+me),Q.write_shift(2,J),Q.write_shift(2,~J&65535);J-- >0;)Q[Q.l++]=re[Y++]}return Q.l}function X(re,Q){for(var Y=0,J=0,me=pe?new Uint16Array(32768):[];J<re.length;){var Ee=Math.min(65535,re.length-J);if(Ee<10){for(Y=Qe(Q,Y,+(J+Ee==re.length)),Y&7&&(Y+=8-(Y&7)),Q.l=Y/8|0,Q.write_shift(2,Ee),Q.write_shift(2,~Ee&65535);Ee-- >0;)Q[Q.l++]=re[J++];Y=Q.l*8;continue}Y=Qe(Q,Y,+(J+Ee==re.length)+2);for(var ke=0;Ee-- >0;){var ve=re[J];ke=(ke<<5^ve)&32767;var Ie=-1,Be=0;if((Ie=me[ke])&&(Ie|=J&-32768,Ie>J&&(Ie-=32768),Ie<J))for(;re[Ie+Be]==re[J+Be]&&Be<250;)++Be;if(Be>2){ve=V[Be],ve<=22?Y=Yt(Q,Y,fe[ve+1]>>1)-1:(Yt(Q,Y,3),Y+=5,Yt(Q,Y,fe[ve-23]>>5),Y+=3);var _t=ve<8?0:ve-4>>2;_t>0&&(Jt(Q,Y,Be-ie[ve]),Y+=_t),ve=L[J-Ie],Y=Yt(Q,Y,fe[ve]>>3),Y-=3;var lt=ve<4?0:ve-2>>1;lt>0&&(Jt(Q,Y,J-Ie-de[ve]),Y+=lt);for(var bt=0;bt<Be;++bt)me[ke]=J&32767,ke=(ke<<5^re[J])&32767,++J;Ee-=Be-1}else ve<=143?ve=ve+48:Y=mt(Q,Y,1),Y=Yt(Q,Y,fe[ve]),me[ke]=J&32767,++J}Y=Yt(Q,Y,0)-1}return Q.l=(Y+7)/8|0,Q.l}return function(Q,Y){return Q.length<8?U(Q,Y):X(Q,Y)}}();function Ue(C){var L=ne(50+Math.floor(C.length*1.1)),P=Fr(C,L);return L.slice(0,P)}var yt=pe?new Uint16Array(32768):rr(32768),$t=pe?new Uint16Array(32768):rr(32768),Ct=pe?new Uint16Array(128):rr(128),sn=1,Bs=1;function zu(C,L){var P=xe(C,L)+257;L+=5;var N=xe(C,L)+1;L+=5;var V=ue(C,L)+4;L+=4;for(var U=0,X=pe?new Uint8Array(19):rr(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Q=1,Y=pe?new Uint8Array(8):rr(8),J=pe?new Uint8Array(8):rr(8),me=X.length,Ee=0;Ee<V;++Ee)X[z[Ee]]=U=Z(C,L),Q<U&&(Q=U),Y[U]++,L+=3;var ke=0;for(Y[0]=0,Ee=1;Ee<=Q;++Ee)J[Ee]=ke=ke+Y[Ee-1]<<1;for(Ee=0;Ee<me;++Ee)(ke=X[Ee])!=0&&(re[Ee]=J[ke]++);var ve=0;for(Ee=0;Ee<me;++Ee)if(ve=X[Ee],ve!=0){ke=fe[re[Ee]]>>8-ve;for(var Ie=(1<<7-ve)-1;Ie>=0;--Ie)Ct[ke|Ie<<ve]=ve&7|Ee<<3}var Be=[];for(Q=1;Be.length<P+N;)switch(ke=Ct[se(C,L)],L+=ke&7,ke>>>=3){case 16:for(U=3+ot(C,L),L+=2,ke=Be[Be.length-1];U-- >0;)Be.push(ke);break;case 17:for(U=3+Z(C,L),L+=3;U-- >0;)Be.push(0);break;case 18:for(U=11+se(C,L),L+=7;U-- >0;)Be.push(0);break;default:Be.push(ke),Q<ke&&(Q=ke);break}var _t=Be.slice(0,P),lt=Be.slice(P);for(Ee=P;Ee<286;++Ee)_t[Ee]=0;for(Ee=N;Ee<30;++Ee)lt[Ee]=0;return sn=ct(_t,yt,286),Bs=ct(lt,$t,30),L}function Hu(C,L){if(C[0]==3&&!(C[1]&3))return[Pi(L),2];for(var P=0,N=0,V=Dp(L||1<<18),U=0,X=V.length>>>0,re=0,Q=0;!(N&1);){if(N=Z(C,P),P+=3,N>>>1)N>>1==1?(re=9,Q=5):(P=zu(C,P),re=sn,Q=Bs);else{P&7&&(P+=8-(P&7));var Y=C[P>>>3]|C[(P>>>3)+1]<<8;if(P+=32,Y>0)for(!L&&X<U+Y&&(V=jr(V,U+Y),X=V.length);Y-- >0;)V[U++]=C[P>>>3],P+=8;continue}for(;;){!L&&X<U+32767&&(V=jr(V,U+32767),X=V.length);var J=$e(C,P,re),me=N>>>1==1?Ze[J]:yt[J];if(P+=me&15,me>>>=4,!(me>>>8&255))V[U++]=me;else{if(me==256)break;me-=257;var Ee=me<8?0:me-4>>2;Ee>5&&(Ee=0);var ke=U+ie[me];Ee>0&&(ke+=$e(C,P,Ee),P+=Ee),J=$e(C,P,Q),me=N>>>1==1?It[J]:$t[J],P+=me&15,me>>>=4;var ve=me<4?0:me-2>>1,Ie=de[me];for(ve>0&&(Ie+=$e(C,P,ve),P+=ve),!L&&X<ke&&(V=jr(V,ke+100),X=V.length);U<ke;)V[U]=V[U-Ie],++U}}}return L?[V,P+7>>>3]:[V.slice(0,U),P+7>>>3]}function Us(C,L){var P=C.slice(C.l||0),N=Hu(P,L);return C.l+=N[1],N[0]}function $a(C,L){if(C)typeof console<"u"&&console.error(L);else throw new Error(L)}function Ka(C,L){var P=C;dr(P,0);var N=[],V=[],U={FileIndex:N,FullPaths:V};y(U,{root:L.root});for(var X=P.length-4;(P[X]!=80||P[X+1]!=75||P[X+2]!=5||P[X+3]!=6)&&X>=0;)--X;P.l=X+4,P.l+=4;var re=P.read_shift(2);P.l+=6;var Q=P.read_shift(4);for(P.l=Q,X=0;X<re;++X){P.l+=20;var Y=P.read_shift(4),J=P.read_shift(4),me=P.read_shift(2),Ee=P.read_shift(2),ke=P.read_shift(2);P.l+=8;var ve=P.read_shift(4),Ie=o(P.slice(P.l+me,P.l+me+Ee));P.l+=me+Ee+ke;var Be=P.l;P.l=ve+4,$i(P,Y,J,U,Ie),P.l=Be}return U}function $i(C,L,P,N,V){C.l+=2;var U=C.read_shift(2),X=C.read_shift(2),re=a(C);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var Q=C.read_shift(4),Y=C.read_shift(4),J=C.read_shift(4),me=C.read_shift(2),Ee=C.read_shift(2),ke="",ve=0;ve<me;++ve)ke+=String.fromCharCode(C[C.l++]);if(Ee){var Ie=o(C.slice(C.l,C.l+Ee));(Ie[21589]||{}).mt&&(re=Ie[21589].mt),((V||{})[21589]||{}).mt&&(re=V[21589].mt)}C.l+=Ee;var Be=C.slice(C.l,C.l+Y);switch(X){case 8:Be=H(C,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var _t=!1;U&8&&(Q=C.read_shift(4),Q==134695760&&(Q=C.read_shift(4),_t=!0),Y=C.read_shift(4),J=C.read_shift(4)),Y!=L&&$a(_t,"Bad compressed size: "+L+" != "+Y),J!=P&&$a(_t,"Bad uncompressed size: "+P+" != "+J),Gn(N,ke,Be,{unsafe:!0,mt:re})}function qa(C,L){var P=L||{},N=[],V=[],U=ne(1),X=P.compression?8:0,re=0,Q=0,Y=0,J=0,me=0,Ee=C.FullPaths[0],ke=Ee,ve=C.FileIndex[0],Ie=[],Be=0;for(Q=1;Q<C.FullPaths.length;++Q)if(ke=C.FullPaths[Q].slice(Ee.length),ve=C.FileIndex[Q],!(!ve.size||!ve.content||ke=="Sh33tJ5")){var _t=J,lt=ne(ke.length);for(Y=0;Y<ke.length;++Y)lt.write_shift(1,ke.charCodeAt(Y)&127);lt=lt.slice(0,lt.l),Ie[me]=sk.buf(ve.content,0);var bt=ve.content;X==8&&(bt=W(bt)),U=ne(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,re),U.write_shift(2,X),ve.mt?s(U,ve.mt):U.write_shift(4,0),U.write_shift(-4,Ie[me]),U.write_shift(4,bt.length),U.write_shift(4,ve.content.length),U.write_shift(2,lt.length),U.write_shift(2,0),J+=U.length,N.push(U),J+=lt.length,N.push(lt),J+=bt.length,N.push(bt),U=ne(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,re),U.write_shift(2,X),U.write_shift(4,0),U.write_shift(-4,Ie[me]),U.write_shift(4,bt.length),U.write_shift(4,ve.content.length),U.write_shift(2,lt.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,_t),Be+=U.l,V.push(U),Be+=lt.length,V.push(lt),++me}return U=ne(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,me),U.write_shift(2,me),U.write_shift(4,Be),U.write_shift(4,J),U.write_shift(2,0),ar([ar(N),ar(V),U])}var oi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Un(C,L){if(C.ctype)return C.ctype;var P=C.name||"",N=P.match(/\.([^\.]+)$/);return N&&oi[N[1]]||L&&(N=(P=L).match(/[\.\\]([^\.\\])+$/),N&&oi[N[1]])?oi[N[1]]:"application/octet-stream"}function Dc(C){for(var L=Xo(C),P=[],N=0;N<L.length;N+=76)P.push(L.slice(N,N+76));return P.join(`\r
`)+`\r
`}function Gs(C){var L=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var J=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],N=L.split(`\r
`),V=0;V<N.length;++V){var U=N[V];if(U.length==0){P.push("");continue}for(var X=0;X<U.length;){var re=76,Q=U.slice(X,X+re);Q.charAt(re-1)=="="?re--:Q.charAt(re-2)=="="?re-=2:Q.charAt(re-3)=="="&&(re-=3),Q=U.slice(X,X+re),X+=re,X<U.length&&(Q+="="),P.push(Q)}}return P.join(`\r
`)}function Pc(C){for(var L=[],P=0;P<C.length;++P){for(var N=C[P];P<=C.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+C[++P];L.push(N)}for(var V=0;V<L.length;++V)L[V]=L[V].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Xr(L.join(`\r
`))}function Ki(C,L,P){for(var N="",V="",U="",X,re=0;re<10;++re){var Q=L[re];if(!Q||Q.match(/^\s*$/))break;var Y=Q.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":N=Y[2].trim();break;case"content-type":U=Y[2].trim();break;case"content-transfer-encoding":V=Y[2].trim();break}}switch(++re,V.toLowerCase()){case"base64":X=Xr(tn(L.slice(re).join("")));break;case"quoted-printable":X=Pc(L.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var J=Gn(C,N.slice(P.length),X,{unsafe:!0});U&&(J.ctype=U)}function Nc(C,L){if(K(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=L&&L.root||"",N=(Ke&&Buffer.isBuffer(C)?C.toString("binary"):K(C)).split(`\r
`),V=0,U="";for(V=0;V<N.length;++V)if(U=N[V],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),P||(P=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),U.slice(0,P.length)!=P););var X=(N[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var re="--"+(X[1]||""),Q=[],Y=[],J={FileIndex:Q,FullPaths:Y};y(J);var me,Ee=0;for(V=0;V<N.length;++V){var ke=N[V];ke!==re&&ke!==re+"--"||(Ee++&&Ki(J,N.slice(me,V),P),me=V)}return J}function lr(C,L){var P=L||{},N=P.boundary||"SheetJS";N="------="+N;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],U=C.FullPaths[0],X=U,re=C.FileIndex[0],Q=1;Q<C.FullPaths.length;++Q)if(X=C.FullPaths[Q].slice(U.length),re=C.FileIndex[Q],!(!re.size||!re.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var Y=re.content,J=Ke&&Buffer.isBuffer(Y)?Y.toString("binary"):K(Y),me=0,Ee=Math.min(1024,J.length),ke=0,ve=0;ve<=Ee;++ve)(ke=J.charCodeAt(ve))>=32&&ke<128&&++me;var Ie=me>=Ee*4/5;V.push(N),V.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+X),V.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),V.push("Content-Type: "+Un(re,X)),V.push(""),V.push(Ie?Gs(J):Dc(J))}return V.push(N+`--\r
`),V.join(`\r
`)}function Oc(C){var L={};return y(L,C),L}function Gn(C,L,P,N){var V=N&&N.unsafe;V||y(C);var U=!V&&Pe.find(C,L);if(!U){var X=C.FullPaths[0];L.slice(0,X.length)==X?X=L:(X.slice(-1)!="/"&&(X+="/"),X=(X+L).replace("//","/")),U={name:i(L),type:2},C.FileIndex.push(U),C.FullPaths.push(X),V||Pe.utils.cfb_gc(C)}return U.content=P,U.size=P?P.length:0,N&&(N.CLSID&&(U.clsid=N.CLSID),N.mt&&(U.mt=N.mt),N.ct&&(U.ct=N.ct)),U}function qi(C,L){y(C);var P=Pe.find(C,L);if(P){for(var N=0;N<C.FileIndex.length;++N)if(C.FileIndex[N]==P)return C.FileIndex.splice(N,1),C.FullPaths.splice(N,1),!0}return!1}function ju(C,L,P){y(C);var N=Pe.find(C,L);if(N){for(var V=0;V<C.FileIndex.length;++V)if(C.FileIndex[V]==N)return C.FileIndex[V].name=i(P),C.FullPaths[V]=P,!0}return!1}function $u(C){v(C,!0)}return e.find=I,e.read=O,e.parse=u,e.write=Fe,e.writeFile=We,e.utils={cfb_new:Oc,cfb_add:Gn,cfb_del:qi,cfb_mov:ju,cfb_gc:$u,ReadShift:To,CheckField:lv,prep_blob:dr,bconcat:ar,use_zlib:B,_deflateRaw:Ue,_inflateRaw:Us,consts:le},e}();let wi;function ak(r){wi=r}function ok(r){return typeof r=="string"?Tc(r):Array.isArray(r)?DI(r):r}function Sc(r,e,t){if(typeof wi<"u"&&wi.writeFileSync)return t?wi.writeFileSync(r,e,t):wi.writeFileSync(r,e);if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Tc(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?Rn(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var i=new Blob([ok(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=zi(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function ck(r){if(typeof wi<"u")return wi.readFileSync(r);if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Bt(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function Up(r,e){for(var t=[],n=Bt(r),i=0;i!==n.length;++i)t[r[n[i]][e]]==null&&(t[r[n[i]][e]]=n[i]);return t}function Du(r){for(var e=[],t=Bt(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function Pu(r){for(var e=[],t=Bt(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function lk(r){for(var e=[],t=Bt(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var Jl=new Date(1899,11,30,0,0,0);function er(r,e){var t=r.getTime(),n=Jl.getTime()+(r.getTimezoneOffset()-Jl.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var $x=new Date,uk=Jl.getTime()+($x.getTimezoneOffset()-Jl.getTimezoneOffset())*6e4,Gp=$x.getTimezoneOffset();function Nu(r){var e=new Date;return e.setTime(r*24*60*60*1e3+uk),e.getTimezoneOffset()!==Gp&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Gp)*6e4),e}function fk(r){var e=0,t=0,n=!1,i=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(i[s],10)}return e}var Wp=new Date("2017-02-19T19:06:09.000Z"),Kx=isNaN(Wp.getFullYear())?new Date("2/19/17"):Wp,hk=Kx.getFullYear()==2017;function St(r,e){var t=new Date(r);if(hk)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(Kx.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function As(r,e){if(Ke&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return Rn(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Rn(Px(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return Rn(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Rn(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function vt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=vt(r[t]));return e}function Lt(r,e){for(var t="";t.length<e;)t+=r;return t}function wn(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var dk=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fa(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&dk.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var mk=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function qx(r){return r?r.content&&r.type?As(r.content,!0):r.data?aa(r.data):r.asNodeBuffer&&Ke?aa(r.asNodeBuffer().toString("binary")):r.asBinary?aa(r.asBinary()):r._data&&r._data.getContent?aa(As(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function Xx(r){if(!r)return null;if(r.data)return ql(r.data);if(r.asNodeBuffer&&Ke)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?ql(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function pk(r){return r&&r.name.slice(-4)===".bin"?Xx(r):qx(r)}function un(r,e){for(var t=r.FullPaths||Bt(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function O0(r,e){var t=un(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Xt(r,e,t){if(!t)return pk(O0(r,e));if(!e)return null;try{return Xt(r,e)}catch{return null}}function Qr(r,e,t){if(!t)return qx(O0(r,e));if(!e)return null;try{return Qr(r,e)}catch{return null}}function gk(r,e,t){return Xx(O0(r,e))}function zp(r){for(var e=r.FullPaths||Bt(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function He(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return Ke?n=ii(t):n=PI(t),Pe.utils.cfb_add(r,e,n)}Pe.utils.cfb_add(r,e,t)}else r.file(e,t)}function L0(){return Pe.utils.cfb_new()}function Qx(r,e){switch(e.type){case"base64":return Pe.read(r,{type:"base64"});case"binary":return Pe.read(r,{type:"binary"});case"buffer":case"array":return Pe.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function go(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var jt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_k=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Hp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,xk=/<[^>]*>/g,Rr=jt.match(Hp)?Hp:xk,vk=/<\w*:/,yk=/<(\/?)\w+:/;function Me(r,e,t){for(var n={},i=0,s=0;i!==r.length&&!((s=r.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=r.slice(0,i)),i===r.length)return n;var a=r.match(_k),o=0,c="",l=0,u="",h="",d=1;if(a)for(l=0;l!=a.length;++l){for(h=a[l],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,c=h.slice(s+1+d,h.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var m=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[m]&&u.slice(o-3,o)=="ext")continue;n[m]=c,n[m.toLowerCase()]=c}}return n}function Vn(r){return r.replace(yk,"<$1")}var Yx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},M0=Du(Yx),it=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(r,function(o,c){return Yx[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,a)+t(i.slice(a+3))}}(),V0=/[&<>'"]/g,wk=/[\u0000-\u0008\u000b-\u001f]/g;function dt(r){var e=r+"";return e.replace(V0,function(t){return M0[t]}).replace(wk,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function jp(r){return dt(r).replace(/ /g,"_x0020_")}var Jx=/[\u0000-\u001f]/g;function B0(r){var e=r+"";return e.replace(V0,function(t){return M0[t]}).replace(/\n/g,"<br/>").replace(Jx,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Ek(r){var e=r+"";return e.replace(V0,function(t){return M0[t]}).replace(Jx,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var $p=function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}}();function Tk(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function Tt(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _f(r){for(var e="",t=0,n=0,i=0,s=0,a=0,o=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=r.charCodeAt(t++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Kp(r){var e=Pi(2*r.length),t,n,i=1,s=0,a=0,o;for(n=0;n<r.length;n+=i)i=1,(o=r.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(n+1)&63),i=2):o<240?(t=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function qp(r){return ii(r,"binary").toString("utf8")}var nl="foo bar baz",pt=Ke&&(qp(nl)==_f(nl)&&qp||Kp(nl)==_f(nl)&&Kp)||_f,Rn=Ke?function(r){return ii(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Yo=function(){var r={};return function(t,n){var i=t+"|"+(n||"");return r[i]?r[i]:r[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Zx=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}}(),Ak=function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Sk=/<\/?(?:vt:)?variant>/g,Ik=/<(?:vt:)([^>]*)>([\s\S]*)</;function Xp(r,e){var t=Me(r),n=r.match(Ak(t.baseType))||[],i=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(s){var a=s.replace(Sk,"").match(Ik);a&&i.push({v:pt(a[2]),t:a[1]})}),i}var ev=/(^\s|\s$|\n)/;function pr(r,e){return"<"+r+(e.match(ev)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function Jo(r){return Bt(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function ye(r,e,t){return"<"+r+(t!=null?Jo(t):"")+(e!=null?(e.match(ev)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function fh(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function kk(r,e){switch(typeof r){case"string":var t=ye("vt:lpwstr",dt(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return ye((r|0)==r?"vt:i4":"vt:r8",dt(String(r)));case"boolean":return ye("vt:bool",r?"true":"false")}if(r instanceof Date)return ye("vt:filetime",fh(r));throw new Error("Unable to serialize "+r)}function U0(r){if(Ke&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return pt(zi(D0(r)));throw new Error("Bad input format: expected Buffer or string")}var Zo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ps=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],qr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Ck(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,s=5;s>=0;--s)i=i*256+r[e+s];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function bk(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(i&15)<<4|s&15,r[t+7]=i>>4|n}var Qp=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,s=r[0][n].length;i<s;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},Yp=Ke?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:ii(e)})):Qp(r)}:Qp,Jp=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(Yn(r,i)));return n.join("").replace(kr,"")},Ou=Ke?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(kr,""):Jp(r,e,t)}:Jp,Zp=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},tv=Ke?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):Zp(r,e,t)}:Zp,eg=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(ia(r,i)));return n.join("")},za=Ke?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):eg(e,t,n)}:eg,rv=function(r,e){var t=sr(r,e);return t>0?za(r,e+4,e+4+t-1):""},G0=rv,nv=function(r,e){var t=sr(r,e);return t>0?za(r,e+4,e+4+t-1):""},W0=nv,iv=function(r,e){var t=2*sr(r,e);return t>0?za(r,e+4,e+4+t-1):""},z0=iv,sv=function(e,t){var n=sr(e,t);return n>0?Ou(e,t+4,t+4+n):""},H0=sv,av=function(r,e){var t=sr(r,e);return t>0?za(r,e+4,e+4+t):""},j0=av,ov=function(r,e){return Ck(r,e)},Zl=ov,$0=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ke&&(G0=function(e,t){if(!Buffer.isBuffer(e))return rv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},W0=function(e,t){if(!Buffer.isBuffer(e))return nv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},z0=function(e,t){if(!Buffer.isBuffer(e))return iv(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},H0=function(e,t){if(!Buffer.isBuffer(e))return sv(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},j0=function(e,t){if(!Buffer.isBuffer(e))return av(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Zl=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):ov(e,t)},$0=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function cv(){Ou=function(r,e,t){return rt.utils.decode(1200,r.slice(e,t)).replace(kr,"")},za=function(r,e,t){return rt.utils.decode(65001,r.slice(e,t))},G0=function(r,e){var t=sr(r,e);return t>0?rt.utils.decode(Es,r.slice(e+4,e+4+t-1)):""},W0=function(r,e){var t=sr(r,e);return t>0?rt.utils.decode(Zr,r.slice(e+4,e+4+t-1)):""},z0=function(r,e){var t=2*sr(r,e);return t>0?rt.utils.decode(1200,r.slice(e+4,e+4+t-1)):""},H0=function(r,e){var t=sr(r,e);return t>0?rt.utils.decode(1200,r.slice(e+4,e+4+t)):""},j0=function(r,e){var t=sr(r,e);return t>0?rt.utils.decode(65001,r.slice(e+4,e+4+t)):""}}typeof rt<"u"&&cv();var ia=function(r,e){return r[e]},Yn=function(r,e){return r[e+1]*256+r[e]},Rk=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},sr=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},ss=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},Fk=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function To(r,e){var t="",n,i,s=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,Ke&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)t+=String.fromCharCode(Yn(this,l)),l+=2;r*=2;break;case"utf8":t=za(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Ou(this,this.l,this.l+r);break;case"wstr":if(typeof rt<"u")t=rt.utils.decode(Zr,this.slice(this.l,this.l+2*r));else return To.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":t=G0(this,this.l),r=4+sr(this,this.l);break;case"lpstr-cp":t=W0(this,this.l),r=4+sr(this,this.l);break;case"lpwstr":t=z0(this,this.l),r=4+2*sr(this,this.l);break;case"lpp4":r=4+sr(this,this.l),t=H0(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+sr(this,this.l),t=j0(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=ia(this,this.l+r++))!==0;)s.push(mo(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=Yn(this,this.l+r))!==0;)s.push(mo(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=ia(this,l),this.l=l+1,o=To.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(mo(Yn(this,l))),l+=2}t=s.join(""),r*=2;break;case"cpstr":if(typeof rt<"u"){t=rt.utils.decode(Zr,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(t="",l=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=ia(this,l),this.l=l+1,o=To.call(this,r-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(mo(ia(this,l))),l+=1}t=s.join("");break;default:switch(r){case 1:return n=ia(this,this.l),this.l++,n;case 2:return n=(e==="i"?Rk:Yn)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(r>0?ss:Fk)(this,this.l),this.l+=4,n):(i=sr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=Zl(this,this.l):i=Zl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=tv(this,this.l,r);break}}return this.l+=r,t}var Dk=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},Pk=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},Nk=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function Ok(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)Nk(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){if(typeof rt<"u"&&Es==874)for(i=0;i!=e.length;++i){var s=rt.utils.encode(Es,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Dk(this,e,this.l);break;case 8:if(n=8,t==="f"){bk(this,e,this.l);break}case 16:break;case-4:n=4,Pk(this,e,this.l);break}return this.l+=n,this}function lv(r,e){var t=tv(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function dr(r,e){r.l=e,r.read_shift=To,r.chk=lv,r.write_shift=Ok}function br(r,e){r.l+=e}function ne(r){var e=Pi(r);return dr(e,0),e}function si(r,e,t){if(r){var n,i,s;dr(r,r.l||0);for(var a=r.length,o=0,c=0;r.l<a;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var l=sc[o]||sc[65535];for(n=r.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=r.read_shift(1))&127)<<7*i;c=r.l+s;var u=l.f&&l.f(r,s,t);if(r.l=c,e(u,l,o))return}}}function Ur(){var r=[],e=Ke?256:2048,t=function(l){var u=ne(l);return dr(u,0),u},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(i(),n=t(Math.max(l+1,e)))},a=function(){return i(),ar(r)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:r}}function ce(r,e,t,n){var i=+e,s;if(!isNaN(i)){n||(n=sc[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=r.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&$0(t)&&r.push(t)}}function Ao(r,e,t){var n=vt(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function tg(r,e,t){var n=vt(r);return n.s=Ao(n.s,e.s,t),n.e=Ao(n.e,e.s,t),n}function So(r,e){if(r.cRel&&r.c<0)for(r=vt(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=vt(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=Le(r);return!r.cRel&&r.cRel!=null&&(t=Vk(t)),!r.rRel&&r.rRel!=null&&(t=Lk(t)),t}function xf(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+At(r.s.c)+":"+(r.e.cRel?"":"$")+At(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Mt(r.s.r)+":"+(r.e.rRel?"":"$")+Mt(r.e.r):So(r.s,e.biff)+":"+So(r.e,e.biff)}function K0(r){return parseInt(Mk(r),10)-1}function Mt(r){return""+(r+1)}function Lk(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Mk(r){return r.replace(/\$(\d+)$/,"$1")}function q0(r){for(var e=Bk(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function At(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function Vk(r){return r.replace(/^([A-Z])/,"$$$1")}function Bk(r){return r.replace(/^\$([A-Z])/,"$1")}function Uk(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pt(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Le(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function Or(r){var e=r.indexOf(":");return e==-1?{s:Pt(r),e:Pt(r)}:{s:Pt(r.slice(0,e)),e:Pt(r.slice(e+1))}}function ze(r,e){return typeof e>"u"||typeof e=="number"?ze(r.s,r.e):(typeof r!="string"&&(r=Le(r)),typeof e!="string"&&(e=Le(e)),r==e?r:r+":"+e)}function Je(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=r.length;for(t=0;n<s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=s&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function rg(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=rn(r.z,t?er(e):e)}catch{}try{return r.w=rn((r.XF||{}).numFmtId||(t?14:0),t?er(e):e)}catch{return""+e}}function On(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?ai[r.v]||r.v:e==null?rg(r,r.v):rg(r,e))}function Hi(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function uv(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,s=r||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Pt(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Je(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),a==-1&&(l.e.r=a=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},g=a+h,p=o+d;if(l.s.r>g&&(l.s.r=g),l.s.c>p&&(l.s.c=p),l.e.r<g&&(l.e.r=g),l.e.c<p&&(l.e.c=p),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Oe[14],n.cellDates?(m.t="d",m.w=rn(m.z,er(m.v))):(m.t="n",m.v=er(m.v),m.w=rn(m.z,m.v))):m.t="s";if(i)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(m.z=s[g][p].z),s[g][p]=m;else{var x=Le({c:p,r:g});s[x]&&s[x].z&&(m.z=s[x].z),s[x]=m}}}return l.s.c<1e7&&(s["!ref"]=ze(l)),s}function Ha(r,e){return uv(null,r,e)}function Gk(r){return r.read_shift(4,"i")}function En(r,e){return e||(e=ne(4)),e.write_shift(4,r),e}function Cr(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function or(r,e){var t=!1;return e==null&&(t=!0,e=ne(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function Wk(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function zk(r,e){return e||(e=ne(4)),e.write_shift(2,0),e.write_shift(2,0),e}function X0(r,e){var t=r.l,n=r.read_shift(1),i=Cr(r),s=[],a={t:i,h:i};if(n&1){for(var o=r.read_shift(4),c=0;c!=o;++c)s.push(Wk(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}function Hk(r,e){var t=!1;return e==null&&(t=!0,e=ne(15+4*r.t.length)),e.write_shift(1,0),or(r.t,e),t?e.slice(0,e.l):e}var jk=X0;function $k(r,e){var t=!1;return e==null&&(t=!0,e=ne(23+4*r.t.length)),e.write_shift(1,1),or(r.t,e),e.write_shift(4,1),zk({},e),t?e.slice(0,e.l):e}function mn(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Ns(r,e){return e==null&&(e=ne(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function Os(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Ls(r,e){return e==null&&(e=ne(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var Kk=Cr,fv=or;function Q0(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function eu(r,e){var t=!1;return e==null&&(t=!0,e=ne(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var qk=Cr,hh=Q0,Y0=eu;function J0(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?Zl([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ss(e,0)>>2;return t?i/100:i}function hv(r,e){e==null&&(e=ne(4));var t=0,n=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function dv(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function Xk(r,e){return e||(e=ne(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Ms=dv,ja=Xk;function Ar(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Ss(r,e){return(e||ne(8)).write_shift(8,r,"f")}function Qk(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var l=cs[i];l&&(e.rgb=tc(l));break;case 2:e.rgb=tc([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function tu(r,e){if(e||(e=ne(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Yk(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function Jk(r,e){e||(e=ne(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function mv(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function Zk(r){return mv(r,1)}function e4(r){return mv(r,2)}var Z0=2,Lr=3,il=11,ng=12,ru=19,sl=64,t4=65,r4=71,n4=4108,i4=4126,ir=80,pv=81,s4=[ir,pv],dh={1:{n:"CodePage",t:Z0},2:{n:"Category",t:ir},3:{n:"PresentationFormat",t:ir},4:{n:"ByteCount",t:Lr},5:{n:"LineCount",t:Lr},6:{n:"ParagraphCount",t:Lr},7:{n:"SlideCount",t:Lr},8:{n:"NoteCount",t:Lr},9:{n:"HiddenCount",t:Lr},10:{n:"MultimediaClipCount",t:Lr},11:{n:"ScaleCrop",t:il},12:{n:"HeadingPairs",t:n4},13:{n:"TitlesOfParts",t:i4},14:{n:"Manager",t:ir},15:{n:"Company",t:ir},16:{n:"LinksUpToDate",t:il},17:{n:"CharacterCount",t:Lr},19:{n:"SharedDoc",t:il},22:{n:"HyperlinksChanged",t:il},23:{n:"AppVersion",t:Lr,p:"version"},24:{n:"DigSig",t:t4},26:{n:"ContentType",t:ir},27:{n:"ContentStatus",t:ir},28:{n:"Language",t:ir},29:{n:"Version",t:ir},255:{},2147483648:{n:"Locale",t:ru},2147483651:{n:"Behavior",t:ru},1919054434:{}},mh={1:{n:"CodePage",t:Z0},2:{n:"Title",t:ir},3:{n:"Subject",t:ir},4:{n:"Author",t:ir},5:{n:"Keywords",t:ir},6:{n:"Comments",t:ir},7:{n:"Template",t:ir},8:{n:"LastAuthor",t:ir},9:{n:"RevNumber",t:ir},10:{n:"EditTime",t:sl},11:{n:"LastPrinted",t:sl},12:{n:"CreatedDate",t:sl},13:{n:"ModifiedDate",t:sl},14:{n:"PageCount",t:Lr},15:{n:"WordCount",t:Lr},16:{n:"CharCount",t:Lr},17:{n:"Thumbnail",t:r4},18:{n:"Application",t:ir},19:{n:"DocSecurity",t:Lr},255:{},2147483648:{n:"Locale",t:ru},2147483651:{n:"Behavior",t:ru},1919054434:{}},ig={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},a4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function o4(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var c4=o4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),cs=vt(c4),ai={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},gv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ph={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},al={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ed(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function l4(r){var e=ed();if(!r||!r.match)return e;var t={};if((r.match(Rr)||[]).forEach(function(n){var i=Me(n);switch(i[0].replace(vk,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":e[ph[i.ContentType]]!==void 0&&e[ph[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Zt.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function _v(r,e){var t=lk(ph),n=[],i;n[n.length]=jt,n[n.length]=ye("Types",null,{xmlns:Zt.CT,"xmlns:xsd":Zt.xsd,"xmlns:xsi":Zt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ye("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){r[c]&&r[c].length>0&&(i=r[c][0],n[n.length]=ye("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:al[c][e.bookType]||al[c].xlsx}))},a=function(c){(r[c]||[]).forEach(function(l){n[n.length]=ye("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:al[c][e.bookType]||al[c].xlsx})})},o=function(c){(r[c]||[]).forEach(function(l){n[n.length]=ye("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Xe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ec(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Io(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(Rr)||[]).forEach(function(i){var s=Me(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:go(s.Target,e);t[o]=a,n[s.Id]=a}}),t["!id"]=n,t}function ha(r){var e=[jt,ye("Relationships",null,{xmlns:Zt.RELS})];return Bt(r["!id"]).forEach(function(t){e[e.length]=ye("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ft(r,e,t,n,i,s){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=t,[Xe.HLINK,Xe.XPATH,Xe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}var u4="application/vnd.oasis.opendocument.spreadsheet";function f4(r,e){for(var t=U0(r),n,i;n=Zo.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Me(n[0],!1),i.path=="/"&&i.type!==u4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function h4(r){var e=[jt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function sg(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function d4(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function m4(r){var e=[jt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(sg(r[t][0],r[t][1])),e.push(d4("",r[t][0]));return e.push(sg("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function xv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+qo.version+"</meta:generator></office:meta></office:document-meta>"}var dn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],p4=function(){for(var r=new Array(dn.length),e=0;e<dn.length;++e){var t=dn[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r}();function vv(r){var e={};r=pt(r);for(var t=0;t<dn.length;++t){var n=dn[t],i=r.match(p4[t]);i!=null&&i.length>0&&(e[n[1]]=it(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=St(e[n[1]]))}return e}function vf(r,e,t,n,i){i[r]!=null||e==null||e===""||(i[r]=e,e=dt(e),n[n.length]=t?ye(r,e,t):pr(r,e))}function yv(r,e){var t=e||{},n=[jt,ye("cp:coreProperties",null,{"xmlns:cp":Zt.CORE_PROPS,"xmlns:dc":Zt.dc,"xmlns:dcterms":Zt.dcterms,"xmlns:dcmitype":Zt.dcmitype,"xmlns:xsi":Zt.xsi})],i={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&vf("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:fh(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),r.ModifiedDate!=null&&vf("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:fh(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=dn.length;++s){var a=dn[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&vf(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ls=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],wv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ev(r,e,t,n){var i=[];if(typeof r=="string")i=Xp(r,n);else for(var s=0;s<r.length;++s)i=i.concat(r[s].map(function(u){return{v:u}}));var a=typeof e=="string"?Xp(e,n).map(function(u){return u.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=c,t.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=a.slice(o,o+c);break}o+=c}}function g4(r,e,t){var n={};return e||(e={}),r=pt(r),ls.forEach(function(i){var s=(r.match(Yo(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=it(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=r.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Ev(n.HeadingPairs,n.TitlesOfParts,e,t),e}function Tv(r){var e=[],t=ye;return r||(r={}),r.Application="SheetJS",e[e.length]=jt,e[e.length]=ye("Properties",null,{xmlns:Zt.EXT_PROPS,"xmlns:vt":Zt.vt}),ls.forEach(function(n){if(r[n[1]]!==void 0){var i;switch(n[2]){case"string":i=dt(String(r[n[1]]));break;case"bool":i=r[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(n[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+dt(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var _4=/<[^>]+>[^<]*/g;function x4(r,e){var t={},n="",i=r.match(_4);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Me(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=it(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[n]=it(u);break;case"bool":t[n]=Tt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(u);break;case"filetime":case"date":t[n]=St(u);break;case"cy":case"error":t[n]=it(u);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}function Av(r){var e=[jt,ye("Properties",null,{xmlns:Zt.CUST_PROPS,"xmlns:vt":Zt.vt})];if(!r)return e.join("");var t=1;return Bt(r).forEach(function(i){++t,e[e.length]=ye("property",kk(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:dt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var gh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},yf;function v4(r,e,t){yf||(yf=Du(gh)),e=yf[e]||e,r[e]=t}function y4(r,e){var t=[];return Bt(gh).map(function(n){for(var i=0;i<dn.length;++i)if(dn[i][1]==n)return dn[i];for(i=0;i<ls.length;++i)if(ls[i][1]==n)return ls[i];throw n}).forEach(function(n){if(r[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(pr(gh[n[1]]||n[1],i))}}),ye("DocumentProperties",t.join(""),{xmlns:qr.o})}function w4(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return r&&Bt(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<dn.length;++a)if(s==dn[a][1])return;for(a=0;a<ls.length;++a)if(s==ls[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=r[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(ye(jp(s),o,{"dt:dt":c}))}}),e&&Bt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ye(jp(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+qr.o+'">'+i.join("")+"</"+n+">"}function td(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function E4(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ne(8);return a.write_shift(4,n),a.write_shift(4,i),a}function Sv(r,e,t){var n=r.l,i=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return i}function Iv(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function kv(r,e,t){return e===31?Iv(r):Sv(r,e,t)}function _h(r,e,t){return kv(r,e,t===!1?0:4)}function T4(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return kv(r,e,0)}function A4(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var i=r.l;t[n]=r.read_shift(0,"lpwstr").replace(kr,""),r.l-i&2&&(r.l+=2)}return t}function S4(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(kr,"");return t}function I4(r){var e=r.l,t=nu(r,pv);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=nu(r,Lr);return[t,n]}function k4(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(I4(r));return t}function ag(r,e){for(var t=r.read_shift(4),n={},i=0;i!=t;++i){var s=r.read_shift(4),a=r.read_shift(4);n[s]=r.read_shift(a,e===1200?"utf16le":"utf8").replace(kr,"").replace(po,"!"),e===1200&&a%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function Cv(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function C4(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function nu(r,e,t){var n=r.read_shift(2),i,s=t||{};if(r.l+=2,e!==ng&&n!==e&&s4.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===ng?n:e){case 2:return i=r.read_shift(2,"i"),s.raw||(r.l+=2),i;case 3:return i=r.read_shift(4,"i"),i;case 11:return r.read_shift(4)!==0;case 19:return i=r.read_shift(4),i;case 30:return Sv(r,n,4).replace(kr,"");case 31:return Iv(r);case 64:return td(r);case 65:return Cv(r);case 71:return C4(r);case 80:return _h(r,n,!s.raw).replace(kr,"");case 81:return T4(r,n).replace(kr,"");case 4108:return k4(r);case 4126:case 4127:return n==4127?A4(r):S4(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function og(r,e){var t=ne(4),n=ne(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=ne(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=E4(e);break;case 31:case 80:for(n=ne(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return ar([t,n])}function cg(r,e){var t=r.l,n=r.read_shift(4),i=r.read_shift(4),s=[],a=0,o=0,c=-1,l={};for(a=0;a!=i;++a){var u=r.read_shift(4),h=r.read_shift(4);s[a]=[u,h+t]}s.sort(function(b,E){return b[1]-E[1]});var d={};for(a=0;a!=i;++a){if(r.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:r.l+2===s[a][1]&&(r.l+=2,m=!1);break;case 80:r.l<=s[a][1]&&(r.l=s[a][1],m=!1);break;case 4108:r.l<=s[a][1]&&(r.l=s[a][1],m=!1);break}if((!e||a==0)&&r.l<=s[a][1]&&(m=!1,r.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+r.l+" :"+a)}if(e){var g=e[s[a][0]];if(d[g.n]=nu(r,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:hn(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(s[a][0]===1){if(o=d.CodePage=nu(r,Z0),hn(o),c!==-1){var p=r.l;r.l=s[c][1],l=ag(r,o),r.l=p}}else if(s[a][0]===0){if(o===0){c=a,r.l=s[a+1][1];continue}l=ag(r,o)}else{var x=l[s[a][0]],T;switch(r[r.l]){case 65:r.l+=4,T=Cv(r);break;case 30:r.l+=4,T=_h(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,T=_h(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,T=r.read_shift(4,"i");break;case 19:r.l+=4,T=r.read_shift(4);break;case 5:r.l+=4,T=r.read_shift(8,"f");break;case 11:r.l+=4,T=Ut(r,4);break;case 64:r.l+=4,T=St(td(r));break;default:throw new Error("unparsed value: "+r[r.l])}d[x]=T}}return r.l=t+n,d}var bv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function b4(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function lg(r,e,t){var n=ne(8),i=[],s=[],a=8,o=0,c=ne(8),l=ne(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),i.push(l),a+=8+c.length,!e){l=ne(8),l.write_shift(4,0),i.unshift(l);var u=[ne(4)];for(u[0].write_shift(4,r.length),o=0;o<r.length;++o){var h=r[o][0];for(c=ne(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=ar(u),s.unshift(c),a+=8+c.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(bv.indexOf(r[o][0])>-1||wv.indexOf(r[o][0])>-1)&&r[o][1]!=null){var d=r[o][1],m=0;if(e){m=+e[r[o][0]];var g=t[m];if(g.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}c=og(g.t,d)}else{var x=b4(d);x==-1&&(x=31,d=String(d)),c=og(x,d)}s.push(c),l=ne(8),l.write_shift(4,e?m:2+o),i.push(l),a+=8+c.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),ar([n].concat(i).concat(s))}function ug(r,e,t){var n=r.content;if(!n)return{};dr(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),u=n.read_shift(16);if(u!==Pe.utils.consts.HEADER_CLSID&&u!==t)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var h=cg(n,e),d={SystemIdentifier:l};for(var m in h)d[m]=h[m];if(d.FMTID=s,i===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=cg(n,null)}catch{}for(m in g)d[m]=g[m];return d.FMTID=[s,a],d}function fg(r,e,t,n,i,s){var a=ne(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Pe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var c=lg(r,t,n);if(o.push(c),i){var l=lg(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return ar(o)}function di(r,e){return r.read_shift(e),null}function R4(r,e){e||(e=ne(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function F4(r,e,t){for(var n=[],i=r.l+e;r.l<i;)n.push(t(r,i-r.l));if(i!==r.l)throw new Error("Slurp error");return n}function Ut(r,e){return r.read_shift(e)===1}function Pr(r,e){return e||(e=ne(2)),e.write_shift(2,+!!r),e}function Qt(r){return r.read_shift(2,"u")}function fn(r,e){return e||(e=ne(2)),e.write_shift(2,r),e}function Rv(r,e){return F4(r,e,Qt)}function D4(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function Fv(r,e,t){return t||(t=ne(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function Ic(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=Zr;if(t&&t.biff>=8&&(Zr=1200),!t||t.biff==8){var a=r.read_shift(1);a&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=n?r.read_shift(n,i):"";return Zr=s,o}function P4(r){var e=Zr;Zr=1200;var t=r.read_shift(2),n=r.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,c,l={};s&&(o=r.read_shift(2)),i&&(c=r.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",h=t===0?"":r.read_shift(t,u);return s&&(r.l+=4*o),i&&(r.l+=c),l.t=h,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Zr=e,l}function N4(r){var e=r.t||"",t=ne(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=ne(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[t,n];return ar(i)}function Is(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function kc(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):Is(r,n,t)}function Vs(r,e,t){if(t.biff>5)return kc(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function Dv(r,e,t){return t||(t=ne(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function O4(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function L4(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var i=r.read_shift((n?e-24:e)>>1,"utf16le").replace(kr,"");return n&&(r.l+=24),i}function M4(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=r.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=r.read_shift(s>>1,"utf16le").replace(kr,"");return t+a}function V4(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return L4(r);case"0303000000000000c000000000000046":return M4(r);default:throw new Error("Unsupported Moniker "+t)}}function ol(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(kr,""):"";return t}function hg(r,e){e||(e=ne(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function B4(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=r.read_shift(2);r.l+=2;var s,a,o,c,l="",u,h;i&16&&(s=ol(r,t-r.l)),i&128&&(a=ol(r,t-r.l)),(i&257)===257&&(o=ol(r,t-r.l)),(i&257)===1&&(c=V4(r,t-r.l)),i&8&&(l=ol(r,t-r.l)),i&32&&(u=r.read_shift(16)),i&64&&(h=td(r)),r.l=t;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return u&&(m.guid=u),h&&(m.time=h),s&&(m.Tooltip=s),m}function U4(r){var e=ne(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)n=n.slice(1),hg(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&hg(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),t=0;t<n.length-3*c;++t)e.write_shift(1,n.charCodeAt(t+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Pv(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),i=r.read_shift(1);return[e,t,n,i]}function Nv(r,e){var t=Pv(r);return t[3]=0,t}function Bn(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function ks(r,e,t,n){return n||(n=ne(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function G4(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function W4(r,e,t){return e===0?"":Vs(r,e,t)}function z4(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),s=r.read_shift(n,"i"),a=r.read_shift(n,"i");return[i,s,a]}function Ov(r){var e=r.read_shift(2),t=J0(r);return[e,t]}function H4(r,e,t){r.l+=4,e-=4;var n=r.l+e,i=Ic(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,i}function Lu(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function Lv(r,e){return e||(e=ne(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function Mv(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),i=r.read_shift(1);return{s:{c:n,r:e},e:{c:i,r:t}}}var j4=Mv;function Vv(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function $4(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function K4(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function vr(r){r.l+=2,r.l+=r.read_shift(2)}var q4={0:vr,4:vr,5:vr,6:vr,7:K4,8:vr,9:vr,10:vr,11:vr,12:vr,13:$4,14:vr,15:vr,16:vr,17:vr,18:vr,19:vr,20:vr,21:Vv};function X4(r,e){for(var t=r.l+e,n=[];r.l<t;){var i=r.read_shift(2);r.l-=2;try{n.push(q4[i](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function cl(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function rd(r,e,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ne(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Q4(r,e){return e===0||r.read_shift(2),1200}function Y4(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,i=Vs(r,0,t);return r.read_shift(e+n-r.l),i}function J4(r,e){var t=!e||e.biff==8,n=ne(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function Z4(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function eC(r,e,t){var n=r.read_shift(4),i=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Ic(r,0,t);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function tC(r,e){var t=!e||e.biff>=8?2:1,n=ne(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function rC(r,e){for(var t=r.l+e,n=r.read_shift(4),i=r.read_shift(4),s=[],a=0;a!=i&&r.l<t;++a)s.push(P4(r));return s.Count=n,s.Unique=i,s}function nC(r,e){var t=ne(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],i=0;i<r.length;++i)n[i]=N4(r[i]);var s=ar([t].concat(n));return s.parts=[t.length].concat(n.map(function(a){return a.length})),s}function iC(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function sC(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function aC(r){var e=G4(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function oC(r){return r.read_shift(2),r.read_shift(4)}function dg(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var i=r.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function cC(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=r.read_shift(2),c=r.read_shift(2),l=r.read_shift(2);return{Pos:[e,t],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function lC(){var r=ne(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function uC(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function fC(r){var e=ne(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function hC(){}function dC(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=Ic(r,0,t),n}function mC(r,e){var t=r.name||"Arial",n=e&&e.biff==5,i=n?15+t.length:16+2*t.length,s=ne(i);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function pC(r){var e=Bn(r);return e.isst=r.read_shift(4),e}function gC(r,e,t,n){var i=ne(10);return ks(r,e,n,i),i.write_shift(4,t),i}function _C(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,i=Bn(r);t.biff==2&&r.l++;var s=kc(r,n-r.l,t);return i.val=s,i}function xC(r,e,t,n,i){var s=!i||i.biff==8,a=ne(8+ +s+(1+s)*t.length);return ks(r,e,n,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function vC(r,e,t){var n=r.read_shift(2),i=Vs(r,0,t);return[n,i]}function yC(r,e,t,n){var i=t&&t.biff==5;n||(n=ne(i?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var wC=Vs;function mg(r,e,t){var n=r.l+e,i=t.biff==8||!t.biff?4:2,s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(2),c=r.read_shift(2);return r.l=n,{s:{r:s,c:o},e:{r:a,c}}}function EC(r,e){var t=e.biff==8||!e.biff?4:2,n=ne(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function TC(r){var e=r.read_shift(2),t=r.read_shift(2),n=Ov(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function AC(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(Ov(r));if(r.l!==t)throw new Error("MulRK read error");var a=r.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function SC(r,e){for(var t=r.l+e-2,n=r.read_shift(2),i=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var a=r.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function IC(r,e,t,n){var i={},s=r.read_shift(4),a=r.read_shift(4),o=r.read_shift(4),c=r.read_shift(2);return i.patternType=a4[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function kC(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=IC(r,e,n.fStyle,t),n}function pg(r,e,t,n){var i=t&&t.biff==5;n||(n=ne(i?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function CC(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function bC(r){var e=ne(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function gg(r,e,t){var n=Bn(r);(t.biff==2||e==9)&&++r.l;var i=D4(r);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function RC(r,e,t,n,i,s){var a=ne(8);return ks(r,e,n,a),Fv(t,s,a),a}function FC(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Bn(r),i=Ar(r);return n.val=i,n}function DC(r,e,t,n){var i=ne(14);return ks(r,e,n,i),Ss(t,i),i}var _g=W4;function PC(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Is(r,s),o=[];n>r.l;)o.push(kc(r));return[s,i,a,o]}function xg(r,e,t){var n=r.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=H4(r,e-2,t)),s.body=i||r.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var NC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vg(r,e,t){var n=r.l+e,i=r.read_shift(2),s=r.read_shift(1),a=r.read_shift(1),o=r.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),c=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var l=Is(r,a,t);i&32&&(l=NC[l.charCodeAt(0)]);var u=n-r.l;t&&t.biff==2&&--u;var h=n==r.l||o===0||!(u>0)?[]:XD(r,u,t,o);return{chKey:s,Name:l,itab:c,rgce:h}}function Bv(r,e,t){if(t.biff<8)return OC(r,e,t);for(var n=[],i=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(z4(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function OC(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=Ic(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function LC(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),i=r.read_shift(2),s=Is(r,n,t),a=Is(r,i,t);return[s,a]}function MC(r,e,t){var n=Mv(r);r.l++;var i=r.read_shift(1);return e-=8,[QD(r,e,t),i,n]}function yg(r,e,t){var n=j4(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,KD(r,e,t)]}function VC(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function BC(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=Vs(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:i},o,a,s]}}function UC(r,e,t){return BC(r,e,t)}function GC(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(Lu(r));return t}function WC(r){var e=ne(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)Lv(r[t],e);return e}function zC(r,e,t){if(t&&t.biff<8)return jC(r,e,t);var n=Vv(r),i=X4(r,e-22,n[1]);return{cmo:n,ft:i}}var HC={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var i=r.read_shift(1);return r.l+=i,r.l=t,{fmt:n}}};function jC(r,e,t){r.l+=4;var n=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var a=[];return a.push((HC[n]||br)(r,e,t)),{cmo:[i,n,s],ft:a}}function $C(r,e,t){var n=r.l,i="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:a=O4(r,6,t);var o=r.read_shift(2);r.read_shift(2),Qt(r,2);var c=r.read_shift(2);r.l+=c;for(var l=1;l<r.lens.length-1;++l){if(r.l-n!=r.lens[l])throw new Error("TxO: bad continue record");var u=r[r.l],h=Is(r,r.lens[l+1]-r.lens[l]-1);if(i+=h,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return r.l=n+e,{t:i}}catch{return r.l=n+e,{t:i}}}function KC(r,e){var t=Lu(r);r.l+=16;var n=B4(r,e-24);return[t,n]}function qC(r){var e=ne(24),t=Pt(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return ar([e,U4(r[1])])}function XC(r,e){r.read_shift(2);var t=Lu(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(kr,""),[t,n]}function QC(r){var e=r[1].Tooltip,t=ne(10+2*(e.length+1));t.write_shift(2,2048);var n=Pt(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function YC(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=ig[t]||t,t=r.read_shift(2),e[1]=ig[t]||t,e}function JC(r){return r||(r=ne(4)),r.write_shift(2,1),r.write_shift(2,1),r}function ZC(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(Nv(r));return t}function eb(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(Nv(r));return t}function tb(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function Uv(r,e,t){if(!t.cellStyles)return br(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),s=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(n),c=r.read_shift(2);n==2&&(r.l+=2);var l={s:i,e:s,w:a,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function rb(r,e){var t=ne(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function nb(r,e){var t={};return e<32||(r.l+=16,t.header=Ar(r),t.footer=Ar(r),r.l+=2),t}function ib(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var i=r.read_shift(1);return r.l+=3,i&16&&(n.area=!0),n}function sb(r){for(var e=ne(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var ab=Bn,ob=Rv,cb=kc;function lb(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,i}function ub(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Bn(r);++r.l;var i=Vs(r,e-7,t);return n.t="str",n.val=i,n}function fb(r){var e=Bn(r);++r.l;var t=Ar(r);return e.t="n",e.val=t,e}function hb(r,e,t){var n=ne(15);return Fc(n,r,e),n.write_shift(8,t,"f"),n}function db(r){var e=Bn(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function mb(r,e,t){var n=ne(9);return Fc(n,r,e),n.write_shift(2,t),n}function pb(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function gb(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function _b(r,e,t){var n=r.l+e,i=Bn(r),s=r.read_shift(2),a=Is(r,s,t);return r.l=n,i.t="str",i.val=a,i}var xb=[2,3,48,49,131,139,140,245],xh=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Du({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],u=Pi(1);switch(c.type){case"base64":u=Xr(tn(o));break;case"binary":u=Xr(o);break;case"buffer":case"array":u=o;break}dr(u,0);var h=u.read_shift(1),d=!!(h&136),m=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,x=521;h==2&&(p=u.read_shift(2)),u.l+=3,h!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(x=u.read_shift(2));var T=u.read_shift(2),b=c.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=r[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var E=[],F={},M=Math.min(u.length,h==2?521:x-10-(m?264:0)),O=g?32:11;u.l<M&&u[u.l]!=13;)switch(F={},F.name=rt.utils.decode(b,u.slice(u.l,u.l+O)).replace(/[\u0000\r\n].*$/g,""),u.l+=O,F.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(F.offset=u.read_shift(4)),F.len=u.read_shift(1),h==2&&(F.offset=u.read_shift(2)),F.dec=u.read_shift(1),F.name.length&&E.push(F),h!=2&&(u.l+=g?13:14),F.type){case"B":(!m||F.len!=8)&&c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var y=0,A=0;for(l[0]=[],A=0;A!=E.length;++A)l[0][A]=E[A].name;for(;p-- >0;){if(u[u.l]===42){u.l+=T;continue}for(++u.l,l[++y]=[],A=0,A=0;A!=E.length;++A){var v=u.slice(u.l,u.l+E[A].len);u.l+=E[A].len,dr(v,0);var S=rt.utils.decode(b,v);switch(E[A].type){case"C":S.trim().length&&(l[y][A]=S.replace(/\s+$/,""));break;case"D":S.length===8?l[y][A]=new Date(+S.slice(0,4),+S.slice(4,6)-1,+S.slice(6,8)):l[y][A]=S;break;case"F":l[y][A]=parseFloat(S.trim());break;case"+":case"I":l[y][A]=g?v.read_shift(-4,"i")^2147483648:v.read_shift(4,"i");break;case"L":switch(S.trim().toUpperCase()){case"Y":case"T":l[y][A]=!0;break;case"N":case"F":l[y][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+S+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[y][A]="##MEMO##"+(g?parseInt(S.trim(),10):v.read_shift(4));break;case"N":S=S.replace(/\u0000/g,"").trim(),S&&S!="."&&(l[y][A]=+S||0);break;case"@":l[y][A]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":l[y][A]=new Date((v.read_shift(4)-2440588)*864e5+v.read_shift(4));break;case"Y":l[y][A]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[y][A]=-v.read_shift(-8,"f");break;case"B":if(m&&E[A].len==8){l[y][A]=v.read_shift(8,"f");break}case"G":case"P":v.l+=E[A].len;break;case"0":if(E[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[A].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=E,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var u=Ha(t(o,l),l);return u["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,u}function i(o,c){try{return Hi(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&hn(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ur(),h=au(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),g=o["!cols"]||[],p=0,x=0,T=0,b=1;for(p=0;p<d.length;++p){if(((g[p]||{}).DBF||{}).name){d[p]=g[p].DBF.name,++T;continue}if(d[p]!=null){if(++T,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(x=0;x<1024;++x)if(d.indexOf(d[p]+"_"+x)==-1){d[p]+="_"+x;break}}}}var E=Je(o["!ref"]),F=[],M=[],O=[];for(p=0;p<=E.e.c-E.s.c;++p){var y="",A="",v=0,S=[];for(x=0;x<m.length;++x)m[x][p]!=null&&S.push(m[x][p]);if(S.length==0||d[p]==null){F[p]="?";continue}for(x=0;x<S.length;++x){switch(typeof S[x]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=S[x]instanceof Date?"D":"C";break;default:A="C"}v=Math.max(v,String(S[x]).length),y=y&&y!=A?"C":A}v>250&&(v=250),A=((g[p]||{}).DBF||{}).type,A=="C"&&g[p].DBF.len>v&&(v=g[p].DBF.len),y=="B"&&A=="N"&&(y="N",O[p]=g[p].DBF.dec,v=g[p].DBF.len),M[p]=y=="C"||A=="N"?v:s[y]||0,b+=M[p],F[p]=y}var I=u.next(32);for(I.write_shift(4,318902576),I.write_shift(4,m.length),I.write_shift(2,296+32*T),I.write_shift(2,b),p=0;p<4;++p)I.write_shift(4,0);for(I.write_shift(4,0|(+e[Es]||3)<<8),p=0,x=0;p<d.length;++p)if(d[p]!=null){var k=u.next(32),R=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,R,"sbcs"),k.write_shift(1,F[p]=="?"?"C":F[p],"sbcs"),k.write_shift(4,x),k.write_shift(1,M[p]||s[F[p]]||0),k.write_shift(1,O[p]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),x+=M[p]||s[F[p]]||0}var ae=u.next(264);for(ae.write_shift(4,13),p=0;p<65;++p)ae.write_shift(4,0);for(p=0;p<m.length;++p){var oe=u.next(b);for(oe.write_shift(1,0),x=0;x<d.length;++x)if(d[x]!=null)switch(F[x]){case"L":oe.write_shift(1,m[p][x]==null?63:m[p][x]?84:70);break;case"B":oe.write_shift(8,m[p][x]||0,"f");break;case"N":var Ae="0";for(typeof m[p][x]=="number"&&(Ae=m[p][x].toFixed(O[x]||0)),T=0;T<M[x]-Ae.length;++T)oe.write_shift(1,32);oe.write_shift(1,Ae,"sbcs");break;case"D":m[p][x]?(oe.write_shift(4,("0000"+m[p][x].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(m[p][x].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+m[p][x].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var le=String(m[p][x]!=null?m[p][x]:"").slice(0,M[x]);for(oe.write_shift(1,le,"sbcs"),T=0;T<M[x]-le.length;++T)oe.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),Gv=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Bt(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,m){var g=r[m];return typeof g=="number"?uh(g):g},n=function(d,m,g){var p=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?d:uh(p)};r["|"]=254;function i(d,m){switch(m.type){case"base64":return s(tn(d),m);case"binary":return s(d,m);case"buffer":return s(Ke&&Buffer.isBuffer(d)?d.toString("binary"):zi(d),m);case"array":return s(As(d),m)}throw new Error("Unrecognized type "+m.type)}function s(d,m){var g=d.split(/[\n\r]+/),p=-1,x=-1,T=0,b=0,E=[],F=[],M=null,O={},y=[],A=[],v=[],S=0,I;for(+m.codepage>=0&&hn(+m.codepage);T!==g.length;++T){S=0;var k=g[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),R=k.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),ae=R[0],oe;if(k.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&F.push(k.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,le=!1,We=!1,K=!1,Fe=-1,Ne=-1;for(b=1;b<R.length;++b)switch(R[b].charAt(0)){case"A":break;case"X":x=parseInt(R[b].slice(1))-1,le=!0;break;case"Y":for(p=parseInt(R[b].slice(1))-1,le||(x=0),I=E.length;I<=p;++I)E[I]=[];break;case"K":oe=R[b].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(wn(oe))?isNaN(Fa(oe).getDate())||(oe=St(oe)):(oe=wn(oe),M!==null&&Ds(M)&&(oe=Nu(oe))),typeof rt<"u"&&typeof oe=="string"&&(m||{}).type!="string"&&(m||{}).codepage&&(oe=rt.utils.decode(m.codepage,oe)),Ae=!0;break;case"E":K=!0;var B=da(R[b].slice(1),{r:p,c:x});E[p][x]=[E[p][x],B];break;case"S":We=!0,E[p][x]=[E[p][x],"S5S"];break;case"G":break;case"R":Fe=parseInt(R[b].slice(1))-1;break;case"C":Ne=parseInt(R[b].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+k)}if(Ae&&(E[p][x]&&E[p][x].length==2?E[p][x][0]=oe:E[p][x]=oe,M=null),We){if(K)throw new Error("SYLK shared formula cannot have own formula");var H=Fe>-1&&E[Fe][Ne];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");E[p][x][1]=sy(H[1],{r:p-Fe,c:x-Ne})}break;case"F":var W=0;for(b=1;b<R.length;++b)switch(R[b].charAt(0)){case"X":x=parseInt(R[b].slice(1))-1,++W;break;case"Y":for(p=parseInt(R[b].slice(1))-1,I=E.length;I<=p;++I)E[I]=[];break;case"M":S=parseInt(R[b].slice(1))/20;break;case"F":break;case"G":break;case"P":M=F[parseInt(R[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(v=R[b].slice(1).split(" "),I=parseInt(v[0],10);I<=parseInt(v[1],10);++I)S=parseInt(v[2],10),A[I-1]=S===0?{hidden:!0}:{wch:S},Ni(A[I-1]);break;case"C":x=parseInt(R[b].slice(1))-1,A[x]||(A[x]={});break;case"R":p=parseInt(R[b].slice(1))-1,y[p]||(y[p]={}),S>0?(y[p].hpt=S,y[p].hpx=Pa(S)):S===0&&(y[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+k)}W<1&&(M=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+k)}}return y.length>0&&(O["!rows"]=y),A.length>0&&(O["!cols"]=A),m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),[E,O]}function a(d,m){var g=i(d,m),p=g[0],x=g[1],T=Ha(p,m);return Bt(x).forEach(function(b){T[b]=x[b]}),T}function o(d,m){return Hi(a(d,m),m)}function c(d,m,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(d.t){case"n":x+=d.v||0,d.f&&!d.F&&(x+=";E"+cd(d.f,{r:g,c:p}));break;case"b":x+=d.v?"TRUE":"FALSE";break;case"e":x+=d.w||d.v;break;case"d":x+='"'+(d.w||d.v)+'"';break;case"s":x+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function l(d,m){m.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=rc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=nc(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&d.push(x)})}function u(d,m){m.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*ic(g.hpx)+";"),x.length>2&&d.push(x+"R"+(p+1))})}function h(d,m){var g=["ID;PWXL;N;E"],p=[],x=Je(d["!ref"]),T,b=Array.isArray(d),E=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&l(g,d["!cols"]),d["!rows"]&&u(g,d["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var F=x.s.r;F<=x.e.r;++F)for(var M=x.s.c;M<=x.e.c;++M){var O=Le({r:F,c:M});T=b?(d[F]||[])[M]:d[O],!(!T||T.v==null&&(!T.f||T.F))&&p.push(c(T,d,F,M))}return g.join(E)+E+p.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),Wv=function(){function r(s,a){switch(a.type){case"base64":return e(tn(s),a);case"binary":return e(s,a);case"buffer":return e(Ke&&Buffer.isBuffer(s)?s.toString("binary"):zi(s),a);case"array":return e(As(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,l=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++c]=[],l=0;continue}if(!(c<0)){var d=o[u].trim().split(","),m=d[0],g=d[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+m){case-1:if(p==="BOT"){h[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[c][l]=!0:p==="FALSE"?h[c][l]=!1:isNaN(wn(g))?isNaN(Fa(g).getDate())?h[c][l]=g:h[c][l]=St(g):h[c][l]=wn(g),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function t(s,a){return Ha(r(s,a),a)}function n(s,a){return Hi(t(s,a),a)}var i=function(){var s=function(c,l,u,h,d){c.push(l),c.push(u+","+h),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,u,h){c.push(l+","+u),c.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var l=[],u=Je(c["!ref"]),h,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,u.e.r-u.s.r+1,""),s(l,"TUPLES",0,u.e.c-u.s.c+1,""),s(l,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){a(l,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=Le({r:m,c:g});if(h=d?(c[m]||[])[g]:c[p],!h){a(l,1,0,"");continue}switch(h.t){case"n":var x=h.w;!x&&h.v!=null&&(x=h.v),x==null?h.f&&!h.F?a(l,1,0,"="+h.f):a(l,1,0,""):a(l,0,x,"V");break;case"b":a(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=rn(h.z||Oe[14],er(St(h.v)))),a(l,0,h.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var T=`\r
`,b=l.join(T);return b}}();return{to_workbook:n,to_sheet:t,from_sheet:i}}(),zv=function(){function r(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(h,d){for(var m=h.split(`
`),g=-1,p=-1,x=0,T=[];x!==m.length;++x){var b=m[x].trim().split(":");if(b[0]==="cell"){var E=Pt(b[1]);if(T.length<=E.r)for(g=T.length;g<=E.r;++g)T[g]||(T[g]=[]);switch(g=E.r,p=E.c,b[2]){case"t":T[g][p]=r(b[3]);break;case"v":T[g][p]=+b[3];break;case"vtf":var F=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[g][p]=!!+b[4];break;default:T[g][p]=+b[4];break}b[2]=="vtf"&&(T[g][p]=[T[g][p],F])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return Ha(t(h,d),d)}function i(h,d){return Hi(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],g,p="",x=Or(h["!ref"]),T=Array.isArray(h),b=x.s.r;b<=x.e.r;++b)for(var E=x.s.c;E<=x.e.c;++E)if(p=Le({r:b,c:E}),g=T?(h[b]||[])[E]:h[p],!(!g||g.v==null||g.t==="z")){switch(m=["cell",p,"t"],g.t){case"s":case"str":m.push(e(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=e(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var F=er(St(g.v));m[2]="vtc",m[3]="nd",m[4]=""+F,m[5]=g.w||rn(g.z||Oe[14],F);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[s,a,o,a,l(h),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),Da=function(){function r(u,h,d,m,g){g.raw?h[d][m]=u:u===""||(u==="TRUE"?h[d][m]=!0:u==="FALSE"?h[d][m]=!1:isNaN(wn(u))?isNaN(Fa(u).getDate())?h[d][m]=u:h[d][m]=St(u):h[d][m]=wn(u))}function e(u,h){var d=h||{},m=[];if(!u||u.length===0)return m;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,T=0,b=0;b<=p;++b)T=g[b].indexOf(" "),T==-1?T=g[b].length:T++,x=Math.max(x,T);for(b=0;b<=p;++b){m[b]=[];var E=0;for(r(g[b].slice(0,x).trim(),m,b,E,d),E=1;E<=(g[b].length-x)/10+1;++E)r(g[b].slice(x+(E-1)*10,x+E*10).trim(),m,b,E,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},d=!1,m=0,g=0;m<u.length;++m)(g=u.charCodeAt(m))==34?d=!d:!d&&g in t&&(h[g]=(h[g]||0)+1);g=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m]);if(!g.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m])}return g.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),t[g.pop()[1]]||44}function s(u,h){var d=h||{},m="",g=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=i(u.slice(0,1024)):d&&d.FS?m=d.FS:m=i(u.slice(0,1024));var x=0,T=0,b=0,E=0,F=0,M=m.charCodeAt(0),O=!1,y=0,A=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var v=d.dateNF!=null?nk(d.dateNF):null;function S(){var I=u.slice(E,F),k={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)k.t="z";else if(d.raw)k.t="s",k.v=I;else if(I.trim().length===0)k.t="s",k.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(k.t="s",k.v=I.slice(2,-1).replace(/""/g,'"')):PF(I)?(k.t="n",k.f=I.slice(1)):(k.t="s",k.v=I);else if(I=="TRUE")k.t="b",k.v=!0;else if(I=="FALSE")k.t="b",k.v=!1;else if(!isNaN(b=wn(I)))k.t="n",d.cellText!==!1&&(k.w=I),k.v=b;else if(!isNaN(Fa(I).getDate())||v&&I.match(v)){k.z=d.dateNF||Oe[14];var R=0;v&&I.match(v)&&(I=ik(I,d.dateNF,I.match(v)||[]),R=1),d.cellDates?(k.t="d",k.v=St(I,R)):(k.t="n",k.v=er(St(I,R))),d.cellText!==!1&&(k.w=rn(k.z,k.v instanceof Date?er(k.v):k.v)),d.cellNF||delete k.z}else k.t="s",k.v=I;if(k.t=="z"||(d.dense?(g[x]||(g[x]=[]),g[x][T]=k):g[Le({c:T,r:x})]=k),E=F+1,A=u.charCodeAt(E),p.e.c<T&&(p.e.c=T),p.e.r<x&&(p.e.r=x),y==M)++T;else if(T=0,++x,d.sheetRows&&d.sheetRows<=x)return!0}e:for(;F<u.length;++F)switch(y=u.charCodeAt(F)){case 34:A===34&&(O=!O);break;case M:case 10:case 13:if(!O&&S())break e;break}return F-E>0&&S(),g["!ref"]=ze(p),g}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):Ha(e(u,h),h)}function o(u,h){var d="",m=h.type=="string"?[0,0,0,0]:_d(u,h);switch(h.type){case"base64":d=tn(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof rt<"u"?d=rt.utils.decode(h.codepage,u):d=Ke&&Buffer.isBuffer(u)?u.toString("binary"):zi(u);break;case"array":d=As(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=pt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=pt(d):h.type=="binary"&&typeof rt<"u"&&h.codepage&&(d=rt.utils.decode(h.codepage,rt.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?zv.to_sheet(h.type=="string"?d:pt(d),h):a(d,h)}function c(u,h){return Hi(o(u,h),h)}function l(u){for(var h=[],d=Je(u["!ref"]),m,g=Array.isArray(u),p=d.s.r;p<=d.e.r;++p){for(var x=[],T=d.s.c;T<=d.e.c;++T){var b=Le({r:p,c:T});if(m=g?(u[p]||[])[T]:u[b],!m||m.v==null){x.push("          ");continue}for(var E=(m.w||(On(m),m.w)||"").slice(0,10);E.length<10;)E+=" ";x.push(E+(T===0?" ":""))}h.push(x.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function vb(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var i=Gv.to_workbook(r,t);return t.WTF=n,i}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Da.to_workbook(r,e)}}var us=function(){function r(B,H,W){if(B){dr(B,B.l||0);for(var z=W.Enum||Fe;B.l<B.length;){var ie=B.read_shift(2),de=z[ie]||z[65535],_e=B.read_shift(2),pe=B.l+_e,fe=de.f&&de.f(B,_e,W);if(B.l=pe,H(fe,de,ie))return}}}function e(B,H){switch(H.type){case"base64":return t(Xr(tn(B)),H);case"binary":return t(Xr(B),H);case"buffer":case"array":return t(B,H)}throw"Unsupported type "+H.type}function t(B,H){if(!B)return B;var W=H||{},z=W.dense?[]:{},ie="Sheet1",de="",_e=0,pe={},fe=[],Ve=[],G={s:{r:0,c:0},e:{r:0,c:0}},ot=W.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)W.Enum=Fe,r(B,function(se,$e,Qe){switch(Qe){case 0:W.vers=se,se>=4096&&(W.qpro=!0);break;case 6:G=se;break;case 204:se&&(de=se);break;case 222:de=se;break;case 15:case 51:W.qpro||(se[1].v=se[1].v.slice(1));case 13:case 14:case 16:Qe==14&&(se[2]&112)==112&&(se[2]&15)>1&&(se[2]&15)<15&&(se[1].z=W.dateNF||Oe[14],W.cellDates&&(se[1].t="d",se[1].v=Nu(se[1].v))),W.qpro&&se[3]>_e&&(z["!ref"]=ze(G),pe[ie]=z,fe.push(ie),z=W.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},_e=se[3],ie=de||"Sheet"+(_e+1),de="");var mt=W.dense?(z[se[0].r]||[])[se[0].c]:z[Le(se[0])];if(mt){mt.t=se[1].t,mt.v=se[1].v,se[1].z!=null&&(mt.z=se[1].z),se[1].f!=null&&(mt.f=se[1].f);break}W.dense?(z[se[0].r]||(z[se[0].r]=[]),z[se[0].r][se[0].c]=se[1]):z[Le(se[0])]=se[1];break}},W);else if(B[2]==26||B[2]==14)W.Enum=Ne,B[2]==14&&(W.qpro=!0,B.l=0),r(B,function(se,$e,Qe){switch(Qe){case 204:ie=se;break;case 22:se[1].v=se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(se[3]>_e&&(z["!ref"]=ze(G),pe[ie]=z,fe.push(ie),z=W.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},_e=se[3],ie="Sheet"+(_e+1)),ot>0&&se[0].r>=ot)break;W.dense?(z[se[0].r]||(z[se[0].r]=[]),z[se[0].r][se[0].c]=se[1]):z[Le(se[0])]=se[1],G.e.c<se[0].c&&(G.e.c=se[0].c),G.e.r<se[0].r&&(G.e.r=se[0].r);break;case 27:se[14e3]&&(Ve[se[14e3][0]]=se[14e3][1]);break;case 1537:Ve[se[0]]=se[1],se[0]==_e&&(ie=se[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(z["!ref"]=ze(G),pe[de||ie]=z,fe.push(de||ie),!Ve.length)return{SheetNames:fe,Sheets:pe};for(var Z={},ue=[],xe=0;xe<Ve.length;++xe)pe[fe[xe]]?(ue.push(Ve[xe]||fe[xe]),Z[Ve[xe]]=pe[Ve[xe]]||pe[fe[xe]]):(ue.push(Ve[xe]),Z[Ve[xe]]={"!ref":"A1"});return{SheetNames:ue,Sheets:Z}}function n(B,H){var W=H||{};if(+W.codepage>=0&&hn(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var z=Ur(),ie=Je(B["!ref"]),de=Array.isArray(B),_e=[];we(z,0,s(1030)),we(z,6,c(ie));for(var pe=Math.min(ie.e.r,8191),fe=ie.s.r;fe<=pe;++fe)for(var Ve=Mt(fe),G=ie.s.c;G<=ie.e.c;++G){fe===ie.s.r&&(_e[G]=At(G));var ot=_e[G]+Ve,Z=de?(B[fe]||[])[G]:B[ot];if(!(!Z||Z.t=="z"))if(Z.t=="n")(Z.v|0)==Z.v&&Z.v>=-32768&&Z.v<=32767?we(z,13,m(fe,G,Z.v)):we(z,14,p(fe,G,Z.v));else{var ue=On(Z);we(z,15,h(fe,G,ue.slice(0,239)))}}return we(z,1),z.end()}function i(B,H){var W=H||{};if(+W.codepage>=0&&hn(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var z=Ur();we(z,0,a(B));for(var ie=0,de=0;ie<B.SheetNames.length;++ie)(B.Sheets[B.SheetNames[ie]]||{})["!ref"]&&we(z,27,K(B.SheetNames[ie],de++));var _e=0;for(ie=0;ie<B.SheetNames.length;++ie){var pe=B.Sheets[B.SheetNames[ie]];if(!(!pe||!pe["!ref"])){for(var fe=Je(pe["!ref"]),Ve=Array.isArray(pe),G=[],ot=Math.min(fe.e.r,8191),Z=fe.s.r;Z<=ot;++Z)for(var ue=Mt(Z),xe=fe.s.c;xe<=fe.e.c;++xe){Z===fe.s.r&&(G[xe]=At(xe));var se=G[xe]+ue,$e=Ve?(pe[Z]||[])[xe]:pe[se];if(!(!$e||$e.t=="z"))if($e.t=="n")we(z,23,S(Z,xe,_e,$e.v));else{var Qe=On($e);we(z,22,y(Z,xe,_e,Qe.slice(0,239)))}}++_e}}return we(z,1),z.end()}function s(B){var H=ne(2);return H.write_shift(2,B),H}function a(B){var H=ne(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var W=0,z=0,ie=0,de=0;de<B.SheetNames.length;++de){var _e=B.SheetNames[de],pe=B.Sheets[_e];if(!(!pe||!pe["!ref"])){++ie;var fe=Or(pe["!ref"]);W<fe.e.r&&(W=fe.e.r),z<fe.e.c&&(z=fe.e.c)}}return W>8191&&(W=8191),H.write_shift(2,W),H.write_shift(1,ie),H.write_shift(1,z),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(B,H,W){var z={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&W.qpro?(z.s.c=B.read_shift(1),B.l++,z.s.r=B.read_shift(2),z.e.c=B.read_shift(1),B.l++,z.e.r=B.read_shift(2),z):(z.s.c=B.read_shift(2),z.s.r=B.read_shift(2),H==12&&W.qpro&&(B.l+=2),z.e.c=B.read_shift(2),z.e.r=B.read_shift(2),H==12&&W.qpro&&(B.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function c(B){var H=ne(8);return H.write_shift(2,B.s.c),H.write_shift(2,B.s.r),H.write_shift(2,B.e.c),H.write_shift(2,B.e.r),H}function l(B,H,W){var z=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(z[0].c=B.read_shift(1),z[3]=B.read_shift(1),z[0].r=B.read_shift(2),B.l+=2):(z[2]=B.read_shift(1),z[0].c=B.read_shift(2),z[0].r=B.read_shift(2)),z}function u(B,H,W){var z=B.l+H,ie=l(B,H,W);if(ie[1].t="s",W.vers==20768){B.l++;var de=B.read_shift(1);return ie[1].v=B.read_shift(de,"utf8"),ie}return W.qpro&&B.l++,ie[1].v=B.read_shift(z-B.l,"cstr"),ie}function h(B,H,W){var z=ne(7+W.length);z.write_shift(1,255),z.write_shift(2,H),z.write_shift(2,B),z.write_shift(1,39);for(var ie=0;ie<z.length;++ie){var de=W.charCodeAt(ie);z.write_shift(1,de>=128?95:de)}return z.write_shift(1,0),z}function d(B,H,W){var z=l(B,H,W);return z[1].v=B.read_shift(2,"i"),z}function m(B,H,W){var z=ne(7);return z.write_shift(1,255),z.write_shift(2,H),z.write_shift(2,B),z.write_shift(2,W,"i"),z}function g(B,H,W){var z=l(B,H,W);return z[1].v=B.read_shift(8,"f"),z}function p(B,H,W){var z=ne(13);return z.write_shift(1,255),z.write_shift(2,H),z.write_shift(2,B),z.write_shift(8,W,"f"),z}function x(B,H,W){var z=B.l+H,ie=l(B,H,W);if(ie[1].v=B.read_shift(8,"f"),W.qpro)B.l=z;else{var de=B.read_shift(2);F(B.slice(B.l,B.l+de),ie),B.l+=de}return ie}function T(B,H,W){var z=H&32768;return H&=-32769,H=(z?B:0)+(H>=8192?H-16384:H),(z?"":"$")+(W?At(H):Mt(H))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(B,H){dr(B,0);for(var W=[],z=0,ie="",de="",_e="",pe="";B.l<B.length;){var fe=B[B.l++];switch(fe){case 0:W.push(B.read_shift(8,"f"));break;case 1:de=T(H[0].c,B.read_shift(2),!0),ie=T(H[0].r,B.read_shift(2),!1),W.push(de+ie);break;case 2:{var Ve=T(H[0].c,B.read_shift(2),!0),G=T(H[0].r,B.read_shift(2),!1);de=T(H[0].c,B.read_shift(2),!0),ie=T(H[0].r,B.read_shift(2),!1),W.push(Ve+G+":"+de+ie)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(B.read_shift(2));break;case 6:{for(var ot="";fe=B[B.l++];)ot+=String.fromCharCode(fe);W.push('"'+ot.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:pe=W.pop(),_e=W.pop(),W.push(["AND","OR"][fe-20]+"("+_e+","+pe+")");break;default:if(fe<32&&E[fe])pe=W.pop(),_e=W.pop(),W.push(_e+E[fe]+pe);else if(b[fe]){if(z=b[fe][1],z==69&&(z=B[B.l++]),z>W.length){console.error("WK1 bad formula parse 0x"+fe.toString(16)+":|"+W.join("|")+"|");return}var Z=W.slice(-z);W.length-=z,W.push(b[fe][0]+"("+Z.join(",")+")")}else return fe<=7?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=24?console.error("WK1 unsupported op "+fe.toString(16)):fe<=30?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=115?console.error("WK1 unsupported function opcode "+fe.toString(16)):console.error("WK1 unrecognized opcode "+fe.toString(16))}}W.length==1?H[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function M(B){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=B.read_shift(2),H[3]=B[B.l++],H[0].c=B[B.l++],H}function O(B,H){var W=M(B);return W[1].t="s",W[1].v=B.read_shift(H-4,"cstr"),W}function y(B,H,W,z){var ie=ne(6+z.length);ie.write_shift(2,B),ie.write_shift(1,W),ie.write_shift(1,H),ie.write_shift(1,39);for(var de=0;de<z.length;++de){var _e=z.charCodeAt(de);ie.write_shift(1,_e>=128?95:_e)}return ie.write_shift(1,0),ie}function A(B,H){var W=M(B);W[1].v=B.read_shift(2);var z=W[1].v>>1;if(W[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return W[1].v=z,W}function v(B,H){var W=M(B),z=B.read_shift(4),ie=B.read_shift(4),de=B.read_shift(2);if(de==65535)return z===0&&ie===3221225472?(W[1].t="e",W[1].v=15):z===0&&ie===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var _e=de&32768;return de=(de&32767)-16446,W[1].v=(1-_e*2)*(ie*Math.pow(2,de+32)+z*Math.pow(2,de)),W}function S(B,H,W,z){var ie=ne(14);if(ie.write_shift(2,B),ie.write_shift(1,W),ie.write_shift(1,H),z==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var de=0,_e=0,pe=0,fe=0;return z<0&&(de=1,z=-z),_e=Math.log2(z)|0,z/=Math.pow(2,_e-31),fe=z>>>0,fe&2147483648||(z/=2,++_e,fe=z>>>0),z-=fe,fe|=2147483648,fe>>>=0,z*=Math.pow(2,32),pe=z>>>0,ie.write_shift(4,pe),ie.write_shift(4,fe),_e+=16383+(de?32768:0),ie.write_shift(2,_e),ie}function I(B,H){var W=v(B);return B.l+=H-14,W}function k(B,H){var W=M(B),z=B.read_shift(4);return W[1].v=z>>6,W}function R(B,H){var W=M(B),z=B.read_shift(8,"f");return W[1].v=z,W}function ae(B,H){var W=R(B);return B.l+=H-10,W}function oe(B,H){return B[B.l+H-1]==0?B.read_shift(H,"cstr"):""}function Ae(B,H){var W=B[B.l++];W>H-1&&(W=H-1);for(var z="";z.length<W;)z+=String.fromCharCode(B[B.l++]);return z}function le(B,H,W){if(!(!W.qpro||H<21)){var z=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ie=B.read_shift(H-21,"cstr");return[z,ie]}}function We(B,H){for(var W={},z=B.l+H;B.l<z;){var ie=B.read_shift(2);if(ie==14e3){for(W[ie]=[0,""],W[ie][0]=B.read_shift(2);B[B.l];)W[ie][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return W}function K(B,H){var W=ne(5+B.length);W.write_shift(2,14e3),W.write_shift(2,H);for(var z=0;z<B.length;++z){var ie=B.charCodeAt(z);W[W.l++]=ie>127?95:ie}return W[W.l++]=0,W}var Fe={0:{n:"BOF",f:Qt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},Ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:v},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:We},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:k},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function yb(r){var e={},t=r.match(Rr),n=0,i=!1;if(t)for(;n!=t.length;++n){var s=Me(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=F0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var wb=function(){var r=Yo("t"),e=Yo("rPr");function t(s){var a=s.match(r);if(!a)return{t:"s",v:""};var o={t:"s",v:it(a[1])},c=s.match(e);return c&&(o.s=yb(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(t).filter(function(o){return o.v})}}(),Eb=function(){var e=/(\r\n|\n)/g;function t(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Tb=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ab=/<(?:\w+:)?r>/,Sb=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function nd(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=it(pt(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pt(r),t&&(n.h=B0(n.t))):r.match(Ab)&&(n.r=pt(r),n.t=it(pt((r.replace(Sb,"").match(Tb)||[]).join("").replace(Rr,""))),t&&(n.h=Eb(wb(n.r)))),n):{t:""}}var Ib=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kb=/<(?:\w+:)?(?:si|sstItem)>/g,Cb=/<\/(?:\w+:)?(?:si|sstItem)>/;function bb(r,e){var t=[],n="";if(!r)return t;var i=r.match(Ib);if(i){n=i[2].replace(kb,"").split(Cb);for(var s=0;s!=n.length;++s){var a=nd(n[s].trim(),e);a!=null&&(t[t.length]=a)}i=Me(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}var Rb=/^\s|\s$|[\t\n\r]/;function Hv(r,e){if(!e.bookSST)return"";var t=[jt];t[t.length]=ye("sst",null,{xmlns:Ps[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var i=r[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Rb)&&(s+=' xml:space="preserve"'),s+=">"+dt(i.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function Fb(r){return[r.read_shift(4),r.read_shift(4)]}function Db(r,e){var t=[],n=!1;return si(r,function(s,a,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function Pb(r,e){return e||(e=ne(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var Nb=Hk;function Ob(r){var e=Ur();ce(e,159,Pb(r));for(var t=0;t<r.length;++t)ce(e,19,Nb(r[t]));return ce(e,160),e.end()}function jv(r){if(typeof rt<"u")return rt.utils.encode(Es,r);for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function ei(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function Lb(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=ei(r,4),e.U=ei(r,4),e.W=ei(r,4),e}function Mb(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},i=r.read_shift(4),s=[];i-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function Vb(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(Mb(r));return e}function Bb(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function Ub(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=ei(r,4),e.U=ei(r,4),e.W=ei(r,4),e}function Gb(r){var e=Ub(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function $v(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function Kv(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function Wb(r){var e=ei(r);switch(e.Minor){case 2:return[e.Minor,zb(r)];case 3:return[e.Minor,Hb()];case 4:return[e.Minor,jb(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function zb(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=$v(r,t),i=Kv(r,r.length-r.l);return{t:"Std",h:n,v:i}}function Hb(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jb(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(Rr,function(s){var a=Me(s);switch(Vn(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function $b(r,e){var t={},n=t.EncryptionVersionInfo=ei(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var i=r.read_shift(4);return e-=4,t.EncryptionHeader=$v(r,i),e-=i,t.EncryptionVerifier=Kv(r,e),t}function Kb(r){var e={},t=e.EncryptionVersionInfo=ei(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function id(r){var e=0,t,n=jv(r),i=n.length+1,s,a,o,c,l;for(t=Pi(i),t[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)a=t[s],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var qv=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var u=a[l],h=0;h!=7;++h)u&64&&(o^=t[c]),u*=2,--c;return o};return function(a){for(var o=jv(a),c=s(o),l=o.length,u=Pi(16),h=0;h!=16;++h)u[h]=0;var d,m,g;for((l&1)===1&&(d=c>>8,u[l]=i(r[0],d),--l,d=c&255,m=o[o.length-1],u[l]=i(m,d));l>0;)--l,d=c>>8,u[l]=i(o[l],d),--l,d=c&255,u[l]=i(o[l],d);for(l=15,g=15-o.length;g>0;)d=c>>8,u[l]=i(r[g],d),--l,--g,d=c&255,u[l]=i(o[l],d),--l,--g;return u}}(),qb=function(r,e,t,n,i){i||(i=e),n||(n=qv(r));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[t],a=(a>>5|a<<3)&255,i[s]=a,++t;return[i,t,n]},Xb=function(r){var e=0,t=qv(r);return function(n){var i=qb("",n,e,t);return e=i[1],i[0]}};function Qb(r,e,t,n){var i={key:Qt(r),verificationBytes:Qt(r)};return t.password&&(i.verifier=id(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Xb(t.password)),i}function Yb(r,e,t){var n=t||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=Kb(r):n.Data=$b(r,e),n}function Jb(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?Yb(r,e-2,n):Qb(r,t.biff>=8?e:e-2,t,n),n}var Xv=function(){function r(i,s){switch(s.type){case"base64":return e(tn(i),s);case"binary":return e(i,s);case"buffer":return e(Ke&&Buffer.isBuffer(i)?i.toString("binary"):zi(i),s);case"array":return e(As(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,g,p=-1;g=d.exec(u);){switch(g[0]){case"\\cell":var x=u.slice(m,d.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var T={v:x,t:"s"};Array.isArray(o)?o[h][p]=T:o[Le({r:h,c:p})]=T}break}m=d.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=ze(l),o}function t(i,s){return Hi(r(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Je(i["!ref"]),o,c=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=Le({r:l,c:u});o=c?(i[l]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(On(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function Zb(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function tc(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function eR(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.max(e,t,n),s=Math.min(e,t,n),a=i-s;if(a===0)return[0,0,e];var o=0,c=0,l=i+s;switch(c=a/(l>1?2-l:l),i){case e:o=((t-n)/a+6)%6;break;case t:o=(n-e)/a+2;break;case n:o=(e-t)/a+4;break}return[o/6,c,l/2]}function tR(r){var e=r[0],t=r[1],n=r[2],i=t*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,c;if(t!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function iu(r,e){if(e===0)return r;var t=eR(Zb(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),tc(tR(t))}var Qv=6,rR=15,nR=1,Tr=Qv;function rc(r){return Math.floor((r+Math.round(128/Tr)/256)*Tr)}function nc(r){return Math.floor((r-5)/Tr*100+.5)/100}function su(r){return Math.round((r*Tr+5)/Tr*256)/256}function wf(r){return su(nc(rc(r)))}function sd(r){var e=Math.abs(r-wf(r)),t=Tr;if(e>.005)for(Tr=nR;Tr<rR;++Tr)Math.abs(r-wf(r))<=e&&(e=Math.abs(r-wf(r)),t=Tr);Tr=t}function Ni(r){r.width?(r.wpx=rc(r.width),r.wch=nc(r.wpx),r.MDW=Tr):r.wpx?(r.wch=nc(r.wpx),r.width=su(r.wch),r.MDW=Tr):typeof r.wch=="number"&&(r.width=su(r.wch),r.wpx=rc(r.width),r.MDW=Tr),r.customWidth&&delete r.customWidth}var iR=96,Yv=iR;function ic(r){return r*96/Yv}function Pa(r){return r*Yv/96}var sR={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function aR(r,e,t,n){e.Borders=[];var i={},s=!1;(r[0].match(Rr)||[]).forEach(function(a){var o=Me(a);switch(Vn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Tt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Tt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function oR(r,e,t,n){e.Fills=[];var i={},s=!1;(r[0].match(Rr)||[]).forEach(function(a){var o=Me(a);switch(Vn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function cR(r,e,t,n){e.Fonts=[];var i={},s=!1;(r[0].match(Rr)||[]).forEach(function(a){var o=Me(a);switch(Vn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=pt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Tt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Tt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Tt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Tt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Tt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Tt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Tt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=F0[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Tt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=cs[i.color.index];i.color.index==81&&(c=cs[1]),c||(c=cs[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=iu(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function lR(r,e,t){e.NumberFmt=[];for(var n=Bt(Oe),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Oe[n[i]];var s=r[0].match(Rr);if(s)for(i=0;i<s.length;++i){var a=Me(s[i]);switch(Vn(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=it(pt(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}Fn(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function uR(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=ye("numFmt",null,{numFmtId:n,formatCode:dt(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ye("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var ll=["numFmtId","fillId","fontId","borderId","xfId"],ul=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function fR(r,e,t){e.CellXf=[];var n,i=!1;(r[0].match(Rr)||[]).forEach(function(s){var a=Me(s),o=0;switch(Vn(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<ll.length;++o)n[ll[o]]&&(n[ll[o]]=parseInt(n[ll[o]],10));for(o=0;o<ul.length;++o)n[ul[o]]&&(n[ul[o]]=Tt(n[ul[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=Tt(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function hR(r){var e=[];return e[e.length]=ye("cellXfs",null),r.forEach(function(t){e[e.length]=ye("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ye("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var dR=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&lR(h,u,l),(h=o.match(i))&&cR(h,u,c,l),(h=o.match(n))&&oR(h,u,c,l),(h=o.match(s))&&aR(h,u,c,l),(h=o.match(t))&&fR(h,u,l),u}}();function Jv(r,e){var t=[jt,ye("styleSheet",null,{xmlns:Ps[0],"xmlns:vt":Zt.vt})],n;return r.SSF&&(n=uR(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=hR(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function mR(r,e){var t=r.read_shift(2),n=Cr(r);return[t,n]}function pR(r,e,t){t||(t=ne(6+4*e.length)),t.write_shift(2,r),or(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function gR(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=Yk(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(n.underline=a);var o=r.read_shift(1);o>0&&(n.family=o);var c=r.read_shift(1);switch(c>0&&(n.charset=c),r.l++,n.color=Qk(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Cr(r),n}function _R(r,e){e||(e=ne(25+4*32)),e.write_shift(2,r.sz*20),Jk(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),tu(r.color,e);var n=0;return n=2,e.write_shift(1,n),or(r.name,e),e.length>e.l?e.slice(0,e.l):e}var xR=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ef,vR=br;function wg(r,e){e||(e=ne(4*3+8*7+16*1)),Ef||(Ef=Du(xR));var t=Ef[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(tu({auto:1},e),tu({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function yR(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}function Zv(r,e,t){t||(t=ne(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function oo(r,e){return e||(e=ne(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var wR=br;function ER(r,e){return e||(e=ne(51)),e.write_shift(1,0),oo(null,e),oo(null,e),oo(null,e),oo(null,e),oo(null,e),e.length>e.l?e.slice(0,e.l):e}function TR(r,e){return e||(e=ne(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),eu(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function AR(r,e,t){var n=ne(2052);return n.write_shift(4,r),eu(e,n),eu(t,n),n.length>n.l?n.slice(0,n.l):n}function SR(r,e,t){var n={};n.NumberFmt=[];for(var i in Oe)n.NumberFmt[i]=Oe[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return si(r,function(c,l,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],Fn(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=iu(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(l.T>0)s.push(u);else if(l.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function IR(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++t}),t!=0&&(ce(r,615,En(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ce(r,44,pR(i,e[i]))}),ce(r,616))}}function kR(r){var e=1;ce(r,611,En(e)),ce(r,43,_R({sz:12,color:{theme:1},name:"Calibri",family:2})),ce(r,612)}function CR(r){var e=2;ce(r,603,En(e)),ce(r,45,wg({patternType:"none"})),ce(r,45,wg({patternType:"gray125"})),ce(r,604)}function bR(r){var e=1;ce(r,613,En(e)),ce(r,46,ER()),ce(r,614)}function RR(r){var e=1;ce(r,626,En(e)),ce(r,47,Zv({numFmtId:0},65535)),ce(r,627)}function FR(r,e){ce(r,617,En(e.length)),e.forEach(function(t){ce(r,47,Zv(t,0))}),ce(r,618)}function DR(r){var e=1;ce(r,619,En(e)),ce(r,48,TR({xfId:0,name:"Normal"})),ce(r,620)}function PR(r){var e=0;ce(r,505,En(e)),ce(r,506)}function NR(r){var e=0;ce(r,508,AR(e,"TableStyleMedium9","PivotStyleMedium4")),ce(r,509)}function OR(r,e){var t=Ur();return ce(t,278),IR(t,r.SSF),kR(t),CR(t),bR(t),RR(t),FR(t,e.cellXfs),DR(t),PR(t),NR(t),ce(t,279),t.end()}var LR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function MR(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(Rr)||[]).forEach(function(i){var s=Me(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[LR.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function VR(){}function BR(){}var UR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,GR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,WR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function zR(r,e,t){e.themeElements={};var n;[["clrScheme",UR,MR],["fontScheme",GR,VR],["fmtScheme",WR,BR]].forEach(function(i){if(!(n=r.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,t)})}var HR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ey(r,e){(!r||r.length===0)&&(r=ad());var t,n={};if(!(t=r.match(HR)))throw new Error("themeElements not found in theme");return zR(t[0],n,e),n.raw=r,n}function ad(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[jt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function jR(r,e,t){var n=r.l+e,i=r.read_shift(4);if(i!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var a;try{a=Qx(s,{type:"array"})}catch{return}var o=Qr(a,"theme/theme/theme1.xml",!0);if(o)return ey(o,t)}}function $R(r){return r.read_shift(4)}function KR(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=qR(r,4);break;case 2:e.xclrValue=Pv(r);break;case 3:e.xclrValue=$R(r);break;case 4:r.l+=4;break}return r.l+=8,e}function qR(r,e){return br(r,e)}function XR(r,e){return br(r,e)}function QR(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=KR(r);break;case 6:n[1]=XR(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function YR(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var i=r.read_shift(2),s=[];i-- >0;)s.push(QR(r,t-r.l));return{ixfe:n,ext:s}}function JR(r,e){e.forEach(function(t){switch(t[0]){}})}function ZR(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Cr(r)}}function eF(r){var e=ne(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),or(r.name,e),e.slice(0,e.l)}function tF(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function rF(r){var e=ne(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function nF(r,e){var t=ne(8+2*e.length);return t.write_shift(4,r),or(e,t),t.slice(0,t.l)}function iF(r){return r.l+=4,r.read_shift(4)!=0}function sF(r,e){var t=ne(8);return t.write_shift(4,r),t.write_shift(4,1),t}function aF(r,e,t){var n={Types:[],Cell:[],Value:[]},i=t||{},s=[],a=!1,o=2;return si(r,function(c,l,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!l.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function oF(){var r=Ur();return ce(r,332),ce(r,334,En(1)),ce(r,335,eF({name:"XLDAPR",version:12e4,flags:3496657072})),ce(r,336),ce(r,339,nF(1,"XLDAPR")),ce(r,52),ce(r,35,En(514)),ce(r,4096,En(0)),ce(r,4097,fn(1)),ce(r,36),ce(r,53),ce(r,340),ce(r,337,sF(1)),ce(r,51,rF([[1,0]])),ce(r,338),ce(r,333),r.end()}function cF(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var i=!1,s=2,a;return r.replace(Rr,function(o){var c=Me(o);switch(Vn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function ty(){var r=[jt];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function lF(r){var e=[];if(!r)return e;var t=1;return(r.match(Rr)||[]).forEach(function(n){var i=Me(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,e.push(i);break}}),e}function uF(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=Le(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function fF(r,e,t){var n=[];return si(r,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function hF(r,e,t,n){if(!r)return r;var i=n||{},s=!1;si(r,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},i)}function dF(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var oa=1024;function ry(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[ye("xml",null,{"xmlns:v":qr.v,"xmlns:o":qr.o,"xmlns:x":qr.x,"xmlns:mv":qr.mv}).replace(/\/>/,">"),ye("o:shapelayout",ye("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),ye("v:shapetype",[ye("v:stroke",null,{joinstyle:"miter"}),ye("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];oa<r*1e3;)oa+=1e3;return e.forEach(function(s){var a=Pt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ye("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ye("v:fill",c,o),u={on:"t",obscured:"t"};++oa,i=i.concat(["<v:shape"+Jo({id:"_x0000_s"+oa,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ye("v:shadow",null,u),ye("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),pr("x:AutoFill","False"),pr("x:Row",String(a.r)),pr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Eg(r,e,t,n){var i=Array.isArray(r),s;e.forEach(function(a){var o=Pt(a.ref);if(i?(r[o.r]||(r[o.r]=[]),s=r[o.r][o.c]):s=r[a.ref],!s){s={t:"z"},i?r[o.r][o.c]=s:r[a.ref]=s;var c=Je(r["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=ze(c);l!==r["!ref"]&&(r["!ref"]=l)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:t};a.h&&(u.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!t&&s.c[h].T)return;t&&!s.c[h].T&&s.c.splice(h,1)}if(t&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function mF(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Me(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Pt(c.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&nd(h[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function ny(r){var e=[jt,ye("comments",null,{xmlns:Ps[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(i){var s=dt(i.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=t.indexOf(dt(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(pr("t",dt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(pr("t",dt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function pF(r,e){var t=[],n=!1,i={},s=0;return r.replace(Rr,function(o,c){var l=Me(o);switch(Vn(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=r.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function gF(r,e,t){var n=[jt,ye("ThreadedComments",null,{xmlns:Zt.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(ye("threadedComment",pr("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function _F(r,e){var t=[],n=!1;return r.replace(Rr,function(s){var a=Me(s);switch(Vn(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function xF(r){var e=[jt,ye("personList",null,{xmlns:Zt.TCMNT,"xmlns:x":Ps[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(ye("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function vF(r){var e={};e.iauthor=r.read_shift(4);var t=Ms(r);return e.rfx=t.s,e.ref=Le(t.s),r.l+=16,e}function yF(r,e){return e==null&&(e=ne(36)),e.write_shift(4,r[1].iauthor),ja(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var wF=Cr;function EF(r){return or(r.slice(0,54))}function TF(r,e){var t=[],n=[],i={},s=!1;return si(r,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}function AF(r){var e=Ur(),t=[];return ce(e,628),ce(e,630),r.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),ce(e,632,EF(i.a)))})}),ce(e,631),ce(e,633),r.forEach(function(n){n[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var s={s:Pt(n[0]),e:Pt(n[0])};ce(e,635,yF([s,i])),i.t&&i.t.length>0&&ce(e,637,$k(i)),ce(e,636),delete i.iauthor})}),ce(e,634),ce(e,629),e.end()}var SF="application/vnd.ms-office.vbaProject";function IF(r){var e=Pe.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Pe.utils.cfb_add(e,i,r.FileIndex[n].content)}}),Pe.write(e)}function kF(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Pe.utils.cfb_add(r,i,e.FileIndex[n].content)}})}var iy=["xlsb","xlsm","xlam","biff8","xla"];function CF(){return{"!type":"dialog"}}function bF(){return{"!type":"dialog"}}function RF(){return{"!type":"macro"}}function FF(){return{"!type":"macro"}}var da=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,c?l+=e.r:--l,i+(o?"":"$")+At(u)+(c?"":"$")+Mt(l)}return function(i,s){return e=s,i.replace(r,t)}}(),od=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,cd=function(){return function(e,t){return e.replace(od,function(n,i,s,a,o,c){var l=q0(a)-(s?0:t.c),u=K0(c)-(o?0:t.r),h=u==0?"":o?u+1:"["+u+"]",d=l==0?"":s?l+1:"["+l+"]";return i+"R"+h+"C"+d})}}();function sy(r,e){return r.replace(od,function(t,n,i,s,a,o){return n+(i=="$"?i+s:At(q0(s)+e.c))+(a=="$"?a+o:Mt(K0(o)+e.r))})}function DF(r,e,t){var n=Or(e),i=n.s,s=Pt(t),a={r:s.r-i.r,c:s.c-i.c};return sy(r,a)}function PF(r){return r.length!=1}function Tg(r){return r.replace(/_xlfn\./g,"")}function Kt(r){r.l+=1}function Oi(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function ay(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return oy(r);t.biff==12&&(n=4)}var i=r.read_shift(n),s=r.read_shift(n),a=Oi(r),o=Oi(r);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function oy(r){var e=Oi(r),t=Oi(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function NF(r,e,t){if(t.biff<8)return oy(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),s=Oi(r),a=Oi(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function cy(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return OF(r);var n=r.read_shift(t&&t.biff==12?4:2),i=Oi(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function OF(r){var e=Oi(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function LF(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function MF(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return VF(r);var i=r.read_shift(n>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function VF(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function BF(r,e,t){var n=(r[r.l++]&96)>>5,i=ay(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function UF(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=ay(r,s,t);return[n,i,a]}function GF(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function WF(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,i]}function zF(r,e,t){var n=(r[r.l++]&96)>>5,i=NF(r,e-1,t);return[n,i]}function HF(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Ag(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function jF(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function $F(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function KF(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function qF(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function XF(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function ly(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function QF(r){return r.read_shift(2),ly(r)}function YF(r){return r.read_shift(2),ly(r)}function JF(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=cy(r,0,t);return[n,i]}function ZF(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=MF(r,0,t);return[n,i]}function eD(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=cy(r,0,t);return[n,i,s]}function tD(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[iP[i],hy[i],n]}function rD(r,e,t){var n=r[r.l++],i=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:nD(r);return[i,(s[0]===0?hy:nP)[s[1]]]}function nD(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function iD(r,e,t){r.l+=t&&t.biff==2?3:4}function sD(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function aD(r){return r.l++,ai[r.read_shift(1)]}function oD(r){return r.l++,r.read_shift(2)}function cD(r){return r.l++,r.read_shift(1)!==0}function lD(r){return r.l++,Ar(r)}function uD(r,e,t){return r.l++,Ic(r,e-1,t)}function fD(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Ut(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=ai[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Ar(r);break;case 2:t[1]=Vs(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function hD(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((t.biff==12?Ms:Lu)(r));return i}function dD(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=fD(r,t.biff);return a}function mD(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function pD(r,e,t){if(t.biff==5)return gD(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),s=r.read_shift(4);return[n,i,s]}function gD(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function _D(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function xD(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function vD(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function yD(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,i]}var wD=br,ED=br,TD=br;function Cc(r,e,t){return r.l+=2,[LF(r)]}function ld(r){return r.l+=6,[]}var AD=Cc,SD=ld,ID=ld,kD=Cc;function uy(r){return r.l+=2,[Qt(r),r.read_shift(2)&1]}var CD=Cc,bD=uy,RD=ld,FD=Cc,DD=Cc,PD=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ND(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),s=r.read_shift(2),a=PD[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:n,c:i,C:s}}function OD(r){return r.l+=2,[r.read_shift(4)]}function LD(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function MD(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function VD(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function BD(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function UD(r){return r.l+=4,[0,0]}var Sg={1:{n:"PtgExp",f:sD},2:{n:"PtgTbl",f:TD},3:{n:"PtgAdd",f:Kt},4:{n:"PtgSub",f:Kt},5:{n:"PtgMul",f:Kt},6:{n:"PtgDiv",f:Kt},7:{n:"PtgPower",f:Kt},8:{n:"PtgConcat",f:Kt},9:{n:"PtgLt",f:Kt},10:{n:"PtgLe",f:Kt},11:{n:"PtgEq",f:Kt},12:{n:"PtgGe",f:Kt},13:{n:"PtgGt",f:Kt},14:{n:"PtgNe",f:Kt},15:{n:"PtgIsect",f:Kt},16:{n:"PtgUnion",f:Kt},17:{n:"PtgRange",f:Kt},18:{n:"PtgUplus",f:Kt},19:{n:"PtgUminus",f:Kt},20:{n:"PtgPercent",f:Kt},21:{n:"PtgParen",f:Kt},22:{n:"PtgMissArg",f:Kt},23:{n:"PtgStr",f:uD},26:{n:"PtgSheet",f:LD},27:{n:"PtgEndSheet",f:MD},28:{n:"PtgErr",f:aD},29:{n:"PtgBool",f:cD},30:{n:"PtgInt",f:oD},31:{n:"PtgNum",f:lD},32:{n:"PtgArray",f:HF},33:{n:"PtgFunc",f:tD},34:{n:"PtgFuncVar",f:rD},35:{n:"PtgName",f:mD},36:{n:"PtgRef",f:JF},37:{n:"PtgArea",f:BF},38:{n:"PtgMemArea",f:_D},39:{n:"PtgMemErr",f:wD},40:{n:"PtgMemNoMem",f:ED},41:{n:"PtgMemFunc",f:xD},42:{n:"PtgRefErr",f:vD},43:{n:"PtgAreaErr",f:GF},44:{n:"PtgRefN",f:ZF},45:{n:"PtgAreaN",f:zF},46:{n:"PtgMemAreaN",f:VD},47:{n:"PtgMemNoMemN",f:BD},57:{n:"PtgNameX",f:pD},58:{n:"PtgRef3d",f:eD},59:{n:"PtgArea3d",f:UF},60:{n:"PtgRefErr3d",f:yD},61:{n:"PtgAreaErr3d",f:WF},255:{}},GD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},WD={1:{n:"PtgElfLel",f:uy},2:{n:"PtgElfRw",f:FD},3:{n:"PtgElfCol",f:AD},6:{n:"PtgElfRwV",f:DD},7:{n:"PtgElfColV",f:kD},10:{n:"PtgElfRadical",f:CD},11:{n:"PtgElfRadicalS",f:RD},13:{n:"PtgElfColS",f:SD},15:{n:"PtgElfColSV",f:ID},16:{n:"PtgElfRadicalLel",f:bD},25:{n:"PtgList",f:ND},29:{n:"PtgSxName",f:OD},255:{}},zD={0:{n:"PtgAttrNoop",f:UD},1:{n:"PtgAttrSemi",f:XF},2:{n:"PtgAttrIf",f:KF},4:{n:"PtgAttrChoose",f:jF},8:{n:"PtgAttrGoto",f:$F},16:{n:"PtgAttrSum",f:iD},32:{n:"PtgAttrBaxcel",f:Ag},33:{n:"PtgAttrBaxcel",f:Ag},64:{n:"PtgAttrSpace",f:QF},65:{n:"PtgAttrSpaceSemi",f:YF},128:{n:"PtgAttrIfError",f:qF},255:{}};function bc(r,e,t,n){if(n.biff<8)return br(r,e);for(var i=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=dD(r,0,n),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=hD(r,t[a][1],n),s.push(t[a][2]);break;case"PtgExp":n&&n.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=i-r.l,e!==0&&s.push(br(r,e)),s}function Rc(r,e,t){for(var n=r.l+e,i,s,a=[];n!=r.l;)e=n-r.l,s=r[r.l],i=Sg[s]||Sg[GD[s]],(s===24||s===25)&&(i=(s===24?WD:zD)[r[r.l+1]]),!i||!i.f?br(r,e):a.push([i.n,i.f(r,e,t)]);return a}function HD(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var jD={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $D(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function fy(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ig(r,e,t){var n=fy(r,e,t);return n=="#REF"?n:$D(n,t)}function Er(r,e,t,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],c,l,u,h=0,d=0,m,g="";if(!r[0]||!r[0][0])return"";for(var p=-1,x="",T=0,b=r[0].length;T<b;++T){var E=r[0][T];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(r[0][p][1][0]){case 0:x=Lt(" ",r[0][p][1][1]);break;case 1:x=Lt("\r",r[0][p][1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}l=l+x,p=-1}o.push(l+jD[E[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ao(E[1][1],a,i),o.push(So(u,s));break;case"PtgRefN":u=t?Ao(E[1][1],t,i):E[1][1],o.push(So(u,s));break;case"PtgRef3d":h=E[1][1],u=Ao(E[1][2],a,i),g=Ig(n,h,i),o.push(g+"!"+So(u,s));break;case"PtgFunc":case"PtgFuncVar":var F=E[1][0],M=E[1][1];F||(F=0),F&=127;var O=F==0?[]:o.slice(-F);o.length-=F,M==="User"&&(M=O.shift()),o.push(M+"("+O.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":m=tg(E[1][1],t?{s:t}:a,i),o.push(xf(m,i));break;case"PtgArea":m=tg(E[1][1],a,i),o.push(xf(m,i));break;case"PtgArea3d":h=E[1][1],m=E[1][2],g=Ig(n,h,i),o.push(g+"!"+xf(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=E[1][2];var y=(n.names||[])[d-1]||(n[0]||[])[d],A=y?y.Name:"SH33TJSNAME"+String(d);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var v=E[1][1];d=E[1][2];var S;if(i.biff<=5)v<0&&(v=-v),n[v]&&(S=n[v][d]);else{var I="";if(((n[v]||[])[0]||[])[0]==14849||(((n[v]||[])[0]||[])[0]==1025?n[v][d]&&n[v][d].itab>0&&(I=n.SheetNames[n[v][d].itab-1]+"!"):I=n.SheetNames[d-1]+"!"),n[v]&&n[v][d])I+=n[v][d].Name;else if(n[0]&&n[0][d])I+=n[0][d].Name;else{var k=(fy(n,v,i)||"").split(";;");k[d-1]?I=k[d-1]:I+="SH33TJSERRX"}o.push(I);break}S||(S={Name:"SH33TJSERRY"}),o.push(S.Name);break;case"PtgParen":var R="(",ae=")";if(p>=0){switch(x="",r[0][p][1][0]){case 2:R=Lt(" ",r[0][p][1][1])+R;break;case 3:R=Lt("\r",r[0][p][1][1])+R;break;case 4:ae=Lt(" ",r[0][p][1][1])+ae;break;case 5:ae=Lt("\r",r[0][p][1][1])+ae;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][p][1][0])}p=-1}o.push(R+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:E[1][1],r:E[1][0]};var oe={c:t.c,r:t.r};if(n.sharedf[Le(u)]){var Ae=n.sharedf[Le(u)];o.push(Er(Ae,a,oe,n,i))}else{var le=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(u.c<l[0].s.c||u.c>l[0].e.c)&&!(u.r<l[0].s.r||u.r>l[0].e.r)){o.push(Er(l[1],a,oe,n,i)),le=!0;break}le||o.push(E[1])}break;case"PtgArray":o.push("{"+HD(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var We=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&We.indexOf(r[0][T][0])==-1){E=r[0][p];var K=!0;switch(E[1][0]){case 4:K=!1;case 0:x=Lt(" ",E[1][1]);break;case 5:K=!1;case 1:x=Lt("\r",E[1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((K?x:"")+o.pop()+(K?"":x)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function KD(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,a=r.read_shift(i);if(a==65535)return[[],br(r,e-2)];var o=Rc(r,a,t);return e!==a+i&&(s=bc(r,e-a-i,o,t)),r.l=n,[o,s]}function qD(r,e,t){var n=r.l+e,i=t.biff==2?1:2,s,a=r.read_shift(i);if(a==65535)return[[],br(r,e-2)];var o=Rc(r,a,t);return e!==a+i&&(s=bc(r,e-a-i,o,t)),r.l=n,[o,s]}function XD(r,e,t,n){var i=r.l+e,s=Rc(r,n,t),a;return i!==r.l&&(a=bc(r,i-r.l,s,t)),[s,a]}function QD(r,e,t){var n=r.l+e,i,s=r.read_shift(2),a=Rc(r,s,t);return s==65535?[[],br(r,e-2)]:(e!==s+2&&(i=bc(r,n-s-2,a,t)),[a,i])}function YD(r){var e;if(Yn(r,r.l+6)!==65535)return[Ar(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function JD(r){if(r==null){var e=ne(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return Ss(r);return Ss(0)}function Tf(r,e,t){var n=r.l+e,i=Bn(r);t.biff==2&&++r.l;var s=YD(r),a=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var o=qD(r,n-r.l,t);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function ZD(r,e,t,n,i){var s=ks(e,t,i),a=JD(r.v),o=ne(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=ne(r.bf.length),u=0;u<r.bf.length;++u)l[u]=r.bf[u];var h=ar([s,a,o,l]);return h}function Mu(r,e,t){var n=r.read_shift(4),i=Rc(r,n,t),s=r.read_shift(4),a=s>0?bc(r,s,i,t):null;return[i,a]}var eP=Mu,Vu=Mu,tP=Mu,rP=Mu,nP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function kg(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function sP(r){var e="of:="+r.replace(od,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Af(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function aP(r){return r.replace(/\./,"!")}var ko={},ma={},Co=typeof Map<"u";function ud(r,e,t){var n=0,i=r.length;if(t){if(Co?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Co?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<i;++n)if(r[n].t===e)return r.Count++,n;return r[i]={t:e},r.Count++,r.Unique++,t&&(Co?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Bu(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(Tr=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=nc(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=su(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function fs(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function ji(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],i=60,s=r.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){Fn(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(r[i].numFmtId===n)return i;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function dy(r,e,t,n,i,s){try{n.cellNF&&(r.z=Oe[e])}catch(o){if(n.WTF)throw o}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=St(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(Oe[e]==null&&Fn(rk[e]||"General",e),r.t==="e")r.w=r.w||ai[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Qo(r.v);else if(r.t==="d"){var a=er(r.v);(a|0)===a?r.w=a.toString(10):r.w=Qo(a)}else{if(r.v===void 0)return"";r.w=Ts(r.v,ma)}else r.t==="d"?r.w=rn(e,er(r.v),ma):r.w=rn(e,r.v,ma)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=iu(i.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=i.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=iu(i.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=i.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function oP(r,e,t){if(r&&r["!ref"]){var n=Je(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function cP(r,e){var t=Je(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=ze(t))}var lP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,uP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,fP=/<(?:\w:)?hyperlink [^>]*>/mg,hP=/"(\w*:\w*)"/,dP=/<(?:\w:)?col\b[^>]*[\/]?>/g,mP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pP=/<(?:\w:)?pageMargins[^>]*\/>/g,my=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,gP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,_P=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xP(r,e,t,n,i,s,a){if(!r)return r;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",h=r.match(uP);h?(l=r.slice(0,h.index),u=r.slice(h.index+h[0].length)):l=u=r;var d=l.match(my);d?fd(d[0],o,i,t):(d=l.match(gP))&&yP(d[0],d[1]||"",o,i,t);var m=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=l.slice(m,m+50).match(hP);g&&cP(o,g[1])}var p=l.match(_P);p&&p[1]&&PP(p[1],i);var x=[];if(e.cellStyles){var T=l.match(dP);T&&CP(x,T)}h&&LP(h[1],o,e,c,s,a);var b=u.match(mP);b&&(o["!autofilter"]=RP(b[0]));var E=[],F=u.match(lP);if(F)for(m=0;m!=F.length;++m)E[m]=Je(F[m].slice(F[m].indexOf('"')+1));var M=u.match(fP);M&&SP(o,M,n);var O=u.match(pP);if(O&&(o["!margins"]=IP(Me(O[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=ze(c)),e.sheetRows>0&&o["!ref"]){var y=Je(o["!ref"]);e.sheetRows<=+y.e.r&&(y.e.r=e.sheetRows-1,y.e.r>c.e.r&&(y.e.r=c.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>c.e.c&&(y.e.c=c.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ze(y))}return x.length>0&&(o["!cols"]=x),E.length>0&&(o["!merges"]=E),o}function vP(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+ze(r[t])+'"/>';return e+"</mergeCells>"}function fd(r,e,t,n){var i=Me(r);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=it(pt(i.codeName)))}function yP(r,e,t,n,i){fd(r.slice(0,r.indexOf(">")),t,n,i)}function wP(r,e,t,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[t];try{e.Workbook&&(c=e.Workbook.Sheets[t].CodeName||c)}catch{}s=!0,a.codeName=Rn(dt(c))}if(r&&r["!outline"]){var l={summaryBelow:1,summaryRight:1};r["!outline"].above&&(l.summaryBelow=0),r["!outline"].left&&(l.summaryRight=0),o=(o||"")+ye("outlinePr",null,l)}!s&&!o||(i[i.length]=ye("sheetPr",o,a))}var EP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],TP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function AP(r){var e={sheet:1};return EP.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),TP.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=id(r.password).toString(16).toUpperCase()),ye("sheetProtection",null,e)}function SP(r,e,t){for(var n=Array.isArray(r),i=0;i!=e.length;++i){var s=Me(pt(e[i]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+it(s.location))):(s.Target="#"+it(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Je(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=Le({c:l,r:c});n?(r[c]||(r[c]=[]),r[c][l]||(r[c][l]={t:"z",v:void 0}),r[c][l].l=s):(r[u]||(r[u]={t:"z",v:void 0}),r[u].l=s)}}}function IP(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function kP(r){return fs(r),ye("pageMargins",null,r)}function CP(r,e){for(var t=!1,n=0;n!=e.length;++n){var i=Me(e[n],!0);i.hidden&&(i.hidden=Tt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,sd(i.width)),Ni(i);s<=a;)r[s++]=vt(i)}}function bP(r,e){for(var t=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(t[t.length]=ye("col",null,Bu(i,n)));return t[t.length]="</cols>",t.join("")}function RP(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function FP(r,e,t,n){var i=typeof r.ref=="string"?r.ref:ze(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=Or(i);a.s.r==a.e.r&&(a.e.r=Or(e["!ref"]).e.r,i=ze(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+t.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),ye("autoFilter",null,{ref:i})}var DP=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function PP(r,e){e.Views||(e.Views=[{}]),(r.match(DP)||[]).forEach(function(t,n){var i=Me(t);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Tt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function NP(r,e,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ye("sheetViews",ye("sheetView",null,i),{})}function OP(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=ai[r.v];break;case"d":n&&n.cellDates?i=St(r.v,-1).toISOString():(r=vt(r),r.t="n",i=""+(r.v=er(St(r.v)))),typeof r.z>"u"&&(r.z=Oe[14]);break;default:i=r.v;break}var o=pr("v",dt(i)),c={r:e},l=ji(n.cellXfs,r,n);switch(l!==0&&(c.s=l),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=pr("v",""+ud(n.Strings,r.v,n.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var u=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=ye("f",dt(r.f),u)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(c.cm=1),ye("c",o,c)}var LP=function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Yo("v"),a=Yo("f");return function(c,l,u,h,d,m){for(var g=0,p="",x=[],T=[],b=0,E=0,F=0,M="",O,y,A=0,v=0,S,I,k=0,R=0,ae=Array.isArray(m.CellXf),oe,Ae=[],le=[],We=Array.isArray(l),K=[],Fe={},Ne=!1,B=!!u.sheetStubs,H=c.split(e),W=0,z=H.length;W!=z;++W){p=H[W].trim();var ie=p.length;if(ie!==0){var de=0;e:for(g=0;g<ie;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(y=Me(p.slice(de,g),!0),A=y.r!=null?parseInt(y.r,10):A+1,v=-1,u.sheetRows&&u.sheetRows<A)continue;Fe={},Ne=!1,y.ht&&(Ne=!0,Fe.hpt=parseFloat(y.ht),Fe.hpx=Pa(Fe.hpt)),y.hidden=="1"&&(Ne=!0,Fe.hidden=!0),y.outlineLevel!=null&&(Ne=!0,Fe.level=+y.outlineLevel),Ne&&(K[A-1]=Fe)}break;case"<":de=g;break}if(de>=g)break;if(y=Me(p.slice(de,g),!0),A=y.r!=null?parseInt(y.r,10):A+1,v=-1,!(u.sheetRows&&u.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),u&&u.cellStyles&&(Fe={},Ne=!1,y.ht&&(Ne=!0,Fe.hpt=parseFloat(y.ht),Fe.hpx=Pa(Fe.hpt)),y.hidden=="1"&&(Ne=!0,Fe.hidden=!0),y.outlineLevel!=null&&(Ne=!0,Fe.level=+y.outlineLevel),Ne&&(K[A-1]=Fe)),x=p.slice(g).split(r);for(var _e=0;_e!=x.length&&x[_e].trim().charAt(0)=="<";++_e);for(x=x.slice(_e),g=0;g!=x.length;++g)if(p=x[g].trim(),p.length!==0){if(T=p.match(t),b=g,E=0,F=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,T!=null&&T.length===2){for(b=0,M=T[1],E=0;E!=M.length&&!((F=M.charCodeAt(E)-64)<1||F>26);++E)b=26*b+F;--b,v=b}else++v;for(E=0;E!=p.length&&p.charCodeAt(E)!==62;++E);if(++E,y=Me(p.slice(0,E),!0),y.r||(y.r=Le({r:A-1,c:v})),M=p.slice(E),O={t:""},(T=M.match(s))!=null&&T[1]!==""&&(O.v=it(T[1])),u.cellFormula){if((T=M.match(a))!=null&&T[1]!==""){if(O.f=it(pt(T[1])).replace(/\r\n/g,`
`),u.xlfn||(O.f=Tg(O.f)),T[0].indexOf('t="array"')>-1)O.F=(M.match(i)||[])[1],O.F.indexOf(":")>-1&&Ae.push([Je(O.F),O.F]);else if(T[0].indexOf('t="shared"')>-1){I=Me(T[0]);var pe=it(pt(T[1]));u.xlfn||(pe=Tg(pe)),le[parseInt(I.si,10)]=[I,pe,y.r]}}else(T=M.match(/<f[^>]*\/>/))&&(I=Me(T[0]),le[I.si]&&(O.f=DF(le[I.si][1],le[I.si][2],y.r)));var fe=Pt(y.r);for(E=0;E<Ae.length;++E)fe.r>=Ae[E][0].s.r&&fe.r<=Ae[E][0].e.r&&fe.c>=Ae[E][0].s.c&&fe.c<=Ae[E][0].e.c&&(O.F=Ae[E][1])}if(y.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(B)O.t="z";else continue;else O.t=y.t||"n";switch(h.s.c>v&&(h.s.c=v),h.e.c<v&&(h.e.c=v),O.t){case"n":if(O.v==""||O.v==null){if(!B)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!B)continue;O.t="z"}else S=ko[parseInt(O.v,10)],O.v=S.t,O.r=S.r,u.cellHTML&&(O.h=S.h);break;case"str":O.t="s",O.v=O.v!=null?pt(O.v):"",u.cellHTML&&(O.h=B0(O.v));break;case"inlineStr":T=M.match(n),O.t="s",T!=null&&(S=nd(T[1]))?(O.v=S.t,u.cellHTML&&(O.h=S.h)):O.v="";break;case"b":O.v=Tt(O.v);break;case"d":u.cellDates?O.v=St(O.v,1):(O.v=er(St(O.v,1)),O.t="n");break;case"e":(!u||u.cellText!==!1)&&(O.w=O.v),O.v=gv[O.v];break}if(k=R=0,oe=null,ae&&y.s!==void 0&&(oe=m.CellXf[y.s],oe!=null&&(oe.numFmtId!=null&&(k=oe.numFmtId),u.cellStyles&&oe.fillId!=null&&(R=oe.fillId))),dy(O,k,R,u,d,m),u.cellDates&&ae&&O.t=="n"&&Ds(Oe[k])&&(O.t="d",O.v=Nu(O.v)),y.cm&&u.xlmeta){var Ve=(u.xlmeta.Cell||[])[+y.cm-1];Ve&&Ve.type=="XLDAPR"&&(O.D=!0)}if(We){var G=Pt(y.r);l[G.r]||(l[G.r]=[]),l[G.r][G.c]=O}else l[y.r]=O}}}}K.length>0&&(l["!rows"]=K)}}();function MP(r,e,t,n){var i=[],s=[],a=Je(r["!ref"]),o="",c,l="",u=[],h=0,d=0,m=r["!rows"],g=Array.isArray(r),p={r:l},x,T=-1;for(d=a.s.c;d<=a.e.c;++d)u[d]=At(d);for(h=a.s.r;h<=a.e.r;++h){for(s=[],l=Mt(h),d=a.s.c;d<=a.e.c;++d){c=u[d]+l;var b=g?(r[h]||[])[d]:r[c];b!==void 0&&(o=OP(b,c,r,e))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(p={r:l},m&&m[h]&&(x=m[h],x.hidden&&(p.hidden=1),T=-1,x.hpx?T=ic(x.hpx):x.hpt&&(T=x.hpt),T>-1&&(p.ht=T,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),i[i.length]=ye("row",s.join(""),p))}if(m)for(;h<m.length;++h)m&&m[h]&&(p={r:h+1},x=m[h],x.hidden&&(p.hidden=1),T=-1,x.hpx?T=ic(x.hpx):x.hpt&&(T=x.hpt),T>-1&&(p.ht=T,p.customHeight=1),x.level&&(p.outlineLevel=x.level),i[i.length]=ye("row","",p));return i.join("")}function py(r,e,t,n){var i=[jt,ye("worksheet",null,{xmlns:Ps[0],"xmlns:r":Zt.r})],s=t.SheetNames[r],a=0,o="",c=t.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",u=Je(l);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),l=ze(u)}n||(n={}),c["!comments"]=[];var h=[];wP(c,t,r,e,i),i[i.length]=ye("dimension",null,{ref:l}),i[i.length]=NP(c,e,r,t),e.sheetFormat&&(i[i.length]=ye("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=bP(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=MP(c,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=AP(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=FP(c["!autofilter"],c,t,r)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=vP(c["!merges"]));var d=-1,m,g=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=ft(n,-1,dt(p[1].Target).replace(/#.*$/,""),Xe.HLINK),m["r:id"]="rId"+g),(d=p[1].Target.indexOf("#"))>-1&&(m.location=dt(p[1].Target.slice(d+1))),p[1].Tooltip&&(m.tooltip=dt(p[1].Tooltip)),i[i.length]=ye("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=kP(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=pr("ignoredErrors",ye("ignoredError",null,{numberStoredAsText:1,sqref:l}))),h.length>0&&(g=ft(n,-1,"../drawings/drawing"+(r+1)+".xml",Xe.DRAW),i[i.length]=ye("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=h),c["!comments"].length>0&&(g=ft(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Xe.VML),i[i.length]=ye("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function VP(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}function BP(r,e,t){var n=ne(145),i=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;i.hpx?s=ic(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,d=-1,m=u<<10;m<u+1<<10;++m){l.c=m;var g=Array.isArray(t)?(t[l.r]||[])[l.c]:t[Le(l)];g&&(h<0&&(h=m),d=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var p=n.l;return n.l=c,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function UP(r,e,t,n){var i=BP(n,t,e);(i.length>17||(e["!rows"]||[])[n])&&ce(r,0,i)}var GP=Ms,WP=ja;function zP(){}function HP(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=Kk(r),t}function jP(r,e,t){t==null&&(t=ne(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return tu({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),fv(r,t),t.slice(0,t.l)}function $P(r){var e=mn(r);return[e]}function KP(r,e,t){return t==null&&(t=ne(8)),Ns(e,t)}function qP(r){var e=Os(r);return[e]}function XP(r,e,t){return t==null&&(t=ne(4)),Ls(e,t)}function QP(r){var e=mn(r),t=r.read_shift(1);return[e,t,"b"]}function YP(r,e,t){return t==null&&(t=ne(9)),Ns(e,t),t.write_shift(1,r.v?1:0),t}function JP(r){var e=Os(r),t=r.read_shift(1);return[e,t,"b"]}function ZP(r,e,t){return t==null&&(t=ne(5)),Ls(e,t),t.write_shift(1,r.v?1:0),t}function e3(r){var e=mn(r),t=r.read_shift(1);return[e,t,"e"]}function t3(r,e,t){return t==null&&(t=ne(9)),Ns(e,t),t.write_shift(1,r.v),t}function r3(r){var e=Os(r),t=r.read_shift(1);return[e,t,"e"]}function n3(r,e,t){return t==null&&(t=ne(8)),Ls(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function i3(r){var e=mn(r),t=r.read_shift(4);return[e,t,"s"]}function s3(r,e,t){return t==null&&(t=ne(12)),Ns(e,t),t.write_shift(4,e.v),t}function a3(r){var e=Os(r),t=r.read_shift(4);return[e,t,"s"]}function o3(r,e,t){return t==null&&(t=ne(8)),Ls(e,t),t.write_shift(4,e.v),t}function c3(r){var e=mn(r),t=Ar(r);return[e,t,"n"]}function l3(r,e,t){return t==null&&(t=ne(16)),Ns(e,t),Ss(r.v,t),t}function gy(r){var e=Os(r),t=Ar(r);return[e,t,"n"]}function u3(r,e,t){return t==null&&(t=ne(12)),Ls(e,t),Ss(r.v,t),t}function f3(r){var e=mn(r),t=J0(r);return[e,t,"n"]}function h3(r,e,t){return t==null&&(t=ne(12)),Ns(e,t),hv(r.v,t),t}function d3(r){var e=Os(r),t=J0(r);return[e,t,"n"]}function m3(r,e,t){return t==null&&(t=ne(8)),Ls(e,t),hv(r.v,t),t}function p3(r){var e=mn(r),t=X0(r);return[e,t,"is"]}function g3(r){var e=mn(r),t=Cr(r);return[e,t,"str"]}function _3(r,e,t){return t==null&&(t=ne(12+4*r.v.length)),Ns(e,t),or(r.v,t),t.length>t.l?t.slice(0,t.l):t}function x3(r){var e=Os(r),t=Cr(r);return[e,t,"str"]}function v3(r,e,t){return t==null&&(t=ne(8+4*r.v.length)),Ls(e,t),or(r.v,t),t.length>t.l?t.slice(0,t.l):t}function y3(r,e,t){var n=r.l+e,i=mn(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"b"];if(t.cellFormula){r.l+=2;var o=Vu(r,n-r.l,t);a[3]=Er(o,null,i,t.supbooks,t)}else r.l=n;return a}function w3(r,e,t){var n=r.l+e,i=mn(r);i.r=t["!row"];var s=r.read_shift(1),a=[i,s,"e"];if(t.cellFormula){r.l+=2;var o=Vu(r,n-r.l,t);a[3]=Er(o,null,i,t.supbooks,t)}else r.l=n;return a}function E3(r,e,t){var n=r.l+e,i=mn(r);i.r=t["!row"];var s=Ar(r),a=[i,s,"n"];if(t.cellFormula){r.l+=2;var o=Vu(r,n-r.l,t);a[3]=Er(o,null,i,t.supbooks,t)}else r.l=n;return a}function T3(r,e,t){var n=r.l+e,i=mn(r);i.r=t["!row"];var s=Cr(r),a=[i,s,"str"];if(t.cellFormula){r.l+=2;var o=Vu(r,n-r.l,t);a[3]=Er(o,null,i,t.supbooks,t)}else r.l=n;return a}var A3=Ms,S3=ja;function I3(r,e){return e==null&&(e=ne(4)),e.write_shift(4,r),e}function k3(r,e){var t=r.l+e,n=Ms(r),i=Q0(r),s=Cr(r),a=Cr(r),o=Cr(r);r.l=t;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function C3(r,e){var t=ne(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));ja({s:Pt(r[0]),e:Pt(r[0])},t),Y0("rId"+e,t);var n=r[1].Target.indexOf("#"),i=n==-1?"":r[1].Target.slice(n+1);return or(i||"",t),or(r[1].Tooltip||"",t),or("",t),t.slice(0,t.l)}function b3(){}function R3(r,e,t){var n=r.l+e,i=dv(r),s=r.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=eP(r,n-r.l,t);a[1]=o}else r.l=n;return a}function F3(r,e,t){var n=r.l+e,i=Ms(r),s=[i];if(t.cellFormula){var a=rP(r,n-r.l,t);s[1]=a,r.l=n}else r.l=n;return s}function D3(r,e,t){t==null&&(t=ne(18));var n=Bu(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var _y=["left","right","top","bottom","header","footer"];function P3(r){var e={};return _y.forEach(function(t){e[t]=Ar(r)}),e}function N3(r,e){return e==null&&(e=ne(6*8)),fs(r),_y.forEach(function(t){Ss(r[t],e)}),e}function O3(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function L3(r,e,t){t==null&&(t=ne(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function M3(r){var e=ne(24);return e.write_shift(4,4),e.write_shift(4,1),ja(r,e),e}function V3(r,e){return e==null&&(e=ne(16*4+2)),e.write_shift(2,r.password?id(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function B3(){}function U3(){}function G3(r,e,t,n,i,s,a){if(!r)return r;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,g,p,x,T,b,E,F,M,O=[];o.biff=12,o["!row"]=0;var y=0,A=!1,v=[],S={},I=o.supbooks||i.supbooks||[[]];if(I.sharedf=S,I.arrayf=v,I.SheetNames=i.SheetNames||i.Sheets.map(function(We){return We.name}),!o.supbooks&&(o.supbooks=I,i.Names))for(var k=0;k<i.Names.length;++k)I[0][k+1]=i.Names[k];var R=[],ae=[],oe=!1;sc[16]={n:"BrtShortReal",f:gy};var Ae;if(si(r,function(K,Fe,Ne){if(!d)switch(Ne){case 148:l=K;break;case 0:m=K,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),F=Mt(x=m.r),o["!row"]=m.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=Pa(K.hpt)),ae[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:K[2]},K[2]){case"n":g.v=K[1];break;case"s":E=ko[K[1]],g.v=E.t,g.r=E.r;break;case"b":g.v=!!K[1];break;case"e":g.v=K[1],o.cellText!==!1&&(g.w=ai[g.v]);break;case"str":g.t="s",g.v=K[1];break;case"is":g.t="s",g.v=K[1].t;break}if((p=a.CellXf[K[0].iStyleRef])&&dy(g,p.numFmtId,null,o,s,a),T=K[0].c==-1?T+1:K[0].c,o.dense?(c[x]||(c[x]=[]),c[x][T]=g):c[At(T)+F]=g,o.cellFormula){for(A=!1,y=0;y<v.length;++y){var B=v[y];m.r>=B[0].s.r&&m.r<=B[0].e.r&&T>=B[0].s.c&&T<=B[0].e.c&&(g.F=ze(B[0]),A=!0)}!A&&K.length>3&&(g.f=K[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>T&&(u.s.c=T),u.e.r<m.r&&(u.e.r=m.r),u.e.c<T&&(u.e.c=T),o.cellDates&&p&&g.t=="n"&&Ds(Oe[p.numFmtId])){var H=vi(g.v);H&&(g.t="d",g.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}Ae&&(Ae.type=="XLDAPR"&&(g.D=!0),Ae=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},T=K[0].c==-1?T+1:K[0].c,o.dense?(c[x]||(c[x]=[]),c[x][T]=g):c[At(T)+F]=g,u.s.r>m.r&&(u.s.r=m.r),u.s.c>T&&(u.s.c=T),u.e.r<m.r&&(u.e.r=m.r),u.e.c<T&&(u.e.c=T),Ae&&(Ae.type=="XLDAPR"&&(g.D=!0),Ae=void 0);break;case 176:O.push(K);break;case 49:Ae=((o.xlmeta||{}).Cell||[])[K-1];break;case 494:var W=n["!id"][K.relId];for(W?(K.Target=W.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=W):K.relId==""&&(K.Target="#"+K.loc),x=K.rfx.s.r;x<=K.rfx.e.r;++x)for(T=K.rfx.s.c;T<=K.rfx.e.c;++T)o.dense?(c[x]||(c[x]=[]),c[x][T]||(c[x][T]={t:"z",v:void 0}),c[x][T].l=K):(b=Le({c:T,r:x}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=K);break;case 426:if(!o.cellFormula)break;v.push(K),M=o.dense?c[x][T]:c[At(T)+F],M.f=Er(K[1],u,{r:m.r,c:T},I,o),M.F=ze(K[0]);break;case 427:if(!o.cellFormula)break;S[Le(K[0].s)]=K[1],M=o.dense?c[x][T]:c[At(T)+F],M.f=Er(K[1],u,{r:m.r,c:T},I,o);break;case 60:if(!o.cellStyles)break;for(;K.e>=K.s;)R[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},oe||(oe=!0,sd(K.w/256)),Ni(R[K.e+1]);break;case 161:c["!autofilter"]={ref:ze(K)};break;case 476:c["!margins"]=K;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),K.name&&(i.Sheets[t].CodeName=K.name),(K.above||K.left)&&(c["!outline"]={above:K.above,left:K.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),K.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Fe.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Ne.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(u.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=ze(l||u)),o.sheetRows&&c["!ref"]){var le=Je(c["!ref"]);o.sheetRows<=+le.e.r&&(le.e.r=o.sheetRows-1,le.e.r>u.e.r&&(le.e.r=u.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>u.e.c&&(le.e.c=u.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ze(le))}return O.length>0&&(c["!merges"]=O),R.length>0&&(c["!cols"]=R),ae.length>0&&(c["!rows"]=ae),c}function W3(r,e,t,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=vt(e),e.z=e.z||Oe[14],e.v=er(St(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r:t,c:n};switch(c.s=ji(i.cellXfs,e,i),e.l&&s["!links"].push([Le(c),e.l]),e.c&&s["!comments"].push([Le(c),e.c]),e.t){case"s":case"str":return i.bookSST?(o=ud(i.Strings,e.v,i.revStrings),c.t="s",c.v=o,a?ce(r,18,o3(e,c)):ce(r,7,s3(e,c))):(c.t="str",a?ce(r,17,v3(e,c)):ce(r,6,_3(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ce(r,13,m3(e,c)):ce(r,2,h3(e,c)):a?ce(r,16,u3(e,c)):ce(r,5,l3(e,c)),!0;case"b":return c.t="b",a?ce(r,15,ZP(e,c)):ce(r,4,YP(e,c)),!0;case"e":return c.t="e",a?ce(r,14,n3(e,c)):ce(r,3,t3(e,c)),!0}return a?ce(r,12,XP(e,c)):ce(r,1,KP(e,c)),!0}function z3(r,e,t,n){var i=Je(e["!ref"]||"A1"),s,a="",o=[];ce(r,145);var c=Array.isArray(e),l=i.e.r;e["!rows"]&&(l=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=l;++u){a=Mt(u),UP(r,e,i,u);var h=!1;if(u<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(o[d]=At(d)),s=o[d]+a;var m=c?(e[u]||[])[d]:e[s];if(!m){h=!1;continue}h=W3(r,m,u,d,n,e,h)}}ce(r,146)}function H3(r,e){!e||!e["!merges"]||(ce(r,177,I3(e["!merges"].length)),e["!merges"].forEach(function(t){ce(r,176,S3(t))}),ce(r,178))}function j3(r,e){!e||!e["!cols"]||(ce(r,390),e["!cols"].forEach(function(t,n){t&&ce(r,60,D3(n,t))}),ce(r,391))}function $3(r,e){!e||!e["!ref"]||(ce(r,648),ce(r,649,M3(Je(e["!ref"]))),ce(r,650))}function K3(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var i=ft(t,-1,n[1].Target.replace(/#.*$/,""),Xe.HLINK);ce(r,494,C3(n,i))}}),delete e["!links"]}function q3(r,e,t,n){if(e["!comments"].length>0){var i=ft(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Xe.VML);ce(r,551,Y0("rId"+i)),e["!legacy"]=i}}function X3(r,e,t,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ze(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=Or(s);o.s.r==o.e.r&&(o.e.r=Or(e["!ref"]).e.r,s=ze(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),ce(r,161,ja(Je(s))),ce(r,162)}}function Q3(r,e,t){ce(r,133),ce(r,137,L3(e,t)),ce(r,138),ce(r,134)}function Y3(r,e){e["!protect"]&&ce(r,535,V3(e["!protect"]))}function J3(r,e,t,n){var i=Ur(),s=t.SheetNames[r],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var c=Je(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ce(i,129),(t.vbaraw||a["!outline"])&&ce(i,147,jP(o,a["!outline"])),ce(i,148,WP(c)),Q3(i,a,t.Workbook),j3(i,a),z3(i,a,r,e),Y3(i,a),X3(i,a,t,r),H3(i,a),K3(i,a,n),a["!margins"]&&ce(i,476,N3(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&$3(i,a),q3(i,a,r,n),ce(i,130),i.end()}function Z3(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var i=it((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function eN(r,e,t,n,i,s){var a=s||{"!type":"chart"};if(!r)return s;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=Z3(h);u.s.r=u.s.c=0,u.e.c=o,l=At(o),d[0].forEach(function(m,g){a[l+Mt(g)]={t:"n",v:m,z:d[1]},c=g}),u.e.r<c&&(u.e.r=c),++o}),o>0&&(a["!ref"]=ze(u)),a}function tN(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=r.match(my);return o&&fd(o[0],s,i,t),(a=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function rN(r,e){r.l+=10;var t=Cr(r);return{name:t}}function nN(r,e,t,n,i){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return si(r,function(c,l,u){switch(u){case 550:s["!rel"]=c;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),c.name&&(i.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var hd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],iN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],sN=[],aN=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Cg(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Tt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function bg(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=Tt(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function xy(r){bg(r.WBProps,hd),bg(r.CalcPr,aN),Cg(r.WBView,iN),Cg(r.Sheets,sN),ma.date1904=Tt(r.WBProps.date1904)}function oN(r){return!r.Workbook||!r.Workbook.WBProps?"false":Tt(r.Workbook.WBProps.date1904)?"true":"false"}var cN="][*?/\\".split("");function vy(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return cN.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function lN(r,e,t){r.forEach(function(n,i){vy(n);for(var s=0;s<i;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function yy(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];lN(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)oP(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var uN=/<\w+:workbook/;function fN(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(r.replace(Rr,function(c,l){var u=Me(c);switch(Vn(u[0])){case"<?xml":break;case"<workbook":c.match(uN)&&(i="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],t.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":hd.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":t.WBProps[h[0]]=Tt(u[h[0]]);break;case"int":t.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:t.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(t.WBProps.CodeName=pt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],t.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=it(pt(u.name)),delete u[0],t.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=pt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Tt(u.hidden||"0")&&(s.Hidden=!0),a=l+c.length;break;case"</definedName>":s.Ref=it(pt(r.slice(a,l))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],t.CalcPr=u;break;case"<calcPr/>":delete u[0],t.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Ps.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return xy(t),t}function wy(r){var e=[jt];e[e.length]=ye("workbook",null,{xmlns:Ps[0],"xmlns:r":Zt.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(hd.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ye("workbookPr",null,n);var i=r.Workbook&&r.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:dt(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=ye("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=ye("definedName",dt(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function hN(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=hh(r),t.name=Cr(r),t}function dN(r,e){return e||(e=ne(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Y0(r.strRelID,e),or(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function mN(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?Cr(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function pN(r,e){e||(e=ne(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),fv(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function gN(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function _N(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),s=qk(r),a=tP(r,0,t),o=Q0(r);r.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function xN(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],sc[16]={n:"BrtFRTArchID$",f:gN},si(r,function(c,l,u){switch(u){case 156:a.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=Er(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,c]):a[0]=[u,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),xy(t),t.Names=s,t.supbooks=a,t}function vN(r,e){ce(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};ce(r,156,dN(i))}ce(r,144)}function yN(r,e){e||(e=ne(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return or("SheetJS",e),or(qo.version,e),or(qo.version,e),or("7262",e),e.length>e.l?e.slice(0,e.l):e}function wN(r,e){e||(e=ne(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function EN(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,i=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&s==-1&&(s=n);s>i||(ce(r,135),ce(r,158,wN(i)),ce(r,136))}}function TN(r,e){var t=Ur();return ce(t,131),ce(t,128,yN()),ce(t,153,pN(r.Workbook&&r.Workbook.WBProps||null)),EN(t,r),vN(t,r),ce(t,132),t.end()}function AN(r,e,t){return e.slice(-4)===".bin"?xN(r,t):fN(r,t)}function SN(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?G3(r,n,t,i,s,a,o):xP(r,n,t,i,s,a,o)}function IN(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?nN(r,n,t,i,s):tN(r,n,t,i,s)}function kN(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?RF():FF()}function CN(r,e,t,n,i,s,a,o){return e.slice(-4)===".bin"?CF():bF()}function bN(r,e,t,n){return e.slice(-4)===".bin"?SR(r,t,n):dR(r,t,n)}function RN(r,e,t){return ey(r,t)}function FN(r,e,t){return e.slice(-4)===".bin"?Db(r,t):bb(r,t)}function DN(r,e,t){return e.slice(-4)===".bin"?TF(r,t):mF(r,t)}function PN(r,e,t){return e.slice(-4)===".bin"?fF(r):lF(r)}function NN(r,e,t,n){return t.slice(-4)===".bin"?hF(r,e,t,n):void 0}function ON(r,e,t){return e.slice(-4)===".bin"?aF(r,e,t):cF(r,e,t)}function LN(r,e,t){return(e.slice(-4)===".bin"?TN:wy)(r)}function MN(r,e,t,n,i){return(e.slice(-4)===".bin"?J3:py)(r,t,n,i)}function VN(r,e,t){return(e.slice(-4)===".bin"?OR:Jv)(r,t)}function BN(r,e,t){return(e.slice(-4)===".bin"?Ob:Hv)(r,t)}function UN(r,e,t){return(e.slice(-4)===".bin"?AF:ny)(r)}function GN(r){return(r.slice(-4)===".bin"?oF:ty)()}var Ey=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ty=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gn(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=r.match(Ey),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(Ty),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function WN(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(Ey),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(Ty),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),t[a]=i[2].slice(1,i[2].length-1));return t}var bo;function zN(r,e){var t=bo[r]||it(r);return t==="General"?Ts(e):rn(t,e)}function HN(r,e,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Tt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=St(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[it(e)]=i}function jN(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||ai[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Qo(r.v):r.w=Ts(r.v):r.w=zN(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=bo[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&Ds(n)){var i=vi(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function $N(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=sR[n.Pattern]||n.Pattern)}r[e.ID]=e}function KN(r,e,t,n,i,s,a,o,c,l){var u="General",h=n.StyleID,d={};l=l||{};var m=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&m.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Tt(r);break;case"String":n.t="s",n.r=$p(it(r)),n.v=r.indexOf("<")>-1?it(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(St(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=it(r):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=gv[r],l.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=$p(e||r));break}if(jN(n,u,l),l.cellFormula!==!1)if(n.Formula){var p=it(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=da(p,i),delete n.Formula,n.ArrayRange=="RC"?n.F=da("RC:RC",i):n.ArrayRange&&(n.F=da(n.ArrayRange,i),c.push([Je(n.F),n.F]))}else for(g=0;g<c.length;++g)i.r>=c[g][0].s.r&&i.r<=c[g][0].e.r&&i.c>=c[g][0].s.c&&i.c<=c[g][0].e.c&&(n.F=c[g][1]);l.cellStyles&&(m.forEach(function(x){!d.patternType&&x.patternType&&(d.patternType=x.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function qN(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function Sf(r,e){var t=e||{};Wa();var n=aa(U0(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof rt<"u"?n=rt.utils.decode(65001,ql(n)):n=pt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=vt(t);return a.type="string",Da.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($e){i.indexOf("<"+$e)>=0&&(s=!0)}),s)return R6(n,t);bo={"General Number":"General","General Date":Oe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Oe[15],"Short Date":Oe[14],"Long Time":Oe[19],"Medium Time":Oe[18],"Short Time":Oe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Oe[2],Standard:Oe[4],Percent:Oe[10],Scientific:Oe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,u={},h=[],d=t.dense?[]:{},m="",g={},p={},x=gn('<Data ss:Type="String">'),T=0,b=0,E=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},O={},y="",A=0,v=[],S={},I={},k=0,R=[],ae=[],oe={},Ae=[],le,We=!1,K=[],Fe=[],Ne={},B=0,H=0,W={Sheets:[],WBProps:{date1904:!1}},z={};Zo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";o=Zo.exec(n);)switch(o[3]=(ie=o[3]).toLowerCase()){case"data":if(ie=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?KN(n.slice(T,o.index),y,x,c[c.length-1][0]=="comment"?oe:g,{c:b,r:E},M,Ae[b],p,K,t):(y="",x=gn(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ae.length>0&&(g.c=ae),(!t.sheetRows||t.sheetRows>E)&&g.v!==void 0&&(t.dense?(d[E]||(d[E]=[]),d[E][b]=g):d[At(b)+Mt(E)]=g),g.HRef&&(g.l={Target:it(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(B=b+(parseInt(g.MergeAcross,10)|0),H=E+(parseInt(g.MergeDown,10)|0),v.push({s:{c:b,r:E},e:{c:B,r:H}})),!t.sheetStubs)g.MergeAcross?b=B+1:++b;else if(g.MergeAcross||g.MergeDown){for(var de=b;de<=B;++de)for(var _e=E;_e<=H;++_e)(de>b||_e>E)&&(t.dense?(d[_e]||(d[_e]=[]),d[_e][de]={t:"z"}):d[At(de)+Mt(_e)]={t:"z"});b=B+1}else++b;else g=WN(o[0]),g.Index&&(b=+g.Index-1),b<F.s.c&&(F.s.c=b),b>F.e.c&&(F.e.c=b),o[0].slice(-2)==="/>"&&++b,ae=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<F.s.r&&(F.s.r=E),E>F.e.r&&(F.e.r=E),o[0].slice(-2)==="/>"&&(p=gn(o[0]),p.Index&&(E=+p.Index-1)),b=0,++E):(p=gn(o[0]),p.Index&&(E=+p.Index-1),Ne={},(p.AutoFitHeight=="0"||p.Height)&&(Ne.hpx=parseInt(p.Height,10),Ne.hpt=ic(Ne.hpx),Fe[E]=Ne),p.Hidden=="1"&&(Ne.hidden=!0,Fe[E]=Ne));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));h.push(m),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(d["!ref"]=ze(F),t.sheetRows&&t.sheetRows<=F.e.r&&(d["!fullref"]=d["!ref"],F.e.r=t.sheetRows-1,d["!ref"]=ze(F))),v.length&&(d["!merges"]=v),Ae.length>0&&(d["!cols"]=Ae),Fe.length>0&&(d["!rows"]=Fe),u[m]=d}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=b=0,c.push([o[3],!1]),l=gn(o[0]),m=it(l.Name),d=t.dense?[]:{},v=[],K=[],Fe=[],z={name:m,Hidden:0},W.Sheets.push(z);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Ae=[],We=!1}break;case"style":o[1]==="/"?$N(M,O,t):O=gn(o[0]);break;case"numberformat":O.nf=it(gn(o[0]).Format||"General"),bo[O.nf]&&(O.nf=bo[O.nf]);for(var pe=0;pe!=392&&Oe[pe]!=O.nf;++pe);if(pe==392){for(pe=57;pe!=392;++pe)if(Oe[pe]==null){Fn(O.nf,pe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(le=gn(o[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!We&&le.wpx>10){We=!0,Tr=Qv;for(var fe=0;fe<Ae.length;++fe)Ae[fe]&&Ni(Ae[fe])}We&&Ni(le),Ae[le.Index-1||Ae.length]=le;for(var Ve=0;Ve<+le.Span;++Ve)Ae[Ae.length]=vt(le);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var G=Me(o[0]),ot={Name:G.Name,Ref:da(G.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(ot.Sheet=W.Sheets.length-1),W.Names.push(ot);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;O.Interior=gn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?v4(S,ie,n.slice(k,o.index)):k=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));qN(oe),ae.push(oe)}else c.push([o[3],!1]),l=gn(o[0]),oe={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Z=gn(o[0]);d["!autofilter"]={ref:da(Z.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Ng(n,t);var ue=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ue=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ue=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ue=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ue=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(k,o.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else k=o.index+o[0].length;break;case"header":d["!margins"]||fs(d["!margins"]={},"xlml"),isNaN(+Me(o[0]).Margin)||(d["!margins"].header=+Me(o[0]).Margin);break;case"footer":d["!margins"]||fs(d["!margins"]={},"xlml"),isNaN(+Me(o[0]).Margin)||(d["!margins"].footer=+Me(o[0]).Margin);break;case"pagemargins":var xe=Me(o[0]);d["!margins"]||fs(d["!margins"]={},"xlml"),isNaN(+xe.Top)||(d["!margins"].top=+xe.Top),isNaN(+xe.Left)||(d["!margins"].left=+xe.Left),isNaN(+xe.Right)||(d["!margins"].right=+xe.Right),isNaN(+xe.Bottom)||(d["!margins"].bottom=+xe.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ue=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ue=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ue=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ue=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ue=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ue=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ue=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ue=!1}break;case"smarttags":break;default:ue=!1;break}if(ue||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?HN(I,ie,R,n.slice(k,o.index)):(R=o,k=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var se={};return!t.bookSheets&&!t.bookProps&&(se.Sheets=u),se.SheetNames=h,se.Workbook=W,se.SSF=vt(Oe),se.Props=S,se.Custprops=I,se}function vh(r,e){switch(pd(e=e||{}),e.type||"base64"){case"base64":return Sf(tn(r),e);case"binary":case"buffer":case"file":return Sf(r,e);case"array":return Sf(zi(r),e)}}function XN(r,e){var t=[];return r.Props&&t.push(y4(r.Props,e)),r.Custprops&&t.push(w4(r.Props,r.Custprops)),t.join("")}function QN(){return""}function YN(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(ye("NumberFormat",null,{"ss:Format":dt(Oe[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};t.push(ye("Style",s.join(""),a))}),ye("Styles",t.join(""))}function Ay(r){return ye("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+cd(r.Ref,{r:0,c:0})})}function JN(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(Ay(i)))}return ye("Names",t.join(""))}function ZN(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(Ay(o)))}return s.join("")}function e6(r,e,t,n){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push(ye("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push(ye("Footer",null,{"x:Margin":r["!margins"].footer})),i.push(ye("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(ye("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(pr("ProtectContents","True")),r["!protect"].objects&&i.push(pr("ProtectObjects","True")),r["!protect"].scenarios&&i.push(pr("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(pr("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(pr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ye("WorksheetOptions",i.join(""),{xmlns:qr.x})}function t6(r){return r.map(function(e){var t=Tk(e.t||""),n=ye("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return ye("Comment",n,{"ss:Author":e.a})}).join("")}function r6(r,e,t,n,i,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+dt(cd(r.f,a))),r.F&&r.F.slice(0,e.length)==e){var c=Pt(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=dt(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=dt(r.l.Tooltip))),t["!merges"])for(var l=t["!merges"],u=0;u!=l.length;++u)l[u].s.c!=a.c||l[u].s.r!=a.r||(l[u].e.c>l[u].s.c&&(o["ss:MergeAcross"]=l[u].e.c-l[u].s.c),l[u].e.r>l[u].s.r&&(o["ss:MergeDown"]=l[u].e.r-l[u].s.r));var h="",d="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(r.v);break;case"b":h="Boolean",d=r.v?"1":"0";break;case"e":h="Error",d=ai[r.v];break;case"d":h="DateTime",d=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||Oe[14]);break;case"s":h="String",d=Ek(r.v||"");break}var m=ji(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var g=r.v!=null?d:"",p=r.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(r.c||[]).length>0&&(p+=t6(r.c)),ye("Cell",p,o)}function n6(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Pa(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function i6(r,e,t,n){if(!r["!ref"])return"";var i=Je(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(x,T){Ni(x);var b=!!x.width,E=Bu(T,x),F={"ss:Index":T+1};b&&(F["ss:Width"]=rc(E.width)),x.hidden&&(F["ss:Hidden"]="1"),o.push(ye("Column",null,F))});for(var c=Array.isArray(r),l=i.s.r;l<=i.e.r;++l){for(var u=[n6(l,(r["!rows"]||[])[l])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>l)&&!(s[a].e.c<h)&&!(s[a].e.r<l)){(s[a].s.c!=h||s[a].s.r!=l)&&(d=!0);break}if(!d){var m={r:l,c:h},g=Le(m),p=c?(r[l]||[])[h]:r[g];u.push(r6(p,g,r,e,t,n,m))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function s6(r,e,t){var n=[],i=t.SheetNames[r],s=t.Sheets[i],a=s?ZN(s,e,r,t):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?i6(s,e,r,t):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(e6(s,e,r,t)),n.join("")}function a6(r,e){e||(e={}),r.SSF||(r.SSF=vt(Oe)),r.SSF&&(Wa(),Ac(r.SSF),e.revssf=Pu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],ji(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(XN(r,e)),t.push(QN()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(ye("Worksheet",s6(n,e,r),{"ss:Name":dt(r.SheetNames[n])}));return t[2]=YN(r,e),t[3]=JN(r),jt+ye("Workbook",t.join(""),{xmlns:qr.ss,"xmlns:o":qr.o,"xmlns:x":qr.x,"xmlns:ss":qr.ss,"xmlns:dt":qr.dt,"xmlns:html":qr.html})}function o6(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Zk(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=e4(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var c6=[60,1084,2066,2165,2175];function l6(r,e,t,n,i){var s=n,a=[],o=t.slice(t.l,t.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),t.l+=s;for(var c=Yn(t,t.l),l=yh[c],u=0;l!=null&&c6.indexOf(c)>-1;)s=Yn(t,t.l+2),u=t.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),o=t.slice(u,t.l+4+s),a.push(o),t.l+=4+s,l=yh[c=Yn(t,t.l)];var h=ar(a);dr(h,0);var d=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(d),d+=a[m].length;if(h.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Sn(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=Oe[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||ai[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Qo(r.v):r.w=Ts(r.v):r.w=rn(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&Ds(Oe[n]||String(n))){var i=vi(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function fl(r,e,t){return{v:r,ixfe:e,t}}function u6(r,e){var t={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,c=[],l="",u={},h,d="",m,g,p,x,T={},b=[],E,F,M=[],O=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},v=function(Ue){return Ue<8?cs[Ue]:Ue<64&&O[Ue-8]||cs[Ue]},S=function(Ue,yt,$t){var Ct=yt.XF.data;if(!(!Ct||!Ct.patternType||!$t||!$t.cellStyles)){yt.s={},yt.s.patternType=Ct.patternType;var sn;(sn=tc(v(Ct.icvFore)))&&(yt.s.fgColor={rgb:sn}),(sn=tc(v(Ct.icvBack)))&&(yt.s.bgColor={rgb:sn})}},I=function(Ue,yt,$t){if(!(Ne>1)&&!($t.sheetRows&&Ue.r>=$t.sheetRows)){if($t.cellStyles&&yt.XF&&yt.XF.data&&S(Ue,yt,$t),delete yt.ixfe,delete yt.XF,h=Ue,d=Le(Ue),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ue.r<a.s.r&&(a.s.r=Ue.r),Ue.c<a.s.c&&(a.s.c=Ue.c),Ue.r+1>a.e.r&&(a.e.r=Ue.r+1),Ue.c+1>a.e.c&&(a.e.c=Ue.c+1),$t.cellFormula&&yt.f){for(var Ct=0;Ct<b.length;++Ct)if(!(b[Ct][0].s.c>Ue.c||b[Ct][0].s.r>Ue.r)&&!(b[Ct][0].e.c<Ue.c||b[Ct][0].e.r<Ue.r)){yt.F=ze(b[Ct][0]),(b[Ct][0].s.c!=Ue.c||b[Ct][0].s.r!=Ue.r)&&delete yt.f,yt.f&&(yt.f=""+Er(b[Ct][1],a,Ue,K,k));break}}$t.dense?(i[Ue.r]||(i[Ue.r]=[]),i[Ue.r][Ue.c]=yt):i[d]=yt}},k={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(k.password=e.password);var R,ae=[],oe=[],Ae=[],le=[],We=!1,K=[];K.SheetNames=k.snames,K.sharedf=k.sharedf,K.arrayf=k.arrayf,K.names=[],K.XTI=[];var Fe=0,Ne=0,B=0,H=[],W=[],z;k.codepage=1200,hn(1200);for(var ie=!1;r.l<r.length-1;){var de=r.l,_e=r.read_shift(2);if(_e===0&&Fe===10)break;var pe=r.l===r.length?0:r.read_shift(2),fe=yh[_e];if(fe&&fe.f){if(e.bookSheets&&Fe===133&&_e!==133)break;if(Fe=_e,fe.r===2||fe.r==12){var Ve=r.read_shift(2);if(pe-=2,!k.enc&&Ve!==_e&&((Ve&255)<<8|Ve>>8)!==_e)throw new Error("rt mismatch: "+Ve+"!="+_e);fe.r==12&&(r.l+=10,pe-=10)}var G={};if(_e===10?G=fe.f(r,pe,k):G=l6(_e,fe,r,pe,k),Ne==0&&[9,521,1033,2057].indexOf(Fe)===-1)continue;switch(_e){case 34:t.opts.Date1904=y.WBProps.date1904=G;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(k.enc||(r.l=0),k.enc=G,!e.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:k.lastuser=G;break;case 66:var ot=Number(G);switch(ot){case 21010:ot=1200;break;case 32768:ot=1e4;break;case 32769:ot=1252;break}hn(k.codepage=ot),ie=!0;break;case 317:k.rrtabid=G;break;case 25:k.winlocked=G;break;case 439:t.opts.RefreshAll=G;break;case 12:t.opts.CalcCount=G;break;case 16:t.opts.CalcDelta=G;break;case 17:t.opts.CalcIter=G;break;case 13:t.opts.CalcMode=G;break;case 14:t.opts.CalcPrecision=G;break;case 95:t.opts.CalcSaveRecalc=G;break;case 15:k.CalcRefMode=G;break;case 2211:t.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:M.push(G);break;case 430:K.push([G]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(G);break;case 24:case 536:z={Name:G.Name,Ref:Er(G.rgce,a,null,K,k)},G.itab>0&&(z.Sheet=G.itab-1),K.names.push(z),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(W[G.itab-1]={ref:ze(G.rgce[0][0][1][2])});break;case 22:k.ExternCount=G;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(G),K.XTI=K.XTI.concat(G);break;case 2196:if(k.biff<8)break;z!=null&&(z.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&k.WTF&&console.error("Password verifier: "+G);break;case 133:s[G.pos]=G,k.snames.push(G.name);break;case 10:{if(--Ne)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=ze(a),e.sheetRows&&e.sheetRows<=a.e.r){var Z=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=ze(a),a.e.r=Z}a.e.r++,a.e.c++}ae.length>0&&(i["!merges"]=ae),oe.length>0&&(i["!objects"]=oe),Ae.length>0&&(i["!cols"]=Ae),le.length>0&&(i["!rows"]=le),y.Sheets.push(A)}l===""?u=i:n[l]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(k.biff===8&&(k.biff={9:2,521:3,1033:4}[_e]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),k.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(k.biff=5,ie=!0,hn(k.codepage=28591)),k.biff==8&&G.BIFFVer==0&&G.dt==16&&(k.biff=2),Ne++)break;if(i=e.dense?[]:{},k.biff<8&&!ie&&(ie=!0,hn(k.codepage=e.codepage||1252)),k.biff<5||G.BIFFVer==0&&G.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var ue={pos:r.l-pe,name:l};s[ue.pos]=ue,k.snames.push(l)}else l=(s[de]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),ae=[],oe=[],k.arrayf=b=[],Ae=[],le=[],We=!1,A={Hidden:(s[de]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[G.r]||[])[G.c]:i[Le({c:G.c,r:G.r})])&&++G.c,E={ixfe:G.ixfe,XF:M[G.ixfe]||{},v:G.val,t:"n"},B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I({c:G.c,r:G.r},E,e);break;case 5:case 517:E={ixfe:G.ixfe,XF:M[G.ixfe],v:G.val,t:G.t},B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I({c:G.c,r:G.r},E,e);break;case 638:E={ixfe:G.ixfe,XF:M[G.ixfe],v:G.rknum,t:"n"},B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I({c:G.c,r:G.r},E,e);break;case 189:for(var xe=G.c;xe<=G.C;++xe){var se=G.rkrec[xe-G.c][0];E={ixfe:se,XF:M[se],v:G.rkrec[xe-G.c][1],t:"n"},B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I({c:xe,r:G.r},E,e)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(E=fl(G.val,G.cell.ixfe,G.tt),E.XF=M[E.ixfe],e.cellFormula){var $e=G.formula;if($e&&$e[0]&&$e[0][0]&&$e[0][0][0]=="PtgExp"){var Qe=$e[0][0][1][0],mt=$e[0][0][1][1],Yt=Le({r:Qe,c:mt});T[Yt]?E.f=""+Er(G.formula,a,G.cell,K,k):E.F=((e.dense?(i[Qe]||[])[mt]:i[Yt])||{}).F}else E.f=""+Er(G.formula,a,G.cell,K,k)}B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I(G.cell,E,e),o=G}break;case 7:case 519:if(o)o.val=G,E=fl(G,o.cell.ixfe,"s"),E.XF=M[E.ixfe],e.cellFormula&&(E.f=""+Er(o.formula,a,o.cell,K,k)),B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I(o.cell,E,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(G);var Jt=Le(G[0].s);if(m=e.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[Jt],e.cellFormula&&m){if(!o||!Jt||!m)break;m.f=""+Er(G[1],a,G[0],K,k),m.F=ze(G[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Le(o.cell)]=G[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Le(o.cell)],(m||{}).f=""+Er(G[0],a,h,K,k)}}break;case 253:E=fl(c[G.isst].t,G.ixfe,"s"),c[G.isst].h&&(E.h=c[G.isst].h),E.XF=M[E.ixfe],B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I({c:G.c,r:G.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:G.ixfe,XF:M[G.ixfe],t:"z"},B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I({c:G.c,r:G.r},E,e));break;case 190:if(e.sheetStubs)for(var jr=G.c;jr<=G.C;++jr){var rr=G.ixfe[jr-G.c];E={ixfe:rr,XF:M[rr],t:"z"},B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I({c:jr,r:G.r},E,e)}break;case 214:case 516:case 4:E=fl(G.val,G.ixfe,"s"),E.XF=M[E.ixfe],B>0&&(E.z=H[E.ixfe>>8&63]),Sn(E,e,t.opts.Date1904),I({c:G.c,r:G.r},E,e);break;case 0:case 512:Ne===1&&(a=G);break;case 252:c=G;break;case 1054:if(k.biff==4){H[B++]=G[1];for(var ct=0;ct<B+163&&Oe[ct]!=G[1];++ct);ct>=163&&Fn(G[1],B+163)}else Fn(G[1],G[0]);break;case 30:{H[B++]=G;for(var Ze=0;Ze<B+163&&Oe[Ze]!=G;++Ze);Ze>=163&&Fn(G,B+163)}break;case 229:ae=ae.concat(G);break;case 93:oe[G.cmo[0]]=k.lastobj=G;break;case 438:k.lastobj.TxO=G;break;case 127:k.lastobj.ImData=G;break;case 440:for(x=G[0].s.r;x<=G[0].e.r;++x)for(p=G[0].s.c;p<=G[0].e.c;++p)m=e.dense?(i[x]||[])[p]:i[Le({c:p,r:x})],m&&(m.l=G[1]);break;case 2048:for(x=G[0].s.r;x<=G[0].e.r;++x)for(p=G[0].s.c;p<=G[0].e.c;++p)m=e.dense?(i[x]||[])[p]:i[Le({c:p,r:x})],m&&m.l&&(m.l.Tooltip=G[1]);break;case 28:{if(k.biff<=5&&k.biff>=2)break;m=e.dense?(i[G[0].r]||[])[G[0].c]:i[Le(G[0])];var It=oe[G[2]];m||(e.dense?(i[G[0].r]||(i[G[0].r]=[]),m=i[G[0].r][G[0].c]={t:"z"}):m=i[Le(G[0])]={t:"z"},a.e.r=Math.max(a.e.r,G[0].r),a.s.r=Math.min(a.s.r,G[0].r),a.e.c=Math.max(a.e.c,G[0].c),a.s.c=Math.min(a.s.c,G[0].c)),m.c||(m.c=[]),g={a:G[1],t:It.TxO.t},m.c.push(g)}break;case 2173:JR(M[G.ixfe],G.ext);break;case 125:{if(!k.cellStyles)break;for(;G.e>=G.s;)Ae[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},We||(We=!0,sd(G.w/256)),Ni(Ae[G.e+1])}break;case 520:{var kt={};G.level!=null&&(le[G.r]=kt,kt.level=G.level),G.hidden&&(le[G.r]=kt,kt.hidden=!0),G.hpt&&(le[G.r]=kt,kt.hpt=G.hpt,kt.hpx=Pa(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||fs(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[_e]]=G;break;case 161:i["!margins"]||fs(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(y.Views[0].RTL=!0);break;case 146:O=G;break;case 2198:R=G;break;case 140:F=G;break;case 442:l?A.CodeName=G||A.name:y.WBProps.CodeName=G||"ThisWorkbook";break}}else fe||console.error("Missing Info for XLS Record 0x"+_e.toString(16)),r.l+=pe}return t.SheetNames=Bt(s).sort(function(Fr,Ue){return Number(Fr)-Number(Ue)}).map(function(Fr){return s[Fr].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&u["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=u)):t.Preamble=u,t.Sheets&&W.forEach(function(Fr,Ue){t.Sheets[t.SheetNames[Ue]]["!autofilter"]=Fr}),t.Strings=c,t.SSF=vt(Oe),k.enc&&(t.Encryption=k.enc),R&&(t.Themes=R),t.Metadata={},F!==void 0&&(t.Metadata.Country=F),K.names.length>0&&(y.Names=K.names),t.Workbook=y,t}var Ro={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function f6(r,e,t){var n=Pe.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ug(n,dh,Ro.DSI);for(var s in i)e[s]=i[s]}catch(l){if(t.WTF)throw l}var a=Pe.find(r,"/!SummaryInformation");if(a&&a.size>0)try{var o=ug(a,mh,Ro.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(t.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(Ev(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function h6(r,e){var t=[],n=[],i=[],s=0,a,o=Up(dh,"n"),c=Up(mh,"n");if(r.Props)for(a=Bt(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=Bt(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],r.Custprops[a[s]]]);var l=[];for(s=0;s<i.length;++s)bv.indexOf(i[s][0])>-1||wv.indexOf(i[s][0])>-1||i[s][1]!=null&&l.push(i[s]);n.length&&Pe.utils.cfb_add(e,"/SummaryInformation",fg(n,Ro.SI,c,mh)),(t.length||l.length)&&Pe.utils.cfb_add(e,"/DocumentSummaryInformation",fg(t,Ro.DSI,o,dh,l.length?l:null,Ro.UDI))}function dd(r,e){e||(e={}),pd(e),Fu(),e.codepage&&Ru(e.codepage);var t,n;if(r.FullPaths){if(Pe.find(r,"/encryption"))throw new Error("File is password-protected");t=Pe.find(r,"!CompObj"),n=Pe.find(r,"/Workbook")||Pe.find(r,"/Book")}else{switch(e.type){case"base64":r=Xr(tn(r));break;case"binary":r=Xr(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}dr(r,0),n={content:r}}var i,s;if(t&&o6(t),e.bookProps&&!e.bookSheets)i={};else{var a=Ke?"buffer":"array";if(n&&n.content)i=u6(n.content,e);else if((s=Pe.find(r,"PerfectOffice_MAIN"))&&s.content)i=us.to_workbook(s.content,(e.type=a,e));else if((s=Pe.find(r,"NativeContent_MAIN"))&&s.content)i=us.to_workbook(s.content,(e.type=a,e));else throw(s=Pe.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&Pe.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=IF(r))}var o={};return r.FullPaths&&f6(r,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=r),i}function d6(r,e){var t=e||{},n=Pe.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Pe.utils.cfb_add(n,i,Sy(r,t)),t.biff==8&&(r.Props||r.Custprops)&&h6(r,n),t.biff==8&&r.vbaraw&&kF(n,Pe.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var sc={0:{f:VP},1:{f:$P},2:{f:f3},3:{f:e3},4:{f:QP},5:{f:c3},6:{f:g3},7:{f:i3},8:{f:T3},9:{f:E3},10:{f:y3},11:{f:w3},12:{f:qP},13:{f:d3},14:{f:r3},15:{f:JP},16:{f:gy},17:{f:x3},18:{f:a3},19:{f:X0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_N},40:{},42:{},43:{f:gR},44:{f:mR},45:{f:vR},46:{f:wR},47:{f:yR},48:{},49:{f:Gk},50:{},51:{f:tF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Uv},62:{f:p3},63:{f:uF},64:{f:B3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:O3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:HP},148:{f:GP,p:16},151:{f:b3},152:{},153:{f:mN},154:{},155:{},156:{f:hN},157:{},158:{},159:{T:1,f:Fb},160:{T:-1},161:{T:1,f:Ms},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:A3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ZR},336:{T:-1},337:{f:iF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Bv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:R3},427:{f:F3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:P3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:zP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:k3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:wF},633:{T:1},634:{T:-1},635:{T:1,f:vF},636:{T:-1},637:{f:jk},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:rN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:U3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},yh={6:{f:Tf},10:{f:di},12:{f:Qt},13:{f:Qt},14:{f:Ut},15:{f:Ut},16:{f:Ar},17:{f:Ut},18:{f:Ut},19:{f:Qt},20:{f:_g},21:{f:_g},23:{f:Bv},24:{f:vg},25:{f:Ut},26:{},27:{},28:{f:UC},29:{},34:{f:Ut},35:{f:xg},38:{f:Ar},39:{f:Ar},40:{f:Ar},41:{f:Ar},42:{f:Ut},43:{f:Ut},47:{f:Jb},49:{f:dC},51:{f:Qt},60:{},61:{f:cC},64:{f:Ut},65:{f:hC},66:{f:Qt},77:{},80:{},81:{},82:{},85:{f:Qt},89:{},90:{},91:{},92:{f:Y4},93:{f:zC},94:{},95:{f:Ut},96:{},97:{},99:{f:Ut},125:{f:Uv},128:{f:CC},129:{f:Z4},130:{f:Qt},131:{f:Ut},132:{f:Ut},133:{f:eC},134:{},140:{f:YC},141:{f:Qt},144:{},146:{f:eb},151:{},152:{},153:{},154:{},155:{},156:{f:Qt},157:{},158:{},160:{f:ob},161:{f:nb},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:AC},190:{f:SC},193:{f:di},197:{},198:{},199:{},200:{},201:{},202:{f:Ut},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Qt},220:{},221:{f:Ut},222:{},224:{f:kC},225:{f:Q4},226:{f:di},227:{},229:{f:GC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:rC},253:{f:pC},255:{f:iC},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Rv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ut},353:{f:di},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:PC},431:{f:Ut},432:{},433:{},434:{},437:{},438:{f:$C},439:{f:Ut},440:{f:KC},441:{},442:{f:kc},443:{},444:{f:Qt},445:{},446:{},448:{f:di},449:{f:oC,r:2},450:{f:di},512:{f:mg},513:{f:ab},515:{f:FC},516:{f:_C},517:{f:gg},519:{f:cb},520:{f:sC},523:{},545:{f:yg},549:{f:dg},566:{},574:{f:uC},638:{f:TC},659:{},1048:{},1054:{f:vC},1084:{},1212:{f:MC},2048:{f:XC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:cl},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:di},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:tb,r:12},2173:{f:YR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ut,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:LC,r:12},2197:{},2198:{f:jR,r:12},2199:{},2200:{},2201:{},2202:{f:VC,r:12},2203:{f:di},2204:{},2205:{},2206:{},2207:{},2211:{f:aC},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Qt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ib},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ZC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:mg},1:{},2:{f:db},3:{f:fb},4:{f:ub},5:{f:gg},7:{f:pb},8:{},9:{f:cl},11:{},22:{f:Qt},30:{f:wC},31:{},32:{},33:{f:yg},36:{},37:{f:dg},50:{f:gb},62:{},52:{},67:{},68:{f:Qt},69:{},86:{},126:{},127:{f:lb},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:_b},223:{},234:{},354:{},421:{},518:{f:Tf},521:{f:cl},536:{f:vg},547:{f:xg},561:{},579:{},1030:{f:Tf},1033:{f:cl},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function we(r,e,t,n){var i=e;if(!isNaN(i)){var s=n||(t||[]).length||0,a=r.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&$0(t)&&r.push(t)}}function m6(r,e,t,n){var i=(t||[]).length||0;if(i<=8224)return we(r,e,t,i);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var u=r.next(4);for(u.write_shift(2,s),u.write_shift(2,l),r.push(t.slice(c,c+l)),c+=l;c<i;){for(u=r.next(4),u.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;u.write_shift(2,l),r.push(t.slice(c,c+l)),c+=l}}}function Fc(r,e,t){return r||(r=ne(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function p6(r,e,t,n){var i=ne(9);return Fc(i,r,e),Fv(t,n||"b",i),i}function g6(r,e,t){var n=ne(8+2*t.length);return Fc(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function _6(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?er(St(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?we(r,2,mb(t,n,i)):we(r,3,hb(t,n,i));return;case"b":case"e":we(r,5,p6(t,n,e.v,e.t));return;case"s":case"str":we(r,4,g6(t,n,(e.v||"").slice(0,255)));return}we(r,1,Fc(null,t,n))}function x6(r,e,t,n){var i=Array.isArray(e),s=Je(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ze(s)}for(var l=s.s.r;l<=s.e.r;++l){o=Mt(l);for(var u=s.s.c;u<=s.e.c;++u){l===s.s.r&&(c[u]=At(u)),a=c[u]+o;var h=i?(e[l]||[])[u]:e[a];h&&_6(r,h,l,u)}}}function v6(r,e){for(var t=e||{},n=Ur(),i=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(i=s);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return we(n,t.biff==4?1033:t.biff==3?521:9,rd(r,16,t)),x6(n,r.Sheets[r.SheetNames[i]],i,t),we(n,10),n.end()}function y6(r,e,t){we(r,49,mC({sz:12,name:"Arial"},t))}function w6(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&we(r,1054,yC(i,e[i],t))})}function E6(r,e){var t=ne(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),we(r,2151,t),t=ne(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Lv(Je(e["!ref"]||"A1"),t),t.write_shift(4,4),we(r,2152,t)}function T6(r,e){for(var t=0;t<16;++t)we(r,224,pg({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){we(r,224,pg(n,0,e))})}function A6(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];we(r,440,qC(n)),n[1].Tooltip&&we(r,2048,QC(n))}delete e["!links"]}function S6(r,e){if(e){var t=0;e.forEach(function(n,i){++t<=256&&n&&we(r,125,rb(Bu(i,n),i))})}}function I6(r,e,t,n,i){var s=16+ji(i.cellXfs,e,i);if(e.v==null&&!e.bf){we(r,513,ks(t,n,s));return}if(e.bf)we(r,6,ZD(e,t,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?er(St(e.v)):e.v;we(r,515,DC(t,n,a,s));break;case"b":case"e":we(r,517,RC(t,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=ud(i.Strings,e.v,i.revStrings);we(r,253,gC(t,n,o,s))}else we(r,516,xC(t,n,(e.v||"").slice(0,255),s,i));break;default:we(r,513,ks(t,n,s))}}function k6(r,e,t){var n=Ur(),i=t.SheetNames[r],s=t.Sheets[i]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[r]||{},c=Array.isArray(s),l=e.biff==8,u,h="",d=[],m=Je(s["!ref"]||"A1"),g=l?65536:16384;if(m.e.c>255||m.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,g-1)}we(n,2057,rd(t,16,e)),we(n,13,fn(1)),we(n,12,fn(100)),we(n,15,Pr(!0)),we(n,17,Pr(!1)),we(n,16,Ss(.001)),we(n,95,Pr(!0)),we(n,42,Pr(!1)),we(n,43,Pr(!1)),we(n,130,fn(1)),we(n,128,bC()),we(n,131,Pr(!1)),we(n,132,Pr(!1)),l&&S6(n,s["!cols"]),we(n,512,EC(m,e)),l&&(s["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){h=Mt(p);for(var x=m.s.c;x<=m.e.c;++x){p===m.s.r&&(d[x]=At(x)),u=d[x]+h;var T=c?(s[p]||[])[x]:s[u];T&&(I6(n,T,p,x,e),l&&T.l&&s["!links"].push([u,T.l]))}}var b=o.CodeName||o.name||i;return l&&we(n,574,fC((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&we(n,229,WC(s["!merges"])),l&&A6(n,s),we(n,442,Dv(b)),l&&E6(n,s),we(n,10),n.end()}function C6(r,e,t){var n=Ur(),i=(r||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=t.biff==8,c=t.biff==5;if(we(n,2057,rd(r,5,t)),t.bookType=="xla"&&we(n,135),we(n,225,o?fn(1200):null),we(n,193,R4(2)),c&&we(n,191),c&&we(n,192),we(n,226),we(n,92,J4("SheetJS",t)),we(n,66,fn(o?1200:1252)),o&&we(n,353,fn(0)),o&&we(n,448),we(n,317,sb(r.SheetNames.length)),o&&r.vbaraw&&we(n,211),o&&r.vbaraw){var l=a.CodeName||"ThisWorkbook";we(n,442,Dv(l))}we(n,156,fn(17)),we(n,25,Pr(!1)),we(n,18,Pr(!1)),we(n,19,fn(0)),o&&we(n,431,Pr(!1)),o&&we(n,444,fn(0)),we(n,61,lC()),we(n,64,Pr(!1)),we(n,141,fn(0)),we(n,34,Pr(oN(r)=="true")),we(n,14,Pr(!0)),o&&we(n,439,Pr(!1)),we(n,218,fn(0)),y6(n,r,t),w6(n,r.SSF,t),T6(n,t),o&&we(n,352,Pr(!1));var u=n.end(),h=Ur();o&&we(h,140,JC()),o&&t.Strings&&m6(h,252,nC(t.Strings)),we(h,10);var d=h.end(),m=Ur(),g=0,p=0;for(p=0;p<r.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*r.SheetNames[p].length;var x=u.length+g+d.length;for(p=0;p<r.SheetNames.length;++p){var T=s[p]||{};we(m,133,tC({pos:x,hs:T.Hidden||0,dt:0,name:r.SheetNames[p]},t)),x+=e[p].length}var b=m.end();if(g!=b.length)throw new Error("BS8 "+g+" != "+b.length);var E=[];return u.length&&E.push(u),b.length&&E.push(b),d.length&&E.push(d),ar(E)}function b6(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=vt(Oe)),r&&r.SSF&&(Wa(),Ac(r.SSF),t.revssf=Pu(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,gd(t),t.cellXfs=[],ji(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)n[n.length]=k6(i,t,r);return n.unshift(C6(r,n,t)),ar(n)}function Sy(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var i=Or(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return b6(r,e);case 4:case 3:case 2:return v6(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Rg(r,e){var t=e||{},n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var i=r.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),a=i.index,o=s&&s.index||r.length,c=mk(r.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<c.length;++a){var p=c[a].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var T=p.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var b=T[o].trim();if(b.match(/<t[dh]/i)){for(var E=b,F=0;E.charAt(0)=="<"&&(F=E.indexOf(">"))>-1;)E=E.slice(F+1);for(var M=0;M<g.length;++M){var O=g[M];O.s.c==u&&O.s.r<l&&l<=O.e.r&&(u=O.e.c+1,M=-1)}var y=Me(b.slice(0,b.indexOf(">")));d=y.colspan?+y.colspan:1,((h=+y.rowspan)>1||d>1)&&g.push({s:{r:l,c:u},e:{r:l+(h||1)-1,c:u+d-1}});var A=y.t||y["data-t"]||"";if(!E.length){u+=d;continue}if(E=Zx(E),m.s.r>l&&(m.s.r=l),m.e.r<l&&(m.e.r=l),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!E.length){u+=d;continue}var v={t:"s",v:E};t.raw||!E.trim().length||A=="s"||(E==="TRUE"?v={t:"b",v:!0}:E==="FALSE"?v={t:"b",v:!1}:isNaN(wn(E))?isNaN(Fa(E).getDate())||(v={t:"d",v:St(E)},t.cellDates||(v={t:"n",v:er(v.v)}),v.z=t.dateNF||Oe[14]):v={t:"n",v:wn(E)}),t.dense?(n[l]||(n[l]=[]),n[l][u]=v):n[Le({r:l,c:u})]=v,u+=d}}}}return n["!ref"]=ze(m),g.length&&(n["!merges"]=g),n}function Iy(r,e,t,n){for(var i=r["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>t||i[l].s.c>a)&&!(i[l].e.r<t||i[l].e.c<a)){if(i[l].s.r<t||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var u=Le({r:t,c:a}),h=n.dense?(r[t]||[])[a]:r[u],d=h&&h.v!=null&&(h.h||B0(h.w||(On(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+u,s.push(ye("td",d,m))}}var g="<tr>";return g+s.join("")+"</tr>"}var ky='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Cy="</body></html>";function R6(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Hi(Rg(t[0],e),e);var n=wd();return t.forEach(function(i,s){Ed(n,Rg(i,e),"Sheet"+(s+1))}),n}function by(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Ry(r,e){var t=e||{},n=t.header!=null?t.header:ky,i=t.footer!=null?t.footer:Cy,s=[n],a=Or(r["!ref"]);t.dense=Array.isArray(r),s.push(by(r,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(Iy(r,a,o,t));return s.push("</table>"+i),s.join("")}function Fy(r,e,t){var n=t||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Pt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(r["!ref"]){var u=Or(r["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),i==-1&&(l.e.r=i=u.e.r+1)}var h=[],d=0,m=r["!rows"]||(r["!rows"]=[]),g=0,p=0,x=0,T=0,b=0,E=0;for(r["!cols"]||(r["!cols"]=[]);g<o.length&&p<c;++g){var F=o[g];if(Fg(F)){if(n.display)continue;m[p]={hidden:!0}}var M=F.children;for(x=T=0;x<M.length;++x){var O=M[x];if(!(n.display&&Fg(O))){var y=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):Zx(O.innerHTML),A=O.getAttribute("data-z")||O.getAttribute("z");for(d=0;d<h.length;++d){var v=h[d];v.s.c==T+s&&v.s.r<p+i&&p+i<=v.e.r&&(T=v.e.c+1-s,d=-1)}E=+O.getAttribute("colspan")||1,((b=+O.getAttribute("rowspan")||1)>1||E>1)&&h.push({s:{r:p+i,c:T+s},e:{r:p+i+(b||1)-1,c:T+s+(E||1)-1}});var S={t:"s",v:y},I=O.getAttribute("data-t")||O.getAttribute("t")||"";y!=null&&(y.length==0?S.t=I||"z":n.raw||y.trim().length==0||I=="s"||(y==="TRUE"?S={t:"b",v:!0}:y==="FALSE"?S={t:"b",v:!1}:isNaN(wn(y))?isNaN(Fa(y).getDate())||(S={t:"d",v:St(y)},n.cellDates||(S={t:"n",v:er(S.v)}),S.z=n.dateNF||Oe[14]):S={t:"n",v:wn(y)})),S.z===void 0&&A!=null&&(S.z=A);var k="",R=O.getElementsByTagName("A");if(R&&R.length)for(var ae=0;ae<R.length&&!(R[ae].hasAttribute("href")&&(k=R[ae].getAttribute("href"),k.charAt(0)!="#"));++ae);k&&k.charAt(0)!="#"&&(S.l={Target:k}),n.dense?(r[p+i]||(r[p+i]=[]),r[p+i][T+s]=S):r[Le({c:T+s,r:p+i})]=S,l.e.c<T+s&&(l.e.c=T+s),T+=E}}++p}return h.length&&(r["!merges"]=(r["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,p-1+i),r["!ref"]=ze(l),p>=c&&(r["!fullref"]=ze((l.e.r=o.length-g+p-1+i,l))),r}function Dy(r,e){var t=e||{},n=t.dense?[]:{};return Fy(n,r,e)}function F6(r,e){return Hi(Dy(r,e),e)}function Fg(r){var e="",t=D6(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function D6(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function P6(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=it(e.replace(/<[^>]*>/g,""));return[t]}var Dg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Py(r,e){var t=e||{},n=U0(r),i=[],s,a,o={name:""},c="",l=0,u,h,d={},m=[],g=t.dense?[]:{},p,x,T={value:""},b="",E=0,F=[],M=-1,O=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,v={},S=[],I={},k=0,R=0,ae=[],oe=1,Ae=1,le=[],We={Names:[]},K={},Fe=["",""],Ne=[],B={},H="",W=0,z=!1,ie=!1,de=0;for(Zo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Zo.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?g["!ref"]=ze(y):g["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=y.e.r&&(g["!fullref"]=g["!ref"],y.e.r=t.sheetRows-1,g["!ref"]=ze(y)),S.length&&(g["!merges"]=S),ae.length&&(g["!rows"]=ae),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),d[u.name]=g,ie=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Me(p[0],!1),M=O=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,g=t.dense?[]:{},S=[],ae=[],ie=!0);break;case"table-row-group":p[1]==="/"?--A:++A;break;case"table-row":case"":if(p[1]==="/"){M+=oe,oe=1;break}if(h=Me(p[0],!1),h.?M=h.-1:M==-1&&(M=0),oe=+h["number-rows-repeated"]||1,oe<10)for(de=0;de<oe;++de)A>0&&(ae[M+de]={level:A});O=-1;break;case"covered-table-cell":p[1]!=="/"&&++O,t.sheetStubs&&(t.dense?(g[M]||(g[M]=[]),g[M][O]={t:"z"}):g[Le({r:M,c:O})]={t:"z"}),b="",F=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++O,T=Me(p[0],!1),Ae=parseInt(T["number-columns-repeated"]||"1",10),x={t:"z",v:null},T.formula&&t.cellFormula!=!1&&(x.f=kg(it(T.formula))),(T.||T["value-type"])=="string"&&(x.t="s",x.v=it(T["string-value"]||""),t.dense?(g[M]||(g[M]=[]),g[M][O]=x):g[Le({r:M,c:O})]=x),O+=Ae-1;else if(p[1]!=="/"){++O,b="",E=0,F=[],Ae=1;var _e=oe?M+oe-1:M;if(O>y.e.c&&(y.e.c=O),O<y.s.c&&(y.s.c=O),M<y.s.r&&(y.s.r=M),_e>y.e.r&&(y.e.r=_e),T=Me(p[0],!1),Ne=[],B={},x={t:T.||T["value-type"],v:null},t.cellFormula)if(T.formula&&(T.formula=it(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(k=parseInt(T["number-matrix-rows-spanned"],10)||0,R=parseInt(T["number-matrix-columns-spanned"],10)||0,I={s:{r:M,c:O},e:{r:M+k-1,c:O+R-1}},x.F=ze(I),le.push([I,x.F])),T.formula)x.f=kg(T.formula);else for(de=0;de<le.length;++de)M>=le[de][0].s.r&&M<=le[de][0].e.r&&O>=le[de][0].s.c&&O<=le[de][0].e.c&&(x.F=le[de][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(k=parseInt(T["number-rows-spanned"],10)||0,R=parseInt(T["number-columns-spanned"],10)||0,I={s:{r:M,c:O},e:{r:M+k-1,c:O+R-1}},S.push(I)),T["number-columns-repeated"]&&(Ae=parseInt(T["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Tt(T["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(T.value);break;case"percentage":x.t="n",x.v=parseFloat(T.value);break;case"currency":x.t="n",x.v=parseFloat(T.value);break;case"date":x.t="d",x.v=St(T["date-value"]),t.cellDates||(x.t="n",x.v=er(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=fk(T["time-value"])/86400,t.cellDates&&(x.t="d",x.v=Nu(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(T.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",T["string-value"]!=null&&(b=it(T["string-value"]),F=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(z=!1,x.t==="s"&&(x.v=b||"",F.length&&(x.R=F),z=E==0),K.Target&&(x.l=K),Ne.length>0&&(x.c=Ne,Ne=[]),b&&t.cellText!==!1&&(x.w=b),z&&(x.t="z",delete x.v),(!z||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=M))for(var pe=0;pe<oe;++pe){if(Ae=parseInt(T["number-columns-repeated"]||"1",10),t.dense)for(g[M+pe]||(g[M+pe]=[]),g[M+pe][O]=pe==0?x:vt(x);--Ae>0;)g[M+pe][O+Ae]=vt(x);else for(g[Le({r:M+pe,c:O})]=x;--Ae>0;)g[Le({r:M+pe,c:O+Ae})]=vt(x);y.e.c<=O&&(y.e.c=O)}Ae=parseInt(T["number-columns-repeated"]||"1",10),O+=Ae-1,Ae=0,x={},b="",F=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s;B.t=b,F.length&&(B.R=F),B.a=H,Ne.push(B)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);H="",W=0,b="",E=0,F=[];break;case"creator":p[1]==="/"?H=n.slice(W,p.index):W=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);b="",E=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(v[o.name]=c,(s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=Me(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Me(p[0],!1),c+=Dg[p[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Me(p[0],!1),c+=Dg[p[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":a=Me(p[0],!1),Fe=Af(a["cell-range-address"]);var fe={Name:a.name,Ref:Fe[0]+"!"+Fe[1]};ie&&(fe.Sheet=m.length),We.Names.push(fe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!T||!T["string-value"])){var Ve=P6(n.slice(E,p.index));b=(b.length>0?b+`
`:"")+Ve[0]}else Me(p[0],!1),E=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{Fe=Af(Me(p[0])["target-range-address"]),d[Fe[0]]["!autofilter"]={ref:Fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(K=Me(p[0],!1),!K.href)break;K.Target=it(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(Fe=Af(K.Target.slice(1)),K.Target="#"+Fe[0]+"!"+Fe[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(p)}}var G={Sheets:d,SheetNames:m,Workbook:We};return t.bookSheets&&delete G.Sheets,G}function Pg(r,e){e=e||{},un(r,"META-INF/manifest.xml")&&f4(Xt(r,"META-INF/manifest.xml"),e);var t=Qr(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=Py(pt(t),e);return un(r,"meta.xml")&&(n.Props=vv(Xt(r,"meta.xml"))),n}function Ng(r,e){return Py(r,e)}var N6=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Jo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return jt+e}}(),Og=function(){var r=function(s){return dt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+dt(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,u=0,h=Or(s["!ref"]||"A1"),d=s["!merges"]||[],m=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)c.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(l=0;l<h.s.r;++l)p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=h.e.r;++l){for(p=x[l]?' table:style-name="ro'+x[l].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<h.s.c;++u)c.push(e);for(;u<=h.e.c;++u){var T=!1,b={},E="";for(m=0;m!=d.length;++m)if(!(d[m].s.c>u)&&!(d[m].s.r>l)&&!(d[m].e.c<u)&&!(d[m].e.r<l)){(d[m].s.c!=u||d[m].s.r!=l)&&(T=!0),b["table:number-columns-spanned"]=d[m].e.c-d[m].s.c+1,b["table:number-rows-spanned"]=d[m].e.r-d[m].s.r+1;break}if(T){c.push(t);continue}var F=Le({r:l,c:u}),M=g?(s[l]||[])[u]:s[F];if(M&&M.f&&(b["table:formula"]=dt(sP(M.f)),M.F&&M.F.slice(0,F.length)==F)){var O=Or(M.F);b["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,b["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!M){c.push(e);continue}switch(M.t){case"b":E=M.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=M.v?"true":"false";break;case"n":E=M.w||String(M.v||0),b["office:value-type"]="float",b["office:value"]=M.v||0;break;case"s":case"str":E=M.v==null?"":M.v,b["office:value-type"]="string";break;case"d":E=M.w||St(M.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=St(M.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(e);continue}var y=r(E);if(M.l&&M.l.Target){var A=M.l.Target;A=A.charAt(0)=="#"?"#"+aP(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),y=ye("text:a",y,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+ye("table:table-cell",ye("text:p",y,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var u=0;u<l["!cols"].length;++u)if(l["!cols"][u]){var h=l["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ni(h),h.ods=o;var d=l["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var u=0;u<l["!rows"].length;++u)if(l["!rows"][u]){l["!rows"][u].ods=c;var h=l["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[jt],l=Jo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Jo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+u+`>
`),c.push(xv().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)c.push(n(a.Sheets[a.SheetNames[h]],a,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Ny(r,e){if(e.bookType=="fods")return Og(r,e);var t=L0(),n="",i=[],s=[];return n="mimetype",He(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",He(t,n,Og(r,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",He(t,n,N6(r,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",He(t,n,jt+xv()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",He(t,n,m4(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",He(t,n,h4(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Cs(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function wh(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):pt(zi(r))}function O6(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Xr(Rn(r))}function L6(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function Li(r){var e=r.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function Lg(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function M6(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,i=e+13;i>=e;--i)n=n*256+r[i];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function V6(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)r[e+s]=i&255;r[e+15]|=t>=0?0:128}function ac(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function ut(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Vt(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function at(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=ac(r,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=t[0];r[t[0]++]>=128;);o=r.slice(c,t[0])}break;case 5:a=4,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=ac(r,t),o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:s};e[i]==null?e[i]=[l]:e[i].push(l)}return e}function fr(r){var e=[];return r.forEach(function(t,n){t.forEach(function(i){i.data&&(e.push(ut(n*8+i.type)),i.type==2&&e.push(ut(i.data.length)),e.push(i.data))})}),Li(e)}function md(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function cn(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=ac(r,n),s=at(r.slice(n[0],n[0]+i));n[0]+=i;var a={id:Vt(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=at(o.data),l=Vt(c[3][0].data);a.messages.push({meta:c,data:r.slice(n[0],n[0]+l)}),n[0]+=l}),(e=s[3])!=null&&e[0]&&(a.merge=Vt(s[3][0].data)>>>0>0),t.push(a)}return t}function Ys(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:ut(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:ut(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:ut(a.data.length)}],n[2].push({data:fr(a.meta),type:2})});var s=fr(n);e.push(ut(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Li(e)}function B6(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=ac(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(e[t[0]]>>2&7)+4,c=(e[t[0]++]&224)<<3,c|=e[t[0]++]):(l=(e[t[0]++]>>2)+1,s==2?(c=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(c=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Li(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var u=Li(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function ln(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(B6(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return Li(e)}function Js(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var s=ut(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,t+=n}return Li(e)}function U6(r,e,t,n){var i=Cs(r),s=i.getUint32(4,!0),a=(n>1?12:8)+Lg(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Lg(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(l=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(r[2]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[c]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:t[o]};else if(c>-1)h={t:"s",v:e[c]};else if(!isNaN(l))h={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return h}function G6(r,e,t){var n=Cs(r),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,l=NaN,u=new Date(2001,0,1);i&1&&(c=M6(r,s),s+=16),i&2&&(l=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(r[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)))}return h}function If(r,e){var t=new Uint8Array(32),n=Cs(t),i=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,V6(t,i,r.v),s|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,r.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,i)}function kf(r,e){var t=new Uint8Array(32),n=Cs(t),i=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(i,r.v,!0),s|=32,i+=8;break;case"b":t[2]=6,n.setFloat64(i,r.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(i,e.indexOf(r.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,i)}function W6(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return U6(r,e,t,r[0]);case 5:return G6(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function wr(r){var e=at(r);return ac(e[1][0].data)}function Mg(r,e){var t=at(e.data),n=Vt(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(a){var o=at(a.data),c=Vt(o[1][0].data)>>>0;switch(n){case 1:s[c]=wh(o[3][0].data);break;case 8:{var l=r[wr(o[9][0].data)][0],u=at(l.data),h=r[wr(u[1][0].data)][0],d=Vt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=at(h.data);s[c]=m[3].map(function(g){return wh(g.data)}).join("")}break}}),s}function z6(r,e){var t,n,i,s,a,o,c,l,u,h,d,m,g,p,x=at(r),T=Vt(x[1][0].data)>>>0,b=Vt(x[2][0].data)>>>0,E=((n=(t=x[8])==null?void 0:t[0])==null?void 0:n.data)&&Vt(x[8][0].data)>0||!1,F,M;if((s=(i=x[7])==null?void 0:i[0])!=null&&s.data&&e!=0)F=(o=(a=x[7])==null?void 0:a[0])==null?void 0:o.data,M=(l=(c=x[6])==null?void 0:c[0])==null?void 0:l.data;else if((h=(u=x[4])==null?void 0:u[0])!=null&&h.data&&e!=1)F=(m=(d=x[4])==null?void 0:d[0])==null?void 0:m.data,M=(p=(g=x[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var O=E?4:1,y=Cs(F),A=[],v=0;v<F.length/2;++v){var S=y.getUint16(v*2,!0);S<65535&&A.push([v,S])}if(A.length!=b)throw"Expected ".concat(b," cells, found ").concat(A.length);var I=[];for(v=0;v<A.length-1;++v)I[A[v][0]]=M.subarray(A[v][1]*O,A[v+1][1]*O);return A.length>=1&&(I[A[A.length-1][0]]=M.subarray(A[A.length-1][1]*O)),{R:T,cells:I}}function H6(r,e){var t,n=at(e.data),i=(t=n==null?void 0:n[7])!=null&&t[0]?Vt(n[7][0].data)>>>0>0?1:0:-1,s=md(n[5],function(a){return z6(a,i)});return{nrows:Vt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function j6(r,e,t){var n,i=at(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Vt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Vt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=ze(s);var a=at(i[4][0].data),o=Mg(r,r[wr(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?Mg(r,r[wr(a[17][0].data)][0]):[],l=at(a[3][0].data),u=0;l[1].forEach(function(h){var d=at(h.data),m=r[wr(d[2][0].data)][0],g=Vt(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=H6(r,m);p.data.forEach(function(x,T){x.forEach(function(b,E){var F=Le({r:u+T,c:E}),M=W6(b,o,c);M&&(t[F]=M)})}),u+=p.nrows})}function $6(r,e){var t=at(e.data),n={"!ref":"A1"},i=r[wr(t[2][0].data)],s=Vt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return j6(r,i[0],n),n}function K6(r,e){var t,n=at(e.data),i={name:(t=n[1])!=null&&t[0]?wh(n[1][0].data):"",sheets:[]},s=md(n[2],wr);return s.forEach(function(a){r[a].forEach(function(o){var c=Vt(o.meta[1][0].data);c==6e3&&i.sheets.push($6(r,o))})}),i}function q6(r,e){var t=wd(),n=at(e.data),i=md(n[1],wr);if(i.forEach(function(s){r[s].forEach(function(a){var o=Vt(a.meta[1][0].data);if(o==2){var c=K6(r,a);c.sheets.forEach(function(l,u){Ed(t,l,u==0?c.name:c.name+"_"+u,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Cf(r){var e,t,n,i,s={},a=[];if(r.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=ln(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var u;try{u=cn(l)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Vt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(l){var u=Vt(l.meta[1][0].data)>>>0;if(u==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return q6(s,o)}function X6(r,e,t){var n,i,s,a;if(!((n=r[6])!=null&&n[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&Vt(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Cs(r[7][0].data),u=0,h=[],d=Cs(r[4][0].data),m=0,g=[],p=0;p<e.length;++p){if(e[p]==null){l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}l.setUint16(p*2,u,!0),d.setUint16(p*2,m,!0);var x,T;switch(typeof e[p]){case"string":x=If({t:"s",v:e[p]},t),T=kf({t:"s",v:e[p]},t);break;case"number":x=If({t:"n",v:e[p]},t),T=kf({t:"n",v:e[p]},t);break;case"boolean":x=If({t:"b",v:e[p]},t),T=kf({t:"b",v:e[p]},t);break;default:throw new Error("Unsupported value "+e[p])}h.push(x),u+=x.length,g.push(T),m+=T.length,++c}for(r[2][0].data=ut(c);p<r[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return r[6][0].data=Li(h),r[3][0].data=Li(g),c}function Q6(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Or(t["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ze(n)));var s=au(t,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(W){typeof W=="string"&&a.push(W)})});var o={},c=[],l=Pe.read(e.numbers,{type:"base64"});l.FileIndex.map(function(H,W){return[H,l.FullPaths[W]]}).forEach(function(H){var W=H[0],z=H[1];if(W.type==2&&W.name.match(/\.iwa/)){var ie=W.content,de=ln(ie),_e=cn(de);_e.forEach(function(pe){c.push(pe.id),o[pe.id]={deps:[],location:z,type:Vt(pe.messages[0].meta[1][0].data)}})}}),c.sort(function(H,W){return H-W});var u=c.filter(function(H){return H>1}).map(function(H){return[H,ut(H)]});l.FileIndex.map(function(H,W){return[H,l.FullPaths[W]]}).forEach(function(H){var W=H[0];if(H[1],!!W.name.match(/\.iwa/)){var z=cn(ln(W.content));z.forEach(function(ie){ie.messages.forEach(function(de){u.forEach(function(_e){ie.messages.some(function(pe){return Vt(pe.meta[1][0].data)!=11006&&L6(pe.data,_e[1])})&&o[_e[0]].deps.push(ie.id)})})})}});for(var h=Pe.find(l,o[1].location),d=cn(ln(h.content)),m,g=0;g<d.length;++g){var p=d[g];p.id==1&&(m=p)}var x=wr(at(m.messages[0].data)[1][0].data);for(h=Pe.find(l,o[x].location),d=cn(ln(h.content)),g=0;g<d.length;++g)p=d[g],p.id==x&&(m=p);for(x=wr(at(m.messages[0].data)[2][0].data),h=Pe.find(l,o[x].location),d=cn(ln(h.content)),g=0;g<d.length;++g)p=d[g],p.id==x&&(m=p);for(x=wr(at(m.messages[0].data)[2][0].data),h=Pe.find(l,o[x].location),d=cn(ln(h.content)),g=0;g<d.length;++g)p=d[g],p.id==x&&(m=p);var T=at(m.messages[0].data);{T[6][0].data=ut(n.e.r+1),T[7][0].data=ut(n.e.c+1);var b=wr(T[46][0].data),E=Pe.find(l,o[b].location),F=cn(ln(E.content));{for(var M=0;M<F.length&&F[M].id!=b;++M);if(F[M].id!=b)throw"Bad ColumnRowUIDMapArchive";var O=at(F[M].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var y=0;y<=n.e.c;++y){var A=[];A[1]=A[2]=[{type:0,data:ut(y+420690)}],O[1].push({type:2,data:fr(A)}),O[2].push({type:0,data:ut(y)}),O[3].push({type:0,data:ut(y)})}O[4]=[],O[5]=[],O[6]=[];for(var v=0;v<=n.e.r;++v)A=[],A[1]=A[2]=[{type:0,data:ut(v+726270)}],O[4].push({type:2,data:fr(A)}),O[5].push({type:0,data:ut(v)}),O[6].push({type:0,data:ut(v)});F[M].messages[0].data=fr(O)}E.content=Js(Ys(F)),E.size=E.content.length,delete T[46];var S=at(T[4][0].data);{S[7][0].data=ut(n.e.r+1);var I=at(S[1][0].data),k=wr(I[2][0].data);E=Pe.find(l,o[k].location),F=cn(ln(E.content));{if(F[0].id!=k)throw"Bad HeaderStorageBucket";var R=at(F[0].messages[0].data);for(v=0;v<s.length;++v){var ae=at(R[2][0].data);ae[1][0].data=ut(v),ae[4][0].data=ut(s[v].length),R[2][v]={type:R[2][0].type,data:fr(ae)}}F[0].messages[0].data=fr(R)}E.content=Js(Ys(F)),E.size=E.content.length;var oe=wr(S[2][0].data);E=Pe.find(l,o[oe].location),F=cn(ln(E.content));{if(F[0].id!=oe)throw"Bad HeaderStorageBucket";for(R=at(F[0].messages[0].data),y=0;y<=n.e.c;++y)ae=at(R[2][0].data),ae[1][0].data=ut(y),ae[4][0].data=ut(n.e.r+1),R[2][y]={type:R[2][0].type,data:fr(ae)};F[0].messages[0].data=fr(R)}E.content=Js(Ys(F)),E.size=E.content.length;var Ae=wr(S[4][0].data);(function(){for(var H=Pe.find(l,o[Ae].location),W=cn(ln(H.content)),z,ie=0;ie<W.length;++ie){var de=W[ie];de.id==Ae&&(z=de)}var _e=at(z.messages[0].data);{_e[3]=[];var pe=[];a.forEach(function(G,ot){pe[1]=[{type:0,data:ut(ot)}],pe[2]=[{type:0,data:ut(1)}],pe[3]=[{type:2,data:O6(G)}],_e[3].push({type:2,data:fr(pe)})})}z.messages[0].data=fr(_e);var fe=Ys(W),Ve=Js(fe);H.content=Ve,H.size=H.content.length})();var le=at(S[3][0].data);{var We=le[1][0];delete le[2];var K=at(We.data);{var Fe=wr(K[2][0].data);(function(){for(var H=Pe.find(l,o[Fe].location),W=cn(ln(H.content)),z,ie=0;ie<W.length;++ie){var de=W[ie];de.id==Fe&&(z=de)}var _e=at(z.messages[0].data);{delete _e[6],delete le[7];var pe=new Uint8Array(_e[5][0].data);_e[5]=[];for(var fe=0,Ve=0;Ve<=n.e.r;++Ve){var G=at(pe);fe+=X6(G,s[Ve],a),G[1][0].data=ut(Ve),_e[5].push({data:fr(G),type:2})}_e[1]=[{type:0,data:ut(n.e.c+1)}],_e[2]=[{type:0,data:ut(n.e.r+1)}],_e[3]=[{type:0,data:ut(fe)}],_e[4]=[{type:0,data:ut(n.e.r+1)}]}z.messages[0].data=fr(_e);var ot=Ys(W),Z=Js(ot);H.content=Z,H.size=H.content.length})()}We.data=fr(K)}S[3][0].data=fr(le)}T[4][0].data=fr(S)}m.messages[0].data=fr(T);var Ne=Ys(d),B=Js(Ne);return h.content=B,h.size=h.content.length,l}function Oy(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function pd(r){Oy([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function gd(r){Oy([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function Y6(r){return Xe.WS.indexOf(r)>-1?"sheet":r==Xe.CS?"chart":r==Xe.DS?"dialog":r==Xe.MS?"macro":r&&r.length?r:"sheet"}function J6(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,Y6(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function Z6(r,e,t,n,i,s,a,o,c,l,u,h){try{s[n]=Io(Qr(r,t,!0),e);var d=Xt(r,e),m;switch(o){case"sheet":m=SN(d,e,i,c,s[n],l,u,h);break;case"chart":if(m=IN(d,e,i,c,s[n],l,u,h),!m||!m["!drawel"])break;var g=go(m["!drawel"].Target,e),p=ec(g),x=dF(Qr(r,g,!0),Io(Qr(r,p,!0),g)),T=go(x,g),b=ec(T);m=eN(Qr(r,T,!0),T,c,Io(Qr(r,b,!0),T),l,m);break;case"macro":m=kN(d,e,i,c,s[n],l,u,h);break;case"dialog":m=CN(d,e,i,c,s[n],l,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var E=[];s&&s[n]&&Bt(s[n]).forEach(function(F){var M="";if(s[n][F].Type==Xe.CMNT){M=go(s[n][F].Target,e);var O=DN(Xt(r,M,!0),M,c);if(!O||!O.length)return;Eg(m,O,!1)}s[n][F].Type==Xe.TCMNT&&(M=go(s[n][F].Target,e),E=E.concat(pF(Xt(r,M,!0),c)))}),E&&E.length&&Eg(m,E,!0,c.people||[])}catch(F){if(c.WTF)throw F}}function an(r){return r.charAt(0)=="/"?r.slice(1):r}function Ly(r,e){if(Wa(),e=e||{},pd(e),un(r,"META-INF/manifest.xml")||un(r,"objectdata.xml"))return Pg(r,e);if(un(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Cf<"u"){if(r.FileIndex)return Cf(r);var t=Pe.utils.cfb_new();return zp(r).forEach(function(ae){He(t,ae,gk(r,ae))}),Cf(t)}throw new Error("Unsupported NUMBERS file")}if(!un(r,"[Content_Types].xml"))throw un(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):un(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zp(r),i=l4(Qr(r,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Xt(r,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Xt(r,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(ko=[],i.sst)try{ko=FN(Xt(r,an(i.sst)),i.sst,e)}catch(ae){if(e.WTF)throw ae}e.cellStyles&&i.themes.length&&(c=RN(Qr(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(l=bN(Xt(r,an(i.style)),i.style,c,e))}i.links.map(function(ae){try{var oe=Io(Qr(r,ec(an(ae))),ae);return NN(Xt(r,an(ae)),oe,ae,e)}catch{}});var u=AN(Xt(r,an(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=Xt(r,an(i.coreprops[0]),!0),d&&(h=vv(d)),i.extprops.length!==0&&(d=Xt(r,an(i.extprops[0]),!0),d&&g4(d,h,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=Qr(r,an(i.custprops[0]),!0),d&&(m=x4(d,e)));var g={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(oe){return oe.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=m),e.bookSheets&&typeof a<"u"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var p={};e.bookDeps&&i.calcchain&&(p=PN(Xt(r,an(i.calcchain)),i.calcchain));var x=0,T={},b,E;{var F=u.Sheets;h.Worksheets=F.length,h.SheetNames=[];for(var M=0;M!=F.length;++M)h.SheetNames[M]=F[M].name}var O=s?"bin":"xml",y=i.workbooks[0].lastIndexOf("/"),A=(i.workbooks[0].slice(0,y+1)+"_rels/"+i.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");un(r,A)||(A="xl/_rels/workbook."+O+".rels");var v=Io(Qr(r,A,!0),A.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=ON(Xt(r,an(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=_F(Xt(r,an(i.people[0])),e)),v&&(v=J6(v,u.Sheets));var S=Xt(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=h.Worksheets;++x){var I="sheet";if(v&&v[x]?(b="xl/"+v[x][1].replace(/[\/]?xl\//,""),un(r,b)||(b=v[x][1]),un(r,b)||(b=A.replace(/_rels\/.*$/,"")+v[x][1]),I=v[x][2]):(b="xl/worksheets/sheet"+(x+1-S)+"."+O,b=b.replace(/sheet0\./,"sheet.")),E=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(h.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var k=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==x&&(k=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[x].toLowerCase()&&(k=1);if(!k)continue e}}Z6(r,b,E,h.SheetNames[x],x,T,a,I,e,u,c,l)}return g={Directory:i,Workbook:u,Props:h,Custprops:m,Deps:p,Sheets:a,SheetNames:h.SheetNames,Strings:ko,Styles:l,Themes:c,SSF:vt(Oe)},e&&e.bookFiles&&(r.files?(g.keys=n,g.files=r.files):(g.keys=[],g.files={},r.FullPaths.forEach(function(ae,oe){ae=ae.replace(/^Root Entry[\/]/,""),g.keys.push(ae),g.files[ae]=r.FileIndex[oe]}))),e&&e.bookVBA&&(i.vba.length>0?g.vbaraw=Xt(r,an(i.vba[0]),!0):i.defaults&&i.defaults.bin===SF&&(g.vbaraw=Xt(r,"xl/vbaProject.bin",!0))),g}function eO(r,e){var t=e||{},n="Workbook",i=Pe.find(r,n);try{if(n="/!DataSpaces/Version",i=Pe.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Lb(i.content),n="/!DataSpaces/DataSpaceMap",i=Pe.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Vb(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Pe.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Bb(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Pe.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Gb(i.content)}catch{}if(n="/EncryptionInfo",i=Pe.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Wb(i.content);if(n="/EncryptedPackage",i=Pe.find(r,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function tO(r,e){return e.bookType=="ods"?Ny(r,e):e.bookType=="numbers"?Q6(r,e):e.bookType=="xlsb"?rO(r,e):My(r,e)}function rO(r,e){oa=1024,r&&!r.SSF&&(r.SSF=vt(Oe)),r&&r.SSF&&(Wa(),Ac(r.SSF),e.revssf=Pu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Co?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=iy.indexOf(e.bookType)>-1,i=ed();gd(e=e||{});var s=L0(),a="",o=0;if(e.cellXfs=[],ji(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",He(s,a,yv(r.Props,e)),i.coreprops.push(a),ft(e.rels,2,a,Xe.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,He(s,a,Tv(r.Props)),i.extprops.push(a),ft(e.rels,3,a,Xe.EXT_PROPS),r.Custprops!==r.Props&&Bt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",He(s,a,Av(r.Custprops)),i.custprops.push(a),ft(e.rels,4,a,Xe.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var u={"!id":{}},h=r.Sheets[r.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,He(s,a,MN(o-1,a,e,r,u)),i.sheets.push(a),ft(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Xe.WS[0])}if(h){var m=h["!comments"],g=!1,p="";m&&m.length>0&&(p="xl/comments"+o+"."+t,He(s,p,UN(m,p)),i.comments.push(p),ft(u,-1,"../comments"+o+"."+t,Xe.CMNT),g=!0),h["!legacy"]&&g&&He(s,"xl/drawings/vmlDrawing"+o+".vml",ry(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&He(s,ec(a),ha(u))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,He(s,a,BN(e.Strings,a,e)),i.strs.push(a),ft(e.wbrels,-1,"sharedStrings."+t,Xe.SST)),a="xl/workbook."+t,He(s,a,LN(r,a)),i.workbooks.push(a),ft(e.rels,1,a,Xe.WB),a="xl/theme/theme1.xml",He(s,a,ad(r.Themes,e)),i.themes.push(a),ft(e.wbrels,-1,"theme/theme1.xml",Xe.THEME),a="xl/styles."+t,He(s,a,VN(r,a,e)),i.styles.push(a),ft(e.wbrels,-1,"styles."+t,Xe.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",He(s,a,r.vbaraw),i.vba.push(a),ft(e.wbrels,-1,"vbaProject.bin",Xe.VBA)),a="xl/metadata."+t,He(s,a,GN(a)),i.metadata.push(a),ft(e.wbrels,-1,"metadata."+t,Xe.XLMETA),He(s,"[Content_Types].xml",_v(i,e)),He(s,"_rels/.rels",ha(e.rels)),He(s,"xl/_rels/workbook."+t+".rels",ha(e.wbrels)),delete e.revssf,delete e.ssf,s}function My(r,e){oa=1024,r&&!r.SSF&&(r.SSF=vt(Oe)),r&&r.SSF&&(Wa(),Ac(r.SSF),e.revssf=Pu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Co?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=iy.indexOf(e.bookType)>-1,i=ed();gd(e=e||{});var s=L0(),a="",o=0;if(e.cellXfs=[],ji(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",He(s,a,yv(r.Props,e)),i.coreprops.push(a),ft(e.rels,2,a,Xe.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,He(s,a,Tv(r.Props)),i.extprops.push(a),ft(e.rels,3,a,Xe.EXT_PROPS),r.Custprops!==r.Props&&Bt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",He(s,a,Av(r.Custprops)),i.custprops.push(a),ft(e.rels,4,a,Xe.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},d=r.Sheets[r.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,He(s,a,py(o-1,e,r,h)),i.sheets.push(a),ft(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Xe.WS[0])}if(d){var g=d["!comments"],p=!1,x="";if(g&&g.length>0){var T=!1;g.forEach(function(b){b[1].forEach(function(E){E.T==!0&&(T=!0)})}),T&&(x="xl/threadedComments/threadedComment"+o+"."+t,He(s,x,gF(g,u,e)),i.threadedcomments.push(x),ft(h,-1,"../threadedComments/threadedComment"+o+"."+t,Xe.TCMNT)),x="xl/comments"+o+"."+t,He(s,x,ny(g)),i.comments.push(x),ft(h,-1,"../comments"+o+"."+t,Xe.CMNT),p=!0}d["!legacy"]&&p&&He(s,"xl/drawings/vmlDrawing"+o+".vml",ry(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&He(s,ec(a),ha(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,He(s,a,Hv(e.Strings,e)),i.strs.push(a),ft(e.wbrels,-1,"sharedStrings."+t,Xe.SST)),a="xl/workbook."+t,He(s,a,wy(r)),i.workbooks.push(a),ft(e.rels,1,a,Xe.WB),a="xl/theme/theme1.xml",He(s,a,ad(r.Themes,e)),i.themes.push(a),ft(e.wbrels,-1,"theme/theme1.xml",Xe.THEME),a="xl/styles."+t,He(s,a,Jv(r,e)),i.styles.push(a),ft(e.wbrels,-1,"styles."+t,Xe.STY),r.vbaraw&&n&&(a="xl/vbaProject.bin",He(s,a,r.vbaraw),i.vba.push(a),ft(e.wbrels,-1,"vbaProject.bin",Xe.VBA)),a="xl/metadata."+t,He(s,a,ty()),i.metadata.push(a),ft(e.wbrels,-1,"metadata."+t,Xe.XLMETA),u.length>1&&(a="xl/persons/person.xml",He(s,a,xF(u)),i.people.push(a),ft(e.wbrels,-1,"persons/person.xml",Xe.PEOPLE)),He(s,"[Content_Types].xml",_v(i,e)),He(s,"_rels/.rels",ha(e.rels)),He(s,"xl/_rels/workbook."+t+".rels",ha(e.wbrels)),delete e.revssf,delete e.ssf,s}function _d(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=tn(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function nO(r,e){return Pe.find(r,"EncryptedPackage")?eO(r,e):dd(r,e)}function iO(r,e){var t,n=r,i=e||{};return i.type||(i.type=Ke&&Buffer.isBuffer(r)?"buffer":"base64"),t=Qx(n,i),Ly(t,i)}function Vy(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return vh(r.slice(t),e);default:break e}return Da.to_workbook(r,e)}function sO(r,e){var t="",n=_d(r,e);switch(e.type){case"base64":t=tn(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=As(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=pt(t)),e.type="binary",Vy(t,e)}function aO(r,e){var t=r;return e.type=="base64"&&(t=tn(t)),t=rt.utils.decode(1200,t.slice(2),"str"),e.type="binary",Vy(t,e)}function oO(r){return r.match(/[^\x00-\x7F]/)?Rn(r):r}function bf(r,e,t,n){return n?(t.type="string",Da.to_workbook(r,t)):Da.to_workbook(e,t)}function oc(r,e){Fu();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return oc(new Uint8Array(r),(t=vt(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ma={},t.dateNF&&(ma.dateNF=t.dateNF),t.type||(t.type=Ke&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=Ke?"buffer":"binary",n=ck(r),typeof Uint8Array<"u"&&!Ke&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=oO(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return t=vt(t),t.type="array",oc(D0(n),t)}switch((i=_d(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return nO(Pe.read(n,t),t);break;case 9:if(i[1]<=8)return dd(n,t);break;case 60:return vh(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return vb(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Wv.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?iO(n,t):bf(r,n,t,s);case 239:return i[3]===60?vh(n,t):bf(r,n,t,s);case 255:if(i[1]===254)return aO(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return us.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return us.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return xh.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Xv.to_workbook(n,t);break;case 10:case 13:case 32:return sO(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return xb.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?xh.to_workbook(n,t):bf(r,n,t,s)}function Vg(r,e){var t=e||{};return t.type="file",oc(r,t)}function By(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Sc(e.file,Pe.write(r,{type:Ke?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Pe.write(r,e)}function cO(r,e){var t=vt(e||{}),n=tO(r,t);return Uy(n,t)}function lO(r,e){var t=vt(e||{}),n=My(r,t);return Uy(n,t)}function Uy(r,e){var t={},n=Ke?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?Pe.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Tc(i))}return e.password&&typeof encrypt_agile<"u"?By(encrypt_agile(i,e.password),e):e.type==="file"?Sc(e.file,i):e.type=="string"?pt(i):i}function uO(r,e){var t=e||{},n=d6(r,t);return By(n,t)}function kn(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return Xo(Rn(n));case"binary":return Rn(n);case"string":return r;case"file":return Sc(e.file,n,"utf8");case"buffer":return Ke?ii(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):kn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function fO(r,e){switch(e.type){case"base64":return Xo(r);case"binary":return r;case"string":return r;case"file":return Sc(e.file,r,"binary");case"buffer":return Ke?ii(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function hl(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?Xo(t):e.type=="string"?pt(t):t;case"file":return Sc(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function xd(r,e){Fu(),yy(r);var t=vt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=xd(r,t);return t.type="array",Tc(n)}return lO(r,t)}function Na(r,e){Fu(),yy(r);var t=vt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=Na(r,t);return t.type="array",Tc(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return kn(a6(r,t),t);case"slk":case"sylk":return kn(Gv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return kn(Ry(r.Sheets[r.SheetNames[i]],t),t);case"txt":return fO(zy(r.Sheets[r.SheetNames[i]],t),t);case"csv":return kn(yd(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return kn(Wv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return hl(xh.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return kn(Da.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return kn(Xv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return kn(zv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return kn(Ny(r,t),t);case"wk1":return hl(us.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return hl(us.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),hl(Sy(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),uO(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return cO(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function vd(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function Bg(r,e,t){var n=t||{};return n.type="file",n.file=e,vd(n),Na(r,n)}function hO(r,e,t){var n=t||{};return n.type="file",n.file=e,vd(n),xd(r,n)}function dO(r,e,t,n){var i=t||{};i.type="file",i.file=r,vd(i),i.type="buffer";var s=n;return s instanceof Function||(s=t),wi.writeFile(r,Na(e,i),s)}function Gy(r,e,t,n,i,s,a,o){var c=Mt(t),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!a||r[t])for(var m=e.s.c;m<=e.e.c;++m){var g=a?r[t][m]:r[n[m]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[m]!=null&&(d[s[m]]=l);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[m]!=null){if(p==null)if(g.t=="e"&&p===null)d[s[m]]=null;else if(l!==void 0)d[s[m]]=l;else if(u&&p===null)d[s[m]]=null;else continue;else d[s[m]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:On(g,p,o);p!=null&&(h=!1)}}return{row:d,isempty:h}}function au(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},u=l.range!=null?l.range:r["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof u){case"string":c=Je(u);break;case"number":c=Je(r["!ref"]),c.s.r=u;break;default:c=u}n>0&&(i=0);var h=Mt(c.s.r),d=[],m=[],g=0,p=0,x=Array.isArray(r),T=c.s.r,b=0,E={};x&&!r[T]&&(r[T]=[]);var F=l.skipHidden&&r["!cols"]||[],M=l.skipHidden&&r["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(F[b]||{}).hidden)switch(d[b]=At(b),t=x?r[T][b]:r[d[b]+h],n){case 1:s[b]=b-c.s.c;break;case 2:s[b]=d[b];break;case 3:s[b]=l.header[b-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=On(t,null,l),p=E[a]||0,!p)E[a]=1;else{do o=a+"_"+p++;while(E[o]);E[a]=p,E[o]=1}s[b]=o}for(T=c.s.r+i;T<=c.e.r;++T)if(!(M[T]||{}).hidden){var O=Gy(r,c,T,d,n,s,x,l);(O.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(m[g++]=O.row)}return m.length=g,m}var Ug=/"/g;function Wy(r,e,t,n,i,s,a,o){for(var c=!0,l=[],u="",h=Mt(t),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(r[t]||[])[d]:r[n[d]+h];if(m==null)u="";else if(m.v!=null){c=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:On(m,null,o));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===i||p===s||p===34||o.forceQuotes){u='"'+u.replace(Ug,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Ug,'""')+'"')):u="";l.push(u)}return o.blankrows===!1&&c?null:l.join(a)}function yd(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=Je(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(r);for(var d=n.skipHidden&&r["!cols"]||[],m=n.skipHidden&&r["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(h[g]=At(g));for(var p=0,x=i.s.r;x<=i.e.r;++x)(m[x]||{}).hidden||(u=Wy(r,i,x,h,a,c,s,n),u!=null&&(n.strip&&(u=u.replace(l,"")),(u||n.blankrows!==!1)&&t.push((p++?o:"")+u)));return delete n.dense,t.join("")}function zy(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=yd(r,e);if(typeof rt>"u"||e.type=="string")return t;var n=rt.utils.encode(1200,t,"str");return""+n}function mO(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=Je(r["!ref"]),s="",a=[],o,c=[],l=Array.isArray(r);for(o=i.s.c;o<=i.e.c;++o)a[o]=At(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Mt(u),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=l?(r[u]||[])[o]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=e+"="+n}return c}function Hy(r,e,t){var n=t||{},i=+!n.skipHeader,s=r||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Pt(n.origin):n.origin;a=c.r,o=c.c}var l,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Je(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+e.length-1+i)}else a==-1&&(a=0,u.e.r=e.length-1+i);var d=n.header||[],m=0;e.forEach(function(p,x){Bt(p).forEach(function(T){(m=d.indexOf(T))==-1&&(d[m=d.length]=T);var b=p[T],E="z",F="",M=Le({c:o+m,r:a+x+i});l=cc(s,M),b&&typeof b=="object"&&!(b instanceof Date)?s[M]=b:(typeof b=="number"?E="n":typeof b=="boolean"?E="b":typeof b=="string"?E="s":b instanceof Date?(E="d",n.cellDates||(E="n",b=er(b)),F=n.dateNF||Oe[14]):b===null&&n.nullError&&(E="e",b=0),l?(l.t=E,l.v=b,delete l.w,delete l.R,F&&(l.z=F)):s[M]=l={t:E,v:b},F&&(l.z=F))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var g=Mt(a);if(i)for(m=0;m<d.length;++m)s[At(m+o)+g]={t:"s",v:d[m]};return s["!ref"]=ze(u),s}function pO(r,e){return Hy(null,r,e)}function cc(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=Pt(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?cc(r,Le(e)):cc(r,Le({r:e,c:t||0}))}function gO(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function wd(){return{SheetNames:[],Sheets:{}}}function Ed(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=a+i)!=-1;++i);}if(vy(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function _O(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=gO(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function xO(r,e){return r.z=e,r}function jy(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function vO(r,e,t){return jy(r,"#"+e,t)}function yO(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function wO(r,e,t,n){for(var i=typeof e!="string"?e:Je(e),s=typeof e=="string"?e:ze(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=cc(r,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=t,n&&(c.D=!0))}return r}var ca={encode_col:At,encode_row:Mt,encode_cell:Le,encode_range:ze,decode_col:q0,decode_row:K0,split_cell:Uk,decode_cell:Pt,decode_range:Or,format_cell:On,sheet_add_aoa:uv,sheet_add_json:Hy,sheet_add_dom:Fy,aoa_to_sheet:Ha,json_to_sheet:pO,table_to_sheet:Dy,table_to_book:F6,sheet_to_csv:yd,sheet_to_txt:zy,sheet_to_json:au,sheet_to_html:Ry,sheet_to_formulae:mO,sheet_to_row_object_array:au,sheet_get_cell:cc,book_new:wd,book_append_sheet:Ed,book_set_sheet_visibility:_O,cell_set_number_format:xO,cell_set_hyperlink:jy,cell_set_internal_link:vO,cell_add_comment:yO,sheet_set_array_formula:wO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Uu;function EO(r){Uu=r}function TO(r,e){var t=Uu(),n=e??{};if(r==null||r["!ref"]==null)return t.push(null),t;var i=Je(r["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(r);for(var d=n.skipHidden&&r["!cols"]||[],m=n.skipHidden&&r["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(h[g]=At(g));var p=i.s.r,x=!1,T=0;return t._read=function(){if(!x)return x=!0,t.push("\uFEFF");for(;p<=i.e.r;)if(++p,!(m[p-1]||{}).hidden&&(u=Wy(r,i,p-1,h,a,c,s,n),u!=null&&(n.strip&&(u=u.replace(l,"")),u||n.blankrows!==!1)))return t.push((T++?o:"")+u);return t.push(null)},t}function AO(r,e){var t=Uu(),n=e||{},i=n.header!=null?n.header:ky,s=n.footer!=null?n.footer:Cy;t.push(i);var a=Or(r["!ref"]);n.dense=Array.isArray(r),t.push(by(r,a,n));var o=a.s.r,c=!1;return t._read=function(){if(o>a.e.r)return c||(c=!0,t.push("</table>"+s)),t.push(null);for(;o<=a.e.r;){t.push(Iy(r,a,o,n)),++o;break}},t}function SO(r,e){var t=Uu({objectMode:!0});if(r==null||r["!ref"]==null)return t.push(null),t;var n={t:"n",v:0},i=0,s=1,a=[],o=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:r["!ref"];switch(u.header===1?i=1:u.header==="A"?i=2:Array.isArray(u.header)&&(i=3),typeof h){case"string":l=Je(h);break;case"number":l=Je(r["!ref"]),l.s.r=h;break;default:l=h}i>0&&(s=0);var d=Mt(l.s.r),m=[],g=0,p=Array.isArray(r),x=l.s.r,T=0,b={};p&&!r[x]&&(r[x]=[]);var E=u.skipHidden&&r["!cols"]||[],F=u.skipHidden&&r["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(E[T]||{}).hidden)switch(m[T]=At(T),n=p?r[x][T]:r[m[T]+d],i){case 1:a[T]=T-l.s.c;break;case 2:a[T]=m[T];break;case 3:a[T]=u.header[T-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=o=On(n,null,u),g=b[o]||0,!g)b[o]=1;else{do c=o+"_"+g++;while(b[c]);b[o]=g,b[c]=1}a[T]=c}return x=l.s.r+s,t._read=function(){for(;x<=l.e.r;)if(!(F[x-1]||{}).hidden){var M=Gy(r,l,x,m,i,a,p,u);if(++x,M.isempty===!1||(i===1?u.blankrows!==!1:u.blankrows)){t.push(M.row);return}}return t.push(null)},t}var IO={to_json:SO,to_html:AO,to_csv:TO,set_readable:EO};const kO=qo.version,CO=Object.freeze(Object.defineProperty({__proto__:null,CFB:Pe,SSF:Hx,parse_xlscfb:dd,parse_zip:Ly,read:oc,readFile:Vg,readFileSync:Vg,set_cptable:FI,set_fs:ak,stream:IO,utils:ca,version:kO,write:Na,writeFile:Bg,writeFileAsync:dO,writeFileSync:Bg,writeFileXLSX:hO,writeXLSX:xd},Symbol.toStringTag,{value:"Module"}));(function(){function r(t,{tries:n=50,delay:i=200}={}){return new Promise(s=>{let a=0;const o=()=>{const c=t();if(c)return s(c);if(++a>=n)return s(null);setTimeout(o,i)};o()})}function e(t,n,i,s){const a=async()=>{var m;const o=document.getElementById("viewAdmin");if(!o)return;const c=await r(()=>o.querySelector("#"+t)),l=await r(()=>o.querySelector("#"+n));if(!c||!l)return;let u=document.getElementById(i);u||(u=document.createElement("button"),u.id=i,u.type="button",u.className=c.className||"btn",u.textContent="Export JPG",u.style.marginLeft="8px"),c.nextSibling!==u&&c.insertAdjacentElement("afterend",u);const h=g=>{const p=document.createElement("a"),x=URL.createObjectURL(g);p.href=x,p.download=s||n+".jpg",document.body.appendChild(p),p.click(),setTimeout(()=>{URL.revokeObjectURL(x),p.remove()},0)};u.onclick=()=>{try{if(l.toBlob)l.toBlob(g=>{if(g)h(g);else{const p=l.toDataURL("image/jpeg",.92);fetch(p).then(x=>x.blob()).then(h)}},"image/jpeg",.92);else{const g=l.toDataURL("image/jpeg",.92);fetch(g).then(p=>p.blob()).then(h)}}catch(g){console.error("JPG export failed:",g),alert("JPG export mislukt.")}};const d=()=>{try{c.nextSibling!==u&&c.insertAdjacentElement("afterend",u)}catch{}};c.addEventListener("click",()=>setTimeout(d,0)),window.addEventListener("resize",d),(m=document.getElementById("adminSubtabs"))==null||m.addEventListener("click",()=>setTimeout(d,0)),o&&window.MutationObserver&&new MutationObserver(()=>d()).observe(o,{childList:!0,subtree:!0}),d()};a(),document.readyState!=="complete"&&document.readyState!=="interactive"&&document.addEventListener("DOMContentLoaded",a,{once:!0})}window.attachChartExportJPGNextToReload=e})();let jn=[];async function Gu(){try{if(Array.isArray(jn)&&jn.length)return jn;const r=Gt(je,"globals","ridePlan"),e=await Di(r);return jn=(e.exists()&&Array.isArray(e.data().plannedDates)?e.data().plannedDates.filter(Boolean):[]).map(n=>{if(typeof n=="string"){const s=n.match(/\d{4}-\d{2}-\d{2}/);if(s)return s[0]}const i=new Date(n);return isNaN(i)?"":i.toISOString().slice(0,10)}).filter(Boolean),jn}catch(r){return console.error("ensureRideDatesLoaded()",r),jn=[],jn}}const Gg=["LidNr","Naam","Voor naam","Voor letters","Tussen voegsel","Regio Omschrijving"];let Wg=!1;function bO(){return new Promise((r,e)=>{if(window.Html5QrcodeScanner)return r(!0);if(Wg){const n=setInterval(()=>{window.Html5QrcodeScanner&&(clearInterval(n),r(!0))},100);setTimeout(()=>{clearInterval(n),window.Html5QrcodeScanner||e(new Error("Timeout bij laden QR-lib"))},1e4);return}Wg=!0;const t=document.createElement("script");t.src="https://unpkg.com/html5-qrcode",t.async=!0,t.onload=()=>r(!0),t.onerror=()=>e(new Error("Kon QR-bibliotheek niet laden")),document.head.appendChild(t)})}async function RO(r,e){const t=new Map(r.map(n=>[n,0]));try{let n=null;const i=400;for(;;){let s=Wr(Ir(je,"members"),zr("__name__"),Hr(i));n&&(s=Wr(Ir(je,"members"),zr("__name__"),Ec(n),Hr(i)));const a=await Pn(s);if(a.empty||(a.forEach(o=>{const c=o.data()||{};if(e&&String(c["Regio Omschrijving"]||"").trim()!==String(e).trim())return;const l=Array.isArray(c.ScanDatums)?c.ScanDatums:[];for(const u of l){const h=typeof u=="string"?u.slice(0,10):"";h&&t.has(h)&&t.set(h,t.get(h)+1)}}),n=a.docs[a.docs.length-1],a.size<i))break}}catch(n){console.error("[rideStats] tellen mislukt",n)}return t}let dl=null;async function FO(){const r=document.getElementById("rideStatsChart"),e=document.getElementById("rideStatsStatus"),t=document.getElementById("reloadStatsBtn"),n=document.getElementById("rideRegionFilter"),i=document.getElementById("rideRegionStatus");if(!r)return;async function s(){try{e&&(e.textContent="Laden");const o=(await Gu()||[]).map(m=>typeof m=="string"?m.slice(0,10):"").filter(Boolean).sort();if(!o.length){e&&(e.textContent="Geen geplande datums.");return}const c=n&&n.value||null;i&&(i.textContent=c?`Regio: ${c}`:"");const l=await RO(o,c),u=o,h=o.map(m=>l.get(m)||0);try{dl&&(dl.destroy(),dl=null)}catch{}const d=r.getContext("2d");dl=new Chart(d,{type:"bar",data:{labels:u,datasets:[{label:"Inschrijvingen",data:h}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Ritdatum"}},y:{beginAtZero:!0,title:{display:!0,text:"Aantal leden"},ticks:{precision:0}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:m=>` ${m.parsed.y} inschrijvingen`}}}}}),e&&(e.textContent=` Gegevens geladen (${h.reduce((m,g)=>m+g,0)} totaal)`)}catch(a){console.error(a),e&&(e.textContent=" Laden mislukt")}}await s(),t&&t.addEventListener("click",()=>s(),{passive:!0}),(async()=>{try{if(!n)return;n.innerHTML='<option value="">Alles</option>',(await DO()).forEach(o=>{const c=document.createElement("option");c.value=o,c.textContent=o,n.appendChild(c)}),n.addEventListener("change",()=>s(),{passive:!0})}catch(a){console.error("Kon regio's niet laden",a)}})()}async function DO(){const r=new Set;try{let e=null;const t=400;for(;;){let n=Wr(Ir(je,"members"),zr("__name__"),Hr(t));e&&(n=Wr(Ir(je,"members"),zr("__name__"),Ec(e),Hr(t)));const i=await Pn(n);if(i.empty||(i.forEach(s=>{const o=((s.data()||{})["Regio Omschrijving"]||"").trim();o&&r.add(o)}),e=i.docs[i.docs.length-1],i.size<t))break}}catch(e){console.error("getAllRegions failed",e)}return Array.from(r).sort((e,t)=>e.localeCompare(t))}async function PO(r){const e=r.length,t=new Array(e+1).fill(0),n=new Set(r);try{let i=null;const s=400;for(;;){let a=Wr(Ir(je,"members"),zr("__name__"),Hr(s));i&&(a=Wr(Ir(je,"members"),zr("__name__"),Ec(i),Hr(s)));const o=await Pn(a);if(o.empty||(o.forEach(c=>{const l=c.data()||{};if((l.Jaarhanger||"").toString()!=="Ja")return;const u=Array.isArray(l.ScanDatums)?l.ScanDatums:[];let h=0;for(const d of u){const m=typeof d=="string"?d.slice(0,10):"";m&&n.has(m)&&h++}h<0&&(h=0),h>e&&(h=e),t[h]+=1}),i=o.docs[o.docs.length-1],o.size<s))break}}catch(i){console.error("[starDist] bouwen mislukt",i)}return t}let ml=null;async function NO(){const r=document.getElementById("starDistChart"),e=document.getElementById("starDistStatus"),t=document.getElementById("reloadStarDistBtn");if(!r)return;async function n(){try{e&&(e.textContent="Laden");const s=(await Gu()||[]).map(d=>typeof d=="string"?d.slice(0,10):"").filter(Boolean).sort(),a=s.length;if(!a){e&&(e.textContent="Geen geplande datums.");return}const o=await PO(s),c=Array.from({length:a+1},(d,m)=>String(m)),l=o;try{ml&&(ml.destroy(),ml=null)}catch{}const u=r.getContext("2d");ml=new Chart(u,{type:"bar",data:{labels:c,datasets:[{label:"Aantal leden",data:l}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Aantal sterren (0.."+a+")"}},y:{beginAtZero:!0,title:{display:!0,text:"Aantal leden"},ticks:{precision:0}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:d=>` ${d.parsed.y} leden`}}}}});const h=l.reduce((d,m)=>d+m,0);e&&(e.textContent=` Gegevens geladen (leden met Jaarhanger=Ja: ${h})`)}catch(i){console.error(i),e&&(e.textContent=" Laden mislukt")}}await n(),t&&t.addEventListener("click",()=>n(),{passive:!0})}function OO(){var c;const r=l=>document.getElementById(l),e=(window.location.pathname||"/").replace(/\\/g,"/").toLowerCase(),n=(e.split("/").filter(Boolean).pop()||"index.html").replace(/\.html?$/,""),i=n==="admin-scan",s=n==="admin-planning",a=n==="admin-stats",o=n==="index"||e==="/";if(s||o){let g=function(S,I=""){if(!m)return;const k=document.createElement("div");I&&(k.className=I),k.textContent=S,m.appendChild(k),m.scrollTop=m.scrollHeight},p=function(S){h&&(h.disabled=S,h.textContent=S?"Bezig...":"Uploaden")},T=function(S){const I=S.SheetNames[0],k=S.Sheets[I];return ca.sheet_to_json(k,{defval:""})},b=function(S){return S.map(I=>{const k={};for(const R of Gg)k[R]=(I[R]??"").toString().trim();return k})};const l=r("fileInput"),u=r("fileName"),h=r("uploadBtn"),d=r("status"),m=r("log");l==null||l.addEventListener("change",()=>{var I;const S=(I=l==null?void 0:l.files)==null?void 0:I[0];u&&(u.textContent=S?S.name:"Geen bestand gekozen")});async function x(S){const I=await S.arrayBuffer();return oc(I,{type:"array"})}async function E(S){let I=0,k=0,R=0,ae=Hl(je);const oe=async()=>{await ae.commit(),ae=Hl(je)};for(const Ae of S){I++;const le=String(Ae.LidNr||"").trim();if(!/^\d+$/.test(le)){R++;continue}const We={};for(const K of Gg)We[K]=Ae[K];We.ridesCount=Cx(0),ae.set(Gt(je,"members",le),We,{merge:!0}),k++,k%400===0&&await oe()}return await oe(),{total:I,updated:k,skipped:R}}let F=!1;async function M(){var I;if(F)return;const S=(I=l==null?void 0:l.files)==null?void 0:I[0];if(!S){d&&(d.textContent=" Kies eerst een bestand");return}F=!0,p(!0),d&&(d.textContent="Bezig met inlezen"),m&&(m.innerHTML="");try{const k=await x(S),R=b(T(k));g(`Gelezen rijen: ${R.length}`),d&&(d.textContent="Importeren naar Firestore");const ae=await E(R);g(`Klaar. Totaal: ${ae.total}, verwerkt: ${ae.updated}, overgeslagen: ${ae.skipped}`,"ok"),d&&(d.textContent=" Import voltooid (ridesCount behouden)")}catch(k){console.error(k),d&&(d.textContent=" Fout tijdens import"),g(String((k==null?void 0:k.message)||k),"err")}finally{p(!1),F=!1}}(c=r("uploadBtn"))==null||c.addEventListener("click",M);const O=document.getElementById("resetRidesBtn"),y=document.getElementById("resetStatus");O==null||O.addEventListener("click",async()=>{window.confirm("Weet je zeker dat je ALLE ridesCount waardes naar 0 wilt zetten? Dit kan niet ongedaan worden gemaakt.")&&await GO(y)});const A=document.getElementById("resetJaarhangerBtn"),v=document.getElementById("resetJaarhangerStatus");A==null||A.addEventListener("click",async()=>{window.confirm("Weet je zeker dat je de Jaarhanger keuze voor ALLE leden wilt resetten naar leeg? Dit kan niet ongedaan worden gemaakt.")&&await WO(v)}),LO()}if(i||o){BO();try{UO()}catch{}}if(a||o){try{FO()}catch{}try{NO()}catch{}try{attachChartExportJPGNextToReload("reloadStarDistBtn","starDistChart","btnStarDistJPG","sterrenverdeling.jpg")}catch{}try{attachChartExportJPGNextToReload("reloadStatsBtn","rideStatsChart","btnRideStatsJPG","inschrijvingen-per-rit.jpg")}catch{}}}function LO(){const r=T=>document.getElementById(T);if(!r("ridePlannerCard"))return;const t=r("rideDate1"),n=r("rideDate2"),i=r("rideDate3"),s=r("rideDate4"),a=r("rideDate5"),o=r("rideDate6"),c=r("saveRidePlanBtn"),l=r("reloadRidePlanBtn"),u=r("ridePlanStatus"),h=Gt(je,"globals","ridePlan");function d(T,b=!0){u&&(u.textContent=T,u.style.color=b?"#9ca3af":"#ef4444")}function m(T){const E=(Array.isArray(T)?T:[]).slice(0,6).concat(Array(6)).slice(0,6).map(F=>F||"");[t,n,i,s,a,o].forEach((F,M)=>{F&&(F.value=E[M]||"")})}async function g(){try{d("Laden");const T=await Di(h);if(T.exists()){const b=T.data()||{},E=Array.isArray(b.plannedDates)?b.plannedDates:[];m(E),d(` ${E.length} datums geladen`)}else m([]),d("Nog geen planning opgeslagen.")}catch(T){console.error("[ridePlan] loadPlan error",T),d(" Laden mislukt (controleer regels/verbinding)",!1)}}function p(){const T=[t,n,i,s,a,o].map(E=>(E&&E.value||"").trim()).filter(Boolean),b=Array.from(new Set(T));return b.sort(),b}async function x(){try{const T=p();if(T.length<5){d(" Vul minimaal 5 datums in.",!1);return}d("Opslaan"),await qn(h,{plannedDates:T,updatedAt:kx()},{merge:!0}),d(" Planning opgeslagen")}catch(T){console.error("[ridePlan] savePlan error",T),d(" Opslaan mislukt (controleer regels/verbinding)",!1)}}c==null||c.addEventListener("click",x),l==null||l.addEventListener("click",g),g()}async function $y(r,e,t){const n=String(r||"").trim();if(!n)throw new Error("Geen LidNr meegegeven");const i=(t||"").toString().slice(0,10);if(!/^\d{4}-\d{2}-\d{2}$/.test(i))throw new Error("Geen geldige ritdatum gekozen");const s=Gt(je,"members",n),a=await KS(je,async o=>{const c=await o.get(s),l=c.exists()?c.data():{},u=Number.isFinite(Number(l==null?void 0:l.ridesCount))?Number(l.ridesCount):0,h=Array.isArray(l==null?void 0:l.ScanDatums)?l.ScanDatums.map(String):[];if(h.includes(i))return o.set(s,{ridesCount:u,ScanDatums:h.length?h:[]},{merge:!0}),{changed:!1,newTotal:u,ymd:i};{const m=u+1;return o.set(s,{ridesCount:Cx(1),ScanDatums:qS(i)},{merge:!0}),{changed:!0,newTotal:m,ymd:i}}});return{id:n,...a}}function MO(r){if(!r)return null;try{const n=JSON.parse(r),i=(n==null?void 0:n.uid)||(n==null?void 0:n.id)||(n==null?void 0:n.member)||(n==null?void 0:n.lid)||(n==null?void 0:n.lidnr);if(i)return String(i).trim()}catch{}const e=r.match(/lidnr\s*[:=]\s*([\w-]+)/i);if(e)return e[1].trim();try{const n=new URL(r),i=n.searchParams.get("lid")||n.searchParams.get("lidnr")||n.searchParams.get("member")||n.searchParams.get("id")||n.searchParams.get("uid");if(i)return i.trim()}catch{}const t=r.match(/\b(\d{3,})\b/);return t?t[1]:null}function co(r,e=!0){const t=document.getElementById("toast-root")||document.body,n=document.createElement("div");n.className="toast",n.textContent=r,e||(n.style.background="#ef4444"),t.appendChild(n),setTimeout(()=>n.remove(),1200)}function VO(r=new Date){return r.toTimeString().slice(0,8)}function BO(){const r=v=>document.getElementById(v),e=r("adminManualSearchInput"),t=r("adminManualClear"),n=r("adminManualSuggest"),i=r("adminManualResult"),s=r("adminManualError"),a=r("adminMName"),o=r("adminMMemberNo"),c=r("adminMRidesCount"),l=r("adminManualStatus"),u=r("adminRideButtons"),h=r("adminRideHint");let d=null;async function m(v){if(!g){l.textContent="Kies eerst een lid.",l.classList.add("error");return}l.classList.remove("error"),l.textContent="Bezig met registreren";try{const S=await $y(g.id,a.textContent||"",v);l.textContent=S.changed?` Rit geregistreerd op ${S.ymd} (totaal: ${S.newTotal})`:` Deze datum (${S.ymd}) was al geregistreerd  niets aangepast.`,h&&(h.textContent=`Geregistreerd op: ${S.ymd}`)}catch(S){console.error(S),l.textContent=" Fout bij registreren",l.classList.add("error")}}if(!e||!n||!i)return;let g=null,p=null;function x(v){const S=((v==null?void 0:v["Tussen voegsel"])||"").toString().trim();return[((v==null?void 0:v["Voor naam"])||"").toString().trim(),v!=null&&v["Voor letters"]?`(${(v["Voor letters"]+"").trim()})`:"",S,((v==null?void 0:v.Naam)||(v==null?void 0:v.name)||(v==null?void 0:v.naam)||"").toString().trim()].filter(Boolean).join(" ").replace(/\s+/g," ").trim()}function T(){n.innerHTML="",n.style.display="none"}function b(v){n.innerHTML="";for(const S of v){const I=document.createElement("li");I.textContent=`${x(S.data)}  ${S.id}`,I.addEventListener("click",()=>{A(S),T()},{passive:!0}),n.appendChild(I)}n.style.display=v.length?"block":"none"}async function E(v){if(!v)return[];const S=10;try{const I=Wr(Ir(je,"members"),zr("Naam"),Wl(v),zl(v+""),Hr(S)),k=Wr(Ir(je,"members"),zr("Voor naam"),Wl(v),zl(v+""),Hr(S)),[R,ae]=await Promise.all([Pn(I),Pn(k)]),oe=new Map;return R.forEach(le=>{oe.has(le.id)||oe.set(le.id,{id:le.id,data:le.data()})}),ae.forEach(le=>{oe.has(le.id)||oe.set(le.id,{id:le.id,data:le.data()})}),Array.from(oe.values()).slice(0,S)}catch(I){return console.error("queryByLastNamePrefix (admin) failed",I),[]}}function F(){g=null,i.style.display="none",s.style.display="none",l.textContent="";try{p&&p()}catch{}p=null}async function M(){F();const v=(e.value||"").trim();if(v.length>=1)try{const S=await E(v);S&&S.length?b(S):T()}catch{T()}else T()}async function O(){F();const v=(e.value||"").trim();if(v.length<2){T();return}try{const S=await E(v);b(S)}catch(S){console.error(S),T()}}async function y(){if(u){u.innerHTML="",d=null;try{const v=await Gu(),S=new Date,I=new Date(Date.UTC(S.getFullYear(),S.getMonth(),S.getDate())).toISOString().slice(0,10),k=(v||[]).map(ae=>typeof ae=="string"?ae.slice(0,10):"").filter(Boolean).filter(ae=>ae.localeCompare(I)<=0);if(!k.length){u.innerHTML='<span class="muted">Geen geplande ritdatums gevonden.</span>',h&&(h.textContent="Geen (verleden/heden) ritdatums.");return}const R=document.createDocumentFragment();k.forEach(ae=>{const oe=document.createElement("button");oe.type="button",oe.className="chip",oe.textContent=ae,oe.setAttribute("aria-pressed","false"),oe.addEventListener("click",async()=>{d=ae,h&&(h.textContent=`Registreren voor: ${ae}`),await m(ae)},{passive:!0}),R.appendChild(oe)}),u.appendChild(R),h&&(h.textContent="Klik op een datum om direct te registreren.")}catch(v){console.error(v),u.innerHTML='<span class="error">Kon ritdatums niet laden.</span>'}}}function A(v){g=v,a.textContent=x(v.data),o.textContent=v.id,(async()=>{var I,k;try{const R=await os(),ae=Array.isArray((I=v.data)==null?void 0:I.ScanDatums)?v.data.ScanDatums:[],{stars:oe,starsHtml:Ae,tooltip:le,planned:We}=Kl(R,ae);c.innerHTML=Ae||"",c.setAttribute("title",oe?le:"Geen ingeplande datums")}catch{const ae=typeof((k=v.data)==null?void 0:k.ridesCount)=="number"?v.data.ridesCount:0;c.textContent=String(ae)}})(),i.style.display="grid",y();try{p&&p()}catch{}const S=Gt(Ir(je,"members"),v.id);p=Ax(S,I=>{const k=I.exists()?I.data():null;(async()=>{try{const R=await os(),ae=k&&Array.isArray(k.ScanDatums)?k.ScanDatums:[],{stars:oe,starsHtml:Ae,tooltip:le}=Kl(R,ae);c.innerHTML=Ae||"",oe?c.setAttribute("title",le):c.removeAttribute("title")}catch{const ae=k&&typeof k.ridesCount=="number"?k.ridesCount:0;c.textContent=String(ae)}})()},I=>console.error(I))}e.addEventListener("focus",M,{passive:!0}),e.addEventListener("input",O,{passive:!0}),e.addEventListener("keydown",async v=>{if(v.key==="Escape"&&T(),v.key==="Enter"){v.preventDefault();const S=(e.value||"").trim();if(!S){T();return}try{const I=await E(S);I&&I.length?b(I):(s.textContent="Geen leden gevonden.",s.style.display="block",T())}catch{s.textContent="Zoeken mislukt.",s.style.display="block",T()}}}),t==null||t.addEventListener("click",()=>{e.value="",T(),F()})}function UO(){const r=T=>document.getElementById(T),e=r("adminScanStart"),t=r("adminScanStop"),n=r("adminQRStatus"),i=r("adminQRReader"),s=r("adminQRResult");function a(){var b;let T=document.getElementById("adminQRLog");return T||(T=document.createElement("div"),T.id="adminQRLog",T.style.marginTop="10px",T.innerHTML='<h4 style="margin:6px 0 6px;">Registraties</h4><div id="adminQRLogList" class="qr-log-list"></div>',(b=(s==null?void 0:s.parentElement)||(i==null?void 0:i.parentElement)||i)==null||b.appendChild(T)),document.getElementById("adminQRLogList")}const o=a();let c=null,l=new Map;const u=3e4;function h({naam:T,lid:b,ok:E,reason:F,ridesTotal:M}){if(!o)return;const O=document.createElement("div");O.style.display="flex",O.style.justifyContent="space-between",O.style.gap="8px",O.style.padding="10px 12px",O.style.border="1px solid #1f2937",O.style.borderRadius="12px",O.style.marginBottom="6px",O.style.background=E?"#0f1d12":"#1a0f0f";const y=document.createElement("div");y.textContent=`${VO()}  ${T?T+" ":""}${b?"(LidNr: "+b+")":"(onbekend)"}`;const A=document.createElement("div");A.textContent=E?` bijgewerkt${M??M===0?"  totaal: "+M:""}`:` ${F||"geweigerd"}`,O.appendChild(y),O.appendChild(A),o.prepend(O)}async function d(T){const b=Date.now(),E=l.get(T)||0;if(b-E<u)return;l.set(T,b);let F=MO(T||""),M="",O=null;if(!F){n&&(n.textContent=" Geen LidNr in QR"),co(" Onbekende QR (geen LidNr)",!1),h({naam:"",lid:"",ok:!1,reason:"geen LidNr"});return}try{try{const S=await Di(Gt(je,"members",String(F)));if(S.exists()){const I=S.data();M=`${(I["Voor naam"]||"").toString().trim()} ${(I["Tussen voegsel"]||"").toString().trim()} ${(I.Naam||I.name||I.naam||"").toString().trim()}`.replace(/\s+/g," ").trim()||I.Naam||I.name||I.naam||"";const R=Number(I==null?void 0:I.ridesCount);O=Number.isFinite(R)?R:0}else O=0}catch{O=O??0}const y=new Date(Date.UTC(new Date().getFullYear(),new Date().getMonth(),new Date().getDate())).toISOString().slice(0,10);try{await Gu()}catch{}if(!Array.isArray(jn)||!jn.includes(y)){n&&(n.textContent=` ${y} is geen geplande ritdatum  registratie overgeslagen.`),co(" Niet op geplande ritdatum  niet geregistreerd",!0),h({naam:M||"",lid:F,ok:!1,reason:"niet geplande datum"});return}const A=await $y(F,M||"",y),v=A.newTotal;n&&(n.textContent=A.changed?` Rit +1 voor ${M||"(onbekend)"} (${F}) op ${A.ymd}`:` ${M||"(onbekend)"} (${F}) had ${A.ymd} al geregistreerd  niets aangepast.`),s&&(s.textContent=`Gescand: ${M?"Naam: "+M+" ":""}(LidNr: ${F})`),co(A.changed?" QR-code gescand":" Reeds geregistreerd",!0),h({naam:M||"",lid:F,ok:!0,ridesTotal:v})}catch(y){console.error(y),n&&(n.textContent=` Fout bij updaten: ${(y==null?void 0:y.message)||y}`),co(" Fout bij updaten",!1),h({naam:M||"",lid:F,ok:!1,reason:"update fout"})}}function m(T){d(T)}function g(T){}async function p(){n&&(n.textContent="Camera openen");try{await bO()}catch{n&&(n.textContent="Bibliotheek niet geladen."),co("Bibliotheek niet geladen",!1);return}try{c&&c.clear&&await c.clear()}catch{}i&&(i.innerHTML=""),c=new Html5QrcodeScanner("adminQRReader",{fps:10,qrbox:250,aspectRatio:1.333},!1),c.render(m,g),n&&(n.textContent="Richt je camera op de QR-code")}async function x(){n&&(n.textContent="Stoppen");try{c&&c.clear&&await c.clear()}catch{}c=null,i&&(i.innerHTML=""),n&&(n.textContent=" Gestopt")}e==null||e.addEventListener("click",p),t==null||t.addEventListener("click",x)}async function GO(r){if(!r)return;r.textContent="Voorbereiden";let e=0;try{let t=null;const n=400;for(;;){let i=Wr(Ir(je,"members"),zr("__name__"),Hr(n));t&&(i=Wr(Ir(je,"members"),zr("__name__"),Ec(t),Hr(n)));const s=await Pn(i);if(s.empty)break;let a=Hl(je);if(s.forEach(o=>{a.set(Gt(je,"members",o.id),{ridesCount:0,ScanDatums:[]},{merge:!0})}),await a.commit(),e+=s.size,r.textContent=`Gerest: ${e} leden`,t=s.docs[s.docs.length-1],s.size<n)break}r.textContent=` Klaar. Alle ridesCount naar 0 gezet voor ${e} leden.`}catch(t){console.error(t),r.textContent=` Fout bij resetten: ${(t==null?void 0:t.message)||t}`}}async function WO(r){if(!r)return;r.textContent="Voorbereiden";let e=0;try{let t=null;const n=400;for(;;){let i=Wr(Ir(je,"members"),zr("__name__"),Hr(n));t&&(i=Wr(Ir(je,"members"),zr("__name__"),Ec(t),Hr(n)));const s=await Pn(i);if(s.empty)break;let a=Hl(je);if(s.forEach(o=>{a.set(Gt(je,"members",o.id),{Jaarhanger:""},{merge:!0})}),await a.commit(),e+=s.size,r.textContent=`Gerest Jaarhanger voor: ${e} leden`,t=s.docs[s.docs.length-1],s.size<n)break}r.textContent=` Klaar. Jaarhanger gereset voor ${e} leden.`}catch(t){console.error(t),r.textContent=` Fout bij resetten Jaarhanger: ${(t==null?void 0:t.message)||t}`}}async function zO(){const r=document.getElementById("exportExcelStatus");try{r&&(r.textContent="Bezig met ophalen...");const e=await Pn(Ir(je,"members")),t=[];e.forEach(l=>{const u=l.data()||{},h=u.Naam??u.naam??u.lastName??u.achternaam??"",d=u["Tussen voegsel"]??u.tussenvoegsel??u.tussenVoegsel??u.tussen??u.infix??"",m=u["Voor letters"]??u.voorletters??u.initialen??u.initials??"",g=u["Voor naam"]??u.voornaam??u.firstName??u.naamVoor??"",p=typeof u.ridesCount=="number"?u.ridesCount:typeof u.rittenCount=="number"?u.rittenCount:typeof u.ritten=="number"?u.ritten:0;let x=u["Regio Omschrijving"]??u.regioOmschrijving??"";!x&&u.regio&&typeof u.regio=="object"&&(x=u.regio.omschrijving??u.regio.name??u.regio.title??""),t.push({Naam:String(h||""),"Tussen voegsel":String(d||""),"Voor letters":String(m||""),"Voor naam":String(g||""),ridesCount:p,"Regio Omschrijving":String(x||"")})});const n=["Naam","Tussen voegsel","Voor letters","Voor naam","ridesCount","Regio Omschrijving"];try{if(typeof CO<"u"&&ca&&Na){const l=ca.book_new(),u=ca.json_to_sheet(t,{header:n});ca.book_append_sheet(l,u,"Leden");const h=Na(l,{bookType:"xlsx",type:"array"}),d=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=document.createElement("a"),g=URL.createObjectURL(d);m.href=g;const p=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");m.download=`leden_export_${p}.xlsx`,document.body.appendChild(m),m.click(),setTimeout(()=>{URL.revokeObjectURL(g),m.remove()},0),r&&(r.textContent=`Gereed  ${t.length} leden`);return}}catch(l){console.warn("XLSX export faalde, fallback CSV:",l)}const i=[n.join(",")];for(const l of t){const u=n.map(h=>{const d=l[h]??"";return`"${String(d).replace(/"/g,'""')}"`});i.push(u.join(","))}const s=new Blob([i.join(`
`)],{type:"text/csv;charset=utf-8"}),a=document.createElement("a"),o=URL.createObjectURL(s);a.href=o;const c=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");a.download=`leden_export_${c}.csv`,document.body.appendChild(a),a.click(),setTimeout(()=>{URL.revokeObjectURL(o),a.remove()},0),r&&(r.textContent=`Gereed  ${t.length} leden`)}catch(e){console.error("Export mislukt:",e),r&&(r.textContent="Mislukt"),alert("Export mislukt. Controleer de console voor details.")}}function Td(){const r=document.getElementById("exportExcelBtn");r&&(r.dataset._wired||(r.addEventListener("click",zO),r.dataset._wired="1"))}document.addEventListener("DOMContentLoaded",()=>{try{Td()}catch{}});var jg;(jg=document.getElementById("adminSubtabs"))==null||jg.addEventListener("click",()=>{setTimeout(()=>{try{Td()}catch{}},0)});if(window.MutationObserver){const r=document.getElementById("viewAdmin");r&&new MutationObserver(()=>{try{Td()}catch{}}).observe(r,{childList:!0,subtree:!0})}const Wu=r=>document.getElementById(r);let Xn=null;async function Ad(){if(Xn)return Xn;const r=Gt(je,"globals","passwords"),e=await Di(r);if(e.exists()){const t=e.data()||{};Xn={inschrijftafel:String(t.inschrijftafel||"Shadow"),hoofdadmin:String(t.hoofdadmin||"1100")}}else{const t={inschrijftafel:"Shadow",hoofdadmin:"1100",updatedAt:Date.now()};await qn(r,t,{merge:!0}),Xn=t}return Xn}async function HO(r){const e=Gt(je,"globals","passwords");await qn(e,{inschrijftafel:String(r||""),updatedAt:Date.now()},{merge:!0}),Xn={...Xn||{},inschrijftafel:String(r||"")}}async function jO(){return(await Ad()).inschrijftafel}async function $O(r){const e=Gt(je,"globals","passwords");await qn(e,{hoofdadmin:String(r||""),updatedAt:Date.now()},{merge:!0}),Xn={...Xn||{},hoofdadmin:String(r||"")}}async function KO(){return(await Ad()).hoofdadmin}const $n=Wu("tabMember"),Kn=Wu("tabAdmin"),Rf=Wu("viewMember"),Ff=Wu("viewAdmin");function qO(){try{const r=sessionStorage.getItem("admin_level")||"admin",e=document.getElementById("viewAdmin");if(!e)return;const t=Array.from(e.querySelectorAll(".card"));r==="root"?(t.forEach(n=>{n.style.display="",n.removeAttribute("hidden")}),document.body.dataset.role="rootadmin"):(document.body.dataset.role="admin",t.forEach(n=>{const i=n.id||"",s=i==="qrScanCard"||i==="manualRideCard";n.style.display=s?"":"none",s||n.setAttribute("hidden","hidden")}))}catch{}}function XO(){try{const r=document.getElementById("adminSubtabs");if(!r)return;if((sessionStorage.getItem("admin_level")||"admin")!=="root"){r.setAttribute("hidden","");return}r.removeAttribute("hidden")}catch{}}function QO(r){const e=r==="member";$n==null||$n.classList.toggle("active",e),Kn==null||Kn.classList.toggle("active",!e),Rf==null||Rf.classList.toggle("active",e),Ff==null||Ff.classList.toggle("active",!e),$n==null||$n.setAttribute("aria-pressed",String(e)),Kn==null||Kn.setAttribute("aria-pressed",String(!e)),window.innerWidth<560&&window.scrollTo({top:0,behavior:"smooth"})}async function YO(r="Wachtwoord",e="Wachtwoord"){return new Promise(t=>{const n=document.createElement("div");n.style.position="fixed",n.style.inset="0",n.style.background="rgba(0,0,0,0.4)",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.zIndex="9999";const i=document.createElement("div");i.style.background="var(--card-bg, #111)",i.style.color="var(--fg, #fff)",i.style.border="1px solid rgba(255,255,255,0.12)",i.style.borderRadius="16px",i.style.padding="18px 16px",i.style.minWidth="320px",i.style.maxWidth="92vw",i.style.boxShadow="0 10px 30px rgba(0,0,0,0.35)",i.setAttribute("role","dialog"),i.setAttribute("aria-modal","true"),i.setAttribute("aria-label",r);const s=document.createElement("h3");s.textContent=r,s.style.margin="0 0 10px 0",s.style.fontSize="18px";const a=document.createElement("input");a.type="password",a.placeholder=e,a.autocomplete="current-password",a.style.width="100%",a.style.padding="10px 12px",a.style.borderRadius="10px",a.style.border="1px solid rgba(255,255,255,0.2)",a.style.background="transparent",a.style.color="inherit";const o=document.createElement("div");o.style.display="flex",o.style.gap="10px",o.style.alignItems="center",o.style.justifyContent="flex-end",o.style.marginTop="12px";const c=document.createElement("button");c.className="btn",c.textContent="Doorgaan";const l=document.createElement("button");l.className="btn btn-ghost",l.textContent="Annuleren",o.appendChild(l),o.appendChild(c),i.appendChild(s),i.appendChild(a),i.appendChild(o),n.appendChild(i),document.body.appendChild(n);let u=!1;function h(d){if(!u){u=!0;try{document.body.removeChild(n)}catch{}t(d)}}c.addEventListener("click",()=>h(a.value||"")),l.addEventListener("click",()=>h(null)),n.addEventListener("click",d=>{d.target===n&&h(null)}),a.addEventListener("keydown",d=>{d.key==="Enter"&&(d.preventDefault(),c.click()),d.key==="Escape"&&(d.preventDefault(),h(null))}),setTimeout(()=>a.focus(),0)})}async function Sd(r){try{await Ad();const e=await YO("Vul uw wachtwoord in","Wachtwoord");if(e==null)return;const t=await KO(),n=await jO();if(e===t)sessionStorage.setItem("admin_ok","1"),sessionStorage.setItem("admin_level","root");else if(e===n)sessionStorage.setItem("admin_ok","1"),sessionStorage.setItem("admin_level","admin");else{window.alert("Wachtwoord onjuist");return}const i=r||"admin-scan.html";typeof i=="string"&&(window.location.href=i)}catch(e){console.error(e),window.alert("Wachtwoordcontrole mislukt")}}window.adminLoginFlow=Sd;$n==null||$n.addEventListener("click",()=>QO("member"));Kn==null||Kn.addEventListener("click",async()=>{await Sd("admin-scan.html")});document.addEventListener("click",r=>{const e=r.target;if(!(e instanceof HTMLElement))return;const t=e.closest("a.nav-link-admin, .nav .tab")||null;if(t&&t instanceof HTMLAnchorElement){const n=t.getAttribute("href")||"";/admin-scan\.html$/i.test(n)&&(r.preventDefault(),Sd(window.location.pathname))}},{passive:!1});kI();OO();function JO(){try{const r=document.getElementById("saveAdminPwd"),e=document.getElementById("newAdminPwd"),t=document.getElementById("pwdStatus");if(!r||!e)return;e.value="",r.addEventListener("click",async()=>{const n=String(e.value||"").trim();if(n.length<3){t&&(t.textContent="Minimaal 3 tekens.",t.classList.add("error"));return}try{await HO(n),t&&(t.textContent=" Nieuw admin-wachtwoord opgeslagen in Firestore.",t.classList.remove("error")),e.value=""}catch(i){console.error(i),t&&(t.textContent=" Opslaan mislukt.",t.classList.add("error"))}})}catch{}}function ZO(){try{const r=document.getElementById("saveRootPwd"),e=document.getElementById("newRootPwd"),t=document.getElementById("rootPwdStatus");if(!r||!e)return;e.value="",r.addEventListener("click",async()=>{const n=String(e.value||"").trim();if(n.length<4){t&&(t.textContent="Minimaal 4 tekens.",t.classList.add("error"));return}try{await $O(n),t&&(t.textContent=" Nieuw hoofdadmin-wachtwoord opgeslagen in Firestore.",t.classList.remove("error")),e.value=""}catch(i){console.error(i),t&&(t.textContent=" Opslaan mislukt.",t.classList.add("error"))}})}catch{}}document.addEventListener("DOMContentLoaded",()=>{try{sessionStorage.getItem("admin_ok")==="1"&&qO();try{XO()}catch{}}catch{}JO(),ZO();const r=document.getElementById("rideConsentGate");if(!r)return;const e=!!document.getElementById("viewAdmin")&&document.getElementById("viewAdmin").classList.contains("active");if(!!document.getElementById("ridePlanSection")||e||/(^|\/)(admin|beheer)(\/|$)/i.test(location.pathname)){r.remove();return}function n(){const a=document.querySelector('#landelijkeSignup, [data-ride-signup="true"]');if(a)return a.closest("section")||a;const c=Array.from(document.querySelectorAll("section h1, section h2, section h3")).find(l=>/inschrijven\s*voor\s*landelijke\s*rit/i.test(l.textContent||""));return c?c.closest("section"):null}const i=n();if(!i){r.remove();return}i.setAttribute("aria-hidden","true"),i.setAttribute("hidden",""),i.style.display="none";const s=document.getElementById("rideConsentBtn");s==null||s.addEventListener("click",()=>{i.removeAttribute("aria-hidden"),i.removeAttribute("hidden"),i.style.display="",r.remove();try{n8()}catch{}const a=i.querySelector("h1, h2, h3, [tabindex]")||i;a&&(a.setAttribute("tabindex","-1"),a.focus({preventScroll:!1}))})});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(r=>{console.log("ServiceWorker registered:",r.scope)}).catch(r=>{console.warn("ServiceWorker registration failed:",r)})});function Ky(r,e){try{const t=document.getElementById("splashProgressBar"),n=document.getElementById("splashCaption");t&&(t.style.width=Math.max(0,Math.min(100,Number(r)||0))+"%"),n&&typeof e<"u"&&(n.textContent=String(e))}catch{}}function qy(){try{const r=document.getElementById("appSplash");if(!r)return;r.setAttribute("aria-hidden","true"),setTimeout(()=>{try{r.style.display="none"}catch{}},300)}catch{}}function e8(){try{const r=document.getElementById("appSplash");if(!r)return;r.setAttribute("aria-hidden","false"),r.style.display=""}catch{}}window.appSplash={setProgress:Ky,hide:qy,show:e8};try{setTimeout(()=>{Ky(100,"Klaar"),qy()},4e3)}catch{}function t8(r){try{const e=new Date(r);return isNaN(e)?String(r):e.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}catch{return String(r)}}function Df(r,e){if(!r)return;if(r.innerHTML="",!e||e.length===0){const n=document.createElement("li");n.textContent="Geen geplande ritten.",r.appendChild(n);return}const t=(Array.isArray(e)?e.slice():[]).filter(n=>{const i=zg(n);return i===null?!0:i>=0});if(t.sort((n,i)=>new Date(n)-new Date(i)),t.length===0){const n=document.createElement("div");n.className="empty-state",n.innerHTML=`
      <div class="empty-state-icon"></div>
      <h3 class="empty-state-title">Nog geen ritten gepland</h3>
      <p class="empty-state-description">
        Er zijn momenteel geen landelijke ritten ingepland. 
        Check later terug of neem contact op met de club voor meer informatie.
      </p>
    `,r.appendChild(n);return}t.forEach(n=>{const i=document.createElement("li"),s=document.createElement("span");s.className="date",s.textContent=t8(n);const a=document.createElement("span");a.className="days-left";const o=zg(n);o===null?a.textContent="-":o===0?a.textContent="Vandaag":o===1?a.textContent="1 dag":o>1?a.textContent=`${o} dagen`:a.textContent=`${Math.abs(o)} dagen geleden`,a.classList.add(r8(o)),i.appendChild(s),i.appendChild(a),r.appendChild(i)})}function zg(r){try{const e=new Date(r);if(isNaN(e))return null;const t=new Date,n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),i=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return Math.round((i-n)/(1e3*60*60*24))}catch{return null}}function r8(r){return r===null?"":r<0?"passed":r<=3?"soon":"upcoming"}function n8(){const r=document.getElementById("plannedRidesSection");r&&(r.style.display="none")}function i8(){const r=document.getElementById("plannedRidesSection");r&&(r.style.display="")}const Hg=["2025-10-25","2025-11-08","2025-12-06"];document.addEventListener("DOMContentLoaded",()=>{try{const r=document.getElementById("plannedRidesList");(async()=>{try{const e=typeof os=="function"?await os():null;e&&Array.isArray(e)&&e.length?Df(r,e):Df(r,Hg)}catch{Df(r,Hg)}})(),i8()}catch(r){console.error("Planned rides init failed",r)}});export{je as a,kx as b,Gt as d,Di as g,OO as i,qn as s};
